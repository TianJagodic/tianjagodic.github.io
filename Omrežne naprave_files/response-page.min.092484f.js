!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1005)}([function(e,t){e.exports=React},function(e,t,r){"use strict";r.d(t,"c",(function(){return u})),r.d(t,"d",(function(){return l})),r.d(t,"b",(function(){return d})),r.d(t,"a",(function(){return y}));var n=r(4),o=r(18),i=r(66),a=r(14),s=Object.freeze({IsKeyField:!1,IsLocalField:!1,IsNumberTypeInDataSource:!1,IsSourceGenerated:!1});function c(e,t){var r=f();if(n.a.isObjectMasterClass(e))r.masterClassGetter=function(){return e};else{if(!(e instanceof Function))throw Error("The parameter of Spec.fromMasterClass should be a master class of a function.");r.masterClassGetter=e}return p(r,t)}function u(e){var t=e;return t&&t.__nerve__&&"Spec"===t.__nerve__.nerveObjectType}function l(e,t){t?Object.keys(t).forEach((function(r){return function e(t,r){r?u(r)?r.__nerve__.isCollection&&e(t+"[0]",r[0]):l(t,r):h(t,"empty field spec")}(e+r,t[r])})):h(e,"there's no spec passed")}function d(e){return u(e)?e.__nerve__.attributes:s}function f(){return{attributes:s,basicTypeName:null,enumTypeGetter:null,isCollection:!1,isLeaf:!1,keyGetter:null,masterClassGetter:null,nullable:!1,nerveObjectType:"Spec"}}function p(e,t){var r={};return m(e,t),Object(i.b)(r,Object(a.e)(e)),r}function m(e,t){if((t=t||{}).IsKeyField){switch(e.basicTypeName){case"boolean":case"string":case"number":break;default:Object(o.c)('"isKeyField" only supported for basic type fields')}t.IsLocalField&&Object(o.c)("a local field can't be key field.")}var r={IsSourceGenerated:!!t.IsSourceGenerated,IsExpandedField:!!t.IsExpandedField,IsKeyField:!!t.IsKeyField,IsLocalField:!!t.IsLocalField,IsNumberTypeInDataSource:!!t.IsNumberTypeInDataSource,SourceFieldName:t.SourceFieldName};e.attributes=Object.freeze(r)}function h(e,t){throw Error("Spec error of "+e+": "+t+".")}function g(e){return function(t,r){return function(e,t,r){var n=f();return n.isLeaf=!0,n.basicTypeName=e,n.keyGetter=r||null,m(n,t),p(n,t)}(e,t,r)}}var y=Object.freeze({create:function(e,t){var r;return m(r=u(e)?Object(a.f)(e.__nerve__):f(),t),Object(a.k)(p(r,t),e)},boolean:g("boolean"),number:g("number"),string:g("string"),enumeration:function(e,t){var r=f();return r.isLeaf=!0,r.basicTypeName="enum",r.enumTypeGetter=e,m(r,t),p(r,t)},reference:g("reference"),collectionOf:function(e,t){var r;r=u(e)?e:n.a.isObjectMasterClass(e)||e instanceof Function?c(e):e;var o=f();o.isCollection=!0;var i=p(o,t);return Object(a.h)(i,0,r),i},fromMasterClass:c})},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(6),o=r(9),i=r(54),a=function(){function e(){}return Object.defineProperty(e,"LocalizedStrings",{get:function(){return e.localizedStrings},set:function(t){e.localizedStrings=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"UniversalHeaderAndFooter",{get:function(){return e.universalHeaderAndFooter},enumerable:!0,configurable:!0}),e.loadLocalizedStrings=function(){return e.deferredLocalizedStrings||(e.deferredLocalizedStrings=$.Deferred(),Object(n.a)().Flighting.isEnabled("MobilePrefetchResourceStrings")&&OfficeFormServerInfo.resourceStrings?(Object(o.a)({eventName:"MobilePrefetchResourceStrings",eventType:"engagement_event"}),e.localizedStrings=OfficeFormServerInfo.resourceStrings,e.deferredLocalizedStrings.resolve(OfficeFormServerInfo.resourceStrings)):e.localizedStrings?e.deferredLocalizedStrings.resolve(e.localizedStrings):Object(i.f)((function(t){e.localizedStrings=t,e.deferredLocalizedStrings.resolve(t)}),(function(t){return e.deferredLocalizedStrings.reject(t)}))),e.deferredLocalizedStrings.promise()},e.loadLanguageStrings=function(t){var r=e.languageStrings[t];if(!r){var n=$.Deferred();r=n.promise(),e.languageStrings[t]=r,Object(i.d)(t,(function(e){return n.resolve(e)}),(function(t){e.loadLocalizedStrings().done((function(e){return n.resolve(e)}))}))}return r},e.loadUniversalHeaderAndFooter=function(){var t=this;return e.deferredUniversalHeaderAndFooter||(e.deferredUniversalHeaderAndFooter=$.Deferred(),Object(i.h)("headerId=OfficeFormsHeader&footerid=OfficeFormsFooter",(function(r){t.universalHeaderAndFooter=r,e.deferredUniversalHeaderAndFooter.resolve(r)}),(function(t){return e.deferredUniversalHeaderAndFooter.reject(t)}))),e.deferredUniversalHeaderAndFooter.promise()},e.languageStrings={},e}()},function(e,t){e.exports=_},function(e,t,r){"use strict";var n,o=r(18),i=function(){function e(t){t instanceof e?this.setData(t.data):this.newData(t)}return Object.defineProperty(e.prototype,"Count",{get:function(){return this.data.fieldCount},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this.hasId(ve(e))},e.prototype.hasId=function(e){return!!this.data.map[e]},e.prototype.intersect=function(e){if(Array.isArray(e))return e.some(this.has.bind(this));var t=this,r=e;if(r.Count<t.Count){var n=t;t=r,r=n}for(var o in t.data.map)if(r.data.map[o])return!0;return!1},e.prototype.intersection=function(t){var r=this;if(Array.isArray(t))return new e(t.filter((function(e){return ge(e)&&r.has(e)})));if(t instanceof e){var n=this,o=t;if(o.Count<n.Count){var i=n;n=o,o=i}var a=new e;for(var s in n.data.map)o.hasId(s)&&a.addFieldSchema(Me(s));return a}return new e},e.prototype.toArray=function(){return Object.keys(this.data.map).map(Me)},e.prototype.clone=function(){return new e(this)},e.prototype.clear=function(){this.newData()},e.prototype.addFieldSchema=function(e){this.has(e)||(this.ensureDataOwnership(),this.internalAddFieldSchema(e))},e.prototype.addFieldSchemas=function(t){var r,n=this;(r=(r=t instanceof e?t.toArray():t).filter((function(e){return!n.has(e)}))).length&&(this.ensureDataOwnership(),this.internalAddFieldSchema.bind(this),r.forEach((function(e){return n.internalAddFieldSchema(e)})))},e.prototype.removeFieldSchema=function(e){this.has(e)&&(this.ensureDataOwnership(),this.internalRemoveFieldSchema(e))},e.prototype.removeFieldSchemas=function(t){var r,n=this;(r=(r=t instanceof e?t.toArray():t).filter((function(e){return n.has(e)}))).length&&(this.ensureDataOwnership(),r.forEach((function(e){return n.internalRemoveFieldSchema(e)})))},e.prototype.ensureDataOwnership=function(){1!==this.data.referenceCount&&this.newData(this.toArray())},e.prototype.internalAddFieldSchema=function(e){var t=ve(e);this.data.map[t]||(this.data.map[t]=!0,++this.data.fieldCount)},e.prototype.internalRemoveFieldSchema=function(e){var t=ve(e);this.data.map[t]&&(delete this.data.map[t],--this.data.fieldCount)},e.prototype.newData=function(e){this.setData({map:{},fieldCount:0,referenceCount:0}),e&&this.addFieldSchemas(e)},e.prototype.setData=function(e){this.data&&--this.data.referenceCount,this.data=e,++this.data.referenceCount},e}(),a=r(66),s=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.toJSON=function(){return this.__nerve__.master.getSnapshot()},t}(a.a),u=r(14),l=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function d(e){if(e instanceof c)return e.__nerve__.master;Object(o.c)("Invalid parameter: please use '<your master>.Model.*' for the parameter.")}function f(e){return function(e){if(e instanceof p)return e.constructor;Object(o.c)("the parameter is not a nerve master object.")}(e).__nerve__.masterName}var p=function(e){function t(t){var r=e.call(this)||this,n=r.__nerve__,o=t&&t.Reserved&&t.Reserved.Membership;o&&(n.membership=Object(u.e)(o),Object(u.n)(n,"membership"));var i=!1;return Object(u.j)(n,"deleted",(function(){return i}),(function(e){if(!i&&e){i=!0,n.dirtyChecker.updateDirtiness();var t=n.changeManager;t.startBulkEditMode(),n.markChildrenAsDeleted(),t.markAsDeleted(),t.endBulkEditMode()}})),n.instanceId=(++m).toString(),Object(u.n)(n,"instanceId"),r}return l(t,e),Object.defineProperty(t.prototype,"Schema",{get:function(){return Object(o.d)()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Model",{get:function(){return this.__nerve__.model},set:function(e){this.setData(e,this.Schema.__nerve__.subFields.toArray())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Parent",{get:function(){var e=this.__nerve__.membership;return e&&e.Parent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Membership",{get:function(){var e=this.__nerve__.membership;return{Parent:e&&e.Parent,FieldSchema:e&&e.FieldSchema}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Deleted",{get:function(){return this.__nerve__.deleted},set:function(e){this.__nerve__.deleted=e},enumerable:!0,configurable:!0}),t.prototype.getInstanceId=function(){return this.__nerve__.instanceId},t.prototype.getSnapshot=function(e){return this.__nerve__.changeManager.getSnapshot(e)},t.prototype.bulkEdit=function(e){var t=this.__nerve__.changeManager;t&&t.startBulkEditMode();try{return e(this.Model)}finally{t&&t.endBulkEditMode()}},t.prototype.observe=function(e,t){return this.__nerve__.changeManager.observe(e,t)},t.prototype.unobserve=function(e,t){return this.__nerve__.changeManager.unobserve(e,t)},t.prototype.addRule=function(e){return this.__nerve__.changeManager.addRule(e)},t.prototype.removeRule=function(e){return this.__nerve__.changeManager.removeRule(e)},t}(a.a),m=0,h=function(){function e(e){this.master=e,this.observers=[],this.bulkChangingModeStackedCount=0,this.changingPeriod=$.Deferred().resolve(),this.changeNotifier=new u.a(this.notifyChange.bind(this)),this.rules=[],this.initializeSnapshot(),this.resetChangeInfo()}return e.prototype.getSnapshot=function(e){if(!this.snapshotCache){for(var t in this.dirtyProperties)this.refreshSubSnapshot(this.dirtyProperties[t]);this.dirtyProperties={},this.snapshotCache=this.createSnapshotCache()}return this.snapshotCache},e.prototype.definitelyMarkAsChanged=function(e){this.defnitelyMarkedAsChanged=!0,this.markAsChanged(e)},e.prototype.markAsChanged=function(e,t){this.ensureChangingPeriodStarted();var r=e.FieldSchema,n=new i([r]);if(this.changedFields.addFieldSchema(r),t){this.subChanges.push(t);var o=t.FieldSchemas.map(r.__nerve__.shadowMapper);n.addFieldSchemas(o)}this.markFieldsAsChanged(n)},e.prototype.markAsDeleted=function(){this.markFieldsAsChanged([this.master.Schema])},e.prototype.startBulkEditMode=function(){++this.bulkChangingModeStackedCount},e.prototype.endBulkEditMode=function(){--this.bulkChangingModeStackedCount<=0&&(this.bulkChangingModeStackedCount=0,this.changeNotifier.flush())},e.prototype.observe=function(e,t){var r=this.observers[this.getIndexOfObserverInfo(e)];r?t?r.fieldSet.addFieldSchemas(t):r.fieldSet=this.getAllFields().clone():this.observers.push({callback:e,fieldSet:new i(t||this.getAllFields())})},e.prototype.unobserve=function(e,t){var r=this.getIndexOfObserverInfo(e),n=this.observers[r];n&&(t?t.forEach((function(e){n.fieldSet.removeFieldSchemas(e.__nerve__.allContainedFields)})):n.fieldSet.clear(),0===n.fieldSet.Count&&this.observers.splice(r,1))},e.prototype.addRule=function(e){this.rules.indexOf(e)<0&&this.rules.push(e)},e.prototype.removeRule=function(e){var t=this.rules.indexOf(e);t>=0&&this.rules.splice(t,1)},e.prototype.markSubSnapshotAsDirty=function(e){var t=this;if(e.length){this.snapshotCache=void 0,e.forEach((function(e){return t.dirtyProperties[e.Name]=e}));var r=this.Master.__nerve__.membership,n=r&&r.Parent.__nerve__.changeManager;n&&n.markSubSnapshotAsDirty([r.Property])}},e.prototype.getChangingPeriod=function(){return this.changingPeriod.promise()},Object.defineProperty(e.prototype,"Master",{get:function(){return this.master},enumerable:!0,configurable:!0}),e.prototype.createChange=function(e){var t=this.Master.__nerve__.deleted&&!this.markedAsDeleted;return{BeingDeleted:t,DefinitelyMarked:this.defnitelyMarkedAsChanged,FieldSchemas:Object.freeze(e.toArray()),Master:this.Master,NewValues:t?null:this.getSnapshot(),OldValues:this.snapshotBeforeChange,SubChanges:Object.freeze(this.subChanges),UpdateNeeded:t}},e.prototype.resetChangeInfo=function(){this.changedFields=new i,this.subChanges=[],this.snapshotBeforeChange=this.getSnapshot(),this.markedAsDeleted=this.master.Deleted,this.defnitelyMarkedAsChanged=!1},e.prototype.notifyChangeIfNeed=function(){this.bulkChangingModeStackedCount>0?this.changeNotifier.callOnceLater():this.changeNotifier.callImmediately()},e.prototype.anythingChanged=function(){return this.changedFields.Count>0||this.Master.__nerve__.deleted},e.prototype.markFieldsAsChanged=function(e){this.changedFields.addFieldSchemas(e),this.underRuling?this.changedByRules=!0:this.notifyChangeIfNeed()},e.prototype.shouldObserverBeNotified=function(e,t){return e.fieldSet.intersect(t.FieldSchemas)},e.prototype.removeUnchangedFields=function(e,t){},e.prototype.getIndexOfObserverInfo=function(e){for(var t=0;t<this.observers.length;++t)if(this.observers[t].callback===e)return t},e.prototype.notifyChange=function(){var e=this;if(this.applyRules(),this.endCurrentChangingPeriod(),this.defnitelyMarkedAsChanged||this.Master.Deleted||this.removeUnchangedFields(this.changedFields,this.snapshotBeforeChange),this.anythingChanged()){var t=Object.freeze(this.createChange(this.changedFields));this.resetChangeInfo();var r=this.Master.__nerve__.membership;if(r&&r.Property.Mounted){var n=r.Parent.__nerve__.changeManager;n&&n.markAsChanged(r.Property,t)}this.observers.concat().forEach((function(r){e.shouldObserverBeNotified(r,t)&&r.callback(t)}))}},e.prototype.applyRules=function(){var e=this;this.underRuling=!0;var t=0,r=this.changedFields,n=this.subChanges,o=[],a=function(){var a=s.rules.filter((function(t){return!t.InterestedFields||e.changedFields.intersect(t.InterestedFields)}));if(!a.length)return"break";if(++t>8*s.rules.length)return s.warnForAgainstingRules(o),"break";var c=s.changedFields,u=s.subChanges;s.changedFields=new i,s.subChanges=[];var l=s.Master.__nerve__.deleted&&!s.markedAsDeleted;a.forEach((function(t){e.changedByRules=!1,t.onChange({Master:e.Master,BeingDeleted:l,FieldSchemas:c.toArray(),OldValues:e.snapshotBeforeChange,SubChanges:u}),e.changedByRules&&o.push(t)})),r.addFieldSchemas(s.changedFields),n.push.apply(n,s.subChanges)},s=this;do{if("break"===a())break}while(this.changedFields.Count);this.underRuling=!1,this.changedFields=r,this.subChanges=n},e.prototype.warnForAgainstingRules=function(e){Object(o.f)("following rules might do against each other: "+JSON.stringify(e.map((function(e){return e.Name})))+" (master: "+f(this.Master)+")")},e.prototype.getAllFields=function(){return this.Master.Schema.__nerve__.allContainedFields},e.prototype.ensureChangingPeriodStarted=function(){"pending"!==this.changingPeriod.state()&&(this.changingPeriod=$.Deferred())},e.prototype.endCurrentChangingPeriod=function(){this.changingPeriod.resolve()},e}(),g=function(){function e(e,t,r){var n=this;this.name=e,this.fieldSchema=t;var o=r.Reserved.Membership;this.parentMaster=o.Parent,o.Property=this,this.isMounted=!1,r.Reserved.Mounted.done((function(){return n.isMounted=!0}))}return Object.defineProperty(e.prototype,"Name",{get:function(){return this.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FieldSchema",{get:function(){return this.fieldSchema},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ParentMaster",{get:function(){return this.parentMaster},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Index",{get:function(){return this.index},set:function(e){if(e!==this.index){var t=this.index;this.index=e;var r=this.ParentMaster;this.indexDirtinessUpdateNeeded()&&r.__nerve__.dirtyChecker.updateDirtinessForIndexChange(this),this.Mounted&&r.__nerve__.changeManager.onPropertyIndexChange(this,t)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Mounted",{get:function(){return this.isMounted},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Deleted",{get:function(){return this.deleted},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ParentDirtyChecker",{get:function(){return this.ParentMaster.__nerve__.dirtyChecker},enumerable:!0,configurable:!0}),e.prototype.markAsDeleted=function(e){this.deleted=!0,this.Index=void 0},e.prototype.getKey=function(){return this.fieldSchema.__nerve__.getKey(this.getter())},e}(),y=function(){function e(e){this.popupRequired=e}return e.prototype.updateDirtiness=function(){if(this.popupRequired){var e=this.getProperty();e.ParentMaster.__nerve__.dirtyChecker.setMemberDirtiness(e.Name,this.isDirty())}},e}(),b=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),v=function(e){function t(t,r){var n=e.call(this,r)||this;return n.property=t,n}return b(t,e),t.prototype.isDirty=function(){return this.sourceData!==this.convertModelToSourceData()},t.prototype.initializeSourceData=function(e){this.setSourceData(e)},t.prototype.getDelta=function(){return this.convertModelToSourceData()},t.prototype.getSnapshotToUpdate=function(){return this.convertModelToSourceData()},t.prototype.getSourceData=function(){return this.sourceData},t.prototype.setSourceData=function(e){void 0===e&&(e=null),this.sourceData=e,this.updateDirtiness()},t.prototype.onSourceDataReceived=function(e){var t=this.isDirty();this.setSourceData(e),t||this.property.setter(this.convertFromSourceData(e))},t.prototype.getProperty=function(){return this.property},t.prototype.convertModelToSourceData=function(){return this.property.getter()},t.prototype.convertFromSourceData=function(e){return e},t}(y),S=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),I=function(e){function t(t,r,n){var o=e.call(this,t,r,n)||this;o.value=o.normalizeValue(n.InitialData);var i=!r.__nerve__.info.Attributes.IsLocalField;return o.dirtyChecker=o.createDirtyChecker(i),o}return S(t,e),t.prototype.getter=function(){return this.value},t.prototype.setter=function(e){if(e=this.normalizeValue(e),this.value!==e){this.value=e,this.dirtyChecker.updateDirtiness();var t=this.ParentMaster.__nerve__.changeManager;t.markSubSnapshotAsDirty([this]),t.markAsChanged(this)}},t.prototype.getDirtyChecker=function(){return this.dirtyChecker},t.prototype.normalizeValue=function(e){return null==e?null:e},t.prototype.createDirtyChecker=function(e){return new v(this,e)},t.prototype.indexDirtinessUpdateNeeded=function(){return!0},t}(g),M=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),F=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return M(t,e),t.prototype.convertModelToSourceData=function(){return this.convert(this.getProperty().getter())},t.prototype.convertFromSourceData=function(e){return this.convert(e)},t.prototype.convert=function(e){return null==e?null:this.getProperty().FieldSchema.__nerve__.enumType[e]},t}(v),O=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return O(t,e),t.prototype.normalizeValue=function(e){var t=typeof e;if("string"===t||"number"===t){var r=this.FieldSchema.__nerve__.enumType;if(e in r)return"string"===t?r[e]:e}return null},t.prototype.createDirtyChecker=function(e){return new F(this,e)},t}(I),P=r(1);function T(e){return e.__nerve__.info.IsLeaf}function w(e,t,r,n,o){var i=Te({enumTypeGetter:r.__nerve__.enumTypeGetter,getKeyForReferenceType:r.__nerve__.keyGetter,info:{Attributes:Object(P.b)(r),FieldId:e,IsLeaf:!0,IsCollection:!1,Name:n,Path:o||n},parentMasterClass:t,parentSchema:t.__nerve__.schema,withDataSource:!1});return i.__nerve__.generateProperty=function(e){return e.__nerve__.asEnum?function(t,r){return new C(t,e,r)}:function(t,r){return new I(t,e,r)}}(i),Object(u.n)(i.__nerve__,"generateProperty"),i}var _=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return _(t,e),t.prototype.markAsChanged=function(t,r){r&&r.BeingDeleted?this.Master.deleteItems([t.getter()]):e.prototype.markAsChanged.call(this,t,r)},t.prototype.onPropertiesAdded=function(e){e.length&&(this.addedProperties=this.addedProperties.concat(e),this.snapshot=void 0,this.markSubSnapshotAsDirty(e),this.markFieldsAsChanged(this.Master.Schema.__nerve__.allContainedFields))},t.prototype.onPropertiesRemoved=function(e){var t=this;e.length&&(e.forEach((function(e){var r=t.addedProperties.indexOf(e);r>=0?t.addedProperties.splice(r,1):t.removedProperties.push(e),t.indexChanges[e.Name]&&(delete t.indexChanges[e.Name],--t.indexChangedPropertyCount)})),this.snapshot=void 0,this.markSubSnapshotAsDirty(e),this.markFieldsAsChanged(this.Master.Schema.__nerve__.allContainedFields))},t.prototype.onPropertyIndexChange=function(e,t){this.markSubSnapshotAsDirty([e]),this.indexChanges[e.Name]?this.indexChanges[e.Name].NewIndex=e.Index:(this.indexChanges[e.Name]={OldIndex:t,NewIndex:e.Index},++this.indexChangedPropertyCount),this.notifyChangeIfNeed()},t.prototype.initializeSnapshot=function(){T(this.Master.Schema[0])?this.getSubSnapshot=t.getSubSnapshotForLeafContent:this.getSubSnapshot=t.getSubSnapshotForMasterContent,this.createSnapshot()},t.prototype.refreshSubSnapshot=function(e){this.snapshot&&!e.Deleted&&(this.snapshot[e.Index]=this.getSubSnapshot(e.getter()))},t.prototype.createSnapshotCache=function(){return this.snapshot||this.createSnapshot(),this.snapshot.concat()},t.prototype.createChange=function(t){var r=this,n=e.prototype.createChange.call(this,t),o=function(e){return e.getter()},i=function(e){return r.getSubSnapshot(e)};n.AddedModels=Object.freeze(this.addedProperties.map(o)),n.AddedItemsAsSnapshots=Object.freeze(n.AddedModels.map(i)),n.RemovedModels=Object.freeze(this.removedProperties.map(o)),n.RemovedItemsAsSnapshots=Object.freeze(n.RemovedModels.map(i));var a={};Object.keys(this.indexChanges).forEach((function(e){var t=r.indexChanges[e];null!=t.NewIndex&&null!=t.OldIndex&&(a[t.NewIndex]=t.OldIndex)})),n.ChangedIndexMap=Object.freeze(a);var s=this.Master.Schema[0];return n.UpdateNeeded||s.__nerve__.info.Attributes.IsLocalField||(n.UpdateNeeded=n.AddedModels.length>0||n.RemovedModels.length>0||n.SubChanges.some((function(e){return e.UpdateNeeded}))),n},t.prototype.resetChangeInfo=function(){e.prototype.resetChangeInfo.call(this),this.addedProperties=[],this.removedProperties=[],this.indexChanges={},this.indexChangedPropertyCount=0},t.prototype.anythingChanged=function(){return this.addedProperties.length>0||this.removedProperties.length>0||this.indexChangedPropertyCount>0||e.prototype.anythingChanged.call(this)},t.prototype.shouldObserverBeNotified=function(t,r){return!!Object.keys(r.ChangedIndexMap).length||e.prototype.shouldObserverBeNotified.call(this,t,r)},t.prototype.createSnapshot=function(){this.snapshot=[];for(var e=this.Master.Model,t=0;t<e.length;++t)this.snapshot[t]=this.getSubSnapshot(e[t])},t.getSubSnapshotForLeafContent=function(e){return e},t.getSubSnapshotForMasterContent=function(e){return d(e).getSnapshot()},t}(h),R=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),D=function(e){function t(t,r,n){var o=e.call(this,n)||this;return o.memberDirtinesses={},o.dirtinessCount=0,o.master=t,o.existingInSource=r,o}return R(t,e),Object.defineProperty(t.prototype,"Master",{get:function(){return this.master},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ExistingInSource",{get:function(){return this.existingInSource},set:function(e){this.existingInSource=e,this.updateDirtiness()},enumerable:!0,configurable:!0}),t.prototype.isDirty=function(){if(this.master.__nerve__.deleted){var e=this.Master.Parent;return!(e&&e.__nerve__.deleted)&&this.existingInSource}return 0!==this.dirtinessCount},t.prototype.setMemberDirtiness=function(e,t){!this.memberDirtinesses[e]!=!t&&(t?(this.memberDirtinesses[e]=!0,0==this.dirtinessCount++&&this.updateDirtiness()):(delete this.memberDirtinesses[e],0==--this.dirtinessCount&&this.updateDirtiness()))},t.prototype.getDirtyKeys=function(){return Object.keys(this.memberDirtinesses)},t.prototype.getProperty=function(){return this.master.__nerve__.membership.Property},t}(y),A=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),L=function(e){function t(t,r,n){var o=e.call(this,t,r,n)||this;return o.updateMembersWithSourceData([]),o}return A(t,e),t.prototype.initializeSourceData=function(e){var t=this;this.updateMembersWithSourceData(e||[]),this.getProperties().forEach((function(e){var r=e.getDirtyChecker(),n=t.sourceData[t.getSourceIndexForProperty(e)];r.initializeSourceData(n)})),this.updateDirtinessForLength(this.Master.Model.length)},t.prototype.getDelta=function(){return Object(o.e)("get delta for collection is not supported yet.")},t.prototype.getSnapshotToUpdate=function(){return this.getProperties().map((function(e){return e.getDirtyChecker()})).map((function(e){return e.getSnapshotToUpdate()}))},t.prototype.getSourceData=function(){return Ce(this.sourceData,this.Master.Schema)},t.prototype.setSourceData=function(e){this.setSourceDataInternal(e||[])},t.prototype.onSourceDataReceived=function(e){e=e||[],this.updateMembersWithSourceData(e),this.Master.Model.__nerve__.onSourceDataReceived(e),this.updateDirtinessForLength(this.Master.Model.length)},t.prototype.updateDirtinessForLength=function(e){this.setMemberDirtiness("length",e!==this.getSourceDataLength())},t.prototype.updateDirtinessForIndexChange=function(e){e.Deleted?this.setMemberDirtiness(e.Name,!1):e.getDirtyChecker().setSourceData(this.sourceData[e.Index])},t.prototype.getSourceDataLength=function(){return this.sourceData.length},t.prototype.setSourceDataInternal=function(e){var t=this;this.updateMembersWithSourceData(e),this.getProperties().forEach((function(e){var r=e.getDirtyChecker(),n=t.getSourceIndexForProperty(e);r.setSourceData(t.sourceData[n]),r instanceof D&&(r.ExistingInSource=n<t.sourceData.length)})),this.updateDirtinessForLength(this.Master.Model.length)},t.prototype.getProperties=function(){return this.Master.Model.__nerve__.properties},t.prototype.updateMembersWithSourceData=function(e){var t=this;this.sourceData=e;var r=this.Master.Schema[0];r.__nerve__.withKey&&(this.sourceKeyIndexMap={},e.map(r.__nerve__.getKeyFromSourceData).forEach((function(e,r){e&&(t.sourceKeyIndexMap[e]=r)})))},t.prototype.getSourceIndexForProperty=function(e){return this.Master.Schema[0].__nerve__.withKey?this.sourceKeyIndexMap[e.getKey()]:e.Index},t}(D),N=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),k=function(e){function t(t,r){var n,o,i=this,a=t.Schema[0];a.__nerve__.withKey?(n=q,o=W):(n=a.__nerve__.info.IsLeaf?V:H,o=G);var s=r.Reserved&&r.Reserved.ParentExistingInDataSource;return i=e.call(this,{master:t,keyToProperty:a.__nerve__.withKey?{}:null,initializedLength:0,newestPropertyName:0,masterTreeReady:r.MasterTreeReady,properties:[],addItems:function(e,t){return x(i,e,t,s)},deleteItems:function(e,t){return function(e,t,r){var n=e.__nerve__.properties.filter((function(e){var r=e.getter();return t.some((function(e){return e===r}))}));return z(e,n,r),n}(i,e,t)},setData:function(e){return n(i,e)},onSourceDataReceived:function(e){return o(i,e)},setComparer:function(e){i.__nerve__.comparer=e,i.__nerve__.propertyComparer=e&&function(t,r){return e(t.getter(),r.getter())},e&&Q(i,i.__nerve__.propertyComparer)}})||this,x(i,Object(u.g)(r.InitialData),r.ExistingInDataSource,s),i}return N(t,e),Object.defineProperty(t.prototype,"length",{get:function(){return this.__nerve__.properties.length},enumerable:!0,configurable:!0}),t}(c);function x(e,t,r,n){var o=e.__nerve__.master,i=o.Schema[0],a=i.__nerve__.generateProperty,s=$.Deferred(),c=$.when(e.__nerve__.masterTreeReady,s.promise()),u=t.map((function(t){return a((++e.__nerve__.newestPropertyName).toString(),{InitialData:t,ExistingInDataSource:r,MasterTreeReady:c,Reserved:{Membership:{Parent:o,FieldSchema:i},ParentExistingInDataSource:n,Mounted:s}})}));if(i.__nerve__.withKey){var l=e.__nerve__.keyToProperty;if(i.__nerve__.withDataSource){var d=i.__nerve__.keyFields.toArray();u.forEach((function(e){e.Master.Synchronizer.ensureFieldsReady(d).done((function(){return j(l,e)}))}))}else u.forEach((function(e){return j(l,e)}))}var f=e.__nerve__.properties,p=f.length;return o.bulkEdit((function(){f.push.apply(f,u),function(e){var t=e.__nerve__,r=t.properties.length;for(;t.initializedLength<r;)U(e,t.initializedLength),++t.initializedLength}(e);for(var t=p;t<f.length;++t)f[t].Index=t;o.__nerve__.dirtyChecker.updateDirtinessForLength(f.length);var r=e.__nerve__.propertyComparer;r&&Q(e,r),s.resolve();var n=o.__nerve__.changeManager;n&&n.onPropertiesAdded(u)})),u}function j(e,t){var r=t.getKey();r in e&&Object(o.c)('duplicated key "'+r+'" at '+Ie(t.FieldSchema)+" is being added."),e[r]=t}function U(e,t){Object(u.j)(e,t,(function(){return this.__nerve__.properties[t].getter()}),(function(e){this.__nerve__.properties[t].setter(e)}))}function z(e,t,r){var n=t.length;if(n>0){var o=e.__nerve__.properties,i=o.length,a=e.__nerve__.master;a.bulkEdit((function(){for(;n>0;--n){for(var s=t[n-1];--i>s.Index;)o[i].Index-=n;o.splice(i,1),s.markAsDeleted(r)}var c=a.Schema[0];if(c.__nerve__.withKey){var u=e.__nerve__.keyToProperty;if(c.__nerve__.withDataSource){var l=c.__nerve__.keyFields.toArray();t.forEach((function(e){e.Master.Synchronizer.ensureFieldsReady(l).done((function(){return B(u,e)}))}))}else t.forEach((function(e){return B(u,e)}))}a.__nerve__.dirtyChecker.updateDirtinessForLength(o.length),a.__nerve__.changeManager.onPropertiesRemoved(t)}))}}function B(e,t){var r=t.getKey();t===e[r]&&delete e[r]}function Q(e,t){t&&e.__nerve__.properties.sort(t),e.__nerve__.master.bulkEdit((function(){e.__nerve__.properties.forEach((function(e,t){e.Index=t}))}))}function q(e,t){var r=e.__nerve__.master,n=e.__nerve__.master.Schema[0],o=e.__nerve__.properties,i={};t.map(n.__nerve__.getKey).forEach((function(e,t){return i[e]=t}));var a={};o.forEach((function(e){return a[e.getKey()]=e}));var s={};r.bulkEdit((function(){var r=[];for(var n in i){var o=i[n];if(n in a){var c=a[n];c.setter(t[o]),s[c.Name]=o,delete a[n]}else r.push(o)}var u=[];for(var n in a)u.push(a[n]);u.length&&(u.sort((function(e,t){return e.Index-t.Index})),z(e,u,!1)),r.length&&e.__nerve__.addItems(r.map((function(e){return t[e]})),!1).forEach((function(e,t){return s[e.Name]=r[t]}));var l=function(e,t){return s[e.Name]-s[t.Name]},d=e.__nerve__.propertyComparer;Q(e,d?function(e,t){return d(e,t)||l(e,t)}:l)}))}function V(e,t){for(var r=e.__nerve__.master,n={},i=Object(u.g)(e.__nerve__.master.getSnapshot()).slice(),a=[],s={},c=0;c<t.length;++c){var l=t[c],d=i.indexOf(l);d<0?a.push(l):(s[c]=d,i[d]=n)}var f=e.__nerve__.properties,p=[];for(c=0;c<i.length;++c)i[c]!==n&&p.push(f[c]);var m=f.slice();r.bulkEdit((function(){var r=e.__nerve__.addItems(a,!1);p.length&&(p.sort((function(e,t){return e.Index-t.Index})),z(e,p,!1)),Object(o.a)(t.length===f.length,"All items should be updated into properties.");for(var n=0,i=0;i<t.length;++i)null==s[i]?f[i]=r[n++]:f[i]=m[s[i]];Q(e,e.__nerve__.propertyComparer)}))}function H(e,t){e.__nerve__.master.bulkEdit((function(){for(var r=e.length,n=Math.min(r,t.length),o=e.__nerve__.properties,i=0;i<n;++i)o[i].setter(t[i]);if(r<t.length)e.__nerve__.addItems(t.slice(e.length),!1);else if(r>t.length){var a=e.__nerve__.properties.slice(t.length);z(e,a,!1)}}))}function W(e,t){var r=e.__nerve__.master;r.bulkEdit((function(){var n,o=r.Schema[0].__nerve__,i=e.__nerve__.keyToProperty,a={},s=[];t.map(o.getKeyFromSourceData).forEach((function(e,r){a[e]=r,e in i?i[e].getDirtyChecker().onSourceDataReceived(t[r]):s.push(t[r])})),n=o.withDataSource?function(e){return"resolved"===e.Master.Synchronizer.existingInDataSource().state()&&!(e.getKey()in a)}:function(e){return!(e.getKey()in a)};var c=e.__nerve__.properties.filter(n);z(e,c,!0);var u=Fe(s,r.Schema);e.__nerve__.addItems(u,!0);var l=e.__nerve__.propertyComparer;l||(l=function(e,t){return a[e.getKey()]-a[t.getKey()]}),Q(e,l)}))}function G(e,t){var r=e.__nerve__.master;r.bulkEdit((function(){for(var n=e.length,o=Math.min(n,t.length),i=e.__nerve__.properties,a=0;a<o;++a)i[a].getDirtyChecker().onSourceDataReceived(t[a]);if(n<t.length){var s=Fe(t.slice(n),r.Schema);e.__nerve__.addItems(s,!0)}else if(n>t.length){var c=e.__nerve__.properties.slice(t.length);z(e,c,!0)}}))}var K=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();var J=function(e){function t(t){var r;t=t||{};var n=r=e.call(this,t)||this,o=r.__nerve__;o.markChildrenAsDeleted=function(){var e;T((e=n).Schema[0])||Object(u.g)(e.Model).map(d).forEach((function(e){return e.Deleted=!0}))},Object(u.n)(o,"markChildrenAsDeleted");var i=r.Schema.__nerve__,a=!i.withDataSource&&!i.info.Attributes.IsLocalField;return o.dirtyChecker=new L(n,t.ExistingInDataSource,a),Object(u.n)(o,"dirtyChecker"),o.model=new k(n,t),Object(u.n)(o,"model"),o.changeManager=new E(n),Object(u.n)(o,"changeManager"),r}return K(t,e),t.prototype.addItems=function(e){return this.Model.__nerve__.addItems(e,!1).map((function(e){return e.getter()}))},t.prototype.deleteItems=function(e){return this.Model.__nerve__.deleteItems(e,!1).map((function(e){return e.getter()}))},t.prototype.itemsAddedInSource=function(e){return this.Model.__nerve__.addItems(e,!0).map((function(e){return e.getter()}))},t.prototype.itemsDeletedInSource=function(e){return this.Model.__nerve__.deleteItems(e,!0).map((function(e){return e.getter()}))},t.prototype.getItemWithKeyFields=function(e){var t=this.Schema[0].__nerve__.getKey(e),r=this.Model.__nerve__.keyToProperty[t];return r&&r.getter()},t.prototype.getIndexWithKeyFields=function(e){var t=this.Schema[0].__nerve__.getKey(e),r=this.Model.__nerve__.keyToProperty[t];return r?r.Index:-1},t.prototype.markAsChanged=function(e){var t=this.Model.__nerve__.properties[e];t&&this.__nerve__.changeManager.definitelyMarkAsChanged(t)},t.prototype.setComparer=function(e){this.Model.__nerve__.setComparer(e)},t.prototype.setData=function(e){this.Model.__nerve__.setData(Object(u.g)(e))},t}(p);var Y=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),X=function(e){function t(t,r,n){var o=e.call(this,t,r,n)||this,i=r.__nerve__.subMasterClassGetter();return o.master=new i(n),o}return Y(t,e),Object.defineProperty(t.prototype,"Master",{get:function(){return this.master},enumerable:!0,configurable:!0}),t.prototype.getter=function(){return this.master.Model},t.prototype.setter=function(e){this.master.setData(e,this.master.Schema.__nerve__.subFields.toArray())},t.prototype.markAsDeleted=function(t){e.prototype.markAsDeleted.call(this,t),t&&(this.getDirtyChecker().ExistingInSource=!1),this.master.Deleted=!0},t.prototype.getDirtyChecker=function(){return this.master.__nerve__.dirtyChecker},t.prototype.indexDirtinessUpdateNeeded=function(){return!this.FieldSchema.__nerve__.withDataSource},t}(g);function Z(e){return e.__nerve__.info.IsCollection}function ee(e,t,r,n,i,a){var s=r.Schema,c=s.__nerve__,l=Te({enumTypeGetter:c.enumTypeGetter,getKeyForReferenceType:c.getKeyForReferenceType,info:{Attributes:a,FieldId:e,IsCollection:c.info.IsCollection,IsLeaf:c.info.IsLeaf,Name:n,Path:i||n},parentMasterClass:t,parentSchema:t.__nerve__.schema,shadowParent:s,shadowRoot:s,subMasterClassGetter:function(){return r},withDataSource:c.withDataSource}),d={};return d[ve(r.__nerve__.schema)]=l,l.__nerve__.generateProperty=function(e){return function(t,r){return new X(t,e,r)}}(l),Object(u.n)(l.__nerve__,"generateProperty"),l.__nerve__.shadowMapper=function(e,t){return function r(n){var i=ve(n),a=t[i];if(!a){var s=n.__nerve__.parentSchema;a=(ge(s)?r(s):e)[Se(n)],Object(o.a)(a===t[i],"the new shadow should be added into the shadow map.")}return a}}(l,d),Object(u.n)(l.__nerve__,"shadowMapper"),te(l,r.Schema,d),l}function te(e,t,r){Object.keys(t).forEach((function(n){Object(u.i)(e,n,function(e,t,r,n){return function(){var o=t[r],i=o.__nerve__,a=Te({enumTypeGetter:i.enumTypeGetter,getKeyForReferenceType:i.getKeyForReferenceType,info:{Attributes:i.info.Attributes,FieldId:_e(),IsCollection:i.info.IsCollection,IsLeaf:i.info.IsLeaf,Name:r,Path:we(e.__nerve__.info.Path,r)},parentSchema:e,parentMasterClass:e.__nerve__.parentMasterClass,shadowParent:o,shadowRoot:i.shadowRoot,subMasterClassGetter:i.subMasterClassGetter,withDataSource:i.withDataSource});return n[ve(o)]=a,te(a,o,n),a}}(e,t,n,r))}))}var re={ObjectSynchronizer:void 0},ne=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),oe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ne(t,e),t.prototype.getSnapshot=function(t){var r=e.prototype.getSnapshot.call(this,t);if(!t)return r;var n={};return this.Master.Schema.__nerve__.subFields.intersection(t).toArray().map(Se).forEach((function(e){return n[e]=r[e]})),n},t.prototype.initializeSnapshot=function(){var e=this;this.snapshot={};var t=this.Master,r=t.Schema.__nerve__.subFields.toArray();if(le(t)){var n=t;r=r.filter((function(e){return n.isFieldReady(e)}))}r.forEach((function(t){return e.refreshSubSnapshotWithFieldSchema(t)}))},t.prototype.refreshSubSnapshot=function(e){this.refreshSubSnapshotWithFieldSchema(e.FieldSchema)},t.prototype.createSnapshotCache=function(){return Object.freeze(Object(u.f)(this.snapshot))},t.prototype.createChange=function(t){var r=e.prototype.createChange.call(this,t);return r.UpdateNeeded||(r.UpdateNeeded=t.toArray().some((function(e){return e.__nerve__.info.IsLeaf&&!e.__nerve__.info.Attributes.IsLocalField}))),r.UpdateNeeded||(r.UpdateNeeded=r.SubChanges.filter((function(e){return e.UpdateNeeded})).some((function(e){var r=e.Master.Membership.FieldSchema;return t.has(r)&&!r.__nerve__.info.Attributes.IsLocalField}))),r},t.prototype.removeUnchangedFields=function(e,t){var r=this,n=this.Master.Schema,o=e.toArray().filter((function(e){if(e.__nerve__.parentSchema===n&&T(e)){var o=Se(e);return r.Master.Model[o]===t[o]}return!1}));e.removeFieldSchemas(o)},t.prototype.refreshSubSnapshotWithFieldSchema=function(e){var t=Se(e),r=this.Master.Model[t];if(T(e))this.snapshot[t]=r;else{var n=d(r);this.snapshot[t]=n.getSnapshot()}},t}(h),ie=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ie(t,e),t.prototype.initializeSourceData=function(e){e=this.getNormalizedSourceData(e);var t=this.Master.Schema,r=this.Master.Model.__nerve__.properties;for(var n in r){var o=t[n].__nerve__.sourceName;r[n].getDirtyChecker().initializeSourceData(e[o])}},t.prototype.getDelta=function(){var e=this;if(this.isDirty()){var t=this.Master.Schema,r={};return this.getDirtyKeys().sort().forEach((function(n){var o=t[n].__nerve__.sourceName;r[o]=e.getSubDirtyCheckerWithClientName(n).getSnapshotToUpdate()})),r}},t.prototype.getSnapshotToUpdate=function(){var e={},t=this.Master.Schema,r=this.getSubDirtyCheckers();for(var n in r){e[t[n].__nerve__.sourceName]=r[n].getSnapshotToUpdate()}return e},t.prototype.getSourceData=function(){var e={},t=this.Master.Schema,r=this.getSubDirtyCheckers();for(var n in r){e[t[n].__nerve__.sourceName]=r[n].getSourceData()}return e},t.prototype.setSourceData=function(e){var t=this;e=this.getNormalizedSourceData(e),Object.keys(e).forEach((function(r){t.getSubDirtyCheckerWithSourceName(r).setSourceData(e[r])}))},t.prototype.onSourceDataReceived=function(e){var t,r=this;e=this.getNormalizedSourceData(e);var n=this.Master;if(le(n)){t=$.Deferred();var o=this.Master.Schema.__nerve__.sourceNameToClientName,i=Object.keys(e).map((function(e){return o[e]})).filter((function(e){return e}));n.Synchronizer.markFieldsAsReady(i,t.promise())}n.bulkEdit((function(){Object.keys(e).forEach((function(t){r.getSubDirtyCheckerWithSourceName(t).onSourceDataReceived(e[t])}))})),t&&t.resolve()},t.prototype.getNormalizedSourceData=function(e){var t=this.Master.Schema.__nerve__.sourceNameToClientName,r={};return e?Object.keys(e).filter((function(e){return e in t})).forEach((function(t){return r[t]=e[t]})):Object.keys(t).forEach((function(e){return r[e]=null})),r},t.prototype.getSubDirtyCheckers=function(){var e=this.Master.Model.__nerve__.properties,t={};return this.Master.Schema.__nerve__.subFields.toArray().filter((function(e){return!e.__nerve__.info.Attributes.IsLocalField})).map(Se).forEach((function(r){return t[r]=e[r].getDirtyChecker()})),t},t.prototype.getSubDirtyCheckerWithClientName=function(e){return this.Master.Model.__nerve__.properties[e].getDirtyChecker()},t.prototype.getSubDirtyCheckerWithSourceName=function(e){var t=this.Master.Schema.__nerve__.sourceNameToClientName[e];return this.getSubDirtyCheckerWithClientName(t)},t}(D),se=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ce=function(e){function t(t,r,n,i,a,s){var c,l={};c=e.call(this,{master:t,properties:l})||this;var d=function(e){return le(e)?function(t,r){var n=function(){if(!e.isFieldReady(r)){var t=Ie(r);Object(o.c)("The field ("+t+") not ready yet.")}};return{getter:function(){return n(),t.getter()},setter:function(e){n(),t.setter(e)}}}:function(e,t){return{getter:function(){return e.getter()},setter:function(t){return e.setter(t)}}}}(t);return Object.keys(t.Schema).forEach((function(e){var o=t.Schema[e],f=o.__nerve__.generateProperty(e,{InitialData:r[e],ExistingInDataSource:n,MasterTreeReady:a,Reserved:{Membership:{FieldSchema:o,Parent:t},ParentExistingInDataSource:s,Mounted:i}});l[e]=f;var p=d(f,o);Object(u.j)(c,e,p.getter,p.setter)})),c}return se(t,e),t}(c);var ue=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function le(e){return e instanceof pe}function de(e,t,r){Object(P.d)(e,t);var n=function(e){function t(t,n){return e.call(this,t,n,r)||this}return ue(t,e),Object.defineProperty(t,"Schema",{get:function(){return t.__nerve__.schema},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Schema",{get:function(){return t.__nerve__.schema},enumerable:!0,configurable:!0}),t}(r?pe:fe);return Object(a.b)(n,Object(u.e)({nerveObjectType:"object master",masterName:e,dataSourceFactory:r}),!0),n.__nerve__.schema=Pe(n,t),Object(u.n)(n.__nerve__,"schema"),n}var fe=function(e){function t(t,r,n){var o;t=t||{},r=r||{};var i=(o=e.call(this,t)||this).__nerve__;i.markChildrenAsDeleted=function(){var e;(e=o).Schema.__nerve__.subFields.toArray().filter((function(e){return!T(e)})).map(Se).map((function(t){return e.Model.__nerve__.properties[t]})).map((function(e){return e.Master})).forEach((function(e){return e.Deleted=!0}))},Object(u.n)(i,"markChildrenAsDeleted");var a,s=$.Deferred(),c=$.when(r.MasterReady,s.promise()),l=!n&&i.membership&&!i.membership.FieldSchema.__nerve__.info.Attributes.IsLocalField;if(i.dirtyChecker=new ae(o,t.ExistingInDataSource,l),Object(u.n)(i,"dirtyChecker"),n?(i.synchronizer=new re.ObjectSynchronizer(o,t,r,c,n),a=i.synchronizer.existingInDataSource()):(i.synchronizer=null,a=t.Reserved&&t.Reserved.ParentExistingInDataSource),Object(u.n)(i,"synchronizer"),i.model=new ce(o,t.InitialData||{},t.ExistingInDataSource,c,$.when(t.MasterTreeReady,c),a),Object(u.n)(i,"model"),i.changeManager=new oe(o),Object(u.n)(i,"changeManager"),n){var d=Oe(t.ExistingInDataSource?t.InitialData:null,o.Schema);i.dirtyChecker.initializeSourceData(d)}return s.resolve(),o}return ue(t,e),t.prototype.setData=function(e,t){var r=this.Model;if(e!==r){var n;if(e=e||{},t)n=me(this,t);else{var i=this.Schema;n=Object.keys(e).map((function(e){return i[e]})).filter((function(e){return e}))}var a=[];this.bulkEdit((function(){n.map(Se).forEach((function(t){t in r?r[t]=e[t]:a.push(t)}))})),a.length&&Object(o.f)("following field(s) not found in "+f(this)+": "+a)}},t.prototype.getModelByFieldSchema=function(e){var t=e;ye(t),t=he(this,t);for(var r=this.Schema,n=[];t!==r;){if(n.push(t),t.__nerve__.info.IsCollection)throw Error("unable to get model/value from collection "+Ie(t)+".");t=t.__nerve__.parentSchema}var o=this.Model;do{o=o[Se(t=n.pop())]}while(n.length);return o},t}(p),pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ue(t,e),Object.defineProperty(t.prototype,"Synchronizer",{get:function(){return this.__nerve__.synchronizer},enumerable:!0,configurable:!0}),t.prototype.isFieldReady=function(e){return this.Synchronizer.isFieldReady(e)},t.prototype.ensureFieldsReady=function(e){return this.Synchronizer.ensureFieldsReady(e)},t.prototype.fieldsReady=function(e){return this.Synchronizer.fieldsReady(e)},t.prototype.getRelatedSourceFields=function(e){return e},t.prototype.forceFieldsReady=function(e){return this.Synchronizer.forceFieldsReady(e)},t}(fe);function me(e,t){return t.map((function(t){var r=e.Schema;if("string"==typeof t){var n=r[t];if(ge(n))return n}else if(ge(t))return he(e,t);Object(o.c)("field "+t+" doesn't exist in master "+f(e))}))}function he(e,t){for(var r=e.Schema,n=[];t.__nerve__.shadowRoot!==r;){var i=Se(t);n.push(i),(t=t.__nerve__.parentSchema)||Object(o.c)("field schema ("+Ie(t)+") is not a member schema of master ("+f(e)+")")}for(var a=r;n.length;){a=a[i=n.pop()]}return a}function ge(e){var t=e&&e.__nerve__;return t&&"FieldSchema"===t.nerveObjectType}function ye(e){if(!ge(e))throw Error("Invalid parameter: please use '<your master [class]>.Schema.*' for the parameter.");return!0}function be(e){return ye(e),e.__nerve__.info}function ve(e){return be(e).FieldId}function Se(e){return be(e).Name}function Ie(e){return be(e).Path}function Me(e){return Re[e]}function Fe(e,t){if(T(t)){if(t.__nerve__.asEnum){var r=t.__nerve__.enumType;if(r&&"string"==typeof e&&e in r)return r[e]}return e}if(Z(t))return Object(u.g)(e).map((function(e){return Fe(e,t[0])}));if(e){var n={},o=t.__nerve__.sourceNameToClientName;return Object.keys(e).forEach((function(r){if(r in o){var i=o[r],a=t[i];n[i]=Fe(e[r],a)}})),n}return null}function Oe(e,t){if(T(t)){if(t.__nerve__.asEnum){var r=t.__nerve__.enumType;if(r&&"number"==typeof e&&e in r)return r[e]}return e}if(Z(t))return Object(u.g)(e).map((function(e){return Oe(e,t[0])}));if(e){var n={};return Object.keys(t).forEach((function(r){if(r in e){var o=t[r];if(!o.__nerve__.info.Attributes.IsLocalField){var i=o.__nerve__.sourceName;n[i]=Oe(e[r],o)}}})),n}return null}function Ce(e,t){if(T(t))return e;if(Z(t))return Object(u.g)(e).map((function(e){return Ce(e,t[0])}));if(e){var r={},n=t.__nerve__.sourceNameToClientName;return Object.keys(e).forEach((function(o){if(o in n){var i=t[n[o]];r[o]=Ce(e[o],i)}})),r}return null}function Pe(e,t){var r=e.__nerve__.masterName,n={enumTypeGetter:null,getKeyForReferenceType:null,info:{Attributes:Object(P.b)(t),FieldId:_e(),IsCollection:!(!Object(P.c)(t)||!t.__nerve__.isCollection),IsLeaf:!1,Name:r,Path:r},parentMasterClass:e,shadowParent:null,withDataSource:!!e.__nerve__.dataSourceFactory};n.info.IsCollection&&Object(u.i)(n,"withDataSource",(function(){return o[0].__nerve__.withDataSource}));var o=Te(n);return Object.keys(t).forEach((function(r){Object(u.i)(o,r,function(e,t,r){var n=_e();return function(){var o,i=we(e.__nerve__.masterName,t);if(Object(P.c)(r)){if(r.__nerve__.isLeaf)return w(n,e,r,t,i);r.__nerve__.isCollection?o=function(e,t){var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return K(t,e),Object.defineProperty(t,"Schema",{get:function(){return t.__nerve__.schema},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Schema",{get:function(){return t.__nerve__.schema},enumerable:!0,configurable:!0}),t}(J);return Object(a.b)(r,Object(u.e)({nerveObjectType:"collection master",masterName:e}),!0),r.__nerve__.schema=Pe(r,t),Object(u.n)(r.__nerve__,"schema"),r}(i,r):r.__nerve__.masterClassGetter&&(o=r.__nerve__.masterClassGetter())}o||(o=de(i,r));var s=Object(P.b)(r);return ee(n,e,o,t,i,s)}}(e,r,t[r]))})),o}function Te(e){var t={};return e.info=Object(u.e)(e.info),e.nerveObjectType="FieldSchema",e.shadowParent=e.shadowParent||null,e.shadowRoot=e.shadowRoot||t,Object(u.i)(e,"sourceFieldSet",(function(){var t=e.subFields.toArray().filter((function(e){return!e.__nerve__.info.Attributes.IsLocalField}));return new i(t)})),Object(u.i)(e,"sourceName",(function(){return e.info.Attributes.SourceFieldName||e.info.Name})),Object(u.i)(e,"sourceNameToClientName",(function(){var t={};return e.sourceFieldSet.toArray().forEach((function(e){t[e.__nerve__.sourceName]=e.__nerve__.info.Name})),Object.freeze(t)})),Object(u.i)(e,"subFields",(function(){var e=new i;return Object.keys(t).forEach((function(r){e.addFieldSchema(t[r])})),e})),Object(u.i)(e,"allContainedFields",(function(){var e=new i([t]);return Object.keys(t).forEach((function(r){var n=t[r];e.addFieldSchemas(n.__nerve__.allContainedFields)})),e})),Object(u.i)(e,"asEnum",(function(){return!!e.enumType&&!e.info.Attributes.IsNumberTypeInDataSource})),Object(u.i)(e,"enumType",(function(){return e.enumTypeGetter&&e.enumTypeGetter()})),e.info.IsLeaf?Object(u.i)(e,"getKey",(function(){return Object(o.a)(e.getKeyForReferenceType,"getKey has been called but no keyGetter specified for "+e.info.Path),e.getKeyForReferenceType})):Object(u.i)(e,"getKey",(function(){var t=e.keyFields.toArray().map(Se).sort();return Object(o.a)(t.length>0,"getKey has been called but there's no key fields of "+e.info.Path),function(e){var r=t;if(e instanceof ce){var n=e.__nerve__.master;if(le(n)){var o=n;if(!(r=t.filter((function(e){return o.isFieldReady(e)}))).length)return}}var i={};return r.forEach((function(t){return i[t]=e[t]})),JSON.stringify(i)}})),Object(u.i)(e,"getKeyFromSourceData",(function(){var t=e.keyFields.toArray(),r=e.sourceNameToClientName,n=t.map((function(e){return e.__nerve__.sourceName}));return function(t){var o={};return n.forEach((function(e){var n=r[e];o[n]=t[e]})),e.getKey(o)}})),Object(u.i)(e,"keyFields",(function(){return new i(e.subFields.toArray().filter((function(e){return e.__nerve__.info.Attributes.IsKeyField})))})),e.info.IsLeaf?Object(u.i)(e,"withKey",(function(){return!!e.getKeyForReferenceType})):Object(u.i)(e,"withKey",(function(){return e.keyFields.Count>0})),Object(a.b)(t,e),Object(u.h)(t,"toJSON",(function(){return"[Nerve] FieldSchema: ("+e.info.Path+")>"}),!1),e.info.IsCollection&&Object(u.h)(t,"length",1,!1),Re[e.info.FieldId]=t,t}function we(e,t){return e+"/"+t}function _e(){return(Ee++).toString()}var Ee=1,Re={},De=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ae=function(e){function t(){var t=e.call(this,{InitialData:{InProcess:!1,AllSucceeded:!0,Scheduled:!1,CreationError:null,CreationFailed:!1,CreationInProcess:!1,CreationRetryScheduled:!1,CreationScheduled:!1,QueryError:null,QueryFailed:!1,QueryInProcess:!1,UpdateError:null,UpdateFailed:!1,UpdateInProcess:!1,UpdateRetryScheduled:!1,UpdateScheduled:!1}})||this;return t.addRule(Le),t.addRule(Ne),t.addRule(ke),t}return De(t,e),t}(de("Nerve.ObjectSynchronizerMaster",{InProcess:P.a.boolean(),AllSucceeded:P.a.boolean(),Scheduled:P.a.boolean(),CreationError:P.a.reference(),CreationFailed:P.a.boolean(),CreationInProcess:P.a.boolean(),CreationScheduled:P.a.boolean(),CreationRetryScheduled:P.a.boolean(),QueryError:P.a.reference(),QueryFailed:P.a.boolean(),QueryInProcess:P.a.boolean(),UpdateError:P.a.reference(),UpdateFailed:P.a.boolean(),UpdateInProcess:P.a.boolean(),UpdateRetryScheduled:P.a.boolean(),UpdateScheduled:P.a.boolean()})),Le={Name:"InProcess",InterestedFields:[Ae.Schema.CreationInProcess,Ae.Schema.QueryInProcess,Ae.Schema.UpdateInProcess],onChange:function(e){var t=e.Master.Model;t.InProcess=t.CreationInProcess||t.QueryInProcess||t.UpdateInProcess}},Ne={Name:"AllSucceeded",InterestedFields:[Ae.Schema.CreationFailed,Ae.Schema.QueryFailed,Ae.Schema.UpdateFailed],onChange:function(e){var t=e.Master.Model;t.AllSucceeded=!(t.CreationFailed||t.QueryFailed||t.UpdateFailed)}},ke={Name:"Scheduled",InterestedFields:[Ae.Schema.CreationScheduled,Ae.Schema.CreationRetryScheduled,Ae.Schema.UpdateScheduled,Ae.Schema.UpdateRetryScheduled],onChange:function(e){var t=e.Master.Model;t.Scheduled=t.CreationScheduled||t.CreationRetryScheduled||t.UpdateScheduled||t.UpdateRetryScheduled}},xe=function(){function e(e){e?(this.creationRetryStabilizer=new je({retry:e.retryForCreation&&e.retryForCreation.bind(e),cancel:e.cancelRetryForCreation&&e.cancelRetryForCreation.bind(e)}),this.updateRetryStabilizer=new je({retry:e.retryForUpdate&&e.retryForUpdate.bind(e),cancel:e.cancelRetryForUpdate&&e.cancelRetryForUpdate.bind(e)})):(this.creationRetryStabilizer=new je,this.updateRetryStabilizer=new je),this.scheduler=e||{}}return e.prototype.scheduleUpdate=function(){return this.outputUpdateScheduleDeferred?(this.scheduler.postponeUpdate&&this.scheduler.postponeUpdate(),this.outputUpdateScheduleDeferred.promise()):this.createUpdateSchedule()},e.prototype.postponeUpdate=function(){this.scheduler.postponeUpdate&&this.scheduler.postponeUpdate()},e.prototype.flush=function(){if(this.creationRetryStabilizer.flush(),this.updateRetryStabilizer.flush(),this.cancelableUpdateSchedule&&(this.cancelableUpdateSchedule.cancel(),this.cancelableUpdateSchedule=void 0,this.scheduler.cancelUpdate&&this.scheduler.cancelUpdate()),this.outputUpdateScheduleDeferred){var e=this.outputUpdateScheduleDeferred;this.outputUpdateScheduleDeferred=void 0,e.resolve()}},e.prototype.cancelUpdate=function(){this.outputUpdateScheduleDeferred&&(this.outputUpdateScheduleDeferred.reject(),this.scheduler.cancelUpdate&&this.scheduler.cancelUpdate())},e.prototype.retryForCreation=function(e){return this.creationRetryStabilizer.retry(e)},e.prototype.cancelRetryForCreation=function(){return this.creationRetryStabilizer.cancel()},e.prototype.retryForUpdate=function(e){return this.updateRetryStabilizer.retry(e)},e.prototype.cancelRetryForUpdate=function(){return this.updateRetryStabilizer.cancel()},e.prototype.createUpdateSchedule=function(){var e=this;this.outputUpdateScheduleDeferred||(this.outputUpdateScheduleDeferred=$.Deferred());var t,r=this.outputUpdateScheduleDeferred;return t=this.scheduler.scheduleUpdate?this.scheduler.scheduleUpdate():Object(u.m)(),this.cancelableUpdateSchedule=new u.b(t),this.cancelableUpdateSchedule.promise().always((function(){e.outputUpdateScheduleDeferred=void 0,e.cancelableUpdateSchedule=void 0})).done((function(){return r.resolve()})).fail((function(){return r.reject()})),r.promise()},e}(),je=function(){function e(e){this.scheduler=e||{}}return e.prototype.retry=function(e){var t=this;if(!this.scheduler.retry)return Object(u.l)();this.cancel();var r=$.Deferred();return this.deferred=r,this.cancelable=new u.b(this.scheduler.retry(e)),this.cancelable.promise().always((function(){t.deferred=void 0,t.cancelable=void 0})).done((function(){return r.resolve()})).fail((function(){return r.reject()})),r.promise()},e.prototype.flush=function(){if(this.cancelable&&(this.cancelable.cancel(),this.cancelable=void 0,this.scheduler.cancel&&this.scheduler.cancel()),this.deferred){var e=this.deferred;this.deferred=void 0,e.resolve()}},e.prototype.cancel=function(){this.cancelable&&(this.cancelable.cancel(),this.deferred=void 0,this.cancelable=void 0,this.scheduler.cancel&&this.scheduler.cancel())},e}(),Ue=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ze=function(e){function t(t,r,n,o,i){var a=e.call(this)||this;a.deletionJob=$.Deferred(),a.updateJob=$.Deferred(),a.fieldReadinesses={},a.fieldReadinesseDeferreds={},a.queryJobsPerField={},a.syncJobWithDataSource=$.Deferred().resolve().promise(),a.retryTimesForUpdate=0,a.dataReceivedDuringSync=[],a.master=t,a.scheduler=new xe(n.Scheduler),a.initializeUpdateJob();var s=r.Reserved&&r.Reserved.ParentExistingInDataSource;a.dataSourcePromise=$.when(r.MasterTreeReady,o,s).then((function(){return i(t,(function(e){return a.onSourceDataReceived(e)}),n.DataSourceContext)}));var c=a.getReadyFieldNames(r);if(c.length){var u=$.Deferred().resolve();c.forEach((function(e){a.fieldReadinesses[e]=!0,a.fieldReadinesseDeferreds[e]=u}))}return o.done((function(){t.observe((function(e){e.UpdateNeeded&&a.checkForUpdate()}))})),!r.ExistingInDataSource?a.createWithDataSource():(a.creationJob=o,a.creationJob.done((function(){return a.checkForUpdate()}))),a}return Ue(t,e),t.prototype.flush=function(){var e=this;return this.scheduler.flush(),this.creationJob.then((function(){return e.updateJob}))},t.prototype.existingInDataSource=function(){return this.creationJob},t.prototype.deletedFromDataSource=function(){var e=this;return this.creationJob.then((function(){return e.deletionJob.promise()}),(function(){return Object(u.m)()}))},t.prototype.isFieldReady=function(e){e=this.master.getRelatedSourceFields([e])[0];var t=Se(me(this.master,[e])[0]);return!!this.fieldReadinesses[t]},t.prototype.ensureFieldsReady=function(e){var t=this;e=this.master.getRelatedSourceFields(e);var r=me(this.master,e);return r.filter((function(e){return!t.isFieldReady(e)})).length?this.creationJob.then((function(){var e=r.filter((function(e){return!t.isFieldReady(e)}));return e.length?t.query(e):Object(u.m)()})).then((function(){return t.getChangingPeriod()})):Object(u.m)()},t.prototype.forceFieldsReady=function(e){var t=this;e=this.master.getRelatedSourceFields(e),me(this.master,e).filter((function(e){return!t.isFieldReady(e)})).forEach((function(e){t.fieldReadinesses[Se(e)]=!0}))},t.prototype.fieldsReady=function(e){var t=this;e=this.master.getRelatedSourceFields(e);var r=me(this.master,e).map(Se).map((function(e){return t.fieldReadinesseDeferreds[e]||(t.fieldReadinesseDeferreds[e]=$.Deferred()),t.fieldReadinesseDeferreds[e].promise()}));return $.when.apply($,r).then((function(){return t.getChangingPeriod()}))},t.prototype.query=function(e){var t=this;e=this.master.getRelatedSourceFields(e);var r=me(this.master,e);return this.creationJob.then((function(){var e=[],n=$.Deferred(),o=n.then((function(){return t.queryWithDataSource(e)})),i=[];return r.filter((function(e){return!e.__nerve__.info.Attributes.IsLocalField})).forEach((function(r){var n=Se(r),a=t.queryJobsPerField[n];a&&"pending"===a.state()||(t.queryJobsPerField[n]=o,e.push(r.__nerve__.sourceName)),i.push(t.queryJobsPerField[n])})),e.length?n.resolve():n.reject(),$.when.apply($,i)})).then((function(){return t.getChangingPeriod()}))},t.prototype.onSourceDataReceived=function(e){var t=this,r=Ce(e,this.master.Schema);return this.dataReceivedDuringSync.push(r),this.syncJobWithDataSource.then((function(){return t.flushReceivedDataDuringSync()}))},t.prototype.onDeletedInDataSource=function(){this.getDirtyChecker().ExistingInSource=!1,this.master.Deleted=!0},t.prototype.setFieldsQueryJob=function(e,t){var r=this,n=me(this.master,this.master.getRelatedSourceFields(e)).filter((function(e){return!e.__nerve__.info.Attributes.IsLocalField})),o=$.Deferred(),i=o.then((function(){return t})).then((function(e){var t={};return n.map((function(e){return e.__nerve__.sourceName})).forEach((function(r){return t[r]=e[r]})),r.onSourceDataReceived(t)}));n.map(Se).forEach((function(e){var t=r.queryJobsPerField[e];t&&"pending"===t.state()?r.queryJobsPerField[e]=Object(u.d)(t,i):r.queryJobsPerField[e]=i})),o.resolve()},t.prototype.markFieldsAsReady=function(e,t){var r=this;e.forEach((function(e){return r.fieldReadinesses[e]=!0})),t.done((function(){var t=$.Deferred().resolve();e.forEach((function(e){r.fieldReadinesseDeferreds[e]?r.fieldReadinesseDeferreds[e].resolve():r.fieldReadinesseDeferreds[e]=t}))}))},t.prototype.initializeUpdateJob=function(){var e=this;this.updateJob=$.Deferred().resolve(),this.observe((function(){return e.changeUpdateJobState()}),[this.Schema.UpdateError,this.Schema.UpdateFailed,this.Schema.UpdateInProcess,this.Schema.UpdateScheduled])},t.prototype.changeUpdateJobState=function(){var e=this.Model;e.UpdateScheduled||e.UpdateInProcess?"pending"!==this.updateJob.state()&&(this.updateJob=$.Deferred()):e.UpdateFailed?e.UpdateRetryScheduled||this.updateJob.reject(e.UpdateError):this.updateJob.resolve()},t.prototype.getReadyFieldNames=function(e){var t=this.master.Schema.__nerve__.subFields;if(e.ExistingInDataSource){var r=e.InitialData||{},n=[];return t.toArray().forEach((function(e){var t=Se(e);(e.__nerve__.info.Attributes.IsLocalField||t in r)&&n.push(t)})),n}return t.toArray().filter((function(e){return!e.__nerve__.info.Attributes.IsSourceGenerated})).map(Se)},t.prototype.checkForUpdate=function(){var e=this;this.getDirtyChecker().isDirty()?this.bulkEdit((function(){e.Model.UpdateScheduled=!0,$.when(e.creationJob,e.scheduler.scheduleUpdate()).done((function(){e.retryTimesForUpdate=0,e.update()}))})):(this.scheduler.cancelUpdate(),this.Model.UpdateScheduled=!1)},t.prototype.update=function(){if(this.updating)this.updatePended=!0;else if(this.getDirtyChecker().isDirty()){if(this.onUpdateStart(),this.getDirtyChecker().isDirty())return this.master.__nerve__.deleted?this.deleteWithDataSource():this.updateWithDataSource();Object(o.f)("onUpdateStart changes dirtiness."),this.onUpdateDone()}else this.onUpdateDone()},t.prototype.getDirtyChecker=function(){return this.master.__nerve__.dirtyChecker},t.prototype.createWithDataSource=function(){var e=this,t=$.Deferred();this.creationJob=t.promise();var r=this.master;this.bulkEdit((function(){e.Model.CreationScheduled=!0,e.dataSourcePromise.done((function(n){var o=function(){if(e.scheduler.cancelRetryForCreation(),r.__nerve__.deleted)return e.bulkEdit((function(){e.Model.CreationFailed=!1,e.Model.CreationInProcess=!1,e.Model.CreationRetryScheduled=!1,e.Model.CreationScheduled=!1}));e.bulkEdit((function(){e.Model.CreationError=null,e.Model.CreationFailed=!1,e.Model.CreationInProcess=!0,e.Model.CreationRetryScheduled=!1,e.Model.CreationScheduled=!1}));var a=e.getDirtyChecker(),s=a.getDelta()||{},c=a.getSnapshotToUpdate(),u=e.syncJobWithDataSource.then((function(){return n.add(s,{Master:r,Snapshot:c})})).then((function(n){r.bulkEdit((function(){a.ExistingInSource=!0,a.setSourceData(s),n&&e.onSourceDataReceivedInternal(n)})),e.bulkEdit((function(){e.Model.CreationInProcess=!1,e.checkForUpdate()})),t.resolve()})).fail((function(r){e.bulkEdit((function(){e.Model.CreationFailed=!0,e.Model.CreationError=r,e.Model.CreationInProcess=!1,e.Model.CreationRetryScheduled=!0,e.scheduler.retryForCreation(++i).done(o).fail((function(){e.Model.CreationRetryScheduled=!1,t.reject(r)}))}))}));e.updateSyncJobWithDataSource(u)},i=0;o()}))}))},t.prototype.deleteWithDataSource=function(){var e=this,t=this.getDirtyChecker(),r=this.syncJobWithDataSource.then((function(){return e.dataSourcePromise})).then((function(r){var n=t.getSnapshotToUpdate();return r.delete(n,{Master:e.master,Snapshot:n})})).then((function(){return t.ExistingInSource=!1}));return this.updateSyncJobWithDataSource(r),r.done((function(){e.onUpdateDone(!1),e.deletionJob.resolve()})).fail((function(t){e.onUpdateFailed(t,!1,(function(){e.deletionJob.reject(t)}))}))},t.prototype.queryWithDataSource=function(e){var t=this,r=this.syncJobWithDataSource.then((function(){return t.dataSourcePromise})).then((function(r){return t.bulkEdit((function(){t.Model.QueryError=null,t.Model.QueryInProcess=!0})),r.query(e,{Master:t.master,Snapshot:null})})).then((function(r){if(r){var n={};Object.keys(r).concat(e).forEach((function(e){return n[e]=r[e]})),t.onSourceDataReceivedInternal(n)}}));return this.updateSyncJobWithDataSource(r),r.done((function(){t.Model.QueryInProcess=!1})).fail((function(e){t.bulkEdit((function(){t.Model.QueryError=e,t.Model.QueryInProcess=!1}))}))},t.prototype.updateWithDataSource=function(){var e=this,t=this.getDirtyChecker(),r=t.getDelta(),n=t.getSnapshotToUpdate(),i=t.getSourceData();null==r&&Object(o.f)("data is null when it's dirty.");var a=this.syncJobWithDataSource.then((function(){return e.dataSourcePromise})).then((function(t){return t.update(r,{Master:e.master,Snapshot:n,ValuesBefore:i})})).then((function(n){e.master.bulkEdit((function(){t.setSourceData(r),n&&e.onSourceDataReceivedInternal(n)}))}));return this.updateSyncJobWithDataSource(a),a.done((function(){return e.onUpdateDone(!0)})).fail((function(t){return e.onUpdateFailed(t,!0)}))},t.prototype.onUpdateStart=function(){var e=this;this.updating=!0,this.updatePended=!1,this.scheduler.cancelRetryForUpdate(),this.bulkEdit((function(){e.Model.UpdateError=null,e.Model.UpdateFailed=!1,e.Model.UpdateInProcess=!0,e.Model.UpdateRetryScheduled=!1,e.Model.UpdateScheduled=!1}))},t.prototype.onUpdateDone=function(e){var t=this;this.updating=!1,this.retryTimesForUpdate=0,this.scheduler.cancelRetryForUpdate(),this.bulkEdit((function(){t.Model.UpdateError=null,t.Model.UpdateFailed=!1,t.Model.UpdateInProcess=!1,t.Model.UpdateRetryScheduled=!1,t.Model.UpdateScheduled=!1,e&&(t.updatePended?t.update():t.checkForUpdate())}))},t.prototype.onUpdateFailed=function(e,t,r){var n=this;this.getDirtyChecker().isDirty()?(this.updating=!1,this.bulkEdit((function(){n.Model.UpdateError=e,n.Model.UpdateFailed=!0,n.Model.UpdateInProcess=!1,n.Model.UpdateRetryScheduled=!0,n.Model.UpdateScheduled=!0,t&&n.updatePended?n.update():n.scheduler.retryForUpdate(++n.retryTimesForUpdate).done((function(){return n.update()})).fail((function(){n.bulkEdit((function(){n.Model.UpdateRetryScheduled=!1,n.Model.UpdateScheduled=!1})),r&&r()}))}))):this.onUpdateDone()},t.prototype.onSourceDataReceivedInternal=function(e){var t=Ce(e,this.master.Schema);this.getDirtyChecker().onSourceDataReceived(t)},t.prototype.updateSyncJobWithDataSource=function(e){var t=this;this.syncJobWithDataSource=Object(u.c)(e).then((function(){return t.flushReceivedDataDuringSync()}))},t.prototype.flushReceivedDataDuringSync=function(){var e=this.getDirtyChecker(),t=this.dataReceivedDuringSync;this.dataReceivedDuringSync=[],this.master.bulkEdit((function(){t.forEach((function(t){return e.onSourceDataReceived(t)}))}))},t.prototype.getChangingPeriod=function(){return this.master.__nerve__.changeManager.getChangingPeriod()},t}(Ae);re.ObjectSynchronizer=ze,r.d(t,"a",(function(){return Be}));var Be=function(){function e(){}return e.getSubFieldSchemas=function(e){return function(e){return ye(e),e.__nerve__.subFields.toArray()}(e)},e.convertFromSourceData=function(e,t){return Fe(e,t)},e.convertToSourceData=function(e,t){return Oe(e,t)},e.convertToArray=function(e){return Object(u.g)(e)},e.getFieldSchemaInfo=function(e){return be(e)},e.getObjectMasterFromModel=function(e){return d(e)},e.getCollectionMasterFromModel=function(e){return d(e)},e.createObjectMasterClass=function(e,t,r){return de(e,t,r)},e.isObjectMasterClass=function(e){return function(e){var t=e;return!!t.__nerve__&&"object master"===t.__nerve__.nerveObjectType}(e)},e}();Object(u.n)(Be,"convertToArray"),Object(u.n)(Be,"getFieldSchemaInfo"),Object(u.n)(Be,"getSubFieldSchemas"),Object(u.n)(Be,"convertFromSourceData"),Object(u.n)(Be,"convertToSourceData"),Object(u.n)(Be,"createObjectMasterClass"),Object(u.n)(Be,"getObjectMasterFromModel"),Object(u.n)(Be,"getCollectionMasterFromModel"),Object(u.n)(Be,"isObjectMasterClass");var Qe={addItems:null,deleteItems:null,getIndexWithKeyFields:null,getItemWithKeyFields:null,itemsAddedInSource:null,itemsDeletedInSource:null,markAsChanged:null,setComparer:null};for(var qe in Qe)Qe[qe]=Ve(qe);function Ve(e){return function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=Be.getCollectionMasterFromModel(t),i=o[e];return i.apply(o,r)}}Be.Collection=Object.freeze(Qe),Object(u.n)(Be,"Collection")},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(3),o=r(24),i=function(){function e(){}return e.combineAttributes=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e.map((function(e){return e&&e.trim()})).filter((function(e){return!!e})).join(" ");return r||e.some((function(e){return""===e}))||(r=void 0),r},e.getQueries=function(t){return e.getQueriesOrHashes(t||window.location.search.substring(1))},e.getHashes=function(t){return e.getQueriesOrHashes(t||window.location.hash.substring(1))},e.getQueriesOrHashes=function(e){var t={};return e&&e.trim().split("&").forEach((function(e){var r=e.indexOf("=");-1===r&&(r=e.length);var n=e.substring(0,r).trim();n&&(t[n]=decodeURIComponent(e.substring(r+1)||"").trim())})),t},e.getAbsoluteUrl=function(e){var t=document.createElement("a");return t.href=e,t.href},e.getHostName=function(e){var t=document.createElement("a");return t.href=e,t.hostname},e.getSearchString=function(e){var t=document.createElement("a");return t.href=e,t.search},e.updateUrlParams=function(t,r){var o=t.indexOf("#"),i=-1===o?"":t.substr(o),a=(t=-1===o?t:t.substr(0,o)).indexOf("?"),s=-1===a?"":t.substr(a);t=-1===a?t:t.substr(0,a);var c={};return s&&(c=e.getQueriesOrHashes(s.substr(1))),n.extend(c,r),t+"?"+$.param(c)+i},e.updateUrlParam=function(e,t,r){var n=e.indexOf("#"),o=-1===n?"":e.substr(n);e=-1===n?e:e.substr(0,n);var i=new RegExp("([?&])"+t+"=.*?(&|$)","i"),a=-1!==e.indexOf("?")?"&":"?";return(e=e.match(i)?e.replace(i,"$1"+t+"="+r+"$2"):e+a+t+"="+r)+o},e.scrollToShowSubelement=function(e,t,r,n,o){n=n||0,r=r||0;var i=t.height(),a=e.outerHeight();if(e.offset()&&t.offset()){var s=e.offset().top-t.offset().top;if(s<0)t.scrollTop(t.scrollTop()+s-(a+r>i?0:r));else{var c=Math.min(a,i),u=s+c-i;a+r+n<i?u=s+(c=a+n)-i:a+r<i&&(c=a+r,u=s-r),u>0&&(o?t.animate({scrollTop:t.scrollTop()+u},"fast"):t.scrollTop(t.scrollTop()+u))}}},e.encodeHTML=function(e,t){void 0===t&&(t=!0);var r=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;");return t&&(r=r.replace(/'/g,"&apos;")),r},e.decodeJavascriptString=function(e){return e?e.replace(/\\"/g,'"'):""},e.mergeReactProps=function(t,r){var o=n.extend({},t);for(var i in r)switch(i){case"className":case"aria-labelledby":case"aria-describedby":o[i]=e.combineAttributes(o[i],r[i]);break;case"children":case"defaultValue":case"value":r.hasOwnProperty(i)&&(null!=o[i]?o[i]=[].concat(o[i],r[i]):o[i]=r[i]);break;case"style":null!=o[i]?n.extend(o[i],r[i]):o[i]=r[i];break;case"onCopy":case"onCut":case"onPaste":case"onCompositionEnd":case"onCompositionStart":case"onCompositionUpdate":case"onFocus":case"onBlur":case"onChange":case"onInput":case"onSubmit":case"onLoad":case"onError":case"onKeyDown":case"onKeyPress":case"onKeyUp":case"onAbort":case"onCanPlay":case"onCanPlayThrough":case"onDurationChange":case"onEmptied":case"onEncrypted":case"onEnded":case"onLoadedData":case"onLoadedMetadata":case"onLoadStart":case"onPause":case"onPlay":case"onPlaying":case"onProgress":case"onRateChange":case"onSeeked":case"onSeeking":case"onStalled":case"onSuspend":case"onTimeUpdate":case"onVolumeChange":case"onWaiting":case"onClick":case"onContextMenu":case"onDoubleClick":case"onDrag":case"onDragEnd":case"onDragEnter":case"onDragExit":case"onDragLeave":case"onDragOver":case"onDragStart":case"onDrop":case"onMouseDown":case"onMouseEnter":case"onMouseLeave":case"onMouseMove":case"onMouseOut":case"onMouseOver":case"onMouseUp":case"onSelect":case"onTouchCancel":case"onTouchEnd":case"onTouchMove":case"onTouchStart":case"onScroll":case"onWheel":o[i]=e.wrapReactEvent(o[i],r[i]);break;default:void 0!==r[i]&&(o[i]=r[i])}return o},e.wrapReactEvent=function(e,t){return function(r){e&&e(r),t&&t(r)}},e.onKeyboardEvent=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return function(r){(0===t.length||t.indexOf(r.keyCode)>=0)&&e(r)}},e.getTargetElementOfFocusEvent=function(e){var t=e.nativeEvent.explicitOriginalTarget;return e.relatedTarget||t||document.activeElement},e.getWindowWidth=function(){return window.innerWidth},e.safeOpen=function(e,t,r,n){if(o.a.IsTeamsIntegration){var i=$("<a></a>");return i.attr("href",e),t||(t="_blank"),i.attr("target",t),i[0].click(),i.remove(),null}return t||r||n?r||n?n?window.open(e,t,r,n):window.open(e,t,r):window.open(e,t):window.open(e)},e.hiddenOpen=function(e){var t="hiddeon-open-iframe",r=document.getElementById(t);r&&r.parentNode.removeChild(r),(r=document.createElement("iframe")).id=t,r.name=t,r.hidden=!0,document.body.appendChild(r),r.contentWindow.location.href=e},e.sanitize=function(t){var r=e.escapeHtmlWhilePreservingSupportedTags(t);return e.closeUnclosedSupportedTags(r)},e.escapeHtmlWhilePreservingSupportedTags=function(e){var t=["b"],r=n.map(t,(function(e){return"<"+e+">"})),o=n.map(t,(function(e){return"</"+e+">"})),i=n.map(t,(function(e){return"&lt;"+e+"&gt;"})),a=n.map(t,(function(e){return"&lt;/"+e+"&gt;"})),s=n.escape(e);return t.forEach((function(e,t){s=s.replaceAll(i[t],r[t]).replaceAll(a[t],o[t])})),s},e.closeUnclosedSupportedTags=function(e){var t=document.createElement("span");return t.innerHTML=e,e=t.innerHTML},e.getHeaderIgnoreCase=function(e,t){if(e&&t)return e[t]||e[t.toLowerCase()]||void 0},e}()},function(e,t,r){"use strict";var n,o=r(116),i=r(166),a=function(){function e(e){this.validAuthenticator=null,this.authenticators=e?e.concat():[new i.a]}return e.prototype.signIn=function(){return this.getValidAuthenticator().then((function(e){return e.signIn()}))},e.prototype.getFormApiToken=function(){return this.getValidAuthenticator().then((function(e){return e.getFormApiToken()}))},e.prototype.handleAuthForContentPage=function(e){return this.getValidAuthenticator().then((function(t){return t.handleAuthForContentPage(e)}))},e.prototype.handleAuthForAddinPage=function(){return this.getValidAuthenticator().then((function(e){return e.handleAuthForAddinPage()}))},e.prototype.hasUserLoggedIn=function(){var e=this.getValidAuthenticatorSync();return e&&e.hasUserLoggedIn()},e.prototype.redirectToLogin=function(){return this.getValidAuthenticator().then((function(e){return e.redirectToLogin()}))},e.prototype.refreshToken=function(){return this.getValidAuthenticator().then((function(e){return e.refreshToken()}))},e.prototype.signOut=function(){return this.getValidAuthenticator().then((function(e){return e.signOut()}))},e.prototype.getValidAuthenticator=function(){var e=this;if(this.validAuthenticator)return this.validAuthenticator;var t=function(r){var n=e.authenticators[r];return n?$.when(n.isValid()).then((function(e){return e?n:t(r+1)})):$.Deferred().reject(new Error("No valid authenticator")).promise()};return this.validAuthenticator=t(0),this.validAuthenticator},e.prototype.getValidAuthenticatorSync=function(){return this.authenticators.filter((function(e){return e.isValid()}))[0]},e}(),s=r(188),c=r(9);function u(e){if(n)throw Error("PageContext has already been initialized.");n=new d(e)}function l(){return void 0===n&&(u(),Object(c.a)({eventName:"PageContextNotIntialized",eventType:"error_event"})),n}r.d(t,"b",(function(){return u})),r.d(t,"a",(function(){return l}));var d=function(){function e(e){this.flightsDeferred=$.Deferred(),e=e||{},this.authAdapter=new a(e.authenticators),this.flighting=new s.a(this.flightsDeferred.promise()),e.addinAccessTokenGetter&&Object(o.b)(e.addinAccessTokenGetter)}return Object.defineProperty(e.prototype,"AuthContext",{get:function(){return this.authAdapter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Flighting",{get:function(){return this.flighting},enumerable:!0,configurable:!0}),e.prototype.setFlightsBasingOnAuth_Deprecated=function(e){this.flightsDeferred.resolve(e)},Object.defineProperty(e.prototype,"RetryingRecoverableError",{get:function(){return this.retryingRecoverableError},set:function(e){this.retryingRecoverableError=e},enumerable:!0,configurable:!0}),e}()},function(e,t,r){"use strict";r.d(t,"c",(function(){return s})),r.d(t,"e",(function(){return c})),r.d(t,"b",(function(){return u})),r.d(t,"d",(function(){return l})),r.d(t,"a",(function(){return f}));var n,o,i=r(5),a=r(6);function s(e,t){return d()?t():e()}function c(e){return d()?e():null}function u(e){return d()?null:e()}function l(){c((function(){n||(document.body.className=i.a.combineAttributes(document.body.className,"forms-pro"),n=!0)}))}function d(){return void 0===o&&(o=!!OfficeFormServerInfo.proEnabled&&Object(a.a)().Flighting.isEnabled("FormsPro")),o}FormsPro.baseProAdapter=s,FormsPro.proOnly=c,FormsPro.baseOnly=u,FormsPro.initializeStyleBasis=l;var f={}},function(e,t,r){"use strict";var n,o=r(3),i=r(4),a=r(18),s=r(1),c=r(11),u=r(24),l=r(45),d=r(21),f=r(2),p=r(142),m=r(49),h=r(36),g=r(80),y=r(43),b=r(13),v=r(33),S=r(26),I=r(6),M=r(7),F=r(17),O=r(9),C=r(23),P=r(59),T=r(55),w=r(19),_=r(39),E=r(81),R=r(82),D=r(76),A=r(30),L=r(42),N=r(61),k=r(194),x=r(41),j=function(){function e(e,t){this.permission=e,this.dataProvider=C.a.getDataProviderByFormMaster(this.permission.Form)}return Object.defineProperty(e.prototype,"FormId",{get:function(){return this.permission.FormId},enumerable:!0,configurable:!0}),e.prototype.add=function(e){return this.permission.Form.SyncContext===oe.AdminPhishingReviewForm?this.dataProvider.createAdminPhishingReviewPermissionLink(this.FormId,e):this.dataProvider.createPermissionLink(this.FormId,e)},e.prototype.delete=function(e){return this.dataProvider.deletePermissionLink(this.FormId,e.principalId)},e.prototype.query=function(e){return Object(a.c)("No scenario to call this method currently.")},e.prototype.update=function(e,t){if("OrgLink"===t.Snapshot.type||"Link"===t.Snapshot.type){var r={permissionSet:t.Snapshot.permissionSet,type:t.Snapshot.type};return this.permission.Form.SyncContext===oe.AdminPhishingReviewForm?this.dataProvider.createAdminPhishingReviewPermissionLink(this.FormId,r):this.dataProvider.createPermissionLink(this.FormId,r)}return Object(a.c)("No scenario to call this method currently.")},e}(),U=r(38),z=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),B={PrincipalId:s.a.string({SourceFieldName:"principalId"}),PermissionSet:s.a.string({SourceFieldName:"permissionSet"}),Type:s.a.reference({SourceFieldName:"type"}),FormId:s.a.string({IsSourceGenerated:!0,SourceFieldName:"formId"}),IsOwner:s.a.boolean({IsSourceGenerated:!0,SourceFieldName:"isOwner"}),PrincipalEmailAddress:s.a.string({IsSourceGenerated:!0,SourceFieldName:"principalEmailAddress"}),PrincipalName:s.a.string({IsSourceGenerated:!0,SourceFieldName:"principalName"}),SavingState:s.a.reference({IsLocalField:!0})};function Q(e){return{PermissionSet:"Read, Write, Share",Type:e}}function q(e){return i.a.getObjectMasterFromModel(e)}var V=function(e){function t(t){var r=e.call(this,t)||this;return Object(U.b)(r),r}return z(t,e),Object.defineProperty(t.prototype,"Form",{get:function(){return this.Parent.Parent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!0,configurable:!0}),t}(i.a.createObjectMasterClass("Permission",B,(function(e,t){return new j(e,t)}))),H=r(148),W=r(98),G=r(75),K=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),J={LockGivenQuestionsEndDisplayOrder:s.a.number(),LockGivenQuestionsStartDisplayOrder:s.a.number(),FormClosed:s.a.boolean(),FormClosedMessage:s.a.string(),FormClosedMessageChanged:s.a.boolean(),TimerEnabled:s.a.boolean(),TimerEnabledStart:s.a.boolean(),TimerEnabledEnd:s.a.boolean(),StartTime:s.a.string(),EndTime:s.a.string(),RequiresUniqueResponse:s.a.boolean(),IsAnonymous:s.a.boolean(),NotRecordIdentity:s.a.boolean(),ShuffleAllQuestions:s.a.boolean(),ShuffleQuestionOrder:s.a.boolean(),ShowGradedResults:s.a.boolean(),ShowGradedScores:s.a.boolean(),RespondInAppOnly:s.a.boolean(),AllowCopy:s.a.boolean(),ShareToken:s.a.string(),ManualGradingEnabled:s.a.boolean(),IsQuizMode:s.a.boolean(),EmailNotification:s.a.boolean(),AllowResponderGetAllResponses:s.a.boolean(),ShowQuestionNumbers:s.a.boolean(),IsEmailableEntityCreationEnabled:s.a.boolean(),EmailableEntity:s.a.string()},Y=function(e){function t(r){var n=e.call(this,r)||this;return n.addRule({Name:"updateClosedMessage",InterestedFields:[n.Schema.FormClosed],onChange:t.updateClosedMessage}),n.addRule({Name:"updateAllowCopy",InterestedFields:[n.Schema.ShareToken],onChange:t.updateAllowCopy}),n}return K(t,e),t.serialize=function(e){var t=i.a.convertToSourceData(e,this.Schema),r=0;return Object.keys(t).forEach((function(e){null==t[e]?delete t[e]:++r})),r>0?JSON.stringify(t):null},t.prototype.isAcceptingResponse=function(){return null==this.getFormClosedMessage()},t.prototype.getFormStatus=function(){var e=this.Model;if(e.FormClosed)return ne.Closed;if(e.TimerEnabled){var t=Date.now();if(null!=e.StartTime&&Date.parse(e.StartTime)>t)return ne.NotStarted;if(null!=e.EndTime&&Date.parse(e.EndTime)<t)return ne.Expired}return ne.Opened},t.prototype.getFormClosedMessage=function(){var e=this.Model;switch(this.getFormStatus()){case ne.Closed:return e.FormClosedMessage;case ne.NotStarted:return f.a.LocalizedStrings.FormSetting_NotStartForm_DefaultMessage.format(new Date(e.StartTime).toLocaleString());case ne.Expired:return f.a.LocalizedStrings.FormSetting_ExpiredForm_DefaultMessage;default:return}},t.prototype.setSharingStatus=function(e,t){var r=this,n=this.Parent,o=C.a.getDataProviderByFormMaster(n);return n.existingOnServerSide().then((function(){return o.changeSharingStatus(n.Model.Id,t)})).then((function(e){r.Model.ShareToken=e}))},t.updateClosedMessage=function(e){if(-1===e.FieldSchemas.indexOf(t.Schema.FormClosedMessage)){var r=e.Master.Model;r.FormClosed?null!=r.FormClosedMessage&&f.a.loadLocalizedStrings().done((function(e){return r.FormClosedMessage=e.FormSetting_ClosedForm_DefaultMessage})):r.FormClosedMessage=null}},t.updateAllowCopy=function(e){var t=e.Master.Model;t.AllowCopy=!!t.ShareToken},t}(i.a.createObjectMasterClass("FormSettingsMaster",J)),X=r(157),Z=r(104),ee=r(10),te=r(15);r.d(t,"d",(function(){return ne})),r.d(t,"e",(function(){return oe})),r.d(t,"a",(function(){return ie})),r.d(t,"b",(function(){return ae})),r.d(t,"h",(function(){return le})),r.d(t,"g",(function(){return de})),r.d(t,"k",(function(){return fe})),r.d(t,"j",(function(){return pe})),r.d(t,"l",(function(){return me})),r.d(t,"i",(function(){return he})),r.d(t,"f",(function(){return ge})),r.d(t,"c",(function(){return ye}));var re,ne,oe,ie,ae,se=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ce=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n},ue={Id:s.a.string({IsSourceGenerated:!0,IsKeyField:!0,SourceFieldName:"id"}),Description:s.a.string({SourceFieldName:"description"}),Background:s.a.fromMasterClass((function(){return A.b}),{SourceFieldName:"background"}),Category:s.a.string({SourceFieldName:"category"}),Logo:s.a.fromMasterClass((function(){return A.b}),{SourceFieldName:"logo"}),MeetingId:s.a.string({SourceFieldName:"meetingId"}),ModifiedDate:s.a.string({SourceFieldName:"modifiedDate"}),CreatedDate:s.a.string({SourceFieldName:"createdDate"}),OtherInfo:s.a.string({SourceFieldName:"otherInfo"}),OwnerId:s.a.string({SourceFieldName:"ownerId"}),OwnerTenantId:s.a.string({SourceFieldName:"ownerTenantId"}),OwnerUserType:s.a.string({SourceFieldName:"ownerUserType"}),RowCount:s.a.number({SourceFieldName:"rowCount"}),SharedBy:s.a.string({SourceFieldName:"sharedBy"}),SharedFormOwnerName:s.a.string({SourceFieldName:"ownerDisplayName"}),SharedDate:s.a.string({SourceFieldName:"dateTimeShared"}),TableId:s.a.string({IsSourceGenerated:!0,SourceFieldName:"tableId"}),Title:s.a.string({SourceFieldName:"title"}),Version:s.a.string({SourceFieldName:"version"}),XlWorkbookId:s.a.string({SourceFieldName:"xlWorkbookId"}),XlExportingTag:s.a.string({SourceFieldName:"xlExportingTag"}),XlFileUnsynced:s.a.boolean({SourceFieldName:"xlFileUnSynced"}),XlUnsyncedReason:s.a.string({SourceFieldName:"xlUnsyncedReason"}),Permissions:s.a.collectionOf((function(){return V}),{SourceFieldName:"permissions"}),PermissionTokens:s.a.collectionOf((function(){return H.a}),{SourceFieldName:"permissionTokens"}),Questions:s.a.collectionOf((function(){return ee.d}),{SourceFieldName:"questions"}),DescriptiveElements:s.a.collectionOf((function(){return _.a}),{SourceFieldName:"descriptiveQuestions"}),MovingToRecycleBin:s.a.boolean({IsLocalField:!0}),SoftDeleted:s.a.enumeration((function(){return ae}),{SourceFieldName:"softDeleted",IsNumberTypeInDataSource:!0}),BusinessCdsId:s.a.string({SourceFieldName:"BusinessCdsId"}),BusinessCdsRegion:s.a.string({SourceFieldName:"BusinessCdsRegion"}),IsDefaultCds:s.a.string({SourceFieldName:"IsDefaultCds"}),LastEmbedConfig:s.a.string({SourceFieldName:"LastEmbedConfig"}),FormsProBranchRules:s.a.string({SourceFieldName:"FormsProBranchRules"}),MfpBranchingData:s.a.string({SourceFieldName:"mfpBranchingData"}),PipesDetails:s.a.string({SourceFieldName:"formsProConfiguredPipes"}),FormsProRTTitle:s.a.string({SourceFieldName:"formsProRTTitle"}),FormsProRTDescription:s.a.string({SourceFieldName:"formsProRTDescription"}),ResponseThresholdCount:s.a.string({SourceFieldName:"responseThresholdCount"}),InviteExpiryDays:s.a.string({SourceFieldName:"inviteExpiryDays"}),FormsProAnswerTagMap:s.a.collectionOf({name:s.a.string(),value:s.a.string(),questionId:s.a.string()},{IsLocalField:!0}),FormsProAnswerTagMapRT:s.a.collectionOf({name:s.a.string(),value:s.a.string()},{IsLocalField:!0}),FooterText:s.a.string({SourceFieldName:"footerText"}),CustomCssFileName:s.a.string({SourceFieldName:"customCssFileName"}),CustomDomainSenderEmail:s.a.string({SourceFieldName:"customDomainSenderEmail"}),TrackingId:s.a.string({SourceFieldName:"trackingId"}),ThankYouMessage:s.a.string({SourceFieldName:"thankYouMessage"}),EmailReceiptEnabled:s.a.boolean({SourceFieldName:"emailReceiptEnabled"}),Flags:s.a.number({SourceFieldName:"flags"}),Type:s.a.reference({SourceFieldName:"type"}),OnlineSafetyLevel:s.a.number({SourceFieldName:"onlineSafetyLevel"}),BufferResponses:s.a.collectionOf(s.a.reference({},(function(e){return e.Id.toString()})),{IsLocalField:!0}),CoAuthMessage:s.a.string({IsLocalField:!0}),DeleteCollaborationPermission:s.a.boolean({IsLocalField:!0}),HasValidBranching:s.a.boolean({IsLocalField:!0}),HasQuestionMedia:s.a.boolean({IsLocalField:!0}),Created:s.a.string({IsLocalField:!0}),Modified:s.a.string({IsLocalField:!0}),PredefinedResponses:s.a.collectionOf({Id:s.a.number({IsKeyField:!0}),Answers:s.a.collectionOf({QuestionId:s.a.string(),Answer:s.a.reference()})},{IsLocalField:!0}),PrimaryCustomizedThemeColor:s.a.string({IsLocalField:!0}),QuizQuestionsCount:s.a.number({IsLocalField:!0}),SecondaryCustomizedThemeColor:s.a.string({IsLocalField:!0}),Responses:s.a.collectionOf(s.a.reference({},(function(e){return e.Id.toString()})),{IsLocalField:!0}),ResponsesCount:s.a.number({IsLocalField:!0}),XlExportingLocalTag:s.a.string({IsLocalField:!0}),SerializedSettings:s.a.string({SourceFieldName:"settings"}),Settings:s.a.fromMasterClass((function(){return Y}),{IsLocalField:!0}),SerializedPredefinedResponses:s.a.string({SourceFieldName:"predefinedResponses"}),TertiaryCustomizedThemeColor:s.a.string({IsLocalField:!0}),Theme:s.a.fromMasterClass((function(){return X.a}),{IsLocalField:!0}),ResponseModels:s.a.collectionOf((function(){return W.a}),{IsLocalField:!0}),IntegratedSavingState:s.a.reference({IsLocalField:!0}),SavingState:s.a.reference({IsLocalField:!0}),LogoInfo:s.a.fromMasterClass((function(){return L.b}),{IsLocalField:!0}),CreatedFromOneDrive:s.a.boolean({IsLocalField:!0}),TemplateId:s.a.string(),TransferInProgress:s.a.boolean({IsLocalField:!0}),DataClassificationLabel:s.a.string(),DefaultLanguage:s.a.string({SourceFieldName:"defaultLanguage"}),LocaleList:s.a.collectionOf((function(){return k.a}),{SourceFieldName:"localeList"}),LocalizedResources:s.a.collectionOf((function(){return N.a}),{SourceFieldName:"localizedResources"}),CreatedBy:s.a.string({SourceFieldName:"createdBy"}),FileUploadFormInfo:s.a.create({errorCode:s.a.string()},{SourceFieldName:"fileUploadFormInfo"})};function le(e){return de(e,!0)}function de(e,t,r){if(void 0===r&&(r=!1),t&&(e.SoftDeleted=e.SoftDeleted),e.Id)return Object(G.d)(e,r);var n=ye.FieldsForCreatingForm.map(i.a.getFieldSchemaInfo).map((function(e){return e.Name}));if(e=o.pick(e,n),t?(e.OwnerId=e.OwnerId||u.a.GroupId,!e.OwnerId&&Object(w.b)().Model.GroupMaster&&(e.OwnerId=Object(w.b)().Model.GroupMaster.Model.id),e.OwnerTenantId=e.OwnerTenantId||u.a.TenantId||OfficeFormServerInfo.userInfo.TenantId):(e.OwnerId=e.OwnerId||OfficeFormServerInfo.userInfo.UserId,e.OwnerTenantId=e.OwnerTenantId||OfficeFormServerInfo.userInfo.TenantId),!e.OwnerId||!e.OwnerTenantId)throw new Error("Form OwnerId or OwnerTenantId cannot be null!");return Object(G.b)(e,t?"Group":"User",r)}function fe(e){var t=Object(h.a)(e);return new ye(oe.ResponseTimeForm,{InitialData:{Id:e,OwnerId:t.OwnerId,OwnerTenantId:t.OrgId,TableId:t.TableId},ExistingInDataSource:!0},t.IsGroupOwner)}function pe(e){var t=Object(h.a)(e);return new ye(oe.ResponseDetailTimeForm,{InitialData:{Id:e,OwnerId:t.OwnerId,OwnerTenantId:t.OrgId,TableId:t.TableId},ExistingInDataSource:!0},t.IsGroupOwner)}function me(e){var t=Object(h.a)(e);return new ye(oe.SharedTimeForm,{InitialData:{Id:e,OwnerId:t.OwnerId,OwnerTenantId:t.OrgId,TableId:t.TableId},ExistingInDataSource:!0},t.IsGroupOwner)}function he(e){return new ye(oe.LocalForm,{InitialData:e},!1)}function ge(e){var t=Object(h.a)(e);return new ye(oe.AdminPhishingReviewForm,{InitialData:{Id:e,OwnerId:t.OwnerId,OwnerTenantId:t.OrgId,TableId:t.TableId},ExistingInDataSource:!0},t.IsGroupOwner)}!function(e){e[e.None=0]="None",e[e.MoveInProgress=1]="MoveInProgress",e[e.CvsScanAllowed=2]="CvsScanAllowed"}(re||(re={})),function(e){e[e.NotStarted=1]="NotStarted",e[e.Opened=2]="Opened",e[e.Expired=3]="Expired",e[e.Closed=4]="Closed"}(ne||(ne={})),function(e){e[e.DesignTimeForm=1]="DesignTimeForm",e[e.ResponseTimeForm=2]="ResponseTimeForm",e[e.SharedTimeForm=3]="SharedTimeForm",e[e.LocalForm=4]="LocalForm",e[e.AnalysisTimeForm=5]="AnalysisTimeForm",e[e.ResponseDetailTimeForm=6]="ResponseDetailTimeForm",e[e.AdminPhishingReviewForm=7]="AdminPhishingReviewForm"}(oe||(oe={})),function(e){e[e.ConnectionStateChanged=0]="ConnectionStateChanged",e[e.UserAction=1]="UserAction",e[e.UserConnect=2]="UserConnect",e[e.UserDisconnect=3]="UserDisconnect"}(ie||(ie={})),function(e){e[e.Normal=0]="Normal",e[e.SoftDeleted=1]="SoftDeleted"}(ae||(ae={}));var ye=function(e){function t(r,n,o,i,a){void 0===i&&(i=!1);var s=this,c=$.Deferred();return n=t.normalizeInitialData(n),(s=e.call(this,n,{Scheduler:new T.a,MasterReady:c.promise()})||this).syncBlocker=a||c,s.isGroupForm=o,s.isSampleForm=i,s.currentQuestionListDownloadJob=$.Deferred().resolve().promise(),s.questionSyncJobs=[],s.syncContext=r,s.formElementManager=new D.a(s),s.initializeElementOrderRule(),s.initializeOtherInfoBinder(n),s.initializeSavingStateIntegration(),s.initializeModifiedDate(n),s.initializeCreatedDate(n),s.initializeResponseCount(),Object(L.d)(s,t.Schema.Logo,t.Schema.LogoInfo),s.observe((function(){s.ensureFieldsReady([t.Schema.XlExportingTag]).done((function(){return s.Model.XlExportingLocalTag=s.Model.XlExportingTag.toLocaleLowerCase()}))}),[t.Schema.XlExportingTag]),t.Rules.forEach((function(e){return s.addRule(e)})),s.coAuthUserStateChangeCallbacks=new g.a.CallbackManager,c.resolve(),s}return se(t,e),Object.defineProperty(t,"ExportingProcessingStatusString",{get:function(){return"exporting"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ExportingFailedStatusString",{get:function(){return"failed"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ExportingTimeoutStatusString",{get:function(){return"timeout"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ReexportToExcelMaxTimeForTimeout",{get:function(){return 3e5},enumerable:!0,configurable:!0}),t.getSourceFields=function(e){var r=t.Schema,n=[];return e.forEach((function(e){switch(e){case"Settings":case r.Settings:n.push(r.SerializedSettings);break;case"Modified":case r.Modified:n.push(r.ModifiedDate);break;case"Created":case r.Created:n.push(r.CreatedDate);break;case"ResponsesCount":case r.ResponsesCount:n.push(r.RowCount);break;case"PredefinedResponses":case r.PredefinedResponses:n.push(r.SerializedPredefinedResponses);break;case"Theme":case r.Theme:n.push(r.Background,r.OtherInfo);break;default:if(t.OtherInfoFieldSet.covers(e)){n.push(r.OtherInfo);break}n.push(e)}})),o.uniq(n)},Object.defineProperty(t,"FieldsForCreatingForm",{get:function(){return t.FieldsToCopy.concat([t.Schema.OwnerId,t.Schema.OwnerTenantId])},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SyncBlocker",{get:function(){return this.syncBlocker},enumerable:!0,configurable:!0}),t.prototype.createExportFile=function(){return C.a.createExportFile(this)},t.prototype.downloadExcelFile=function(e,t){return C.a.downloadExcelFile(this,e,t)},Object.defineProperty(t.prototype,"IsGroupForm",{get:function(){return this.isGroupForm},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsSampleForm",{get:function(){return this.isSampleForm},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsAssignmentForm",{get:function(){return!!this.isFieldReady(this.Schema.Category)&&"assignments"===this.Model.Category},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SyncContext",{get:function(){return this.syncContext},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FormElementManager",{get:function(){return this.formElementManager},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SettingMaster",{get:function(){return i.a.getObjectMasterFromModel(this.Model.Settings)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ThemeMaster",{get:function(){return i.a.getObjectMasterFromModel(this.Model.Theme)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"QRCodeImage",{get:function(){return this.qrCodeImage||void 0},set:function(e){this.qrCodeImage=e},enumerable:!0,configurable:!0}),t.prototype.getRelatedSourceFields=function(e){return t.getSourceFields(e)},t.prototype.existingOnServerSide=function(){return this.Synchronizer.existingInDataSource()},t.prototype.getImageMaster=function(e){return Object(A.d)(this.getModelByFieldSchema(e))},t.prototype.getImageSettingsMaster=function(e){return Object(L.e)(this.getModelByFieldSchema(e))},t.prototype.getQuestionById=function(e){return this.formElementManager.getQuestionById(e)},t.prototype.getElementById=function(e){return this.formElementManager.getElementMasterById(e)},t.prototype.getDescriptiveElementMasterById=function(e){return this.formElementManager.getDescriptiveElementMasterById(e)},t.prototype.duplicateSection=function(e){return this.formElementManager.duplicateSectionAndSubElements(e)},t.prototype.deleteSectionAndSubElements=function(e){this.formElementManager.deleteSectionAndSubElements(e)},t.prototype.getQuestionSyncBlocker=function(e){return this.questionSyncJobs.push(y.a.always(e)),this.currentQuestionListDownloadJob},t.prototype.getReleasedResponsesByResponder=function(e){var t=this;return e&&!this.SettingMaster.Model.IsAnonymous?P.a.getReleasedResponsesByResponder(this,e).then((function(e){return t.normalizeResponses(e)})):$.Deferred().resolve().promise()},t.prototype.getRuntimeResponse=function(e){var t=this;return e?P.a.getRuntimeResponse(this,e).then((function(e){return t.normalizeResponse(e)})):$.Deferred().resolve().promise()},t.prototype.getResponseMasterById=function(e){return this.ensureResponseMasterById(e)},t.prototype.duplicateForm=function(e,r){var n=this;return this.ensureFieldsReady(t.FieldsToCopy).then((function(){var t=o.clone(n.getSnapshotToCopy());return t.OwnerId=e.OwnerId,t.OwnerTenantId=e.OwnerTenantId,t.Title=r,t.Settings=o.clone(t.Settings),t.Settings.AllowCopy=!1,t.Settings.ShareToken=null,de(t,e.IsGroupForm)}))},t.prototype.copyFormtoCDS=function(e,r,n,i){var a=this;return this.ensureFieldsReady(t.FieldsToCopy).then((function(){var t=o.clone(a.getSnapshotToCopy());return t.Title=n,t.Settings=o.clone(t.Settings),t.Settings.AllowCopy=!1,t.Settings.ShareToken=null,t.BusinessCdsId=r.TargetCdsId,t.BusinessCdsRegion=r.TargetCdsRegion,t.IsDefaultCds=String(i),de(t,e.IsGroupForm)}))},t.prototype.ensureCreationDone=function(){var e=this,r=this.getImageMaster(t.Schema.Background),n=this.getImageMaster(t.Schema.Logo);return $.when.apply($,ce([r.Synchronizer.flush(),n.Synchronizer.flush().then((function(){return e.Synchronizer.flush()}))],this.formElementManager.AllElementMasters.map((function(e){return e.ensureCreationDone()}))))},t.prototype.ensureReadyToDesign=function(){return this.ensureFieldsReady(t.FieldsToDesign)},t.prototype.ensureReadyToResponse=function(){return this.ensureFieldsReady(t.FieldsToResponse)},t.prototype.ensureReadyToAdminPhishingReview=function(){var e=t.FieldsToResponse;return e.push(this.Schema.CreatedBy),this.ensureFieldsReady(e)},t.prototype.ensureReadyToShare=function(){var e=t.Schema,r=[e.Title,e.ModifiedDate,e.OwnerId,e.OwnerTenantId,e.Description,e.Questions,e.DescriptiveElements,e.Settings,e.Theme,e.Logo,e.LogoInfo,e.Background,e.XlWorkbookId,e.Category,e.Type];return Object(M.e)((function(){r.push(e.FormsProRTTitle,e.FormsProRTDescription,e.ResponseThresholdCount,e.InviteExpiryDays,e.OwnerUserType)})),this.ensureFieldsReady(r)},t.prototype.ensureReadyForMruCard=function(){var e=t.Schema;return this.ensureFieldsReady([e.Title,e.ModifiedDate,e.Settings,e.XlWorkbookId,e.OwnerId,e.OwnerTenantId,e.Category,e.OtherInfo,e.Theme,e.RowCount])},t.prototype.getDefaultResponse=function(){var e={};return m.a.isDarkFunctionalitiesEnabled()&&o.forEach(this.Model.Questions,(function(t){return e[t.Id]=t.DefaultValue})),e},t.prototype.hasSection=function(){return this.FormElementManager.SectionMasters.length>0},t.prototype.moveToRecycleBin=function(){var e=this;return this.bulkEdit((function(){e.Model.MovingToRecycleBin=!0,e.Model.SoftDeleted=ae.SoftDeleted})),this.Synchronizer.flush().done((function(){e.Model.MovingToRecycleBin=!1}))},t.prototype.isNotSoftDeleted=function(){return!this.isFieldReady(this.Schema.SoftDeleted)||this.Model.SoftDeleted===ae.Normal},t.prototype.isSoftDeleted=function(){return!!this.isFieldReady(this.Schema.SoftDeleted)&&this.Model.SoftDeleted===ae.SoftDeleted},t.prototype.reachedQuestionNumberLimitation=function(){return Object(I.a)().Flighting.isEnabled_Deprecated("Question200Limit")?this.formElementManager.QuestionMasters.filter((function(e){return e.Model.Type!=te.a.MatrixChoiceGroup})).length>=d.a.QuestionNumber:this.FormElementManager.QuestionMasters.length>=d.a.QuestionNumber},t.prototype.syncFormResponses=function(){var e=this;return this.responsesQueryJob&&this.responsesQueryJob.state()===y.a.State.Pending?this.responsesQueryJob:(this.responsesQueryJob=this.Synchronizer.existingInDataSource().then((function(){var r=[t.Schema.Questions];r.push(t.Schema.Settings);var n=e.ensureFieldsReady(r);return $.when(P.a.getResponses(e),n).then((function(t){e.updatingResponsesFromServer=!0,e.bulkEdit((function(){e.Model.Responses=e.normalizeResponses(t),e.Synchronizer.onSourceDataReceived({rowCount:t.length})})),e.updatingResponsesFromServer=!1}))})),this.responsesQueryJob)},t.prototype.syncSampleFormResponses=function(e){var t=this,r=e.map(P.a.toClientPayload);this.bulkEdit((function(){t.Model.Responses=t.normalizeResponses(r),t.Synchronizer.onSourceDataReceived({rowCount:e.length})}))},t.prototype.syncFormResponsesByPaging=function(e,t){var r=this;return this.getFormResponsesByPaging(e,t).then((function(e){r.updatingResponsesFromServer=!0,r.Model.BufferResponses=e,r.updatingResponsesFromServer=!1}))},t.prototype.getFormResponsesByPaging=function(e,r){var n=this,o=[t.Schema.Questions];o.push(t.Schema.Settings);var i=this.ensureFieldsReady(o),a=this.Synchronizer.existingInDataSource().then((function(){return P.a.getResponses(n,e,r)}));return $.when(a,i).then((function(e){return n.normalizeResponses(e)}))},t.prototype.syncAnalysisTimeResponsesByPaging=function(e,t){var r=this;return this.getAnalysisTimeResponsesByPaging(e,t).then((function(e){r.updatingResponsesFromServer=!0,r.Model.BufferResponses=e,r.updatingResponsesFromServer=!1}))},t.prototype.getAnalysisTimeResponsesByPaging=function(e,t){var r=this;return C.a.getDataProviderByFormMaster(this).getAnalysisTimeResponses(this.Model.Id,e,t).then((function(e){return r.normalizeResponses(e.map(P.a.toClientPayload))}))},t.prototype.syncRuntimeResponses=function(){var e=this;return this.Synchronizer.existingInDataSource().then((function(){return P.a.getRuntimeResponses(e)})).then((function(t){e.updatingResponsesFromServer=!0,e.bulkEdit((function(){return e.Model.Responses=e.normalizeResponses(t)})),e.updatingResponsesFromServer=!1}))},t.prototype.getFormResponsesCountByAPICall=function(){var e=this;return this.Synchronizer.existingInDataSource().then((function(){return C.a.getResponseCount(e)})).then((function(t){e.Model.ResponsesCount=t}))},t.prototype.refreshFormResponsesCount=function(){return this.Synchronizer.query([t.Schema.ResponsesCount])},t.prototype.submitResponse=function(e){var t=this;if("pending"===this.syncBlocker.state())return $.Deferred().resolve();var r=0,n=0,i=!1;return(e=o.clone(e)).Answers=o.map(e.Answers,(function(e){var a=t.getQuestionById(e.QuestionId);return a&&a.Model&&((e=o.clone(e)).Answer=a.serializeAnswer(e.Answer),a.Model.Type===te.a.TextField&&(r++,e.Answer&&(n+=e.Answer.length),!i&&a.Model.IsMathQuiz&&(i=!0))),e})),i&&this.logTextFieldSubmissionMathInfo(e),F.a.logData({name:"ResponsePage.Form.TextQuestionInfoOfSubmit",extraData:{textQuestionCount:r,textQuestionAnswerTotalLength:n,isQuiz:this.SettingMaster.Model.IsQuizMode}}),this.Synchronizer.existingInDataSource().then((function(){return P.a.submitResponse(t,e)}))},t.prototype.deleteAllResponses=function(){var e=this;return this.Synchronizer.existingInDataSource().then((function(){return P.a.deleteAllResponses(e)})).then((function(){var t={Responses:[],ResponsesCount:0};e.updatingResponsesFromServer=!0,e.setData(t),e.updatingResponsesFromServer=!1}))},t.prototype.deleteBufferResponse=function(e){var t=this;return this.Synchronizer.existingInDataSource().then((function(){return P.a.deleteResponses(t.Model.Id,[e])})).then((function(){var r=i.a.getCollectionMasterFromModel(t.Model.BufferResponses),n=r.getItemWithKeyFields({Id:e});n&&t.bulkEdit((function(){r.itemsDeletedInSource([n]),--t.Model.ResponsesCount}))}))},t.prototype.setResponseComment=function(e,t){var r=this.ensureResponseMasterById(e);r.Model.Feedback=t,this.postFormGradingChange(r.Model)},t.prototype.setAnswerGrading=function(e,t,r,n){var o=this.ensureResponseMasterById(e);o.setAnswerGrading(t,r,n),this.postFormGradingChange(o.Model)},t.prototype.setReleaseDate=function(e,t){var r=this.ensureResponseMasterById(e);r.Model.ReleaseDate=t,this.postFormGradingChange(r.Model)},t.prototype.resetBranchInfo=function(){this.FormElementManager.AllElementMasters.forEach((function(e){return e.resetBranchInfo()}))},t.prototype.hasSectionBranching=function(){return this.hasSection()&&this.FormElementManager.TopElementMasters.some((function(e){return e.hasSectionBranching()}))},t.prototype.startReceivingNotifications=function(e){var r=this,n=t.Schema,o=[n.Id,n.OwnerId,n.OwnerTenantId,n.TableId];return this.ensureFieldsReady(o).done((function(){e&&r.coAuthUserStateChangeCallbacks.register(e),r.receivingNotifications||(r.receivingNotifications=!0,r.startReceivingNotificationsInternal())}))},t.prototype.stopReceivingNotifications=function(e){var t=this;this.existingOnServerSide().done((function(){S.a.getInstance().createNotificationProvider(t.DataProviderType,t.Model.OwnerTenantId,t.Model.OwnerId).close(t.Model.Id),t.receivingNotifications=!1,t.coAuthUserStateChangeCallbacks.clear(),t.responsesQueryJob=null,e()}))},t.prototype.formOwnedByMe=function(){return this.Model.OwnerId&&this.Model.OwnerId===OfficeFormServerInfo.userInfo.UserId},t.prototype.appendPermission=function(e){for(var t=this.Model.Permissions,r=function(r){if("OrgLink"===t[r].Type||"Link"===t[r].Type){var n=t[r],o=q(n),i=o.Model.Type;return o.Model.Type=e,{value:o.Synchronizer.flush().then((function(){return n.PrincipalId})).fail((function(){return o.Model.Type=i}))}}},n=0;n<t.length;n++){var o=r(n);if("object"==typeof o)return o.value}var a=q(i.a.Collection.addItems(t,[Q(e)])[0]);return a.Synchronizer.existingInDataSource().then((function(){return a.Model.PrincipalId}))},t.prototype.removeLinkPermission=function(){var e=this.getLinkPermissions();i.a.Collection.deleteItems(this.Model.Permissions,e);var t=e.map(q).map((function(e){return e.Synchronizer.deletedFromDataSource()}));return $.when.apply($,t)},t.prototype.getPermissionToken=function(){var e=this;return this.Synchronizer.existingInDataSource().then((function(){var t=e.getLinkPermissions().map(q);return 0!==t.length?t[0].Synchronizer.existingInDataSource().then((function(){return t[0].Model.PrincipalId})):null}))},t.prototype.getSnapshotToCopy=function(){var e=this.getSnapshot(t.FieldsToCopy),r=null;return e.XlWorkbookId&&((r=o.clone(e)).XlWorkbookId="WaitingForExport"),this.Model.OwnerTenantId!==OfficeFormServerInfo.userInfo.TenantId&&e.DataClassificationLabel&&(r||(r=o.clone(e)),r.DataClassificationLabel=null),Object(M.e)((function(){e.CustomCssFileName&&(r||(r=o.clone(e)),r.CustomCssFileName=null)})),null===r?e:r},t.prototype.SetToExporting=function(){var e=this;this.ensureFieldsReady([t.Schema.XlExportingLocalTag]).done((function(){e.Model.XlExportingLocalTag=t.ExportingProcessingStatusString}))},t.prototype.IsExporting=function(){var e,r=this,n=0;if(this.isFieldReady(t.Schema.XlExportingLocalTag)&&this.Model.XlExportingLocalTag&&this.Model.XlExportingLocalTag.indexOf(t.ExportingProcessingStatusString)>=0)try{var o=JSON.parse(this.Model.XlExportingLocalTag),i=Date.parse(o.starttime.toUpperCase());e=(n=(new Date).getTime()-i)<t.ReexportToExcelMaxTimeForTimeout}catch(t){e=!0}else e=!1;return e?this.exportingTimeout=this.exportingTimeout||window.setTimeout((function(){r.Model.XlExportingLocalTag=t.ExportingTimeoutStatusString}),t.ReexportToExcelMaxTimeForTimeout-n):window.clearTimeout(this.exportingTimeout),e},t.prototype.IsExportingFailed=function(){return this.Model.XlExportingLocalTag.toLocaleLowerCase().indexOf(t.ExportingFailedStatusString)>=0},t.prototype.triggerShareAction=function(){if(Object(I.a)().Flighting.isEnabled_Deprecated("EnableMsaContentValidation")&&!this.cvsRequestSent&&OfficeFormServerInfo.userInfo.IsMsa&&0==(this.Model.Flags&re.CvsScanAllowed)){this.cvsRequestSent=!0,S.a.getInstance().createDataProvider().postFormShareAction(this.Model.Id);var e=JSON.parse(this.Model.OtherInfo);e&&e.hasOwnProperty("TemplateId")&&Object(O.d)({eventName:"MyTemplate.PostShare",eventType:"engagement_event",extraData:{TemplateTitle:e.TemplateId}})}},t.prototype.createLocale=function(e,t){var r={localeId:e,localeName:t};i.a.Collection.addItems(this.Model.LocaleList,[r]),Object(x.d)(r,this)},t.prototype.deleteLocale=function(e){var t=i.a.Collection.getItemWithKeyFields(this.Model.LocaleList,{localeId:e});t&&(i.a.Collection.deleteItems(this.Model.LocaleList,[t]),Object(x.j)(e,this))},t.prototype.getAllLocaleResources=function(){return C.a.getDataProviderByFormId(this.Model.Id).getAllLocaleResources(this.Model.Id).then((function(e){return Object(x.h)(e)}))},t.prototype.getLocaleResouceById=function(e){return C.a.getDataProviderByFormId(this.Model.Id).getLocaleResource(this.Model.Id,e).then((function(e){return Object(x.h)(e)}))},t.prototype.ensureFieldsReady=function(t){var r=this;return Object(M.c)((function(){return e.prototype.ensureFieldsReady.call(r,t)}),(function(){if(r.isSampleForm){var n=$.Deferred();return FormsPro.MFPDataProviderAdapter.getSampleForm().then((function(e){e?(e.ownerId=OfficeFormServerInfo.userInfo.UserId,e.ownerTenantId=OfficeFormServerInfo.userInfo.TenantId,FormsPro.MFPDataProviderAdapter.setDefaultValuesForSampleFormData(e),r.Synchronizer.onSourceDataReceived(e),r.syncSampleFormResponses(e.responses),n.resolve()):n.reject()}),(function(){return n.reject()})),n.promise()}return e.prototype.ensureFieldsReady.call(r,t)}))},Object.defineProperty(t,"FieldsToCopy",{get:function(){var e=t.Schema,r=[e.Background,e.Description,e.Logo,e.LogoInfo,e.Questions,e.DescriptiveElements,e.Settings,e.SoftDeleted,e.Title,e.PrimaryCustomizedThemeColor,e.SecondaryCustomizedThemeColor,e.TertiaryCustomizedThemeColor,e.Theme,e.TrackingId,e.XlWorkbookId,e.ThankYouMessage,e.EmailReceiptEnabled,e.DataClassificationLabel,e.Type,e.DefaultLanguage,e.LocaleList,e.LocalizedResources,e.OnlineSafetyLevel,e.MeetingId];return Object(M.e)((function(){r.push(e.BusinessCdsId,e.BusinessCdsRegion,e.LastEmbedConfig,e.FormsProBranchRules,e.MfpBranchingData,e.FormsProRTTitle,e.FormsProRTDescription,e.IsDefaultCds,e.PipesDetails,e.FooterText,e.CustomCssFileName,e.CustomDomainSenderEmail,e.ResponseThresholdCount,e.InviteExpiryDays,e.OwnerUserType)})),r},enumerable:!0,configurable:!0}),Object.defineProperty(t,"FieldsToDesign",{get:function(){var e=t.Schema,r=[e.Title,e.ModifiedDate,e.CreatedDate,e.MeetingId,e.OwnerId,e.OwnerTenantId,e.Description,e.Questions,e.DescriptiveElements,e.Permissions,e.PermissionTokens,e.ResponsesCount,e.Settings,e.Theme,e.Logo,e.LogoInfo,e.Background,e.XlWorkbookId,e.XlExportingTag,e.XlFileUnsynced,e.XlUnsyncedReason,e.Category,e.TrackingId,e.PredefinedResponses,e.ThankYouMessage,e.EmailReceiptEnabled,e.Flags,e.OnlineSafetyLevel,e.DataClassificationLabel,e.Type,e.DefaultLanguage,e.LocaleList,e.LocalizedResources];return Object(M.e)((function(){r.push(e.BusinessCdsId,e.BusinessCdsRegion,e.PipesDetails,e.FormsProRTTitle,e.FormsProRTDescription,e.FormsProBranchRules,e.MfpBranchingData,e.FooterText,e.CustomCssFileName,e.CustomDomainSenderEmail,e.Id,e.ResponseThresholdCount,e.InviteExpiryDays,e.OwnerUserType)})),r},enumerable:!0,configurable:!0}),Object.defineProperty(t,"FieldsToResponse",{get:function(){var e=t.Schema,r=[e.Title,e.ModifiedDate,e.Description,e.Settings,e.Theme,e.Questions,e.DescriptiveElements,e.Logo,e.LogoInfo,e.Background,e.Category,e.PredefinedResponses,e.ThankYouMessage,e.EmailReceiptEnabled,e.DataClassificationLabel,e.Type,e.DefaultLanguage,e.LocaleList,e.OnlineSafetyLevel];return Object(M.e)((function(){r.push(e.CustomCssFileName,e.FormsProRTTitle,e.FormsProRTDescription,e.FooterText,e.FormsProBranchRules,e.MfpBranchingData,e.ResponseThresholdCount,e.InviteExpiryDays,e.OwnerUserType)})),r},enumerable:!0,configurable:!0}),t.prototype.hasFileUpload=function(){return!!o.find(this.Model.Questions,(function(e){return e.Type===te.a.FileUpload}))},t.prototype.getQuestionError=function(){if(this.isFieldReady(this.Schema.FileUploadFormInfo)&&this.Model.FileUploadFormInfo&&this.Model.FileUploadFormInfo.errorCode)return f.a.LocalizedStrings.UploadFile_ErrorMessage_PortalPage_FormCard_Bar},Object.defineProperty(t,"OtherInfoFieldSet",{get:function(){return t.otherInfoFieldSet||(t.otherInfoFieldSet=new R.a([t.Schema.PrimaryCustomizedThemeColor,t.Schema.SecondaryCustomizedThemeColor,t.Schema.TertiaryCustomizedThemeColor,t.Schema.Theme,t.Schema.LogoInfo,t.Schema.CreatedFromOneDrive,t.Schema.TemplateId])),t.otherInfoFieldSet},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Rules",{get:function(){if(!t.rules){var e=t.Schema,r=i.a.getSubFieldSchemas(e).filter((function(e){return!i.a.getFieldSchemaInfo(e).Attributes.IsLocalField}));t.rules=[{Name:"IntegrateSavingState",InterestedFields:[e.Background.SavingState,e.Logo.SavingState,e.SavingState],onChange:function(e){return e.Master.updateIntegratedSavingState()}},{Name:"Modified",InterestedFields:o.without(r,e.SoftDeleted),onChange:function(t){if(!t.BeingDeleted&&!o.contains(t.FieldSchemas,e.Modified)){var n=t.Master;if(o.contains(t.FieldSchemas,e.ModifiedDate))n.Model.Modified=n.Model.ModifiedDate;else if(n.isFieldReady(e.Modified))o.intersection(t.FieldSchemas,r).map(i.a.getFieldSchemaInfo).map((function(e){return e.Name})).some((function(e){return e in t.OldValues}))&&(n.Model.Modified=(new Date).toISOString())}}},{Name:"RowCount",InterestedFields:[e.RowCount],onChange:function(e){if(!e.BeingDeleted){var t=e.Master.Model;t.ResponsesCount=t.RowCount}}},{Name:"CollaboratedQuestionProperties",InterestedFields:[e.Questions,e.DescriptiveElements],onChange:function(e){var r=e.Master.Model,n=!1;e.Master.isFieldReady(t.Schema.Questions)&&(n=i.a.convertToArray(e.Master.Model.Questions).some((function(e){return i.a.getObjectMasterFromModel(e).hasValidBranching()})));var o=!1;e.Master.isFieldReady(t.Schema.DescriptiveElements)&&(o=i.a.convertToArray(e.Master.Model.DescriptiveElements).some((function(e){return e.BranchInfo&&i.a.getObjectMasterFromModel(e.BranchInfo).IsValid})));r.HasValidBranching=n||o;var a=i.a.convertToArray(e.Master.getSnapshot().Questions),s=i.a.convertToArray(e.Master.getSnapshot().DescriptiveElements);r.HasQuestionMedia=a.some((function(e){return!(!e.ImageInfo.ResourceUrl&&!e.VideoInfo.Url)}))||s.some((function(e){return!(!e.ImageInfo.ResourceUrl&&!e.VideoInfo.Url)})),r.QuizQuestionsCount=a.filter((function(e){return e.IsQuiz})).length}},{Name:"DeserializeSettings",InterestedFields:[e.SerializedSettings],onChange:function(e){if(!e.BeingDeleted){var t=e.Master.Model.SerializedSettings||"{}",r=JSON.parse(t);e.Master.setData({Settings:r})}}},{Name:"SerializeSettings",InterestedFields:[t.Schema.Settings],onChange:function(e){if(!e.BeingDeleted){var t=e.Master.Model;t.SerializedSettings=Y.serialize(t.Settings)}}},{Name:"DeserializePredefinedResponses",InterestedFields:[e.SerializedPredefinedResponses],onChange:function(e){if(!e.BeingDeleted){var t=e.Master.Model.SerializedPredefinedResponses||"[]",r=JSON.parse(t);e.Master.setData({PredefinedResponses:r})}}},{Name:"SerializePredefinedResponses",InterestedFields:[t.Schema.PredefinedResponses],onChange:function(e){if(!e.BeingDeleted){var r=e.Master.Model;r.SerializedPredefinedResponses=t.serializePredefinedReponses(r.PredefinedResponses)}}},{Name:"DeleteResponseModels",InterestedFields:[e.Responses],onChange:function(e){var t=e.Master,r=t.Model.Responses,n=[],o=[];e.SubChanges.filter((function(e){return e.Master.Model===r})).forEach((function(e){return e.RemovedModels.forEach((function(e){var r=t.getResponseModelById(e.Id);r?n.push(r):o.push(e.Id)}))}));var a=i.a.getCollectionMasterFromModel(t.Model.ResponseModels);t.updatingResponsesFromServer?a.itemsDeletedInSource(n):(a.deleteItems(n),Object(W.b)(t,o))}},{Name:"ResponsesCount",InterestedFields:[e.ResponsesCount],onChange:function(t){var r=t.Master;r.isFieldReady(e.ResponsesCount)&&-1===r.Model.ResponsesCount&&(r.Model.ResponsesCount=null)}},{Name:"ResponseModel Change",InterestedFields:[e.ResponseModels],onChange:function(e){var t=e.Master,r=i.a.getCollectionMasterFromModel(t.Model.ResponseModels),n=i.a.getCollectionMasterFromModel(t.Model.Responses);e.SubChanges.filter((function(e){return e.Master===r})).forEach((function(e){e.SubChanges.forEach((function(e){var t=o.indexOf(n.Model,e.Master.Model);t>=0&&n.markAsChanged(t)}))}))}}]}return t.rules},enumerable:!0,configurable:!0}),t.normalizeInitialData=function(e){var r;return e.InitialData&&((e.InitialData.SerializedSettings||e.InitialData.Settings)&&(r=r||{},e.InitialData.SerializedSettings?r.Settings=JSON.parse(e.InitialData.SerializedSettings):r.SerializedSettings=Y.serialize(e.InitialData.Settings)),(e.InitialData.SerializedPredefinedResponses||e.InitialData.PredefinedResponses)&&(r=r||{},e.InitialData.SerializedPredefinedResponses?r.PredefinedResponses=JSON.parse(e.InitialData.SerializedPredefinedResponses):r.SerializedPredefinedResponses=t.serializePredefinedReponses(e.InitialData.PredefinedResponses))),r&&((e=o.clone(e)).InitialData=o.extend({},e.InitialData,r)),e},t.serializePredefinedReponses=function(e){return e&&e.length>0?JSON.stringify(e):null},t.prototype.initializeElementOrderRule=function(){var e=this;this.formElementManager.adjustElementOrders();var r=[t.Schema.Questions,t.Schema.DescriptiveElements];this.addRule({Name:"ElementOrder",InterestedFields:r,onChange:function(){return e.formElementManager.adjustElementOrders()}})},t.prototype.initializeSavingStateIntegration=function(){var e=this;Object(U.b)(this),this.questionsSavingState="Idle",this.responsesSavingState="Idle",this.descriptiveElementSavingState="Idle",this.fieldsReady([t.Schema.Questions]).done((function(){var t=i.a.getCollectionMasterFromModel(e.Model.Questions);Object(U.c)(t,t.Schema[0].IntegratedSavingState,(function(t){e.questionsSavingState=t,e.updateIntegratedSavingState()}))})),this.fieldsReady([t.Schema.DescriptiveElements]).done((function(){var t=i.a.getCollectionMasterFromModel(e.Model.DescriptiveElements);Object(U.c)(t,t.Schema[0].IntegratedSavingState,(function(t){e.descriptiveElementSavingState=t,e.updateIntegratedSavingState()}))}));var r=i.a.getCollectionMasterFromModel(this.Model.ResponseModels);Object(U.c)(r,r.Schema[0].IntegratedSavingState,(function(t){e.responsesSavingState=t,e.updateIntegratedSavingState()})),this.updateIntegratedSavingState()},t.prototype.initializeModifiedDate=function(e){e.ExistingInDataSource?this.isFieldReady(t.Schema.ModifiedDate)&&(this.Model.Modified=this.Model.ModifiedDate):this.Model.Modified=(new Date).toISOString()},t.prototype.initializeCreatedDate=function(e){e.ExistingInDataSource?this.isFieldReady(t.Schema.CreatedDate)&&(this.Model.Created=this.Model.CreatedDate):this.Model.Created=(new Date).toISOString()},t.prototype.initializeResponseCount=function(){this.isFieldReady(t.Schema.RowCount)&&(this.Model.ResponsesCount=this.Model.RowCount)},t.prototype.updateIntegratedSavingState=function(){var e=this;if("pending"===this.syncBlocker.state())return this.Model.IntegratedSavingState="NotStarted",void this.syncBlocker.done((function(){return e.updateIntegratedSavingState()}));var r=[this.Model.SavingState,this.questionsSavingState,this.responsesSavingState],n=t.Schema;this.isFieldReady(n.DescriptiveElements)&&r.push(this.descriptiveElementSavingState),this.isFieldReady(n.Logo)&&r.push(this.Model.Logo.SavingState),this.isFieldReady(n.Background)&&r.push(this.Model.Background.SavingState),this.Model.IntegratedSavingState=Object(U.a)(r)},t.prototype.initializeOtherInfoBinder=function(e){this.otherInfoBinder=new E.a(this,t.Schema.OtherInfo,t.OtherInfoFieldSet),e.InitialData&&this.isFieldReady(t.Schema.OtherInfo)&&(e.ExistingInDataSource||e.InitialData.OtherInfo?this.otherInfoBinder.deserialize():this.otherInfoBinder.serialize())},t.prototype.updateCoAuthors=function(e,t){if(p.a.isValidUser(t)){var r=this.getElementById(e);r&&r.updateCoAuthors(t)}},Object.defineProperty(t.prototype,"DataProviderType",{get:function(){return this.isGroupForm?v.a.Group:v.a.Personal},enumerable:!0,configurable:!0}),t.prototype.startReceivingNotificationsInternal=function(){var e,r=this,n=function(e,t){return r.coAuthUserStateChangeCallbacks.trigger(e,t)},s=S.a.getInstance().createNotificationProvider(this.DataProviderType,this.Model.OwnerTenantId,this.Model.OwnerId),u=this.Model,d=$.Deferred().resolve().promise(),f=0,p=function(e){d.done((function(){e===f&&(d=r.refreshFormResponsesCount())}))},m=function(){r.Synchronizer.query(t.FieldsToDesign)};e=c.a.isProduction()?function(e){}:function(e){u.CoAuthMessage=e};var g=Object(l.c)(),b={onConnectionStarted:function(t){n(t||[],ie.ConnectionStateChanged),t&&t.length>1&&m(),e("Connection established")},onConnectionFailed:function(t){e("Connection failed to be established")},onConnectionSlow:function(){e("Connection is slow")},onConnectionError:function(t){e("Connection has error")},onConnectionReconnecting:function(){e("Connection reestablishing")},onConnectionReconnected:function(t){n(t||[],ie.ConnectionStateChanged),t&&t.length>1&&m(),e("Connection reestablished")},onConnectionDisconnected:function(){e("Connection disconnected")},onResponseAdded:function(t){r.bulkEdit((function(){p(++f),e("Response added")}))},onResponseDeleted:function(t){r.bulkEdit((function(){p(++f),e("Response deleted")}))},onResponsesAllDeleted:function(){r.bulkEdit((function(){p(++f),e("All responses deleted")}))},onFormElementAdded:g?null:function(t,o){var a=r.getElementById(t.id);if(a instanceof ee.d){var s=t;s.choices||(s.choices=[]),a.Synchronizer.onSourceDataReceived(t)}else a instanceof _.a?a.Synchronizer.onSourceDataReceived(t):r.currentQuestionListDownloadJob=y.a.always(r.currentQuestionListDownloadJob.then((function(){D.a.isDescriptiveElement(t.type)?i.a.Collection.itemsAddedInSource(r.Model.DescriptiveElements,[i.a.convertFromSourceData(t,_.a.Schema)]):i.a.Collection.itemsAddedInSource(r.Model.Questions,[i.a.convertFromSourceData(t,ee.d.Schema)])})));r.updateCoAuthors(t.id,o),n([o],ie.UserAction),e("Question added")},onFormElementDeleted:g?null:function(t,o){r.currentQuestionListDownloadJob=y.a.always(r.currentQuestionListDownloadJob.then((function(){var e=r.getElementById(t);if(e instanceof ee.d){var n=e.SubQuestionMasters.concat(e);i.a.Collection.itemsDeletedInSource(r.Model.Questions,n.map((function(e){return e.Model})))}else e instanceof _.a&&i.a.Collection.itemsDeletedInSource(r.Model.DescriptiveElements,[e.Model])}))),n([o],ie.UserAction),e("Question deleted")},onFormElementUpdated:g?null:function(t,o,i){var a=r.getElementById(t);a&&(a instanceof ee.d?a.Synchronizer.onSourceDataReceived(o):a instanceof _.a&&a.Synchronizer.onSourceDataReceived(o),r.updateCoAuthors(t,i),n([i],ie.UserAction),e("Question updated"))},onChoiceAdded:g?null:function(t,a,s){var c=r.getQuestionById(t);if(c){var u;if(a.key){if(!c.getChoiceByKey(a.key)){var l=i.a.convertFromSourceData(a,Z.a.Schema);i.a.Collection.itemsAddedInSource(c.Model.ChoiceGroup,[l])}u=$.Deferred().resolve().promise()}else{var d=o.map(c.Model.ChoiceGroup,(function(e){return i.a.getObjectMasterFromModel(e).Synchronizer.existingInDataSource()}));u=$.when.apply($,d).then((function(){if(-1===i.a.Collection.getIndexWithKeyFields(c.Model.ChoiceGroup,{Id:a.id})){var e=i.a.convertFromSourceData(a,Z.a.Schema);i.a.Collection.itemsAddedInSource(c.Model.ChoiceGroup,[e])}}))}u.done((function(){r.updateCoAuthors(t,s),n([s],ie.UserAction),e("Choice added")}))}},onChoiceDeleted:g?null:function(t,o,i){var a=r.getQuestionById(t);if(a){var s=a.getChoiceById(o);s&&(s.Synchronizer.onDeletedInDataSource(),n([i],ie.UserAction),e("Question deleted"))}},onChoiceUpdated:g?null:function(t,o,i,a){var s=r.getQuestionById(t);if(s){var c=s.getChoiceById(o);c&&(c.Synchronizer.onSourceDataReceived(i),r.updateCoAuthors(t,a),n([a],ie.UserAction),e("Choice updated"))}},onUserConnected:g?null:function(t){n([t],ie.UserConnect),e("New user connected")},onUserDisconnected:g?null:function(t){n([t],ie.UserDisconnect),e("Existing user disconnected")},onFormUpdated:g?null:function(t,a){var s=o.map(r.Model.PermissionTokens,(function(e){return i.a.getObjectMasterFromModel(e).Synchronizer.existingInDataSource()}));$.when.apply($,s).then((function(){r.Synchronizer.onSourceDataReceived(t),n([a],ie.UserAction),e("Form updated")}))},onLocaleResourceAdded:g?null:function(t,a){r.bulkEdit((function(){o.forEach(t,(function(e){if("localename"===e.elementKey){var t={localeId:e.locale,localeName:e.elementValue};-1===i.a.Collection.getIndexWithKeyFields(r.Model.LocaleList,{localeId:t.localeId})&&(i.a.Collection.itemsAddedInSource(r.Model.LocaleList,[t]),Object(x.d)(t,r))}else r.handleNewLocaleResourceExceptLocaleName(e)})),a&&n([a],ie.UserAction),e("Locale resource added")}))},onLocaleResourceUpdated:g?null:function(t,o){var a=i.a.Collection.getItemWithKeyFields(r.Model.LocaleList,{localeId:t.locale});if(a){if("localename"===t.elementKey){var s={localeName:t.elementValue};i.a.getObjectMasterFromModel(a).Synchronizer.onSourceDataReceived(s);var c=i.a.Collection.getItemWithKeyFields(r.Model.LocalizedResources,{localeId:t.locale});if(c)i.a.getObjectMasterFromModel(c).Synchronizer.onSourceDataReceived(s)}else r.handleNewLocaleResourceExceptLocaleName(t);o&&n([o],ie.UserAction),e("Locale resource updated")}},onLocaleResourceDeleted:g?null:function(t,s){if(t.hasOwnProperty("locale")){var c=t.locale,u=i.a.Collection.getItemWithKeyFields(r.Model.LocaleList,{localeId:c});u&&i.a.Collection.itemsDeletedInSource(r.Model.LocaleList,[u])}else if(t.hasOwnProperty("propertyName")){var l=t.propertyName;o.forEach(r.Model.LocalizedResources,(function(e){var t=i.a.Collection.getItemWithKeyFields(e.questionResources,{questionId:l});t&&i.a.getObjectMasterFromModel(t).Synchronizer.onDeletedInDataSource()}))}else Object(a.c)("Not supposed to happen.");s&&n([s],ie.UserAction),e("Locale resource deleted")}},v=Object(h.a)(u.Id),I={OwnerTenantId:u.OwnerTenantId,OwnerId:u.OwnerId,TableId:u.TableId,IsGroupTable:v.IsGroupOwner};s.open(u.Id,b,I)},t.prototype.handleNewLocaleResourceExceptLocaleName=function(e){if(e.elementKey.startsWith("choiceid_")){var t=o.find(this.Model.LocalizedResources,(function(t){return t.localeId==e.locale}));if(t){var r=o.find(t.questionResources,(function(t){return t.questionId==e.propertyName}));if(r){var n=i.a.getObjectMasterFromModel(r),s=e.elementKey.substring("choiceid_".length),c=n.getChoiceLocalizedMaster(s),u={choiceId:s,description:e.elementValue,key:c.Model.key};c.Synchronizer.onSourceDataReceived(u)}}}else switch(e.elementKey){case"title":case"subtitle":case"formsprortlocaletitle":case"formsprortlocalesubtitle":"_id"===e.propertyName?this.updateFormLevelLocaleResource(e.locale,e.elementKey,e.elementValue):this.updateQuationLevelLocaleResource(e.locale,e.propertyName,e.elementKey,e.elementValue);break;case"thankYouMessage":case"formCloseMessage":case"footerText":"_id"===e.propertyName?this.updateFormLevelLocaleResource(e.locale,e.elementKey,e.elementValue):Object(a.c)("Not supposed to happen. Should be form level property.");break;case"leftDescription":case"rightDescription":case"formsprortlocaleldescription":case"formsprortlocalerdescription":case"option":"_id"===e.propertyName?Object(a.c)("Not supposed to happen. Should be question level property."):this.updateQuationLevelLocaleResource(e.locale,e.propertyName,e.elementKey,e.elementValue);break;default:Object(a.c)("Not supposed to happen. Unknown element key")}},t.prototype.updateFormLevelLocaleResource=function(e,t,r){var n=o.find(this.Model.LocalizedResources,(function(t){return t.localeId==e}));if(n){var a=i.a.getObjectMasterFromModel(n),s={localeId:e};s[t]=r,a.Synchronizer.onSourceDataReceived(s)}},t.prototype.updateQuationLevelLocaleResource=function(e,t,r,n){var a=o.find(this.Model.LocalizedResources,(function(t){return t.localeId==e}));if(a){var s=o.find(a.questionResources,(function(e){return e.questionId==t}));if(s){var c=i.a.getObjectMasterFromModel(s),u={localeId:e};u[r]=n,c.Synchronizer.onSourceDataReceived(u)}}},t.prototype.ensureResponseMasterById=function(e){var t=this,r=this.getResponseModelById(e);if(!r){var n=this.Model.Responses,s=o.findIndex(n,(function(t){return t.Id===e}));s<0&&Object(a.c)("no such response"),this.bulkEdit((function(){r=i.a.Collection.itemsAddedInSource(t.Model.ResponseModels,[n[s]])[0],n[s]=r}))}return Object(W.c)(r)},t.prototype.getLinkPermissions=function(){return o.filter(this.Model.Permissions,(function(e){return"Link"===e.Type||"OrgLink"===e.Type}))},t.prototype.getResponseModelById=function(e){return i.a.Collection.getItemWithKeyFields(this.Model.ResponseModels,{Id:e})},t.prototype.normalizeResponses=function(e){var t=this;return this.bulkEdit((function(){e=e.map((function(e){return t.normalizeResponse(e)}))})),e},t.prototype.normalizeResponse=function(e){var t=this.Model.Settings.IsQuizMode&&this.SyncContext!==oe.ResponseTimeForm,r={};this.FormElementManager.QuestionMasters.forEach((function(e){return r[e.Model.Id]=e})),(e=o.clone(e)).Answers=o.map(e.Answers,(function(e){var n=r[e.QuestionId];return n?((e=o.clone(e)).Answer=n.deserializeAnswer(e.Answer),e.IsMathAnswer=!n.Model.IsAnswerPlainText,null==e.Score&&t&&n.autoGradeAnswer(e),e):null})).filter((function(e){return!!e}));var n=this.getResponseModelById(e.Id);return n&&(Object(W.c)(n).updateWithNormalizedResponse(e),e=n),e},t.prototype.postFormGradingChange=function(e){if(u.a.IsAssignmentsIntegration&&u.a.IsAssignmentsPage&&this.IsAssignmentForm&&Object(I.a)().Flighting.isEnabled("AssignmentsIFrameLimitParentHeaders")){var t=o.reduce(e.Answers,(function(e,t){return e+(t.Score||0)}),0);window.parent.postMessage({eventName:"FormGradingChangePerformed",responseId:e.Id,responder:e.Responder,responseScore:t,feedback:e.Feedback,isReturned:"0001-01-01T00:00:00Z"!==e.ReleaseDateAsString},"*")}},t.prototype.logTextFieldSubmissionMathInfo=function(e){var t=this,r={QuestionCount:0,GradableQuestionCount:0,MathResponses:0,MathGradableResponses:0,TextResponses:0,TextGradableResponses:0,EmptyResponses:0,TotalLength:0};o.forEach(e.Answers,(function(e){var n=t.getQuestionById(e.QuestionId);if(n&&n.Model&&n.Model.Type===te.a.TextField&&n.Model.IsMathQuiz){n.hasCorrectAnswers()?r.GradableQuestionCount++:r.QuestionCount++;var o=b.I(e.Answer);null!=o&&o.Answer?(r.TotalLength+=o.Answer.length,n.hasCorrectAnswers()?o.IsMath?r.MathGradableResponses++:r.TextGradableResponses++:o.IsMath?r.MathResponses++:r.TextResponses++):r.EmptyResponses++}})),F.a.logData({name:"ResponsePage.Form.TextFieldSubmissionMathInfo",extraData:r})},t}(i.a.createObjectMasterClass("FormMaster",ue,(function(e,t){return e.SyncBlocker.then((function(){return new C.a(e,t)}))})));FormsPro.FormMaster=ye},function(e,t,r){"use strict";r.d(t,"a",(function(){return h})),r.d(t,"d",(function(){return g})),r.d(t,"c",(function(){return b})),r.d(t,"b",(function(){return v}));var n=r(3),o=r(11),i=r(24),a=r(47),s=r(135),c=r(27),u=r(67),l=r(7),d=r(40),f=r(171),p={engagement_event:S,error_event:S,formspro_event:S,nav_perf_event:function(e){var t=S(e);e.extraData&&(!function(e){if(I){var t=0;"hidden"===I.initialVisibility?t=I.initializeTime.getTime():I.visiToggleTime&&(t=I.visiToggleTime.getTime());e.extraData.VisiToggled=t,I.stop(),I=null}}(e),t.properties=JSON.stringify(e.extraData));return t},qos_event:function(e){var t={duration:e.duration,eventCorrelationId:e.correlationId,eventName:(e.eventName||m[e.eventType]).replace(" ",""),eventType:e.eventType,properties:"",timeStamp:a.a.getTimeStamp()};e.extraData&&(t.properties=JSON.stringify(e.extraData));return t},session_start:function(e){return e.extraData={DbId:"",DeviceId:""},S(e)}},m={engagement_event:"no_EngagementName",error_event:"no_ErrorName",formspro_event:"formspro_event",nav_perf_event:"no_NavPerfName",qos_event:"no_QosName",session_start:"session_start"};function h(e){y(e,!1)}function g(e){y(e,!0)}function y(e,t){var r,o=p[e.eventType];o?r=o(e):r=S({eventName:"no_ErrorName",eventType:"error_event",extraData:{initData:e,message:"Unsupported event"}});d.a.logData(n.extend(r,{withoutUserInfo:t}))}function b(e){e.eventInfo.timeStamp=Date.now()-60*(new Date).getTimezoneOffset()*1e3,Object(l.e)((function(){e.eventInfo.Geo=o.a.getFormsProGeo()}));var t={eventName:e.type,eventType:"formspro_event",extraData:e.eventInfo};d.a.logData(S(t))}function v(e){i.a.IsTeamsIntegration&&(e?Object(u.a)(e)?microsoftTeams.appInitialization.notifySuccess():microsoftTeams.appInitialization.notifyFailure({message:Object(s.a)(e),reason:"Other"}):microsoftTeams.appInitialization.notifySuccess())}function S(e){var t={duration:0,eventCorrelationId:e.correlationId||c.a.newGuid(),eventName:(e.eventName||m[e.eventType]).replace(" ",""),eventType:e.eventType,properties:"",timeStamp:a.a.getTimeStamp()};return e.extraData&&(t.properties=JSON.stringify(e.extraData)),t}var I=new f.a},function(e,t,r){"use strict";var n=r(3),o=r(4),i=r(18),a=r(1),s=r(134),c=r(43),u=r(64),l=r(6),d=r(34),f=r(93),p=r(55),m=r(30),h=r(42),g=r(81),y=r(82),b=r(38),v=r(104),S=r(144),I=r(16),M=r(7),F=r(23),O=r(8),C=function(){function e(e,t){this.question=e,this.dataProvider=F.a.getDataProviderByFormMaster(this.question.Form)}return Object.defineProperty(e.prototype,"FormId",{get:function(){return this.question.Form.Model.Id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"QuestionId",{get:function(){return this.question.Model.Id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"QuestionType",{get:function(){return this.question.Model.Type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ExtraQosData",{get:function(){var e=this.question.Form;return{WithSection:e.isFieldReady(e.Schema.DescriptiveElements)&&e.hasSection()}},enumerable:!0,configurable:!0}),e.prototype.add=function(e){var t=this;if(this.question.Form.SyncContext===O.e.DesignTimeForm){var r=this.question.ParentQuestionMaster;return r?r.Synchronizer.existingInDataSource().then((function(){return t.addInternally(e)})):this.addInternally(e)}Object(i.c)("Trying to create a question without design type.")},e.prototype.delete=function(e){var t=this;this.question.Form.SyncContext!==O.e.DesignTimeForm&&Object(i.c)("Trying to delete a question without design type.");var r=this.question.ParentQuestionMaster;if(r&&r.Deleted)return $.Deferred().resolve().promise();var n=this.question.SubQuestionMasters.map((function(e){return e.Synchronizer.flush()}));return $.when.apply($,n).then((function(){return t.question.createSyncJob((function(){return t.dataProvider.deleteFormQuestion(t.FormId,e.id,t.QuestionType,t.ExtraQosData)}))})).then(null,(function(e){return e&&e.innerCode===I.b.CDBColumnNotFound?$.Deferred().resolve().promise():e}))},e.prototype.query=function(e){Object(i.c)("No scenario to call this method currently.")},e.prototype.update=function(e,t){var r=this;if(Object(M.e)((function(){return!0}))&&this.question.Form.IsSampleForm)return $.Deferred().resolve().promise();if(this.question.Form.SyncContext!==O.e.DesignTimeForm)return $.Deferred().resolve().promise();if("id"in e){var n=e.id,o=t.ValuesBefore.id;d.a.logData({errorName:"DataSourceUpdatingQuestionId",errorInfo:{newId:n,oldId:o}})}if(null===e.allowMultipleValues)try{throw Error("allowMultipleValues null error")}catch(e){d.a.logData({errorName:"DataSourceUpdatingQuestionNullAllowMultipleValues",errorInfo:{stack:e.stack}})}return this.question.createUploadSyncJob((function(){return r.dataProvider.updateFormQuestion(r.FormId,r.QuestionId,r.QuestionType,e,r.ExtraQosData)}))},e.prototype.addInternally=function(e){var t=this,r=this.question.createSyncJob((function(){return t.dataProvider.createFormQuestion(t.FormId,e,t.ExtraQosData)})).then((function(e){var t=e;return t.FileUploadSPOInfo&&(e.fileUploadSPOInfo={driveId:t.FileUploadSPOInfo.DriveId,errorCode:t.FileUploadSPOInfo.ErrorCode,folderId:t.FileUploadSPOInfo.FolderId}),e}));return r.done((function(e){"id"in e&&e.id!==t.QuestionId&&d.a.logData({errorName:"ChangedIdFromServerSide",errorInfo:{newId:e.id,oldId:t.QuestionId,formId:t.FormId}})})),r},e}(),P=r(15);r.d(t,"g",(function(){return w})),r.d(t,"b",(function(){return _})),r.d(t,"a",(function(){return E})),r.d(t,"f",(function(){return R})),r.d(t,"e",(function(){return D})),r.d(t,"c",(function(){return A})),r.d(t,"h",(function(){return k})),r.d(t,"d",(function(){return x}));var T,w,_,E,R,D,A,L=(T=function(e,t){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}T(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),N={Id:a.a.string({IsKeyField:!0,SourceFieldName:"id"}),DefaultValue:a.a.reference({SourceFieldName:"defaultValue"}),ImageInfo:a.a.fromMasterClass((function(){return m.b}),{SourceFieldName:"image"}),ImageSettings:a.a.fromMasterClass((function(){return h.b}),{IsLocalField:!0}),Order:a.a.number({SourceFieldName:"order"}),QuestionInfo:a.a.string({SourceFieldName:"questionInfo"}),Required:a.a.boolean({SourceFieldName:"required"}),Subtitle:a.a.string({SourceFieldName:"subtitle"}),CombinedTitle:a.a.string({SourceFieldName:"title"}),Type:a.a.reference({SourceFieldName:"type"}),GroupId:a.a.string({SourceFieldName:"groupId"}),ShowSubtitle:a.a.boolean({IsLocalField:!0}),Hidden:a.a.boolean({IsLocalField:!0}),FormsProRTQuestionTitle:a.a.string({SourceFieldName:"formsProRTQuestionTitle"}),FormsProCalculateSentiment:a.a.boolean({IsLocalField:!0}),FormsProRTSubtitle:a.a.string({SourceFieldName:"formsProRTSubtitle"}),FormsProEnableAnswerTag:a.a.boolean({IsLocalField:!0}),FormsProAnswerTag:a.a.string({IsLocalField:!0}),FormsProAnswerTagHasError:a.a.boolean({IsLocalField:!0}),Title:a.a.string({IsLocalField:!0}),BranchInfo:a.a.fromMasterClass((function(){return f.a}),{IsLocalField:!0}),IntegratedSavingState:a.a.reference({IsLocalField:!0}),SavingState:a.a.reference({IsLocalField:!0}),IsQuiz:a.a.boolean({SourceFieldName:"isQuiz"}),GradingBasis:a.a.string({IsLocalField:!0}),Point:a.a.number({IsLocalField:!0}),ChoiceType:a.a.reference({IsLocalField:!0}),Choices:a.a.collectionOf({Description:a.a.string(),BranchInfo:a.a.fromMasterClass((function(){return f.a})),IsAnswerKey:a.a.boolean(),AnswerHint:a.a.string(),IsGenerated:a.a.boolean(),IsMathOption:a.a.boolean(),FormsProDisplayRTText:a.a.string()},{IsLocalField:!0}),Hint:a.a.string({IsLocalField:!0}),AllowMultipleValues:a.a.boolean({SourceFieldName:"allowMultipleValues"}),AllowOtherAnswer:a.a.boolean({IsLocalField:!0}),OptionDisplayStyle:a.a.enumeration((function(){return A}),{IsLocalField:!0}),ShuffleOptions:a.a.boolean({IsLocalField:!0}),BranchInfoForOtherChoice:a.a.fromMasterClass((function(){return f.a}),{IsLocalField:!0}),ChoiceGroup:a.a.collectionOf((function(){return v.a}),{SourceFieldName:"choices"}),Length:a.a.number({IsLocalField:!0}),RatingShape:a.a.enumeration((function(){return R}),{IsLocalField:!0}),LeftDescription:a.a.string({IsLocalField:!0}),RightDescription:a.a.string({IsLocalField:!0}),FormsProRTLeftDescription:a.a.string({IsLocalField:!0}),FormsProRTRightDescription:a.a.string({IsLocalField:!0}),ShowRatingLabel:a.a.boolean({IsLocalField:!0}),MinRating:a.a.number({IsLocalField:!0}),Multiline:a.a.boolean({IsLocalField:!0}),IsNumber:a.a.boolean({IsLocalField:!0}),HasTFRestrictionForPro:a.a.boolean({IsLocalField:!0}),Placeholder:a.a.string({IsLocalField:!0}),NumberValidationRule:a.a.enumeration((function(){return _}),{IsLocalField:!0}),FormsProValidationType:a.a.enumeration((function(){return w}),{IsLocalField:!0}),NumberMinBoundary:a.a.string({IsLocalField:!0}),NumberMaxBoundary:a.a.string({IsLocalField:!0}),FormsProCustomRegEx:a.a.string({IsLocalField:!0}),FormsProCustomPlaceholder:a.a.string({IsLocalField:!0}),Date:a.a.boolean({IsLocalField:!0}),Time:a.a.boolean({IsLocalField:!0}),FileUploadSPOInfo:a.a.create({driveId:a.a.string(),folderId:a.a.string(),errorCode:a.a.string()},{SourceFieldName:"fileUploadSPOInfo"}),FileTypes:a.a.create({Word:a.a.boolean(),Excel:a.a.boolean(),PowerPoint:a.a.boolean(),PDF:a.a.boolean(),Image:a.a.boolean(),Video:a.a.boolean(),Audio:a.a.boolean()},{IsLocalField:!0}),MaxFileCount:a.a.number({IsLocalField:!0}),MaxFileSize:a.a.number({IsLocalField:!0}),HasSpecificFileType:a.a.boolean({IsLocalField:!0}),CoAuthors:a.a.collectionOf(a.a.reference(),{IsLocalField:!0}),IsMathQuiz:a.a.boolean({IsLocalField:!0}),IsPlainTextInMathField:a.a.boolean({IsLocalField:!0}),IsAnswerPlainText:a.a.boolean({IsLocalField:!0}),IsMathInputDefault:a.a.boolean({IsLocalField:!0}),InputSwitcherDisabled:a.a.boolean({IsLocalField:!0}),MathPatterns:a.a.collectionOf(a.a.string(),{IsLocalField:!0}),MathAriaLabels:a.a.collectionOf(a.a.string(),{IsLocalField:!0}),LastMathMLFormula:a.a.string({IsLocalField:!0}),VideoInfo:a.a.create({Url:a.a.string(),Title:a.a.string(),Author:a.a.string(),Thumbnail_url:a.a.string(),OriginalWidth:a.a.number(),OriginalHeight:a.a.number(),ShowWarningBar:a.a.boolean()},{IsLocalField:!0}),TrackingId:a.a.string({SourceFieldName:"trackingId"}),QuestionTagForIntelligence:a.a.string({SourceFieldName:"questionTagForIntelligence"}),IsFromSuggestion:a.a.boolean({SourceFieldName:"isFromSuggestion"})};!function(e){e[e.Number=0]="Number",e[e.Email=1]="Email",e[e.Custom=2]="Custom"}(w||(w={})),function(e){e[e.None=0]="None",e[e.Greater=1]="Greater",e[e.GreaterOrEqual=2]="GreaterOrEqual",e[e.Less=3]="Less",e[e.LessOrEqual=4]="LessOrEqual",e[e.Equal=5]="Equal",e[e.NotEqual=6]="NotEqual",e[e.Between=7]="Between",e[e.NotBetween=8]="NotBetween",e[e.Max=9]="Max"}(_||(_={})),function(e){e[e.SingleChoice=1]="SingleChoice",e[e.MultiChoice=2]="MultiChoice"}(E||(E={})),function(e){e[e.Number=0]="Number",e[e.Star=1]="Star",e[e.Smiley=2]="Smiley"}(R||(R={})),function(e){e[e.Success=0]="Success",e[e.RequiredError=1]="RequiredError",e[e.NumberValidationError=2]="NumberValidationError",e[e.QuizWrongChoiceError=3]="QuizWrongChoiceError",e[e.MathLengthError=4]="MathLengthError",e[e.MultiChoiceQuestionLengthLimitError=5]="MultiChoiceQuestionLengthLimitError",e[e.RegExValidationError=6]="RegExValidationError"}(D||(D={})),function(e){e[e.Dropdown=0]="Dropdown",e[e.ListAll=1]="ListAll"}(A||(A={}));N.Choices[0],N.ChoiceGroup[0];function k(e){return o.a.getObjectMasterFromModel(e)}var x=function(e){function t(r){var a=this,s=$.Deferred();return r.InitialData?(t.resolveQuestionNullTypeIssue(r.InitialData),(r=n.clone(r)).InitialData=n.clone(r.InitialData),void 0!==r.InitialData.CombinedTitle?t.updateTitleWithCombinedTitle(r.InitialData):t.updateCombinedTitle(r.InitialData)):Object(i.c)("Question model should created with initial data."),(a=e.call(this,r,{MasterReady:s.promise(),Scheduler:new p.a})||this).fieldsReady([t.Schema.ChoiceGroup]).done((function(){o.a.Collection.setComparer(a.Model.ChoiceGroup,(function(e,t){return e.Order-t.Order}))})),Object(b.b)(a),a.updateIntegratedSavingState(),a.initializeQuestionInfoBinder(r),Object(h.d)(a,t.Schema.ImageInfo,t.Schema.ImageSettings),a.initializeQuestionFileUploadSPOInfo(r),t.Rules.forEach((function(e){return a.addRule(e)})),a.redressGradingBasis(),a.coAuthorTimers={},s.resolve(),a}return L(t,e),Object.defineProperty(t.prototype,"Form",{get:function(){return this.Parent.Parent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ImageInfoMaster",{get:function(){return Object(m.d)(this.Model.ImageInfo)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ImageSettingsMaster",{get:function(){return Object(h.e)(this.Model.ImageSettings)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ParentQuestionMaster",{get:function(){if(!this.isFieldReady(this.Schema.GroupId))return null;var e=this.Model.GroupId;return e&&this.Form.getQuestionById(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SubQuestionMasters",{get:function(){var e=this;return this.Form.FormElementManager.QuestionMasters.filter((function(t){return t.Model.GroupId===e.Model.Id}))},enumerable:!0,configurable:!0}),t.prototype.isFieldReady=function(r){return r=t.getSourceFields([r])[0],e.prototype.isFieldReady.call(this,r)},t.prototype.ensureFieldsReady=function(r){return e.prototype.ensureFieldsReady.call(this,t.getSourceFields(r))},t.prototype.fieldsReady=function(r){return e.prototype.fieldsReady.call(this,t.getSourceFields(r))},t.prototype.ensureCreationDone=function(){var e=this;return this.ImageInfoMaster.Synchronizer.flush().then((function(){return e.Synchronizer.flush()}))},t.prototype.setVideoUrl=function(e,t){var r=this.Model.VideoInfo;o.a.getObjectMasterFromModel(r).bulkEdit((function(){r.Url=u.a.generateEmbedURLLocally(e),r.Title="",r.Author="",r.Thumbnail_url="",r.OriginalWidth=459,r.OriginalHeight=256,r.ShowWarningBar=t&&u.a.isStreamUrl(e)}))},t.prototype.hasValidVideoUrl=function(){return Object(l.a)().Flighting.isEnabled("SupportStreamVideo")?this.videoUrlExist()&&u.a.isValidVideoUrl(this.Model.VideoInfo.Url):this.videoUrlExist()&&u.a.isYouTubeUrl(this.Model.VideoInfo.Url)},t.prototype.clearVideoInfo=function(){this.Model.VideoInfo={}},t.prototype.isSubQuestion=function(){return!!this.Model.GroupId},t.prototype.addSubQuestion=function(e){e.GroupId=this.Model.Id,e.Required=this.Model.Required,this.Form.FormElementManager.insertElementAfter(e,this)},t.prototype.deleteSubQuestion=function(e){this.Form.getQuestionById(e).Deleted=!0},t.prototype.createSyncJob=function(e){var t=this,r=$.Deferred(),n=$.when(r).then((function(){return t.Form.getQuestionSyncBlocker(n)})).then(e);return r.resolve(),n},t.prototype.createUploadSyncJob=function(e){var t=this,r=$.Deferred(),n=$.when(r,this.uploadJob).then((function(){return t.createSyncJob(e)}));return r.resolve(),this.uploadJob=c.a.always(n),n},t.prototype.getMethodDelegator=function(){var e=this.Model.Type;this.delegators=this.delegators||(this.delegators={});var t=this.delegators[e];t||(t=new(Object(S.a)(e))(this),this.delegators[e]=t);return t},t.prototype.getChoiceById=function(e){var t=o.a.Collection.getItemWithKeyFields(this.Model.ChoiceGroup,{Id:e});return t&&o.a.getObjectMasterFromModel(t)},t.prototype.getChoiceByKey=function(e){var t=n.find(this.Model.ChoiceGroup,(function(t){return t.Key===e}));return t&&Object(v.b)(t)},t.prototype.updateCoAuthors=function(e){var t=this,r=n.filter(this.Model.CoAuthors,(function(t){return e.userId===t.userId}))[0],i=function(){r&&a.deleteItems([r]),e.userId in t.coAuthorTimers&&(clearTimeout(t.coAuthorTimers[e.userId]),delete t.coAuthorTimers[e.userId])},a=o.a.getCollectionMasterFromModel(this.Model.CoAuthors);a.bulkEdit((function(){i(),r=o.a.Collection.addItems(t.Model.CoAuthors,[e])[0]})),this.coAuthorTimers[e.userId]=window.setTimeout(i,1e4)},t.prototype.initializeQuestionInfoBinder=function(e){this.questionInfoBinder=new g.a(this,t.Schema.QuestionInfo,t.QuestionInfoFieldSet),e.InitialData&&this.isFieldReady(t.Schema.QuestionInfo)&&(e.ExistingInDataSource||e.InitialData.QuestionInfo?this.questionInfoBinder.deserialize():this.questionInfoBinder.serialize()),this.justifyQuestionInfo()},t.prototype.initializeQuestionFileUploadSPOInfo=function(e){!e.ExistingInDataSource&&e.InitialData.FileUploadSPOInfo&&(this.Model.FileUploadSPOInfo=null)},t.prototype.updateIntegratedSavingState=function(){this.isFieldReady(t.Schema.ImageInfo)?this.Model.IntegratedSavingState=Object(b.a)([this.Model.ImageInfo.SavingState,this.Model.SavingState]):this.Model.IntegratedSavingState=this.Model.SavingState},t.prototype.hasValidBranching=function(){var e=this.Model;return n.map(e.Choices,(function(e){return e.BranchInfo})).concat([e.BranchInfo,e.BranchInfoForOtherChoice]).map(o.a.getObjectMasterFromModel).some((function(e){return e.IsValid}))},t.prototype.hasSectionBranching=function(){var e=this.Model;return n.map(e.Choices,(function(e){return e.BranchInfo})).concat([e.BranchInfo,e.BranchInfoForOtherChoice]).map(o.a.getObjectMasterFromModel).some((function(e){return e.hasSectionBranching()}))},t.prototype.videoUrlExist=function(){return this.Model.VideoInfo&&this.Model.VideoInfo.Url},Object.defineProperty(t,"QuestionInfoFieldSet",{get:function(){return t.questionInfoFieldSet||(t.questionInfoFieldSet=new y.a([t.Schema.VideoInfo,t.Schema.ShowSubtitle,t.Schema.Hidden,t.Schema.BranchInfo,t.Schema.ShowRatingLabel,t.Schema.Point,t.Schema.FormsProCalculateSentiment,t.Schema.ImageSettings,t.Schema.GradingBasis,t.Schema.ChoiceType,t.Schema.Choices,t.Schema.Hint,t.Schema.AllowOtherAnswer,t.Schema.OptionDisplayStyle,t.Schema.ShuffleOptions,t.Schema.BranchInfoForOtherChoice,t.Schema.Length,t.Schema.RatingShape,t.Schema.LeftDescription,t.Schema.RightDescription,t.Schema.Multiline,t.Schema.IsNumber,t.Schema.Placeholder,t.Schema.NumberValidationRule,t.Schema.NumberMinBoundary,t.Schema.NumberMaxBoundary,t.Schema.Date,t.Schema.Time,t.Schema.IsMathQuiz,t.Schema.IsPlainTextInMathField,t.Schema.IsAnswerPlainText,t.Schema.InputSwitcherDisabled,t.Schema.IsMathInputDefault,t.Schema.MathPatterns,t.Schema.MathAriaLabels,t.Schema.HasSpecificFileType,t.Schema.FileTypes,t.Schema.MaxFileCount,t.Schema.MaxFileSize,t.Schema.MinRating,t.Schema.FormsProRTLeftDescription,t.Schema.FormsProRTRightDescription,t.Schema.FormsProEnableAnswerTag,t.Schema.FormsProAnswerTag,t.Schema.FormsProAnswerTagHasError,t.Schema.HasTFRestrictionForPro,t.Schema.FormsProValidationType,t.Schema.FormsProCustomRegEx,t.Schema.FormsProCustomPlaceholder])),t.questionInfoFieldSet},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Rules",{get:function(){if(!t.rules){var e=t.Schema;t.rules=[{Name:"block id changes",InterestedFields:[e.Id],onChange:function(e){var t,r=e.Master.Model,n=r.Id,o=e.OldValues.Id;r.Id=o;try{throw Error("Changing question id")}catch(e){t=e}d.a.logData({errorName:"UpdatingQuestionId",errorInfo:{newId:n,oldId:o,stack:t.stack}})}},{Name:"null type resolver",InterestedFields:[e.Type],onChange:function(e){return t.resolveQuestionNullTypeIssue(e.Master.Model)}},{Name:"update CombinedTitle",InterestedFields:[e.Title,e.IsMathQuiz,e.Subtitle],onChange:function(e){return t.updateCombinedTitle(e.Master.Model)}},{Name:"update Title",InterestedFields:[e.CombinedTitle],onChange:function(e){return t.updateTitleWithCombinedTitle(e.Master.Model)}},{Name:"IntegrateSavingState",InterestedFields:[e.ImageInfo.SavingState,e.SavingState],onChange:function(e){return e.Master.updateIntegratedSavingState()}},{Name:"IsQuiz",InterestedFields:[e.IsQuiz],onChange:function(e){var t=e.Master.Model;t.IsQuiz||(t.IsMathQuiz=null,o.a.convertToArray(t.Choices).forEach((function(e){e.IsAnswerKey=null})))}},{Name:"IsMathQuiz",InterestedFields:[e.IsMathQuiz],onChange:function(e){var t=e.Master.Model;t.IsMathQuiz||(t.IsMathQuiz=null,t.MathPatterns=null,t.MathAriaLabels=null,t.IsPlainTextInMathField=null,t.IsMathInputDefault=null,t.InputSwitcherDisabled=null,t.LastMathMLFormula=null)}},{Name:"NumberValidationRule",InterestedFields:[e.IsNumber],onChange:function(e){var t=e.Master.Model;t.IsNumber?null==t.NumberValidationRule&&(t.NumberValidationRule=_.None):(t.NumberValidationRule=null,FormsPro.proOnly((function(){t.FormsProValidationType=null})))}},{Name:"JustifyNumberBoundaries",InterestedFields:[e.NumberValidationRule],onChange:function(e){return e.Master.justifyNumberBoundaries()}}]}return t.rules},enumerable:!0,configurable:!0}),t.resolveQuestionNullTypeIssue=function(e){if(!e.Type){var t={choiceType:e.ChoiceType,date:e.Date,time:e.Time,ratingShape:e.RatingShape,multiline:e.Multiline};e.Type=null!=t.choiceType?P.a.Choice:null!=t.date||null!=t.time?P.a.DateTime:t.ratingShape?P.a.Rating:P.a.TextField,d.a.logData({errorName:"QuestionNullTypeError",errorInfo:{message:"question type resolved",conditions:t,resolvedType:e.Type}})}},t.updateCombinedTitle=function(e){if(e.IsMathQuiz&&e.Subtitle){var t=e.Title||"";e.CombinedTitle=t+s.a.mathSeparator+e.Subtitle}else e.CombinedTitle=e.Title},t.updateTitleWithCombinedTitle=function(e){var t=e.CombinedTitle;t&&(t=t.split(s.a.mathSeparator)[0]),e.Title=t},t.getSourceFields=function(e){return n.uniq(e.map((function(e){return t.QuestionInfoFieldSet.covers(e)?t.Schema.QuestionInfo:e})))},t}(o.a.createObjectMasterClass("QuestionMaster",N,(function(e,t){return new C(e,t)})));Object.keys({verify:null,isEmpty:null,getTypeDisplayName:null,getBranchedResult:null,isNumberType:null,resetBranchInfo:null,getNormalizedAnswer:null,hasAnswer:null,justifyNumberBoundaries:null,getNumberValidationErrorMessage:null,getValidationErrorMessage:null,supportsQuestionLevelBranching:null,supportsChoiceLevelBranching:null,getSnapshotWithoutBranchInfo:null,insertChoice:null,setAnswerKey:null,createQuizResult:null,autoGradeAnswer:null,autoGradeWithQuizResult:null,serializeAnswer:null,deserializeAnswer:null,justifyQuestionInfo:null,showAsDropdown:null,hasCorrectAnswers:null,isCorrectAnswer:null,redressGradingBasis:null}).forEach((function(e){x.prototype[e]=function(){var t=this.getMethodDelegator();return t[e].apply(t,arguments)}}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(69),o=r(5),i=r(65),a=function(){function e(){}return e.getEnvironmentType=function(){if(null==e.currentEnvironmentType){var t=e.getHostUrl(),r=OfficeFormServerInfo.deployment.toLocaleLowerCase();r.indexOf("usgovdodproduction")>=0?e.currentEnvironmentType="USDoDProd":r.indexOf("usgovproduction")>=0?e.currentEnvironmentType="USGovProd":r.indexOf("usgovgccproduction")>=0?e.currentEnvironmentType="USGovGccProd":(t.indexOf("forms.office.com")>=0||t.indexOf("forms.osi.office.net")>=0)&&-1==t.indexOf("tip.forms.office.com")?e.currentEnvironmentType="WWProd":t.indexOf("forms.microsoft.com")>=0?e.currentEnvironmentType="MSProd":t.indexOf("forms.office-int.com")>=0||t.indexOf("forms.osi.office-int.net")>=0?e.currentEnvironmentType="Int":t.indexOf("formweekly")>=0?e.currentEnvironmentType="Weekly":t.indexOf("formhotfix")>=0?e.currentEnvironmentType="Hotfix":t.indexOf("formdaily")>=0?e.currentEnvironmentType="Daily":t.indexOf("formpilot")>=0?e.currentEnvironmentType="Pilot":t.indexOf("formtrial")>=0?e.currentEnvironmentType="Trial":t.indexOf("formdrill")>=0?e.currentEnvironmentType="Drill":t.indexOf("localhost")>=0?e.currentEnvironmentType="DevHost":t.indexOf("forms.microsoft-int.com")>=0?e.currentEnvironmentType="MSInt":t.indexOf("formspro-test-staging")>=0?e.currentEnvironmentType="ProDaily":t.indexOf("tip.forms.office.com")>=0&&(e.currentEnvironmentType="ProTip")}return e.currentEnvironmentType},e.isTip=function(){var t=e.getHostUrl();return t.indexOf("sea-000.forms.osi.office.net")>=0||t.indexOf("tip.forms.office.com")>=0},e.isFormsPro=function(){return!!e.getUrlPath().startsWith("/formspro")},e.getMuidHost=function(){switch(e.getEnvironmentType()){case"WWProd":return"https://c.office.com";case"MSProd":return"https://c1.microsoft.com";case"Int":return"https://c.office-int.com";case"MSInt":default:return null}},e.getPageType=function(){var e=window.location.pathname.toLowerCase();switch(this.isFormsPro()&&(e=e.substring("/formspro".length)),e){case"/pages/designpage.aspx":case"/pages/teamsdesignpage.aspx":case"/pages/onenoteaddinpage.aspx":case"/pages/delegatepage.aspx":return"Design";case"/pages/responsepage.aspx":case"/pages/teamsresponsepage.aspx":return"Response";case"/pages/analysispage.aspx":return"Analyze";case"/pages/teamsconfigpage.aspx":return"TeamsConfig";case"/pages/shareformpage.aspx":return"ShareForm";case"/adminsettings.aspx":return"AdminSettings";case"/pages/responsepreviewpage.aspx":return"ResponsePreviewPage";case"/pages/adminphishingreviewpage.aspx":return"AdminPhishingReviewPage";default:return"Unknown"}},e.isProdAlternative=function(){return e.getHostUrl().indexOf(".forms.osi.office.net")>0},e.isProduction=function(){var t=e.getEnvironmentType();return"WWProd"===t||"MSProd"===t||"USGovProd"===t||"USDoDProd"===t||"USGovGccProd"===t},e.isSovereignProd=function(){var t=e.getEnvironmentType();return"USGovProd"===t||"USDoDProd"===t||"USGovGccProd"===t},e.isFairfax=function(){var t=e.getEnvironmentType();return"USGovProd"===t||"USDoDProd"===t},e.isUSGovGccProd=function(){return"USGovGccProd"===e.getEnvironmentType()},e.isMsftProduction=function(){return"72f988bf-86f1-41af-91ab-2d7cd011db47"===OfficeFormServerInfo.userInfo.TenantId},e.isOsi=function(){switch(e.getEnvironmentType()){case"Int":case"WWProd":case"MSInt":case"MSProd":case"USGovProd":case"USDoDProd":case"USGovGccProd":case"ProTip":return!0;default:return!1}},e.isMobile=function(){switch(window.location.pathname.toLowerCase()){case"/pages/mobiledesignpage.aspx":return!0;default:return!1}},e.getAadInstance=function(){var t=i.a.UseLegacyLoginDomain;return e.isProduction()?t?"https://login.windows.net/":"https://login.microsoftonline.com/":"https://login.windows-ppe.net/"},e.getMSGraphAPIHost=function(){return FormsPro.baseProAdapter((function(){return e.isProduction()?"https://graph.microsoft.com/":"https://graph.microsoft-ppe.com"}),(function(){return e.isProduction()?"https://graph.microsoft.com/beta":"https://graph.microsoft-ppe.com/beta"}))},e.getFormsProUIHost=function(){return n.b.getSetting(FormsPro.WebSettingKeys.FormsProUIHost)},e.getFormsProGeo=function(){return n.b.getSetting(FormsPro.WebSettingKeys.FormsProGeo)},e.getFormsHomeUrl=function(){return n.b.getSetting(FormsPro.WebSettingKeys.FormsHomeUrl)},e.getFormsProApiFacadeHost=function(){return n.b.getSetting(FormsPro.WebSettingKeys.ApiFacadeEndPoint)},e.getFormsProCSATHost=function(){return n.b.getSetting(FormsPro.WebSettingKeys.FormsProCSATEndpoint)},e.getFormsProCSATTenant=function(){return n.b.getSetting(FormsPro.WebSettingKeys.FormsProCSATTenant)},e.getFormsProResponseLimit=function(){return n.b.getSetting(FormsPro.WebSettingKeys.FormsProResponseLimit)},e.getFormsProSampleFormTenantId=function(){return n.b.getSetting(FormsPro.WebSettingKeys.FormsProSampleFormTenantId)},e.getFormsProCdnHomeUrl=function(){return n.b.getSetting(FormsPro.WebSettingKeys.FormsProCdnHomeUrl)},e.getAadClientId=function(){return"USGovProd"===e.getEnvironmentType()||"USDoDProd"===e.getEnvironmentType()?"032e56fd-dfe5-4a50-8017-89692bcbcb0e":"038ed4f5-da78-47bc-8176-9153c79e0edb"},e.getFormsResourceId=function(){return"USGovProd"===e.getEnvironmentType()||"USDoDProd"===e.getEnvironmentType()?"153a74ba-783f-4394-bc9a-a109ef69f5c2":"c9a559d2-7aab-4f13-a6ed-e7e9c52aec87"},e.getUserInfoUrl=function(){return"https://portal.{0}/account/#personalinfo".format(e.isProduction()?e.getOffice365Domain(e.getEnvironmentType(),!0):e.getOffice365Domain("Int",!0))},e.getConsumerInfoUrl=function(){return"https://account.{0}".format(e.isProduction()?e.getOffice365ConsumerDomain(e.getEnvironmentType()):e.getOffice365ConsumerDomain("Trial"))},e.getHrdV2Url=function(){var t=e.getExplictLocale()||OfficeFormServerInfo.cultureInfo.Name;return"https://{0}/odc/v2.1/hrd?{1}Ver=16&app=111&p=6&hm=0&fpEnabled=1".format(e.getHrdV2Domain(),null!=t?"rs={0}&".format(t):"")},e.getHrdV2Domain=function(){return e.isProduction()?"odc.officeapps.live.com":"odc.edog.officeapps.live.com"},e.getCollabDBResourceId=function(t){return"lists."+e.getOffice365Domain(t)},e.getMsftTenantId=function(){switch(e.getEnvironmentType()){case"WWProd":case"MSProd":return"72f988bf-86f1-41af-91ab-2d7cd011db47";default:return"f686d426-8d16-42db-81b7-ab578e110ccd"}},e.getMsaTenantId=function(){switch(e.getEnvironmentType()){case"WWProd":case"MSProd":return"9188040d-6c67-4c5b-b112-36a304b66dad";default:return"4925308c-f164-4d2d-bc7e-0631132e9375"}},e.getFastFoodTenantsId=function(){switch(e.getEnvironmentType()){case"WWProd":case"MSProd":return["89d8a01e-e5db-493e-8720-b820d953ef20","b6338c92-533e-4f6d-a327-994263712399"];default:return["f686d426-8d16-42db-81b7-ab578e110ccd"]}},e.getExplictLocale=function(){return o.a.getQueries().lang||null},e.getMultilingualDisplayParam=function(){return o.a.getQueries().showmultilingual||null},e.getCustomCssOriginalHeaderParam=function(){var e=o.a.getQueries().showoriginalheader;return e&&"true"===e},e.getEnvironmentTypeForNonOSI=function(){return"Int"},e.getFormsProLicensingServiceHost=function(){return n.b.getSetting(FormsPro.WebSettingKeys.FormsProLicensingServiceEndPoint)},e.isMicrosoftDomain=function(){return e.getHostUrl().indexOf("forms.microsoft")>=0},e.getOffice365Domain=function(t,r){switch(void 0===r&&(r=!1),null==t&&(t=e.getEnvironmentType()),t){case"USDoDProd":return r?"apps.mil":"osi.apps.mil";case"USGovProd":return r?"office365.us":"osi.office365.us";case"USGovGccProd":return r?"office.com":"gcc.osi.office365.us";case"WWProd":case"MSProd":case"ProTip":return"office.com";case"Trial":return"officeppe.com";default:return"office-int.com"}},e.getOffice365ConsumerDomain=function(t){switch(null==t&&(t=e.getEnvironmentType()),t){case"WWProd":case"MSProd":return"microsoft.com";case"Trial":return"microsoft-ppe.com";default:return"microsoft-int.com"}},e.getHostUrl=function(){return window.location.host.toLocaleLowerCase()},e.getUrlPath=function(){return window.location.pathname.toLocaleLowerCase()},e.getFormsProUIFacadeHost=function(){return FormsPro.WebSettings.getSetting(FormsPro.WebSettingKeys.UIFacadeEndPoint)},e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n,o=r(0),i=r(20),a=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),s=function(e){function t(t){var r,n,o=e.call(this,t)||this;return o.state={},n=r=o,c.forEach((function(e){var t=n[e];t&&(n[e]=function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];try{return t.apply(r,n)}catch(t){return u(r,e,t),null}})})),o}return a(t,e),t}(o.Component),c=["componentWillMount","componentDidMount","componentWillReceiveProps","shouldComponentUpdate","componentWillUpdate","componentDidUpdate","componentWillUnmount","render"];function u(e,t,r){try{if(r&&r.stack&&console.log(r.stack),window.onerror){var n=i.findDOMNode(e),o=n&&n.getAttribute("data-reactId")||"",a="Exception in "+e.constructor.name+"["+o+"]:"+t;r&&r.message&&(a+=" Message: "+r.message),window.onerror(a,"",0,0,r)}}catch(r){}}},function(e,t,r){"use strict";r.d(t,"b",(function(){return s})),r.d(t,"j",(function(){return c})),r.d(t,"w",(function(){return u})),r.d(t,"n",(function(){return l})),r.d(t,"x",(function(){return d})),r.d(t,"y",(function(){return f})),r.d(t,"g",(function(){return p})),r.d(t,"a",(function(){return m})),r.d(t,"D",(function(){return h})),r.d(t,"q",(function(){return g})),r.d(t,"m",(function(){return y})),r.d(t,"o",(function(){return b})),r.d(t,"p",(function(){return v})),r.d(t,"t",(function(){return S})),r.d(t,"v",(function(){return I})),r.d(t,"u",(function(){return M})),r.d(t,"B",(function(){return F})),r.d(t,"r",(function(){return O})),r.d(t,"A",(function(){return C})),r.d(t,"l",(function(){return P})),r.d(t,"C",(function(){return T})),r.d(t,"s",(function(){return w})),r.d(t,"e",(function(){return _})),r.d(t,"I",(function(){return E})),r.d(t,"h",(function(){return R})),r.d(t,"H",(function(){return D})),r.d(t,"i",(function(){return A})),r.d(t,"c",(function(){return L})),r.d(t,"k",(function(){return N})),r.d(t,"z",(function(){return k})),r.d(t,"E",(function(){return x})),r.d(t,"F",(function(){return j})),r.d(t,"G",(function(){return U})),r.d(t,"f",(function(){return z})),r.d(t,"d",(function(){return B}));var n=r(3),o=r(11),i=r(24),a=r(5);function s(e,t){if(!e&&!o.a.isProduction()&&!o.a.isProdAlternative()){var r=(new Error).stack;console.assert(e,t,r)}}function c(){return n.omit(a.a.getQueries(),"embed","oembedsso","themecolor","preview")}function u(){return!!a.a.getQueries().embed}function l(){var e=a.a.getQueries().compact;return e&&"true"===e.toLowerCase()}function d(){return OfficeFormServerInfo.isOembedSPO}function f(){return!!a.a.getQueries().oembedsso&&!!a.a.getQueries().preview}function p(){return!(!i.a.IsAssignmentsIntegration&&!m())}function m(){return!(!i.a.IsTeamsIntegration||!o.a.isProduction()||"Analyze"===o.a.getPageType())}function h(){return-1!==navigator.userAgent.toLowerCase().search("windows nt 10.")}function g(){var e=navigator.userAgent.toLowerCase();return-1!==e.indexOf("msie")||-1!==e.indexOf("trident/")}function y(){var e=navigator.userAgent.toLowerCase();return-1!==e.indexOf("chrome/")&&-1===e.indexOf("edge/")}function b(){return-1!==navigator.userAgent.toLowerCase().indexOf("edge/")}function v(){return-1!==navigator.userAgent.toLowerCase().indexOf("firefox/")}function S(){return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4))}function I(){return a.a.getWindowWidth()<=640&&S()}function M(){return S()&&a.a.getWindowWidth()<=640}function F(){return $(window).width()<=768}function O(){return/ip(hone|od|ad)/.test(navigator.userAgent.toLowerCase())&&!window.MSStream}function C(){var e=navigator.userAgent.toLowerCase();return-1!==e.indexOf("mac os x")&&-1!==e.indexOf("version/9")&&-1!==e.indexOf("safari")}function P(){return!!navigator.userAgent.match(/android/i)}function T(){return-1!==navigator.userAgent.toLowerCase().indexOf("tbs/")}function w(){return-1!==navigator.userAgent.toLowerCase().indexOf("micromessenger/")}function _(e){var t=n.clone(e);return n.each(t,(function(e,r){n.isObject(e)&&(t[r]=_(e))})),t}function E(e){try{return JSON.parse(e)}catch(t){return e}}function R(e){return n.keys(e).filter($.isNumeric).map((function(t){return e[t]}))}function D(e,t,r){var n=new Date;n.setTime(n.getTime()+r);var o="expires="+n.toUTCString();document.cookie=e+"="+t+"; "+o+"; path=/"}function A(e){e+="=";var t=document.cookie.split(";").filter((function(t){return t.indexOf(e)>=0}));if(t.length>0){var r=t[0].trim();return r.substring(e.length,r.length)}return null}function L(e){D(e,null,(new Date).getTime()-9999)}function N(e){for(var t=0,r=0;r<e.length;r++)t=e.charCodeAt(r)+((t<<5)-t);return t}function k(){return document&&document.body&&"rtl"===document.body.getAttribute("dir")}function x(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}function j(e){var t=new RegExp("\\s+","gi");return e=e.replace(t,"")}function U(){if(I()){var e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",e+"px")}}function z(e){if("function"==typeof CustomEvent)window.setTimeout((function(){return window.dispatchEvent(new CustomEvent(e))}));else{var t=document.createEvent("CustomEvent");t.initEvent(e,!0,!0),document.createElement("element").dispatchEvent(t)}}function B(e){document.execCommand("print",!1,null)||window.print(),"function"==typeof e&&(navigator.userAgent.indexOf("Safari")>-1?setTimeout((function(){e()}),3e3):e())}},function(e,t,r){"use strict";r.d(t,"h",(function(){return i})),r.d(t,"i",(function(){return a})),r.d(t,"j",(function(){return s})),r.d(t,"k",(function(){return c})),r.d(t,"f",(function(){return u})),r.d(t,"e",(function(){return l})),r.d(t,"n",(function(){return d})),r.d(t,"g",(function(){return f})),r.d(t,"m",(function(){return m})),r.d(t,"l",(function(){return g})),r.d(t,"c",(function(){return b})),r.d(t,"d",(function(){return v})),r.d(t,"a",(function(){return S})),r.d(t,"b",(function(){return I}));var n=r(18),o=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n};function i(e,t,r,n){void 0===n&&(n=!0),M(e,t,{configurable:!1,enumerable:!!n,value:r,writable:!1})}function a(e,t,r){M(e,t,{configurable:!0,enumerable:!0,get:function(){var n=r();return delete e[t],i(e,t,n),n},set:function(){throw Error("Setting readonly field: "+t)}})}function s(e,t,r,n){M(e,t,{configurable:!1,enumerable:!0,get:r,set:n=n||function(){throw Error("Setting readonly field: "+t)}})}function c(e,t){var r=e;for(var n in t)r[n]=t[n];return r}function u(e){return c({},e)}function l(e){Object(n.a)(!Array.isArray(e),"array is not currently supported by readonly().");var t={};for(var r in e)i(t,r,e[r]);return t}function d(e,t){Object(n.a)(t in e,"the field named "+t+" not been initialized yet."),i(e,t,e[t])}function f(e){return Array.isArray(e)?e:function(e){return e?Array.prototype.slice.apply(e):[]}(e)}var p=$.Deferred().resolve().promise();function m(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(arguments.length){var n=$.Deferred();return n.resolve.apply(n,o([e],t)),n.promise()}return p}var h=$.Deferred().reject().promise();function g(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(arguments.length){var n=$.Deferred();return n.reject.apply(n,o([e],t)),n.promise()}return h}var y=function(){return m()};function b(e){return e.then(y,y)}function v(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=$.Deferred(),n=e.length,o=[];return e.forEach((function(e,t){return e.done((function(e){return r.resolve(e)})).fail((function(e){o[t]=e,0==--n&&r.reject.apply(r,o)}))})),r.promise()}var S=function(){function e(e,t){void 0===t&&(t=0),this.functionToCall=e,this.timeToWaitInMs=t}return e.prototype.callOnceLater=function(){var e=this;0!==this.timeToWaitInMs&&null!=this.handler&&this.clear(),null==this.handler&&(this.handler=window.setTimeout((function(){e.callImmediately()}),this.timeToWaitInMs))},e.prototype.flush=function(){null!=this.handler&&(this.clear(),this.functionToCall())},e.prototype.callImmediately=function(){null!=this.handler&&this.clear(),this.functionToCall()},e.prototype.clear=function(){clearTimeout(this.handler),this.handler=void 0},e}(),I=function(){function e(e){var t=this,r=$.Deferred();e.then((function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.canceled||r.resolve.apply(r,e)}),(function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.canceled||r.reject.apply(r,e)})),this.cancelablePromise=r.promise()}return e.prototype.promise=function(){return this.cancelablePromise},e.prototype.cancel=function(){this.canceled=!0},e}();function M(e,t,r){try{Object.defineProperty(e,t,r)}catch(e){var o=e&&e.message||"(no message)";Object(n.c)('Failed to set property "'+t+'": '+o)}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){function e(){}return e.Choice="Question.Choice",e.DateTime="Question.DateTime",e.Rating="Question.Rating",e.TextField="Question.TextField",e.Ranking="Question.Ranking",e.MatrixChoiceGroup="Question.MatrixChoiceGroup",e.MatrixChoice="Question.MatrixChoice",e.FileUpload="Question.FileUpload",e.NPS="Question.NPS",e.Section="Question.ColumnGroup",e}()},function(e,t,r){"use strict";var n,o;r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o})),function(e){e[e.Continue=100]="Continue",e[e.SwitchingProtocols=101]="SwitchingProtocols",e[e.OK=200]="OK",e[e.Created=201]="Created",e[e.Accepted=202]="Accepted",e[e.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",e[e.NoContent=204]="NoContent",e[e.ResetContent=205]="ResetContent",e[e.PartialContent=206]="PartialContent",e[e.MultiStatus=207]="MultiStatus",e[e.MultipleChoices=300]="MultipleChoices",e[e.Ambiguous=300]="Ambiguous",e[e.MovedPermanently=301]="MovedPermanently",e[e.Moved=301]="Moved",e[e.Found=302]="Found",e[e.Redirect=302]="Redirect",e[e.SeeOther=303]="SeeOther",e[e.RedirectMethod=303]="RedirectMethod",e[e.NotModified=304]="NotModified",e[e.UseProxy=305]="UseProxy",e[e.Unused=306]="Unused",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.RedirectKeepVerb=307]="RedirectKeepVerb",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.PaymentRequired=402]="PaymentRequired",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.MethodNotAllowed=405]="MethodNotAllowed",e[e.NotAcceptable=406]="NotAcceptable",e[e.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",e[e.RequestTimeout=408]="RequestTimeout",e[e.Conflict=409]="Conflict",e[e.Gone=410]="Gone",e[e.LengthRequired=411]="LengthRequired",e[e.PreconditionFailed=412]="PreconditionFailed",e[e.RequestEntityTooLarge=413]="RequestEntityTooLarge",e[e.RequestUriTooLong=414]="RequestUriTooLong",e[e.UnsupportedMediaType=415]="UnsupportedMediaType",e[e.RequestedRangeNotSatisfiable=416]="RequestedRangeNotSatisfiable",e[e.ExpectationFailed=417]="ExpectationFailed",e[e.UpgradeRequired=426]="UpgradeRequired",e[e.InternalServerError=500]="InternalServerError",e[e.NotImplemented=501]="NotImplemented",e[e.BadGateway=502]="BadGateway",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout",e[e.HttpVersionNotSupported=505]="HttpVersionNotSupported"}(n||(n={})),function(e){e[e.UpdateFormFailed=609]="UpdateFormFailed",e[e.GetFormFailed=612]="GetFormFailed",e[e.CDBFormSchemaMismatch=620]="CDBFormSchemaMismatch",e[e.CDBColumnNotFound=621]="CDBColumnNotFound",e[e.CDBUserDataNotFound=624]="CDBUserDataNotFound",e[e.CDBTopLevelError=631]="CDBTopLevelError",e[e.ExceedMaximumFormLimition=650]="ExceedMaximumFormLimition",e[e.CDBTableNotFound=674]="CDBTableNotFound",e[e.TableReadOnly=636]="TableReadOnly",e[e.CDBTableMoved=639]="CDBTableMoved",e[e.DatabaseReadOnly=645]="DatabaseReadOnly",e[e.DatabaseUnavailable=646]="DatabaseUnavailable",e[e.DatabaseTransientError=647]="DatabaseTransientError",e[e.NoPermission=700]="NoPermission",e[e.RequireLogin=701]="RequireLogin",e[e.UserNotAllowed=702]="UserNotAllowed",e[e.DisabledByTenantAdmin=703]="DisabledByTenantAdmin",e[e.AntiForgeryTokenValidationError=704]="AntiForgeryTokenValidationError",e[e.UserNeedMultiFactorAuth=705]="UserNeedMultiFactorAuth",e[e.CDBUnauthorizedAccess=707]="CDBUnauthorizedAccess",e[e.NotAllowedBySetting=708]="NotAllowedBySetting",e[e.PermissionScopeInsufficient=709]="PermissionScopeInsufficient",e[e.TokenExpired=711]="TokenExpired",e[e.NotRolloutMsaUser=712]="NotRolloutMsaUser",e[e.CoAuthNotAllowedForMsa=715]="CoAuthNotAllowedForMsa",e[e.NotAllowedByResponseOwnership=716]="NotAllowedByResponseOwnership",e[e.FailedToCheckUserLicense=750]="FailedToCheckUserLicense",e[e.LicenseNotFound=751]="LicenseNotFound",e[e.LicenseNotValid=752]="LicenseNotValid",e[e.AbusedForm=6100]="AbusedForm",e[e.PhishingFromCustomerReport=6101]="PhishingFromCustomerReport",e[e.PhishingFromContentScan=6102]="PhishingFromContentScan",e[e.TempTakeDown=6103]="TempTakeDown",e[e.MSAOwnerDisabled=6104]="MSAOwnerDisabled",e[e.RestrictUser=6106]="RestrictUser",e[e.RestrictedUserNotFound=6107]="RestrictedUserNotFound",e[e.ImageNotFound=805]="ImageNotFound",e[e.InvalidFormId=1001]="InvalidFormId",e[e.NotSupportComposeFormId=1002]="NotSupportComposeFormId",e[e.ResponseNotFound=1007]="ResponseNotFound",e[e.FormClosed=5e3]="FormClosed",e[e.MultiResponseNotAllowed=5001]="MultiResponseNotAllowed",e[e.FormNotStarted=5002]="FormNotStarted",e[e.FormEnded=5003]="FormEnded",e[e.FormSettingJSONParseError=5004]="FormSettingJSONParseError",e[e.NoODPermissionForOpenInExcel=5117]="NoODPermissionForOpenInExcel",e[e.FailedToCreatePermission=5501]="FailedToCreatePermission",e[e.FailedToDeletePermission=5503]="FailedToDeletePermission",e[e.CreateInfoNotCompletePermission=5504]="CreateInfoNotCompletePermission",e[e.DeleteNotExistPermission=5506]="DeleteNotExistPermission",e[e.CopyNotAllowed=5550]="CopyNotAllowed",e[e.FailedToTurnOnAllowCopy=5551]="FailedToTurnOnAllowCopy",e[e.FailedToTurnOffAllowCopy=5552]="FailedToTurnOffAllowCopy",e[e.IncorrectShareToken=5553]="IncorrectShareToken",e[e.ImageUploadFailed=5200]="ImageUploadFailed",e[e.ImageTypeConvertFailed=5201]="ImageTypeConvertFailed",e[e.ImageProviderGetCDBTokenFailed=5202]="ImageProviderGetCDBTokenFailed",e[e.CdbServiceUnavailable=6503]="CdbServiceUnavailable",e[e.FileUploadItemNotFound=6611]="FileUploadItemNotFound",e[e.FileUploadUnrecognizedSharePointError=6605]="FileUploadUnrecognizedSharePointError",e[e.OriginalOwnerIsEmpty=6700]="OriginalOwnerIsEmpty",e[e.OriginalOwnerNotFound=6701]="OriginalOwnerNotFound",e[e.CurrentSignedUserIsNotDelegator=6702]="CurrentSignedUserIsNotDelegator",e[e.CurrentOwnerIsActiveUser=6705]="CurrentOwnerIsActiveUser",e[e.EmbedFormNeedAuth=10001]="EmbedFormNeedAuth",e[e.WorkBookLostFocus=10100]="WorkBookLostFocus",e[e.GetTableDataFailed=10101]="GetTableDataFailed",e[e.InvalidWorkBookSchema=10102]="InvalidWorkBookSchema",e[e.DeleteFormFailed=10201]="DeleteFormFailed",e[e.DeleteFormSuccessed=10202]="DeleteFormSuccessed",e[e.DownloadExcelFileFailed=10203]="DownloadExcelFileFailed",e[e.DownloadExcelFileFailedOnIos=10204]="DownloadExcelFileFailedOnIos",e[e.ReexportToExcelFailed=10205]="ReexportToExcelFailed",e[e.DownloadExcelFileTimeout=10206]="DownloadExcelFileTimeout",e[e.NetworkIssue=15001]="NetworkIssue",e[e.GetGraphAPITokenFailed=15002]="GetGraphAPITokenFailed",e[e.LoginNotSupportInCurrentBrowser=15003]="LoginNotSupportInCurrentBrowser"}(o||(o={}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(113),o=r(9),i=function(){function e(){}return e.logData=function(e){Object(o.a)({eventName:e.name,eventType:"engagement_event",extraData:e.extraData})},e.logSessionStartEvent=function(){n.a.Instance.ensureMuid(),Object(o.a)({eventName:"session_start",eventType:"session_start"})},e}()},function(e,t,r){"use strict";function n(e,t){e||(console.assert(e,"Nerve - "+t),u("assert failed: "+t))}function o(e){return u("TODO: "+e)}function i(){return u("to be overridden.")}function a(e){c=e}function s(e){if(e="Nerve - warning: "+e,console.warn(e),c){var t=new Error(e).stack;c(t)}}r.d(t,"a",(function(){return n})),r.d(t,"e",(function(){return o})),r.d(t,"d",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"f",(function(){return s})),r.d(t,"c",(function(){return u}));var c=null;function u(e){throw Error("Nerve - "+e)}},function(e,t,r){"use strict";r.d(t,"b",(function(){return d})),r.d(t,"a",(function(){return f}));var n,o=r(4),i=r(1),a=r(67),s=r(7),c=r(9),u=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),l={Action:i.a.reference(),AllFormList:i.a.collectionOf(i.a.reference()),AllFormListLoadState:i.a.reference(),AllSharedFormList:i.a.collectionOf(i.a.reference()),Analysis:i.a.boolean(),BranchingElementId:i.a.string(),CdsList:i.a.reference(),CdsValidationMap:i.a.reference(),CriticalError:i.a.reference(),DataIdeas:i.a.boolean(),DefaultCdsId:i.a.string(),DefaultCdsInfoLoadState:i.a.reference(),DefaultCdsUrl:i.a.string(),DelegateInactiveUser:i.a.reference(),EnvironmentListLoadState:i.a.reference(),ErrorBarMessage:i.a.string(),ExperienceType:i.a.reference(),FlexPane:i.a.reference(),ForceDesktopView:i.a.boolean(),FormCollectionType:i.a.reference(),FormId:i.a.string(),FormList:i.a.collectionOf(i.a.reference()),FormListLoadState:i.a.reference(),FormMaster:i.a.reference(),FormsProBranchingData:i.a.string(),FormsProToken:i.a.string(),FormsTenantSettings:i.a.reference(),Grading:i.a.reference(),GroupMaster:i.a.reference(),GroupMruFormListLoadState:i.a.reference(),Host:i.a.string(),InfoBarMessageType:i.a.string(),IsDefaultCds:i.a.boolean(),IsShowYouTubeDisableMessage:i.a.boolean(),Locale:i.a.string(),MeetingInfo:i.a.reference(),pendingCalls:i.a.reference(),PlaceholderList:i.a.collectionOf(i.a.reference()),Preview:i.a.reference(),PreviousFlexPane:i.a.reference(),RecycleBin:i.a.collectionOf(i.a.reference()),RelativeScrolHeight:i.a.number(),Scenario:i.a.string(),SearchContent:i.a.string(),SectionElementId:i.a.string(),SelectedCdsId:i.a.string(),SelectedCdsRegion:i.a.string(),SelectedCdsUrl:i.a.string(),SelectedPortalForm:i.a.reference(),SenderList:i.a.reference(),SharedWithMeFormList:i.a.collectionOf(i.a.reference()),SharedWithMeFormListLoadState:i.a.reference(),ShouldDisableAllClick:i.a.boolean(),ShowExcelSurveyIntroductionDialog:i.a.boolean(),ShowXLUnsyncedDialog:i.a.boolean(),Store:i.a.boolean(),TenantCountryCode:i.a.string(),Title:i.a.string(),Token:i.a.string(),TopView:i.a.reference(),ValidationChecked:i.a.reference(),XlWorkbookId:i.a.string()};function d(){return f.getInstance()}var f=function(e){function t(){var t=e.call(this)||this;return t.bulkEdit((function(){var e=t.Model;e.Analysis=!1,e.BranchingElementId=null,e.DataIdeas=!1,e.Store=!1,e.Grading=null,e.FormListLoadState="NotStarted",e.SharedWithMeFormListLoadState="NotStarted",e.GroupMruFormListLoadState="NotStarted",e.FormCollectionType="OwnedForms",e.MeetingInfo=null,e.SectionElementId=null,e.CdsList=[],e.FirstLoading=!0,e.SelectedCdsId=null,e.CdsValidationMap={},e.IsDefaultCds=!0,e.AllFormListLoadState="NotStarted",e.DefaultCdsInfoLoadState="NotStarted",e.DefaultCdsId="",e.DefaultCdsUrl="",e.TenantCountryCode="",e.ValidationChecked="Pending",e.FormsTenantSettings={bingImageSearch:!0,externalCollaboration:!0,externalSendForm:!0,externalShareCollaboration:!0,externalShareResult:!0,externalShareTemplate:!0,InOrgSurveyIncentive:!0,recordIdentityByDefault:!0}})),t.addRule({InterestedFields:[t.Schema.FormMaster],Name:"ClearRouting",onChange:function(e){t.Model.FormMaster?Object(s.e)((function(){t.getFormsProBranching(t.Model.FormMaster)})):(t.Model.FormsProBranchingData=null,t.clearFormRelatedRoutingFields())}}),t.addRule({InterestedFields:[t.Schema.FlexPane],Name:"RecordFlexPaneType",onChange:function(e){t.Model.PreviousFlexPane=e.OldValues.FlexPane}}),t}return u(t,e),t.getInstance=function(){return this.instance||(this.instance=new t),this.instance},t.prototype.getFormsProBranching=function(e,t){void 0===t&&(t=!0);var r=$.Deferred(),n=this.Model;return e.IsSampleForm?r.resolve(""):(e.ensureFieldsReady([e.Schema.MfpBranchingData,e.Schema.FormsProBranchRules]).done((function(){var o=null;return e.Model.MfpBranchingData?o=e.Model.MfpBranchingData:e.Model.FormsProBranchRules&&(o=e.Model.FormsProBranchRules),t&&o&&(n.FormsProBranchingData=o),r.resolve(o)})).fail((function(e){return r.reject("")})),r.promise(""))},t.prototype.showTopView=function(e,t){this.Model.TopView=e,this.topViewCloseCallback=t},t.prototype.showErrorMessageBar=function(e,t,r){Object(c.a)({correlationId:t&&t.correlationId,eventName:Object(a.a)(t)?"Error.ErrorMessageBar.Show.Expected":"Error.ErrorMessageBar.Show.Unexpected",eventType:"engagement_event",extraData:{Scenario:e,Error:JSON.stringify(t),Key:r}})},t.prototype.hideTopView=function(){this.Model.TopView="None"},t.prototype.resetTopViewCloseCallback=function(){var e=this.topViewCloseCallback;return this.topViewCloseCallback=void 0,e},t.prototype.collapseFlexPaneIfNeeded=function(e){var t=d().Model,r=t.FlexPane;if("None"!==r){var n="flex-pane-container-"+r,o=document.getElementById(n);o&&!o.contains(e)&&(t.FlexPane="None")}},t.prototype.clearFormRelatedRoutingFields=function(){var e=this;this.bulkEdit((function(){var t=e.Model;t.FormMaster=void 0,t.DataIdeas=!1,t.Analysis=!1,t.BranchingElementId=null,t.SectionElementId=null,t.Store=!1,t.Grading=null,t.Preview=null,t.FlexPane="None"}))},t}(o.a.createObjectMasterClass("DesignPageUxState",l))},function(e,t){e.exports=ReactDOM},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(6),o=r(7),i=function(){function e(){}return Object.defineProperty(e,"FormNumber",{get:function(){return 200},enumerable:!0,configurable:!0}),Object.defineProperty(e,"FormTitleLength",{get:function(){return Object(o.c)((function(){return 90}),(function(){return 200}))},enumerable:!0,configurable:!0}),Object.defineProperty(e,"FormSubtitleLength",{get:function(){return 4e3},enumerable:!0,configurable:!0}),Object.defineProperty(e,"QuestionNumber",{get:function(){return OfficeFormServerInfo.userInfo.IsMsa?100:Object(n.a)().Flighting.isEnabled_Deprecated("Question200Limit")?200:100},enumerable:!0,configurable:!0}),Object.defineProperty(e,"QuestionTitleLength",{get:function(){return 4e3},enumerable:!0,configurable:!0}),Object.defineProperty(e,"QuestionSubtitleLength",{get:function(){return 2e3},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ShortQuestionErrorMessageLength",{get:function(){return 200},enumerable:!0,configurable:!0}),Object.defineProperty(e,"LongQuestionErrorMessageLength",{get:function(){return 500},enumerable:!0,configurable:!0}),Object.defineProperty(e,"QuestionOptionLength",{get:function(){return 1e3},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ImageAltTextLength",{get:function(){return 128},enumerable:!0,configurable:!0}),Object.defineProperty(e,"OtherOptionLength",{get:function(){return 1e3},enumerable:!0,configurable:!0}),Object.defineProperty(e,"AnswerHintLength",{get:function(){return 1e3},enumerable:!0,configurable:!0}),Object.defineProperty(e,"AnswerTextfieldLength",{get:function(){return 4e3},enumerable:!0,configurable:!0}),Object.defineProperty(e,"OpenTypeLength",{get:function(){return 4e3},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ResponseNumber",{get:function(){return 5e3},enumerable:!0,configurable:!0}),Object.defineProperty(e,"DefaultTextLength",{get:function(){return 1e3},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ImagePickerQueryCount",{get:function(){return 50},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ImageMaxWidth",{get:function(){return 800},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ImageMaxHeight",{get:function(){return 600},enumerable:!0,configurable:!0}),Object.defineProperty(e,"QuestionCarMaxWidth",{get:function(){return 719},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ImagePlaceHolderWidth",{get:function(){return 320},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ImagePlaceHolderHeight",{get:function(){return 240},enumerable:!0,configurable:!0}),Object.defineProperty(e,"LogoImagePlaceHolder",{get:function(){return 120},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ImageMaxSize",{get:function(){return 5242880},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ImageCompressRate",{get:function(){return.6},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ClientSideErrorDefaultInnerCode",{get:function(){return-1},enumerable:!0,configurable:!0}),Object.defineProperty(e,"DefaultVideoHeight",{get:function(){return 422},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ImageSupportMimeType",{get:function(){return["image/bmp","image/gif","image/jpeg","image/png"]},enumerable:!0,configurable:!0}),Object.defineProperty(e,"MaxRankingItemNumber",{get:function(){return 10},enumerable:!0,configurable:!0}),Object.defineProperty(e,"DefaultQuestionStartOrder",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(e,"DefaultMiddleScreenSize",{get:function(){return 375},enumerable:!0,configurable:!0}),Object.defineProperty(e,"DefaultSmallScreenSize",{get:function(){return 300},enumerable:!0,configurable:!0}),Object.defineProperty(e,"AnalysisTokenName",{get:function(){return"AnalyzerToken"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"LikertColumnMaxSize",{get:function(){return Object(o.c)((function(){return 7}),(function(){return 11}))},enumerable:!0,configurable:!0}),Object.defineProperty(e,"LikertRowMaxSize",{get:function(){return 20},enumerable:!0,configurable:!0}),Object.defineProperty(e,"FileUploadMaxChunkBytes",{get:function(){return 5242880},enumerable:!0,configurable:!0}),Object.defineProperty(e,"DateQuestionAnswerFormat",{get:function(){return"yyyy-MM-dd"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CustomizedThankYouMessageMaxLength",{get:function(){return 4e3},enumerable:!0,configurable:!0}),Object.defineProperty(e,"DefaultTextFieldHeight",{get:function(){return 40},enumerable:!0,configurable:!0}),Object.defineProperty(e,"MathInputLength",{get:function(){return 3e3},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CustomizedFooterTextMaxLength",{get:function(){return 200},enumerable:!0,configurable:!0}),Object.defineProperty(e,"maxLocaleCount",{get:function(){return 10},enumerable:!0,configurable:!0}),Object.defineProperty(e,"MaxResopnseCountForInviteExpiry",{get:function(){return 5e4},enumerable:!0,configurable:!0}),Object.defineProperty(e,"MaxDaysForInviteExpiry",{get:function(){return 1095},enumerable:!0,configurable:!0}),Object.defineProperty(e,"MaxConditionsOrActionPerBranchingRule",{get:function(){return 10},enumerable:!0,configurable:!0}),Object.defineProperty(e,"RegExpForEmailValidation",{get:function(){return/^[\w+!#$%&'*+-/=?^_`{|}~.]+@[\w+.-]+\.[\w+.]+$/},enumerable:!0,configurable:!0}),e}()},function(e,t,r){"use strict";r.d(t,"b",(function(){return l})),r.d(t,"a",(function(){return d}));var n,o=r(0),i=r(3),a=r(5),s=r(12),c=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),u=function(){return(u=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function l(e){return o.createElement(d,u({},e))}var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.prototype.render=function(){var e=i.clone(this.props.HTMLAttributes)||{};return e.className=a.a.combineAttributes("ms-Icon",this.props.IconName?"ms-Icon--"+this.props.IconName:"",e.className),this.props.Accessible||(e.role="presentation",e["aria-hidden"]="true"),o.createElement("i",u({},e))},t}(s.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r(3),o=r(4),i=r(18),a=r(11),s=r(36),c=r(33),u=r(16),l=r(26),d=r(7),f=r(17),p=r(8),m=r(41),h=r(149),g=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n},y=function(){function e(t,r){if(this.form=t,this.dataProvider=e.getDataProviderByFormMaster(t),this.dataProvider){var n=this.dataProvider.getDesignForm;switch(this.form.SyncContext){case p.e.SharedTimeForm:n=this.dataProvider.getSharedForm;break;case p.e.ResponseTimeForm:n=this.dataProvider.getRuntimeForm;break;case p.e.AnalysisTimeForm:n=this.dataProvider.getAnalysisTimeForm;break;case p.e.ResponseDetailTimeForm:n=this.dataProvider.getResponseDetailRuntimeForm;break;case p.e.AdminPhishingReviewForm:n=this.dataProvider.getAdminPhishingReviewForm}this.getForm=n.bind(this.dataProvider)}}return e.getAllForms=function(t,r,n){var i=e.getSourceFieldNames(t);i.push("status");var a=o.a.getFieldSchemaInfo(p.c.Schema.Version).Attributes.SourceFieldName;i.indexOf(a)&&i.push(a);var s=c.a.Me,u=null,d=null;r&&(u=r.OwnerTenantId,d=r.OwnerId,s=r.IsGroupForm?c.a.Group:c.a.Personal);var m=l.a.getInstance().createDataProvider(s,u,d);return m.getForms(i,n).then((function(e){var t=[],r=0,n=[];return e.forEach((function(e){if("Deleted"===e.status)++r,m.deleteForm(e.id);else if(e.version){var i=o.a.convertFromSourceData(e,p.c.Schema);n.push(i)}else t.push(e.id)})),(t.length||r)&&f.a.logData({name:"PortalPage.FilteredOutForms",extraData:{deletedFormCount:r,oldVersionForms:t}}),n}))},e.getCachedSimpleForms=function(e,t){return l.a.getInstance().createDataProvider().getCachedSimpleForms(e,t)},e.getAllFormsResponseCount=function(){return l.a.getInstance().createDataProvider().getFormsResponseCount()},e.getAllLocaleResources=function(t){return e.getDataProviderByFormId(t).getAllLocaleResources(t)},e.getAllSharedWithMeForms=function(){return l.a.getInstance().createDataProvider(c.a.Me).getFormsSharedWithCurrentUser().then((function(e){return e.map((function(e){return o.a.convertFromSourceData(e,p.c.Schema)}))}))},e.getDataProviderByFormMaster=function(e){if(!e.isFieldReady(p.c.Schema.OwnerTenantId)||!e.isFieldReady(p.c.Schema.OwnerId))return l.a.getInstance().createDataProvider();var t=c.a.Default;if(e.IsGroupForm)t=c.a.Group;else{if(!e.Model.OwnerTenantId||!e.Model.OwnerId)return null;t=c.a.Personal}return l.a.getInstance().createDataProvider(t,e.Model.OwnerTenantId,e.Model.OwnerId)},e.getDataProviderByFormId=function(e){var t=Object(s.a)(e),r=c.a.Default;return t.IsGroupOwner?r=c.a.Group:t.OrgId&&t.OwnerId&&(r=c.a.Personal),l.a.getInstance().createDataProvider(r,t.OrgId,t.OwnerId)},e.createExportFile=function(t){return e.getDataProviderByFormMaster(t).createExportFile(t.Model.Id)},e.downloadExcelFile=function(t,r,n){return e.getDataProviderByFormMaster(t).downloadExcelFile(t.Model.Id,r,n)},e.getResponseCount=function(t){return e.getDataProviderByFormMaster(t).getFormResponseCount(t.Model.Id)},e.duplicateExcelForm=function(e,t){return l.a.getInstance().createDataProvider().dupFormForExcel(e,t).then((function(e){return o.a.convertFromSourceData(e,p.c.Schema)}))},e.getAggregateSurveyData=function(t){return e.getDataProviderByFormId(t).getAnalysisSurveyData(t)},e.getAggregateQuizData=function(t){return e.getDataProviderByFormId(t).getAnalysisQuizData(t)},e.getResultSharingAnalysisSurveyData=function(t){return e.getDataProviderByFormId(t).getResultSharingAnalysisSurveyData(t)},e.getResultSharingAnalysisQuizData=function(t){return e.getDataProviderByFormId(t).getResultSharingAnalysisQuizData(t)},e.getFormInsights=function(t){return e.getDataProviderByFormId(t).getInsights(t)},e.getResoucesByLocale=function(t,r){return o.a.Collection.getItemWithKeyFields(t.Model.LocalizedResources,{localeId:r})?$.Deferred().resolve().promise():e.getDataProviderByFormId(t.Model.Id).getLocaleResource(t.Model.Id,r).then((function(e){Object(m.a)(e,t)}))},e.prototype.add=function(e){return this.form.SyncContext===p.e.LocalForm?$.Deferred().promise():this.form.SyncContext===p.e.DesignTimeForm?this.dataProvider.createForm(e):void Object(i.c)("Trying to create a form without design type.")},e.prototype.delete=function(e){var t=this;if(this.form.SyncContext!==p.e.DesignTimeForm)Object(i.c)("Trying to delete a form without design type.");else{if(this.removeFromMRU(),!Object(d.e)((function(){return!0})))return this.dataProvider.deleteForm(this.form.Model.Id);this.form.ensureFieldsReady([p.c.Schema.BusinessCdsId,p.c.Schema.BusinessCdsRegion]).done((function(){return t.dataProvider.deleteForm(t.form.Model.Id,t.form.Model.BusinessCdsId,t.form.Model.BusinessCdsRegion)}))}},e.prototype.query=function(e){if(Object(d.e)((function(){return!0}))&&this.form.IsSampleForm)return $.Deferred().resolve(null).promise();if(!this.getForm){var t={innerCode:u.b.InvalidFormId,type:"ExpectedFailure"};return $.Deferred().reject(t).promise()}var r=o.a.getFieldSchemaInfo(this.form.Schema.LocalizedResources).Attributes.SourceFieldName,i=e.filter((function(e){return e!==r})),s=[];return s.push(this.getForm(this.form.Model.Id,i)),n.find(e,(function(e){return e===r}))&&!a.a.isMobile()&&s.push(this.form.getAllLocaleResources()),$.when.apply($,s).then((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.extend.apply(n,g([{}],e))}))},e.prototype.update=function(e){if(!Object(d.e)((function(){return!0}))||!this.form.IsSampleForm){if(this.form.SyncContext===p.e.LocalForm)return $.Deferred().promise();if(this.form.SyncContext!==p.e.DesignTimeForm)return $.Deferred().resolve().promise();var t=o.a.getFieldSchemaInfo(p.c.Schema.SoftDeleted).Attributes.SourceFieldName;return t in e&&e[t]===p.b.SoftDeleted&&this.removeFromMRU(),this.dataProvider.updateForm(this.form.Model.Id,e)}},e.getSourceFieldNames=function(e){return p.c.getSourceFields(e||o.a.getSubFieldSchemas(p.c.Schema)).map((function(e){var t=o.a.getFieldSchemaInfo(e);if(!t.Attributes.IsLocalField)return t.Attributes.SourceFieldName||t.Name})).filter((function(e){return e}))},e.prototype.removeFromMRU=function(){var e=this;return this.dataProvider.removeRecentForm(this.form.Model.Id).then((function(){var t=h.a.getInstance();t&&t.removeDocument(e.form.Model.Id)}))},e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n,o=r(5);!function(e){e[e.signup=1]="signup"}(n||(n={}));var i=function(){function e(){}return Object.defineProperty(e,"Host",{get:function(){return e._host||e.GetHostString()},set:function(t){e._host=t},enumerable:!0,configurable:!0}),e.GetHostString=function(){var t=e._host||o.a.getQueries()[e.HostParam]||o.a.getHashes()[e.HostParam];switch(t){case"OneNote":case"OneNoteUwp":case"Outlook":case"Teams":case"Excel":case"OneDrive":case"Excel_Win32":case"PowerPointContent":case"PowerPointTaskpane":case"Assignments":case"ProjectShimla":case"Stream":case"StreamMobile":case"Union":case"ODC":return t;default:return null}},Object.defineProperty(e,"RedirectOrigin",{get:function(){return e._redirectOrigin||n[e.GetRedirectOriginString()]},set:function(t){e._redirectOrigin=t},enumerable:!0,configurable:!0}),e.GetRedirectOriginString=function(){return e._redirectOrigin&&n[e._redirectOrigin]||o.a.getQueries()[e.RedirectOriginParam]||o.a.getHashes()[e.RedirectOriginParam]},Object.defineProperty(e,"GroupId",{get:function(){return e._groupId||o.a.getQueries()[e.GroupParam]||o.a.getHashes()[e.GroupParam]},enumerable:!0,configurable:!0}),Object.defineProperty(e,"TenantId",{get:function(){return e._tenantId||o.a.getQueries()[e.TenantParam]||o.a.getHashes()[e.TenantParam]},enumerable:!0,configurable:!0}),e.setGroupInfo=function(t,r,n){void 0===t&&(t=!1),e._showGroupFormOnly=t,e._tenantId=r,e._groupId=n},Object.defineProperty(e,"IsIntegration",{get:function(){return!!e.GetHostString()||!!OfficeFormServerInfo.isOembedSPO},enumerable:!0,configurable:!0}),Object.defineProperty(e,"StartPageRouteType",{get:function(){var t=o.a.getQueries()[e.RouteParam];if(t){var r=t.toLowerCase();switch(r){case"start":case"appitems":case"groupitems":return r;default:return}}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"IsTeamsIntegration",{get:function(){return"Teams"===e.Host&&"undefined"!=typeof microsoftTeams},enumerable:!0,configurable:!0}),Object.defineProperty(e,"IsTeamsLandingPage",{get:function(){return!!o.a.getQueries()[e.TeamsLandingParam]},enumerable:!0,configurable:!0}),Object.defineProperty(e,"IsMiniLandingView",{get:function(){return!!o.a.getQueries()[e.MiniLandingViewParam]},enumerable:!0,configurable:!0}),Object.defineProperty(e,"IsAssignmentsIntegration",{get:function(){return"Assignments"===e.Host},enumerable:!0,configurable:!0}),Object.defineProperty(e,"IsAssignmentsPage",{get:function(){return"/pages/assignmentsdesignpage.aspx"===window.location.pathname.toLowerCase()||"/pages/assignmentsresponsepage.aspx"===window.location.pathname.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(e,"IsExternalIntegration",{get:function(){return this.IsTeamsIntegration||this.IsAssignmentsIntegration},enumerable:!0,configurable:!0}),Object.defineProperty(e,"IsPPTIntegration",{get:function(){return"PowerPointTaskpane"===e.Host||"PowerPointContent"===e.Host},enumerable:!0,configurable:!0}),Object.defineProperty(e,"IsProjectShimlaIntegration",{get:function(){return"ProjectShimla"===e.Host},enumerable:!0,configurable:!0}),Object.defineProperty(e,"IsRedirectFromSignupService",{get:function(){return e.RedirectOrigin===n.signup},enumerable:!0,configurable:!0}),e.isDelegateMode=function(){if(null===e._isDelegateMode){var t=window.location.pathname.trimEnd("/").toLowerCase();e._isDelegateMode=t.lastIndexOf(e.DelegatePage)==t.length-e.DelegatePage.length}return e._isDelegateMode},Object.defineProperty(e,"IsUnionIntegration",{get:function(){return"Union"===e.Host},enumerable:!0,configurable:!0}),e.setEnvironmentHostAppWithName=function(t){e.Host=t},Object.defineProperty(e,"ShowImageAltText",{get:function(){return e._showImageAltText},set:function(t){e._showImageAltText=t},enumerable:!0,configurable:!0}),e.PopupNotifyTypeParam="popupNotifyType",e.AuthProviderParam="auth_pvr",e.AuthUpnParam="auth_upn",e.ShareToCollabTokenParam="Token",e.HostParam="Host",e.RedirectOriginParam="redirectorigin",e.TeamsLandingParam="TeamsLanding",e.MiniLandingViewParam="MiniLandingView",e.GroupParam="groupId",e.TenantParam="tid",e.DelegatePage="delegatepage.aspx",e.RouteParam="route",e._isDelegateMode=null,e._showImageAltText=!1,e}()},function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e[e.BackSpace=8]="BackSpace",e[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.Shift=16]="Shift",e[e.Esc=27]="Esc",e[e.Space=32]="Space",e[e.End=35]="End",e[e.Home=36]="Home",e[e.ArrowLeft=37]="ArrowLeft",e[e.ArrowUp=38]="ArrowUp",e[e.ArrowRight=39]="ArrowRight",e[e.ArrowDown=40]="ArrowDown",e[e.Delete=46]="Delete",e[e.Eight=56]="Eight",e[e.PlaceHolder=229]="PlaceHolder"}(n||(n={}))},function(e,t,r){"use strict";var n=r(11),o=r(7),i=r(33),a=r(136),s=r(74),c=r(54),u=r(27),l=r(28),d=r(6),f=r(56),p=r(40),m=r(16),h=function(){function e(e){for(this.serviceUrl=e.trim();"/"===this.serviceUrl.charAt(this.serviceUrl.length-1);)this.serviceUrl=this.serviceUrl.substr(0,this.serviceUrl.length-1)}return e.prototype.deleteQuestionImage=function(t,r,n){var o=this;return this.getToken().then((function(i){return e.deleteImageInternal(i,o.getAbsoluteUrl(e.getQuestionImageUrl(t,r,n)))}))},e.prototype.uploadQuestionImage=function(t,r,n,o){var i=this;return this.getToken().then((function(a){return e.uploadImageInternal(a,i.getAbsoluteUrl(e.getQuestionImageUrl(t,r,n)),n,o)}))},e.prototype.deleteFormImage=function(t,r){var n=this;return this.getToken().then((function(o){return e.deleteImageInternal(o,n.getAbsoluteUrl(e.getFormImageUrl(t,r)))}))},e.prototype.uploadFormImage=function(t,r,n){var o=this;return this.getToken().then((function(i){return e.uploadImageInternal(i,o.getAbsoluteUrl(e.getFormImageUrl(t,r)),r,n)}))},e.getFormImageUrl=function(t,r){return e.formImageUrlPattern.format(t,r)},e.getQuestionImageUrl=function(t,r,n){return e.questionImageUrlPattern.format(t,r,n)},e.deleteImageInternal=function(t,r){var n=new f.a("Image.Delete");n.start();var o={type:"DELETE",url:r,headers:{Authorization:t?"Bearer "+t:"","X-CorrelationId":n.CorrelationId,"X-UserSessionId":Object(p.d)()}};return e.sendRequest(o,(function(){return n.end({resultType:"Success"})}),(function(e){var t={correlationId:n.CorrelationId,innerCode:e.responseJSON&&e.responseJSON.error&&e.responseJSON.error.code,statusCode:e.status,innerMessage:e.responseJSON&&e.responseJSON.error&&e.responseJSON.error.message,statusText:e.statusText};return n.end({resultType:"Failure",extraData:{imageUrl:r,error:t}}),t}))},e.uploadImageInternal=function(t,r,n,o){var i=new f.a("Image.Upload");i.start();var a={type:"PUT",url:r,headers:{Authorization:t?"Bearer "+t:"","Content-Type":o.ImageType,"Content-Disposition":"attachment; name={0}; filename={1}".format(u.a.newGuid(),o.ImageName),"X-CorrelationId":i.CorrelationId,"X-UserSessionId":Object(p.d)()},processData:!1,data:o.ImageBlob};return e.sendRequest(a,(function(e){if(!e||!e.resourceId){var t={correlationId:i.CorrelationId,innerCode:m.b.ImageUploadFailed,statusCode:0,innerMessage:"Upload image return bad response",statusText:"CollabDb bad response"};return i.end({resultType:"Failure",extraData:{imageUrl:r,error:t,imageType:n}}),$.Deferred().reject(t).promise()}i.end({resultType:"Success",extraData:{imageType:n}});var o={};return o.altText=e.altText,o.contentType=e.contentType,o.fileIdentifier=e.fileIdentifier,o.originalFileName=e.originalFileName,o.resourceId=e.resourceId,o.resourceUrl=e.resourceUrl,o.height=e.height,o.width=e.width,o}),(function(e){var t={correlationId:i.CorrelationId,innerCode:e.responseJSON&&e.responseJSON.error&&e.responseJSON.error.code,statusCode:e.status,innerMessage:e.responseJSON&&e.responseJSON.error&&e.responseJSON.error.message,statusText:e.statusText};return i.end({resultType:"Failure",extraData:{imageUrl:a.url,error:t}}),t}))},e.sendRequest=function(e,t,r){return Object(d.a)().Flighting.isEnabled("CookieAuth")&&(e.headers.__RequestVerificationToken=OfficeFormServerInfo.antiForgeryToken),Object(o.e)((function(){e.headers["x-ms-form-request-ring"]="formspro"})),$.ajax(e).then(t,(function(n){if(!Object(s.c)(n))return r(n);Object(d.a)().AuthContext.refreshToken().done((function(){Object(c.i)((function(){return e.headers.__RequestVerificationToken=OfficeFormServerInfo.antiForgeryToken,$.ajax(e).then(t,r)}),(function(){return Object(l.d)()}))}))}))},e.prototype.getToken=function(){return Object(d.a)().AuthContext.getFormApiToken()},e.prototype.getAbsoluteUrl=function(e){return this.serviceUrl+"/"+e},e.formImageUrlPattern="forms('{0}')/{1}",e.questionImageUrlPattern="forms('{0}')/questions('{1}')/{2}",e}(),g=r(183),y=r(5),b=r(13),v=r(50),S=r(32),I=function(){function e(t){if(e._instance)return e._instance;e._instance=this,this._serviceUrl=t,b.b(this._serviceUrl,"math service url is null")}return e.getInstance=function(t){return new e(t)},e.prototype.mathFormulaCalculation=function(e){if(!e||!e.Mathml){return $.Deferred().resolve({Aria:"",Responses:[]}).promise()}var t={Context:e.Context,Formulas:[e.Mathml],InputFormat:"MathML",Locale:navigator.language,Mode:1,Origin:e.Origin,OutputFormat:"latex",RequiredIncorrectAnswerCount:e.IncorrectAnswerCount};return this.sendRequest({data:t,method:"POST",requestUri:this._serviceUrl+"mathapi/calculation?formId="+e.FormId+"&questionId="+e.QuestionId,qosEventName:"Question.MathCalculation"})},e.prototype.mathQuestionGeneration=function(e,t){if(!e.Context){return $.Deferred().resolve({Features:0,Results:[]}).promise()}var r={data:{Features:e.Features,Input:e.Context,InputFormat:"MathML",Locale:navigator.language,Origin:e.Origin,OutputFormat:"latex",RequiredQuestionsCount:e.QuestionCount,RequiredIncorrectAnswerCount:e.IncorrectAnswerCount},method:"POST",requestUri:this._serviceUrl+"mathapi/questions?formId="+e.FormId+"&questionId="+e.QuestionId,qosEventName:"Question.MathQuestionGeneration"};return t&&"error"!==t?this.sendRequestWithToken(r,{},t):this.sendRequest(r)},e.prototype.textAnalyze=function(e){var t=v.c.ChoiceQuestionTypeSuggest;return this.textAnalyzeWithFeatures(t,e)},e.prototype.textAnalyzeWithFeatures=function(e,t){if(!t){return $.Deferred().resolve({Features:0,Results:[]}).promise()}var r={Features:e,Text:t};return this.sendRequest({requestUri:this._serviceUrl+"textanalysis2",method:"POST",data:r,qosEventName:"Question.TextAnalysis",qosExtraData:{Features:e}})},e.prototype.sendRequest=function(e){return this.getToken().then((function(t){return e.headers=$.extend(!0,e.headers,{Accept:"application/json",Authorization:t?"Bearer "+t:"",__RequestVerificationToken:OfficeFormServerInfo.antiForgeryToken}),Object(S.b)(e).then((function(e){b.b(e,"math calculation result is null");var t=S.a.parseResponseDataValue(e);return b.b(t,"math calculation result parse failure"),t}),S.a.parseAndTryHandleError)}))},e.prototype.sendRequestWithToken=function(e,t,r){var n=this;return $.when(r||this.getToken()).then((function(r){return e.headers=$.extend(!0,e.headers,n.getCommonHeaders(r)),Object(S.b)(e,t).then(S.a.parseResponseDataValue,S.a.parseAndTryHandleError)}))},e.prototype.getToken=function(){return Object(d.a)().AuthContext.getFormApiToken()},e.prototype.getCommonHeaders=function(e){var t={Accept:"application/json",Authorization:e?"Bearer "+e:"",__RequestVerificationToken:OfficeFormServerInfo.antiForgeryToken,AnalyzerToken:y.a.getQueries().AnalyzerToken,ValidationToken:y.a.getQueries().vt},r=y.a.getHashes().Token;return Object(d.a)().Flighting.isEnabled("GetShareInvitationKeyFromQuery")?t.ShareInvitationKey=r||y.a.getQueries().Token:t.ShareInvitationKey=r,t},e}(),M=r(3),F=r(49),O=r(43),C=r(17),P=r(34),T=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n},w=function(){function e(e){this.clients={},this.requestInfoProvider=e}return e.prototype.close=function(e){this.clients[e]&&(this.clients[e].close(),delete this.clients[e])},e.prototype.open=function(e,t,r){var n=this;if(this.close(e),null==r)throw new Error("PushNotificationProvider.open method: cdbTable should not be null.");return(Object(d.a)().Flighting.isEnabled("SignalRConnectV2")?this.requestInfoProvider.getOwnerCDBSlice():$.Deferred().reject().promise()).then((function(o){return n.createSignalRClient(e,t,r,o)}),(function(){return n.createSignalRClient(e,t,r)}))},e.prototype.createSignalRClient=function(e,t,r,n){return this.clients[e]=new _(A.getInstance().CollabDBServiceUrl,r.OwnerTenantId,r.OwnerId,r.TableId,r.IsGroupTable,n),this.clients[e].open(t)},e}(),_=function(){function e(e,t,r,n,o,i){this.clientId=u.a.newGuid(),this.clientName="CdbSignalR",this.disposed=!0,this.hubConnection=null,this.reconnectingCount=0,this.remainingRetryCount=E.MaxRetryCount;var a=e.trimEnd("/");i&&(a=E.ComposedCDBSliceFormat.format(i,a)),this.rtcUrl=(o?E.CDBUrlForGroupsFormat:E.CDBUrlForUsersFormat).format(a,t,r,n)}return e.prototype.close=function(){var e=this;this.log("Closing connection"),this.disposed=!0;var t=function(){4!==e.hubConnection.state&&e.invokeHubMethod(E.UserHubName,E.Leave).always((function(){e.hubConnection.stop(!0,!0),e.log("Connection closed")}))};null!=this.hubConnection&&(0===this.hubConnection.state||2===this.hubConnection.state?this.hubConnection.stateChanged(t):t())},e.prototype.open=function(e){var t=this;this.log("Creating connection"),this.createHubConnection(this.rtcUrl),this.log("Initializing connection"),(e=M.clone(e)).onFormUpdated&&this.onHubEvent(E.TableDefinitionHubName,E.TableUpdated,(function(t,r){e.onFormUpdated(R.toFormUpdatePayload(r),R.toUserPayload(r._modifiedBy))})),e.onFormElementAdded&&this.onHubEvent(E.TableDefinitionHubName,E.ColumnAdded,(function(t,r){"Comments"!==t.propertyName&&"ReleaseDate"!==t.propertyName&&"FormsProData"!=t.propertyName&&e.onFormElementAdded(R.toFormElementPayload(r),R.toUserPayload(r._modifiedBy))})),e.onFormElementDeleted&&this.onHubEvent(E.TableDefinitionHubName,E.ColumnDeleted,(function(t,r){e.onFormElementDeleted(t.propertyName,R.toUserPayload(r._modifiedBy))})),e.onFormElementUpdated&&this.onHubEvent(E.TableDefinitionHubName,E.ColumnUpdated,(function(t,r){e.onFormElementUpdated(t.propertyName,R.toFormElementUpdatePayload(r),R.toUserPayload(r._modifiedBy))})),e.onChoiceAdded&&this.onHubEvent(E.TableDefinitionHubName,E.ChoiceAdded,(function(t,r){e.onChoiceAdded(t.propertyName,R.toChoicePayload(t,r),R.toUserPayload(r._modifiedBy))})),e.onChoiceDeleted&&this.onHubEvent(E.TableDefinitionHubName,E.ChoiceDeleted,(function(t,r){e.onChoiceDeleted(t.propertyName,t.choiceId,R.toUserPayload(r._modifiedBy))})),e.onChoiceUpdated&&this.onHubEvent(E.TableDefinitionHubName,E.ChoiceUpdated,(function(t,r){e.onChoiceUpdated(t.propertyName,t.choiceId,R.toChoicePayload(t,r),R.toUserPayload(r._modifiedBy))})),e.onResponseAdded&&this.onHubEvent(E.TableDataHubName,E.RowAdded,(function(t,r){e.onResponseAdded(R.toResponsePayload(r))})),e.onResponseDeleted&&this.onHubEvent(E.TableDataHubName,E.RowDeleted,(function(t,r){e.onResponseDeleted(Number(t._id),{modifiedBy:R.toUserPayload(r._modifiedBy),modifiedDateTime:new Date(r._modifiedBy.ModifiedDateTime)})})),e.onResponsesAllDeleted&&this.onHubEvent(E.TableDataHubName,E.RowsAllDeleted,(function(t,r){e.onResponsesAllDeleted({modifiedBy:R.toUserPayload(r._modifiedBy),modifiedDateTime:new Date(r._modifiedBy.ModifiedDateTime)})})),e.onResponseUpdated&&this.onHubEvent(E.TableDataHubName,E.RowUpdated,(function(t,r){e.onResponseUpdated(Number(t._id),R.toResponseUpdatePayload(r))})),e.onCommentAdded&&this.onHubEvent(E.TableDataHubName,E.RelatedRecordAdded,(function(t,r,n){R.isCommentPayload(t)&&e.onCommentAdded(Number(t.rowId),R.toCommentPayload(n),{modifiedBy:R.toUserPayload(r.modifiedBy),modifiedDateTime:new Date(r.modifiedDateTime)})})),e.onCommentDeleted&&this.onHubEvent(E.TableDataHubName,E.RelatedRecordDeleted,(function(t,r,n){R.isCommentPayload(t)&&e.onCommentDeleted(Number(t.rowId),Number(t.id),{modifiedBy:R.toUserPayload(r.modifiedBy),modifiedDateTime:new Date(r.modifiedDateTime)})})),e.onLocaleResourceAdded&&this.onHubEvent(E.TableDefinitionHubName,E.LocaleResourceAdded,(function(r,n){if(n){var o=n.localeResources;o.forEach((function(e){e.elementKey=t.mapLocaleItemKeyName(e.elementKey)})),e.onLocaleResourceAdded(o,R.toUserPayload(n._modifiedBy))}})),e.onLocaleResourceUpdated&&this.onHubEvent(E.TableDefinitionHubName,E.LocaleResourceUpdated,(function(r,n){if(n){var o=M.clone(n);delete o._modifiedBy,o.elementKey=t.mapLocaleItemKeyName(o.elementKey),e.onLocaleResourceUpdated(o,R.toUserPayload(n._modifiedBy))}})),e.onLocaleResourceDeleted&&this.onHubEvent(E.TableDefinitionHubName,E.LocaleResourceDeleted,(function(t,r){r&&e.onLocaleResourceDeleted(r,R.toUserPayload(r._modifiedBy))})),e.onUserConnected&&this.onHubEvent(E.UserHubName,E.UserConnected,(function(t,r){e.onUserConnected(R.toUserPayload(t))})),e.onUserDisconnected&&this.onHubEvent(E.UserHubName,E.UserDisconnected,(function(t,r){e.onUserDisconnected(R.toUserPayload(t))}));var r=void 0;return this.hubConnection.starting((function(){t.log("connection starting"),C.a.logData({name:"DataProvider.RealtimeClient.Connection.Starting",extraData:{clientId:t.ClientId,connectionId:t.hubConnection.id}})})),this.hubConnection.connectionSlow((function(){t.log("connection slow"),C.a.logData({name:"DataProvider.RealtimeClient.Connection.Slow",extraData:{clientId:t.ClientId,connectionId:t.hubConnection.id}}),e.onConnectionSlow&&e.onConnectionSlow()})),this.hubConnection.error((function(n){t.log("connection error: {0}",JSON.stringify(n)),C.a.logData({name:"DataProvider.RealtimeClient.Connection.Error",extraData:{clientId:t.ClientId,connectionId:t.hubConnection.id,error:n}}),r={errorObject:n},e.onConnectionError&&e.onConnectionError(n)})),this.hubConnection.reconnecting((function(){t.log("connection reconnecting"),C.a.logData({name:"DataProvider.RealtimeClient.Connection.Reconnecting",extraData:{clientId:t.ClientId,connectionId:t.hubConnection.id}}),e.onConnectionReconnecting&&e.onConnectionReconnecting()})),this.hubConnection.reconnected((function(){C.a.logData({name:"DataProvider.RealtimeClient.Connection.Reconnected",extraData:{clientId:t.ClientId,connectionId:t.hubConnection.id}}),t.log("connection reconnected"),e.onConnectionReconnected&&e.onConnectionReconnected(void 0)})),this.hubConnection.disconnected((function(){if(t.log("connection disconnected"),C.a.logData({name:"DataProvider.RealtimeClient.Connection.Disconnected",extraData:{clientId:t.ClientId,connectionId:t.hubConnection.id,remainingRetryCount:t.remainingRetryCount,lastError:r&&r.errorObject}}),t.remainingRetryCount-- >0){t.reconnectingCount++;var n={reconnectingCount:t.reconnectingCount,refreshToken:r&&r.errorObject&&r.errorObject.context&&r.errorObject.context.status===m.a.Unauthorized,retryCount:E.MaxRetryCount-t.remainingRetryCount,onSuccess:e.onConnectionReconnected,onError:e.onConnectionFailed};t.startConnection(n).done((function(){r=void 0})).fail((function(e){}))}else C.a.logData({name:"DataProvider.RealtimeClient.Connection.Failed",extraData:{clientId:t.ClientId,connectionId:t.hubConnection.id,lastError:r&&r.errorObject}}),e.onConnectionDisconnected&&e.onConnectionDisconnected()})),!F.a.isDebugMode()&&n.a.isOsi()||(this.hubConnection.logging=!0,this.hubConnection.received((function(e){t.log("Received message: {0}",JSON.stringify(e))}))),this.disposed=!1,this.startConnection({onSuccess:e.onConnectionStarted,onError:e.onConnectionFailed})},Object.defineProperty(e.prototype,"ClientId",{get:function(){return this.clientId},enumerable:!0,configurable:!0}),e.prototype.log=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(F.a.isDebugMode()||!n.a.isOsi()){var o=new Date;console.log("[%s] %s[%s]: %s",o.toTimeString(),this.clientName,this.clientId,e.format.apply(e,t))}},e.prototype.mapLocaleItemKeyName=function(e){switch(e){case"thankyoumessage":return"thankYouMessage";case"formclosemessage":return"formCloseMessage";case"leftdescription":return"leftDescription";case"rightdescription":return"rightDescription";case"formsprortlocaleldescription":return"formsprortlocaleldescription";case"formsprortlocalerdescription":return"formsprortlocalerdescription";case"footertext":return"footerText";default:return e}},e.prototype.createHubConnection=function(e){this.hubConnection=$.hubConnection(e,{useDefaultPath:!1}),this.hubConnection.createHubProxy(E.TableDefinitionHubName),this.hubConnection.createHubProxy(E.TableDataHubName),this.hubConnection.createHubProxy(E.UserHubName)},e.prototype.getHubProxy=function(e){if(null==this.hubConnection)throw Error("Realtime connection has not been created yet.");var t=this.hubConnection.proxies[e.toLocaleLowerCase()];if(null==t)throw Error("Cannot find hub proxy {0}".format(e));return t},e.prototype.handleAuth=function(e){var t=this;return A.getInstance().createDataProvider().getCdbToken().then((function(e){t.hubConnection.qs={Authorization:e}}))},e.prototype.invokeHubMethod=function(e,t){for(var r,n=this,o=[],i=2;i<arguments.length;i++)o[i-2]=arguments[i];if(this.isHubConnected()){var a=new f.a("Connection.InvokeRemoteMethod");return a.start(),(r=this.getHubProxy(e)).invoke.apply(r,T([t],o)).then((function(e){return a.end({resultType:"Success",extraData:{clientId:n.ClientId,connectionId:n.hubConnection.id,methodName:t}}),e}),(function(e){return a.end({resultType:n.isHubConnected()?"Failure":"ExpectedFailure",extraData:{clientId:n.ClientId,connectionId:n.hubConnection.id,methodName:t,error:JSON.stringify(e,["message","description","source","context","data"])}}),e}))}return O.a.getRejectedPromise(Error("Realtime connection has not been established yet."))},e.prototype.isHubConnected=function(){return null!=this.hubConnection&&1===this.hubConnection.state},e.prototype.onHubEvent=function(e,t,r){r&&this.getHubProxy(e).on(t,r)},e.prototype.startConnection=function(e){var t=this;if(this.disposed)return O.a.getRejectedPromise("Connection disposed");var r=$.Deferred();e.onSuccess&&r.done((function(t){return e.onSuccess(t)})),e.onError&&r.fail((function(t){return e.onError(t)}));var n=new f.a("Connection.ConnectToCDBSignalR"),o=function(){n.end({resultType:"Success",extraData:{clientId:t.ClientId,connectionId:t.hubConnection.id,reconnectingCount:e.reconnectingCount,retryCount:e.retryCount}}),t.log("Realtime connection started"),t.remainingRetryCount=E.MaxRetryCount,t.invokeHubMethod(E.UserHubName,E.Join),t.invokeHubMethod(E.UserHubName,E.GetActiveUsers).then((function(e){r.resolve(e)}),(function(e){r.reject(e)}))},i=function(o){n.end({resultType:"Failure",extraData:{clientId:t.ClientId,connectionId:t.hubConnection.id,reconnectingCount:e.reconnectingCount,retryCount:e.retryCount,connectionError:o.source?JSON.stringify(o,["message","description","source","context","transport"]):void 0,serviceError:o.source?void 0:JSON.stringify(o,["message","statusCode","statusText","innerCode"])}}),r.reject(o)};return n.start(),this.handleAuth(e.refreshToken).then((function(){return t.hubConnection.start().then(o,i)}),(function(e){i(e),C.a.logData({name:"DataProvider.RealtimeClient.Connection.Failed",extraData:{clientId:t.ClientId,connectionId:t.hubConnection.id,lastError:JSON.stringify(e)}})})),r.promise()},e}(),E=function(){function e(){}return e.TableDefinitionHubName="TableDefinitionChangeHub",e.TableDataHubName="TableChangeHub",e.UserHubName="TableActivityHub",e.TableUpdated="tableDefinitionUpdated",e.ColumnAdded="columnDefinitionAdded",e.ColumnDeleted="columnDefinitionDeleted",e.ColumnUpdated="columnDefinitionUpdated",e.ChoiceAdded="choiceAdded",e.ChoiceUpdated="choiceUpdated",e.ChoiceDeleted="choiceDeleted",e.RowAdded="rowAdded",e.RowDeleted="rowDeleted",e.RowsAllDeleted="rowsAllDeleted",e.RowUpdated="rowUpdated",e.RelatedRecordAdded="relatedRecordAdded",e.RelatedRecordDeleted="relatedRecordDeleted",e.RelatedRecordUpdated="relatedRecordUpdated",e.LocaleResourceAdded="localeResourceAdded",e.LocaleResourceUpdated="localeResourceUpdated",e.LocaleResourceDeleted="localeResourceDeleted",e.UserConnected="userConnected",e.UserDisconnected="userDisconnected",e.GetActiveUsers="GetActiveUsers",e.Join="Join",e.Leave="Leave",e.MaxRetryCount=5,e.ComposedCDBSliceFormat="{0}.{1}:797",e.CDBUrlForUsersFormat="https://{0}/realtime/beta/{1}/users/{2}/tables/{3}/$notifications",e.CDBUrlForGroupsFormat="https://{0}/realtime/beta/{1}/groups/{2}/tables/{3}/$notifications",e}(),R=function(){function e(){}return e.toFormUpdatePayload=function(t){return t&&e.normalize({id:void 0,tableId:t.id,title:t.displayName,createdBy:t.createBy,modifiedDate:t.dateTimeLastUpdated,description:t.description,settings:t.formSettings,otherInfo:t.otherInfo,questions:void 0,header:e.toImagePayload(t.header),logo:e.toImagePayload(t.logo),background:e.toImagePayload(t.background),thankYouMessage:t.thankYouMessage,version:t.version,xlWorkbookId:t.xlWorkbookId,xlExportingTag:t.xlExportingTag,xlFileUnSynced:t.xlFileUnSynced,xlUnsyncedReason:t.xlUnsyncedReason,permissionTokens:e.toPermissionTokenPayload(t.permissionTokens),onlineSafetyLevel:t.onlineSafetyLevel})},e.toFormElementPayload=function(t){return t&&{id:t.propertyName,title:t.description||t.title||t.displayName,defaultValue:t.defaultValue,subtitle:t.subtitle,required:t.required,type:t.questionType,questionInfo:t.questionInfo,order:t.order,version:void 0,modifiedDate:t.questionModifiedDate,status:t.status,image:e.toImagePayload(t.image),isQuiz:t.isQuiz,titleHasPhishingKeywords:t.titleHasPhishingKeywords,subtitleHasPhishingKeywords:t.subtitleHasPhishingKeywords,formsProRTQuestionTitle:t.formsProRTQuestionTitle,formsProRTSubtitle:t.formsProRTSubtitle,choices:t.choices,groupId:t.columnGroupName,fileUploadSPOInfo:t.fileUploadSPOInfo&&JSON.parse(t.fileUploadSPOInfo),questionTagForIntelligence:t.questionTagForIntelligence,isFromSuggestion:t.isFromSuggestion}},e.toChoicePayload=function(t,r){return r&&e.normalize({id:t.choiceId,customProperties:r.customProperties,description:r.description,displayText:r.displayText,formsProDisplayRTText:r.formsProDisplayRTText,key:r.key,order:r.order})},e.toFormElementUpdatePayload=function(t){return e.normalize(e.toFormElementPayload(t))},e.toUserPayload=function(e){return{userId:e.Id||e.userId,displayName:e.DisplayName||e.displayName,firstName:e.FirstName||e.firstName,lastName:e.LastName||e.lastName,email:e.Email||e.email}},e.toImagePayload=function(e){return e?null==e.ResourceId||null!=e.ResourceUrl?{altText:e.AltText,contentType:e.ContentType,fileIdentifier:e.FileIdentifier,originalFileName:e.OriginalFileName,resourceId:e.ResourceId,resourceUrl:e.ResourceUrl}:void P.a.logData({errorName:"InvalidCdbImagePayload"}):e},e.toPermissionTokenPayload=function(e){return e?JSON.parse(e).map((function(e){return{principalId:e.PrincipalId,name:e.Name,type:e.Type}})):e},e.toResponsePayload=function(t){return null==t?t:{id:null==t._id?void 0:Number(t._id),startDate:t.StartDate,submitDate:t.SubmitDate,responder:t.Responder,responderName:t.ResponderName,answers:e.toAnswers(t),quizResult:void 0,releaseDate:t.ReleaseDate}},e.toAnswers=function(e){var t=M.difference(Object.keys(e).filter((function(e){return"_"!==e[0]})),["SubmitDate","ResponderName","Responder","StartDate","Comments_comments","Comments","ReleaseDate"]);return JSON.stringify(t.map((function(t){return{questionId:t,answer1:e[t]}})))},e.toResponseUpdatePayload=function(t){var r=e.normalize(e.toResponsePayload(t));return delete r.answers,r},e.isCommentPayload=function(e){return e&&"Comments_comments"===e.propertyName},e.toCommentPayload=function(t){return t&&{id:t.id,feedback:t.text,score:t.number,questionId:t.columnReference,createdDateTime:t.createdDateTime,createdBy:e.toUserPayload(t.createdBy)}},e.normalize=function(e){var t=e;for(var r in t)void 0===t[r]&&delete t[r];return t},e}(),D=r(186);r.d(t,"a",(function(){return A})),r.d(t,"b",(function(){return L})),r.d(t,"c",(function(){return N}));var A=function(){function e(){if(e.instance)return e.instance;e.instance=this,this.environment=n.a.getEnvironmentType()}return e.getInstance=function(){return new e},e.prototype.getOwnerServiceUrl=function(e,t,r){return e===i.a.Default?this.FormApiServiceUrl:e===i.a.Me?this.FormApiServiceUrl+"me/":t&&r?this.FormApiServiceUrl+t+(e===i.a.Group?"/groups/":"/users/")+r+"/":null},e.prototype.createDataProvider=function(e,t,r){if(void 0===e&&(e=i.a.Default),void 0===t&&(t=null),void 0===r&&(r=null),e===i.a.Default)return this.defaultDataProvider||(this.defaultDataProvider=new a.a(this.FormApiServiceUrl,this.FormApiServiceUrl)),this.defaultDataProvider;var n=this.getOwnerServiceUrl(e,t,r);return n&&new a.a(this.FormApiServiceUrl,n)},e.prototype.createImageProvider=function(e,t,r){if(void 0===e&&(e=i.a.Default),void 0===t&&(t=null),void 0===r&&(r=null),e===i.a.Default)return this.currentImageProvider||(this.currentImageProvider=new h(this.FormApiServiceUrl)),this.currentImageProvider;var n=this.getOwnerServiceUrl(e,t,r);return n&&new h(n)},e.prototype.createIntelligenceProvider=function(e,t,r){return new g.a(this.BaseServiceUrl,t,r,e===i.a.Group?"groups":"users")},e.prototype.createRequestInfoProvider=function(e,t,r){return new D.a(this.getOwnerServiceUrl(e,t,r))},e.prototype.createNotificationProvider=function(e,t,r){return this.currentNotificationProvider||(this.currentNotificationProvider=new w(this.createRequestInfoProvider(e,t,r))),this.currentNotificationProvider},Object.defineProperty(e.prototype,"CurrentMathProvider",{get:function(){return this.currentMathProvider||(this.currentMathProvider=I.getInstance(this.FormMathServiceUrl)),this.currentMathProvider},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FormApiServiceUrl",{get:function(){return this.getServiceUrl(e.formApiEndpointPostfix)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FormMathServiceUrl",{get:function(){return this.getServiceUrl(e.formMathApiEndpointPostfix)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CollabDBServiceUrl",{get:function(){var e;return e=n.a.isOsi()?n.a.getEnvironmentType():n.a.getEnvironmentTypeForNonOSI(),n.a.getCollabDBResourceId(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"BaseServiceUrl",{get:function(){if(!n.a.isOsi())return e.apiEndpointInt;var t;switch(this.environment){case"USDoDProd":t=e.apiEndpointUSDoDProd;break;case"USGovProd":t=e.apiEndpointUSGovProd;break;case"USGovGccProd":t=n.a.isMicrosoftDomain()?e.apiEndpointMSProd:e.apiEndpointProd;break;case"WWProd":t=Object(o.c)((function(){return e.apiEndpointProd}),(function(){var e=n.a.getFormsHomeUrl();return"/"!==e[e.length-1]&&(e+="/"),e}));break;case"MSProd":t=e.apiEndpointMSProd;break;case"ProTip":t=e.apiEndpointProTip;break;default:t="https://"+window.location.host+"/"}return t},enumerable:!0,configurable:!0}),e.prototype.getServiceUrl=function(e){return this.BaseServiceUrl+e},e.apiEndpointUSDoDProd="https://forms.osi.apps.mil/",e.apiEndpointUSGovProd="https://forms.osi.office365.us/",e.apiEndpointProd="https://forms.office.com/",e.apiEndpointInt="https://forms.office-int.com/",e.apiEndpointMSProd="https://forms.microsoft.com/",e.apiEndpointProTip="https://tip.forms.office.com/",e.formApiEndpointPostfix="formapi/api/",e.formMathApiEndpointPostfix="formmath/api/",e}();function L(){return A.getInstance().createDataProvider()}function N(e){return A.getInstance().createDataProvider(i.a.Group,OfficeFormServerInfo.userInfo.TenantId,e)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(3),o=function(){function e(){}return e.isValidGuid=function(t){return e.charSetChecker.test(t)&&e.formatChecker.test(t)},e.newGuid=function(){return e.newGuidV4()},e.isNullOrEmpty=function(e){var t=e.match(/[0-9a-fA-F]*/g),r="";return n.map(t,(function(e){return r+=e})),!e||/^[0-]*$/.test(e)},e.newGuidV4=function(){var t=e.getRandomWorkblank();return e.makeV4Format(t)},e.getRandomWorkblank=function(){return[e.random4Hex()+e.random4Hex(),e.random4Hex(),e.random4Hex(),e.random4Hex(),e.random4Hex()+e.random4Hex()+e.random4Hex()].join("-")},e.random4Hex=function(){var t=Math.floor(65536*Math.random()).toString(16);return e.fillPrefixToLength(t,4,"0")},e.makeV4Format=function(t){var r=parseInt(t.charAt(19),16),n=(r=3&r|8).toString(16);return t=e.replaceCharAt(t,14,"4"),t=e.replaceCharAt(t,19,n)},e.replaceCharAt=function(e,t,r){return e.substring(0,t)+r+e.substring(t+1)},e.fillPrefixToLength=function(e,t,r){for(var n=e.length,o=r.length;n<t;n+=o)e=r+e;return e},e.charSetChecker=/^[0-9a-fA-F\-]*$/,e.formatChecker=/^[^\-]{8}(\-[^\-]{4}){4}[^\-]{8}$/,e}()},function(e,t,r){"use strict";r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"f",(function(){return c})),r.d(t,"e",(function(){return u})),r.d(t,"a",(function(){return l}));var n=r(43);function o(e){return d().then((function(){window.location.assign(e)}))}function i(){return s(!1)}function a(){return s(!0)}function s(e){return d().then((function(){window.location.reload(e)}))}function c(e){return d().then((function(){window.location.replace(e)}))}function u(e){return d().then((function(){var t=window.location,r=t.origin+e+t.search+t.hash;window.location.replace(r)}))}function l(e){f.push(e)}function d(){var e=f;f=[];var t=n.a.always,r=$.when.apply($,e.map((function(e){return t(e())})));return f.push((function(){return r})),r}var f=[]},function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n,o,i=r(0),a=r(3),s=r(5),c=r(7),u=r(62),l=r(22),d=function(){return(d=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function f(e){var t,r,f=a.clone(e)||{};switch(f.HTMLAttributes=a.clone(f.HTMLAttributes)||{},e.GlyphButtonStyle){case n.Vertical:case"Vertical":f.HTMLAttributes.className=s.a.combineAttributes(f.HTMLAttributes.className,"glyph-button-control-vertical");break;case n.GlyphOnly:case"GlyphOnly":case n.Horizontal:case"Horizontal":default:f.HTMLAttributes.className=s.a.combineAttributes(f.HTMLAttributes.className,"glyph-button-control-horizontal")}if(!f.HTMLAttributes.title&&e.Text&&(f.HTMLAttributes.title=e.Text),Object(c.e)((function(){!f.HTMLAttributes.id&&e.Id&&(f.HTMLAttributes.id=e.Id+"_button")})),!f.HTMLAttributes["aria-label"]&&e.Text&&(f.HTMLAttributes["aria-label"]=e.Text),e.Icon){var p={HTMLAttributes:{className:e.IconClassName},IconName:e.Icon,key:"icon"};t=i.createElement(l.a,d({},p))}switch(f.ButtonStyle=e.ButtonStyle,"GlyphOnly"!==e.GlyphButtonStyle&&e.GlyphButtonStyle!==n.GlyphOnly&&(r=i.createElement("span",{className:e.TextClassName,key:"text"},e.Text)),e.GlyphLocation){case o.Right:case"Right":f.children=[r,e.children,t];break;case o.Left:default:f.children=[t,r,e.children]}return Object(u.b)(f)}!function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical",e[e.GlyphOnly=2]="GlyphOnly"}(n||(n={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right"}(o||(o={}))},function(e,t,r){"use strict";var n=r(3),o=r(4),i=r(1),a=r(21),s=r(2),c=r(17),u=r(18),l=r(27),d=r(33),f=r(16),p=r(26),m=r(34),h=r(39),g=r(8),y=r(10),b=r(23),v=function(){function e(e,t){this.image=e;var r,n=this.image.Parent;if(n instanceof g.c)r=n;else{if(!(n instanceof y.d||n instanceof h.a))throw"Wrong parent type of ImageInfoMaster.";r=n.Form}var i=r.IsGroupForm?d.a.Group:d.a.Personal;this.dataProvider=b.a.getDataProviderByFormMaster(r),this.imageProvider=p.a.getInstance().createImageProvider(i,r.Model.OwnerTenantId,r.Model.OwnerId);var a=o.a.getFieldSchemaInfo(e.Membership.FieldSchema);this.propertyName=a.Attributes.SourceFieldName||a.Name}return e.prototype.add=function(e){var t=$.Deferred();return window.setTimeout((function(){t.resolve()})),t.promise()},e.prototype.delete=function(e){return Object(u.c)("not supported")},e.prototype.query=function(e){return Object(u.c)("not supported")},e.prototype.update=function(e){var t,r=e.uploadParameters;return r?(r.Delete?t=this.deleteImage():r.ImageFile?t=this.uploadFromImageFile(r.ImageFile):r.Url&&(t=this.createImageFromUrl(r.Url,r.Size)),t?t.then((function(e){var t=n.clone(e);return t.uploadParameters=null,t})):void 0):this.uploadAsComplexType()},e.prototype.uploadAsComplexType=function(){var e=this,t=o.a.convertToSourceData(this.image.getSnapshot(),_.Schema);delete t.uploadParameters;var r,n={};n[this.propertyName]=t;var i=this.image.Parent;if(i instanceof g.c)r=this.dataProvider.updateForm(i.Model.Id,n);else{if(!(i instanceof y.d||i instanceof h.a))return Object(u.c)("not supported");var a=i;r=a.createUploadSyncJob((function(){return e.dataProvider.updateFormQuestion(a.Form.Model.Id,a.Model.Id,a.Model.Type,n)}))}return r.then((function(t){return t&&t[e.propertyName]}))},e.prototype.createImageFromUrl=function(e,t){var r=this,n={SourceUrl:e,Title:l.a.newGuid(),Size:t},o=this.image.Parent;if(o instanceof g.c)return this.dataProvider.createFormImageFromUrl(o.Model.Id,this.propertyName,n);if(o instanceof y.d||o instanceof h.a){var i=o;return i.createUploadSyncJob((function(){return r.dataProvider.createQuestionImageFromUrl(i.Form.Model.Id,i.Model.Id,n)}))}return Object(u.c)("not supported")},e.prototype.uploadFromImageFile=function(e){var t=this,r={ImageBlob:e,ImageName:l.a.newGuid(),ImageType:e.type},n=this.image.Parent;if(n instanceof g.c)return this.imageProvider.uploadFormImage(n.Model.Id,this.propertyName,r);if(n instanceof y.d||n instanceof h.a){var o=n;return o.createUploadSyncJob((function(){return t.imageProvider.uploadQuestionImage(o.Form.Model.Id,o.Model.Id,t.propertyName,r)}))}return Object(u.c)("not supported")},e.prototype.deleteImage=function(){var e,t=this,r=this.image.Parent;if(r instanceof g.c)e=this.imageProvider.deleteFormImage(r.Model.Id,this.propertyName);else{if(!(r instanceof y.d||r instanceof h.a))return Object(u.c)("not supported");var n=r;e=n.createUploadSyncJob((function(){return t.imageProvider.deleteQuestionImage(n.Form.Model.Id,n.Model.Id,t.propertyName)}))}return e.then(null,(function(e){return e&&e.innerCode===f.b.ImageNotFound?(m.a.logData({errorName:"DeleteImageNotFoundError",errorInfo:{imageUrl:t.image.Model.ResourceUrl}}),$.Deferred().resolve().promise()):e})).then((function(){return{altText:null,contentType:null,fileIdentifier:null,height:null,imageFile:null,originalFileName:null,resourceId:null,resourceUrl:null,size:null,width:null}}))},e}(),S=r(55),I=r(38);r.d(t,"c",(function(){return F})),r.d(t,"a",(function(){return O})),r.d(t,"e",(function(){return T})),r.d(t,"d",(function(){return w})),r.d(t,"b",(function(){return _}));var M,F,O,C=(M=function(e,t){return(M=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}M(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),P={AltText:i.a.string({SourceFieldName:"altText"}),ContentType:i.a.string({SourceFieldName:"contentType"}),FileIdentifier:i.a.string({SourceFieldName:"fileIdentifier"}),OriginalFileName:i.a.string({SourceFieldName:"originalFileName"}),ResourceId:i.a.string({SourceFieldName:"resourceId"}),ResourceUrl:i.a.string({SourceFieldName:"resourceUrl"}),Width:i.a.number({SourceFieldName:"width"}),Height:i.a.number({SourceFieldName:"height"}),UploadParameters:i.a.reference({SourceFieldName:"uploadParameters"}),ErrorType:i.a.enumeration((function(){return O}),{IsLocalField:!0}),ResponseError:i.a.reference({IsLocalField:!0}),ImageProcessingStatus:i.a.enumeration((function(){return F}),{IsLocalField:!0}),IsPredefined:i.a.boolean({IsLocalField:!0}),SavingState:i.a.reference({IsLocalField:!0})};function T(e){if(!e)return!1;if(e.ResourceUrl)return!0;var t=e.UploadParameters;return!!t&&!!t.ImageFile}function w(e){return o.a.getObjectMasterFromModel(e)}!function(e){e[e.Idle=0]="Idle",e[e.Picking=1]="Picking",e[e.Uploading=2]="Uploading",e[e.Deleting=3]="Deleting"}(F||(F={})),function(e){e[e.NoError=0]="NoError",e[e.SizeTooLarge=1]="SizeTooLarge",e[e.InvalidType=2]="InvalidType",e[e.BrokenImage=3]="BrokenImage",e[e.ServerError=4]="ServerError",e[e.DeleteFailError=5]="DeleteFailError"}(O||(O={}));var _=function(e){function t(r){var o=this,i=$.Deferred(),a=!r.ExistingInDataSource&&r.InitialData&&!!r.InitialData.ResourceUrl,s=n.clone(r.InitialData);(r=n.clone(r)).InitialData=a?n.extend({},s,{ImageProcessingStatus:F.Uploading}):n.extend({},s,t.getDefaultClientFieldValues());var c=new S.a;c.setMaxRetryTimesForUpdate(0),o=e.call(this,r,{Scheduler:c,MasterReady:i.promise()})||this,Object(I.b)(o);var u=o.Synchronizer;return u.observe((function(e){var t;n.contains(e.FieldSchemas,u.Schema.CreationError)?t=u.Model.CreationError:n.contains(e.FieldSchemas,u.Schema.UpdateError)&&(t=u.Model.UpdateError),t&&o.bulkEdit((function(){o.Model.ResponseError=t;var e=o.Model.UploadParameters;e&&e.Delete?o.Model.ErrorType=O.DeleteFailError:o.Model.ErrorType=O.ServerError}))}),[u.Schema.CreationError,u.Schema.UpdateError]),o.addRule({InterestedFields:[o.Schema.ResourceId],Name:"ResetErrorStatus",onChange:function(e){!e.BeingDeleted&&o.Model.ResourceId&&o.resetStatus(F.Idle)}}),i.resolve(),a&&o.Synchronizer.existingInDataSource().done((function(){return o.duplicateFrom(s)})),o}return C(t,e),Object.defineProperty(t.prototype,"SettingsMaster",{get:function(){return this.settingsMaster},set:function(e){this.settingsMaster=e},enumerable:!0,configurable:!0}),t.prototype.addImage=function(e){var t,r=this;if(e.File)t=function(){return r.addImageFromFile(e.File,a.a.ImageMaxWidth,a.a.ImageMaxHeight)};else{if(!e.FromUrl)throw Error("Invalid picked image result.");t=function(){return r.addImageFromUrl(e.FromUrl.Url,e.FromUrl.Size,e.FromUrl.Width,e.FromUrl.Height)}}return this.Model.ImageProcessingStatus=F.Picking,this.Synchronizer.existingInDataSource().then(t).done((function(){r.Model.AltText=null}))},t.prototype.getImageErrorMessage=function(){switch(this.Model.ErrorType){case O.NoError:return null;case O.SizeTooLarge:return s.a.LocalizedStrings.Error_Message_5208;case O.InvalidType:return s.a.LocalizedStrings.Error_Message_5209;case O.BrokenImage:return s.a.LocalizedStrings.ImagePicker_Broken_Image;case O.ServerError:return this.getReponseErrorMessage();case O.DeleteFailError:return s.a.LocalizedStrings.Image_Delete_Fail}},t.prototype.clear=function(){var e=this,r=this.Model;return r.ResourceUrl?r.IsPredefined?(this.setData({AltText:null,ContentType:null,FileIdentifier:null,OriginalFileName:null,ResourceId:null,ResourceUrl:null,IsPredefined:!1,UploadParameters:null,ErrorType:O.NoError,ResponseError:null,ImageProcessingStatus:F.Idle,Width:null,Height:null}),$.Deferred().resolve().promise()):(this.bulkEdit((function(){r.ImageProcessingStatus=F.Deleting,r.UploadParameters={Delete:!0}})),this.flushUpload((function(){return e.setData(t.getDefaultClientFieldValues())}))):$.Deferred().resolve().promise()},t.prototype.updateSettings=function(e,t){this.SettingsMaster&&this.SettingsMaster.updateWith(this.Model,e,t)},t.prototype.duplicateFrom=function(e){var t=this;if(this.Model.ResourceUrl){var r=e.AltText,o=this.SettingsMaster,i={};o&&(i=n.clone(o.getSnapshot())),this.Synchronizer.existingInDataSource().then((function(){return t.addImageFromUrl(e.ResourceUrl,0,i?i.NaturalWidth:a.a.ImageMaxWidth,i?i.NaturalHeight:a.a.ImageMaxHeight)})).done((function(){t.Model.AltText=r,o&&(delete i.TargetResourceId,delete i.NaturalHeight,delete i.NaturalWidth,o.setData(i))}))}},t.prototype.addImageFromUrl=function(e,r,n,o){var i=this;c.a.logData({name:"DesignPage.ImageLayout.ImageSize",extraData:{width:n,height:o}});var a=this.Model;return this.bulkEdit((function(){var s=t.getLimitedSize(n,o,800,600);return a.ErrorType=i.validateImage(r),a.ErrorType!==O.NoError?$.Deferred().reject(a.ErrorType).promise():(i.resetStatus(F.Picking),a.UploadParameters={Url:e,Size:r},i.flushUpload(void 0,s.width,s.height))}))},t.prototype.addImageFromFile=function(e,t,r){var n=this,o=this.Model;return this.bulkEdit((function(){var t=n.validateImage(e.size,e.type);return t===O.NoError?(n.resetStatus(F.Uploading),o.UploadParameters={ImageFile:e},n.flushUpload()):(o.ErrorType=t,o.ImageProcessingStatus=F.Idle,$.Deferred().reject(o.ErrorType))}))},t.prototype.flushUpload=function(e,t,r){var n=this;return this.Synchronizer.flush().always((function(){return n.Model.ImageProcessingStatus=F.Idle})).then(e).then((function(){return n.updateSettings(t,r)})).fail((function(e){n.resetToDefault()}))},t.getLimitedSize=function(e,t,r,n){if(e>r||t>n){var o=Math.min(n/t,r/e);e*=o,t*=o}return{width:e,height:t}},t.prototype.validateImage=function(e,t,r,n){var o=O.NoError;return e>a.a.ImageMaxSize&&(o=O.SizeTooLarge),t&&$.inArray(t,a.a.ImageSupportMimeType)<0&&(o=O.InvalidType),o},t.prototype.resetToDefault=function(){this.setData(t.getDefaultClientFieldValues(),o.a.getSubFieldSchemas(t.Schema)),this.updateSettings()},t.getDefaultClientFieldValues=function(){return{UploadParameters:null,ErrorType:O.NoError,ResponseError:null,ImageProcessingStatus:F.Idle,Width:null,Height:null}},t.prototype.resetStatus=function(e){var t=this.Model;this.bulkEdit((function(){t.ErrorType=O.NoError,t.ResponseError=void 0,t.ImageProcessingStatus=e}))},t.prototype.getReponseErrorMessage=function(){var e=this.Model,t=e.ResponseError&&e.ResponseError.innerCode;return s.a.LocalizedStrings["Error_Message_"+t]||s.a.LocalizedStrings.Image_Upload_Fail},t}(o.a.createObjectMasterClass("ImageInfoMaster",P,(function(e,t){return new v(e,t)})))},function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return d}));var n,o=r(0),i=r(3),a=r(62),s=r(12),c=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),u=function(){return(u=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buttonRef=o.createRef(),t}return c(t,e),t.prototype.render=function(){var e;return(e=i.clone(this.props)||{}).children=this.props.Text,e.ref=this.buttonRef,!(e.HTMLAttributes&&e.HTMLAttributes.title)&&this.props.Text&&(e.HTMLAttributes=i.clone(e.HTMLAttributes)||{},e.HTMLAttributes.title=this.props.Text),o.createElement(a.a,u({},e))},t.prototype.focus=function(){this.buttonRef.current&&this.buttonRef.current.focus()},t}(s.a);function d(e){return o.createElement(l,u({},e))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return M})),r.d(t,"b",(function(){return F})),r.d(t,"c",(function(){return O}));var n,o=r(3),i=r(74),a=r(11),s=r(24),c=r(103),u=r(45),l=r(54),d=r(5),f=r(28),p=r(13),m=r(6),h=r(7),g=r(17),y=r(56),b=r(40),v=r(16),S=r(67),I=r(46),M=function(){function e(){}return e.parseAndTryHandleError=function(t){var r=e.convertToResponseError(t);return e.tryHandleRequireLogin(r)?$.Deferred().promise():r},e.tryHandleRequireLogin=function(t){return t.statusCode===v.a.Unauthorized&&!s.a.IsPPTIntegration&&(e.logNonRecoverableError(t),d.a.getQueries().embed?(t.innerCode=v.b.EmbedFormNeedAuth,!1):(t.innerCode===v.b.NoPermission||t.innerCode===v.b.RequireLogin)&&(Object(p.C)()&&Object(p.s)()&&Object(p.l)()?(t.innerCode=v.b.LoginNotSupportInCurrentBrowser,!1):(Object(m.a)().AuthContext.signIn().then((function(){return Object(f.b)()})),!0)))},e.logNonRecoverableError=function(e){if(e){var t=void 0;switch(e.innerCode){case v.b.UserNotAllowed:t="Auth.NotOnboardedTenant";break;case v.b.DisabledByTenantAdmin:t="Auth.DisabledByTenantAdmin";break;case v.b.UserNeedMultiFactorAuth:t="Auth.UserNeedMultiFactorAuth"}t&&g.a.logData({name:t,extraData:{tenantId:OfficeFormServerInfo.userInfo.TenantId}})}},e.parseResponseDataValue=function(t){return e.convertToAsyncResult(t).value},e.convertToAsyncResult=function(e){var t={status:0};if(null==e)t.value=e;else{var r=e["@odata.count"]&&parseInt(e["@odata.count"]);isNaN(r)||(t.count=r),t.value=Object(p.I)(void 0===e.value?e:e.value)}return t},e.convertToResponseError=function(e){var t={statusCode:e&&e.response&&e.response.statusCode,statusText:e&&e.response&&e.response.statusText,headers:e&&e.response&&e.response.headers,correlationId:e&&e.response&&e.response.headers&&d.a.getHeaderIgnoreCase(e.response.headers,"X-CorrelationId")},r=e&&e.response&&Object(p.I)(e.response.body),n=r.error&&parseInt(r.error.code);return isNaN(n)?t.innerCode=0===t.statusCode?v.b.NetworkIssue:void 0:t.innerCode=n,t.innerMessage=r.error&&r.error.message,t.type=r.error&&r.error["@ms.form.error.type"],Object(m.a)().Flighting.isEnabled("FormCustomizedMessage")&&(t.customizedMessage=r.error&&r.error["@ms.form.error.customizedMessage"]),t.isServerError=!0,t},e}();function F(e,t){t=t||{};var r,d,p=$.Deferred();(t.disableLog||(r=new y.a(e.qosEventName),o.extend(r.Data,{extraData:o.clone(e.qosExtraData)}),r.start(),e.headers["X-CorrelationId"]=r.CorrelationId,e.headers["X-UserSessionId"]=Object(b.d)()),t.disableXMsHeader)||(e.headers["x-ms-form-request-source"]=function(){var e="ms-formweb";if(s.a.IsIntegration){var t=s.a.GetHostString();t&&(e="ms-"+t.toLowerCase()),OfficeFormServerInfo.isOembedSPO&&(e="forms-webpart")}return e}(),Object(h.e)((function(){e.qosExtraData&&e.qosExtraData.FormType&&(d=e.qosExtraData.FormType),e.requestUri&&-1!=e.requestUri.indexOf("linkedBrData")&&(e.headers["x-ms-form-deleted"]=1)})),function(e){if(Object(h.e)((function(){n="Form"!=e&&"Quiz"!=e?$.Deferred().resolve("formspro").promise():null})),!n){if(Object(m.a)().Flighting.isEnabled("LeverageServerRingLogic")&&OfficeFormServerInfo.ring&&!a.a.isSovereignProd())return $.Deferred().resolve(OfficeFormServerInfo.ring.toLowerCase()).promise();n="USGovGccProd"===a.a.getEnvironmentType()?$.Deferred().resolve("gcc").promise():I.a.isMsaUser()||Object(u.c)()?$.Deferred().resolve("msa").promise():I.a.isMsftUser()||Object(u.d)()?$.Deferred().resolve("msft").promise():I.a.isFastFoodTenant()||Object(u.e)()?$.Deferred().resolve("fastfood").promise():$.Deferred().resolve("business").promise()}return n}(d).done((function(t){e.headers["x-ms-form-request-ring"]=t})));var g=-1,F=Object(c.a)("DatabaseUnavailableRetryTimes")||100,C=function(){g++,function(e,t,r,n){void 0===n&&(n=!1);e.blobResponseType?function(e,t,r){var n=new XMLHttpRequest,o=e.requestUri;if(n.onreadystatechange=function(){if(null!=n&&4===n.readyState){var i=n.status,a=n.statusText;1223===i&&(i=204,a="No Content");var s=n.response;if(i>=200&&i<=299)n=null,t(s);else{var c=function(e){for(var t={},r=0,n=e.getAllResponseHeaders().split(/\r?\n/);r<n.length;r++){var o=n[r];if(o){var i=o.split(": ");t[i[0]]=i[1]}}return t}(n);n=null,r({message:"HTTP request failed",request:e,response:{requestUri:o,statusCode:i,statusText:a,headers:c,body:s}})}}},n.open(e.method||"GET",o,!0),n.responseType="blob",e.headers)for(var i in e.headers)n.setRequestHeader(i,e.headers[i]);n.send(e.body)}(e,t,n?r:o):odatajs.oData.request(e,t,n?r:o);function o(n){Object(i.c)(n)?Object(m.a)().AuthContext.refreshToken().done((function(){Object(l.i)((function(){e.headers.__RequestVerificationToken=OfficeFormServerInfo.antiForgeryToken,function(){var e=$.Deferred();if(OfficeFormServerInfo.userInfo.UserId)return e.resolve().promise();return Object(l.k)((function(){return e.resolve()}),(function(){return e.resolve()})),e.promise()}().always((function(){return odatajs.oData.request(e,t,r)}))}),(function(){return Object(f.d)()}))})):r(n)}}(e,(function(e){p.resolve(e)}),(function(t){var n,o=O(e.requestUri.toString(),t),i=parseInt(o.statusCode),a=o.innerCode,s=!1,c=0;0===i||i===v.a.BadGateway||i===v.a.ServiceUnavailable?(n="Forms_Http_"+i,s=g<2):a===v.b.CdbServiceUnavailable||a===v.b.CDBUserDataNotFound||a===v.b.DatabaseTransientError?(n="CDB_Http_"+a,s=g<2):a!==v.b.DatabaseReadOnly&&a!==v.b.DatabaseUnavailable||(Object(m.a)().RetryingRecoverableError=!0,n="CDB_Http_"+a,s=g<F,c=Math.min(1e3*Math.pow(2,g)*(.8+.4*Math.random()),6e4)),s?(r&&r.log({resultCode:n,extraData:{RetryCount:g,ServiceError:o}}),setTimeout(C,c)):p.reject(t)}),t.skipExpiredTokenCheck)};return C(),r?p.promise().done((function(t){var n={};if(n.resultCode=t&&t.response?t.response.statusCode:"",n.resultType="Success","Form.Create"===e.qosEventName){var i=M.parseResponseDataValue(t);n.extraData={FormId:i.id,XLWorkbookId:i.xlWorkbookId||void 0,Origin:Object(b.e)()||void 0,RetryCount:g||void 0},o.extend(n.extraData,e.qosExtraData)}r.end(n)})).fail((function(t){var n=O(e.requestUri.toString(),t);r.end({resultCode:t&&t.response?t.response.statusCode:"",resultType:Object(S.b)(n)?"ExpectedFailure":"Failure",extraData:{ServiceError:n,RetryCount:g||void 0}})})):p.promise()}function O(e,t){var r=M.convertToResponseError(t);return{statusCode:t&&t.response?t.response.statusCode:"",sourceUrl:e,correlationId:t&&t.response?d.a.getHeaderIgnoreCase(t.response.headers,"X-CorrelationId"):"",statusText:t&&t.response?t.response.statusText:"",innerCode:r?r.innerCode:-1,innerMessage:r?r.innerMessage:"",failureReason:t&&t.response?d.a.getHeaderIgnoreCase(t.response.headers,"X-FailureReason"):"",failureType:r?r.type:void 0}}},function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e[e.Default=1]="Default",e[e.Personal=2]="Personal",e[e.Group=3]="Group",e[e.Me=4]="Me"}(n||(n={}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(18),o=r(9),i=function(){function e(){}return e.logData=function(e){Object(o.a)({eventName:e.errorName,eventType:"error_event",extraData:e.errorInfo})},e}();"undefined"!=typeof Nerve&&Object(n.b)((function(e){i.logData({errorInfo:e,errorName:"ModelError"})}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){function e(){}return Object.defineProperty(e,"DefaultStorage",{get:function(){return e.defaultStorage||(e.defaultStorage=e.LocalStorage,e.defaultStorage instanceof o&&(e.defaultStorage=e.SessionStorage)),e.defaultStorage},enumerable:!0,configurable:!0}),Object.defineProperty(e,"LocalStorage",{get:function(){return e.localStorage||(e.supportsLocalStorage()?e.localStorage=window.localStorage:e.localStorage=e.NoStorage),e.localStorage},enumerable:!0,configurable:!0}),Object.defineProperty(e,"SessionStorage",{get:function(){return e.sessionStorage||(e.supportsSessionStorage()?e.sessionStorage=window.sessionStorage:e.sessionStorage=e.NoStorage),e.sessionStorage},enumerable:!0,configurable:!0}),Object.defineProperty(e,"NoStorage",{get:function(){return e.noStorage||(e.noStorage=new o),e.noStorage},enumerable:!0,configurable:!0}),e.supportsLocalStorage=function(){if(null==e.localStorageSupported)try{var t="officeforms.__storage_test__";localStorage.setItem(t,t),localStorage.removeItem(t),e.localStorageSupported=!0}catch(t){e.localStorageSupported=!1}return e.localStorageSupported},e.supportsSessionStorage=function(){if(null==e.sessionStorageSupported)try{var t="officeforms.__storage_test__";sessionStorage.setItem(t,t),sessionStorage.removeItem(t),e.sessionStorageSupported=!0}catch(t){e.sessionStorageSupported=!1}return e.sessionStorageSupported},e}(),o=function(){function e(){}return e.prototype.clear=function(){},e.prototype.getItem=function(e){},e.prototype.key=function(e){return null},e.prototype.removeItem=function(e){},e.prototype.setItem=function(e,t){},e}()},function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return o}));function n(e,t,r,n){var o={};return o.t=n?"g":"u",function(e,t,r,n){var o=i(e),s=i(t);n&&0!==Object.keys(n).length&&Object.keys(n).forEach((function(e){r+="$%@#"+e+"="+n[e]}));var c=3-(32+r.length)%3;c=c<3?c:0;var u=a((d=r,f=r.length+c,p=".",r=d+Array(f-d.length+1).join(p||" "))),l=o.concat(s,u);var d,f,p;return window.btoa(String.fromCharCode.apply(String,l)).replace(/\//g,"_").replace(/\+/g,"-")}(e,t,r,o)}function o(e){var t=function(e){try{e=e.replace(/_/g,"/").replace(/-/g,"+");var t=(d=e,a(window.atob(d.replace(/ /g,"")))),r=s(t.slice(0,16)),n=s(t.slice(16,32)),o=function(e,t){if(null==e||0===e.length)return e;var r=e.length;for(;--r>=0&&!(t.indexOf(e.charAt(r))<0););return e.substr(0,r+1)}(function(e){for(var t="",r=0;r<e.length;++r)t+=String.fromCharCode(e[r]);return t}(t.slice(32)),"."),i={},c=o.split("$%@#");if(c.length>1){o=c[0];for(var u=1;u<c.length;u++){var l=c[u].split("=");l&&2===l.length&&(i[l[0]]=l[1])}}return{OrgId:r,OwnerId:n,TableId:o,MoreInfo:i}}catch(e){return{OrgId:null,OwnerId:null,TableId:null,MoreInfo:null}}var d}(e),r=!1;return t.MoreInfo&&"g"===t.MoreInfo.t&&(r=!0),{OrgId:t.OrgId,OwnerId:t.OwnerId,TableId:t.TableId,IsGroupOwner:r}}function i(e){var t=[];return e.split("-").forEach((function(e,r){var n=e.match(/.{2}/g);r<3&&(n=n.reverse()),n.forEach((function(e){t.push(parseInt(e,16))}))})),t}function a(e){return e.split("").map((function(e){return e.charCodeAt(0)}))}function s(e){if(16!==e.length)return null;var t=function(e){for(var t="",r="",n=0;n<e.length;n++)r=1===(r=e[n].toString(16)).length?"0"+r:r,t+=r;return t}([].concat(e.slice(0,4).reverse(),e.slice(4,6).reverse(),e.slice(6,8).reverse(),e.slice(8)));return t=t.slice(0,8)+"-"+t.slice(8,12)+"-"+t.slice(12,16)+"-"+t.slice(16,20)+"-"+t.slice(20)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"c",(function(){return g})),r.d(t,"d",(function(){return y})),r.d(t,"b",(function(){return b}));var n,o,i=r(0),a=r(20),s=r(3),c=r(21),u=r(5),l=r(7),d=r(17),f=r(12),p=r(101),m=r(108),h=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function g(e){return i.createElement(v,e)}function y(e,t,r,n){return Object(l.c)((function(){return g(e)}),(function(){return l.a.createTextFieldWithCKEditor(e,t,r,n)}))}function b(e,t,r,n,o){return void 0===r&&(r=null),void 0===n&&(n=!0),t?y(e,r,o,n):g(e)}!function(e){e[e.SingleLine=0]="SingleLine",e[e.FixHeightMultiline=1]="FixHeightMultiline",e[e.AutoHeightMultiline=2]="AutoHeightMultiline"}(o||(o={}));var v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.textFieldRef=i.createRef(),t}return h(t,e),t.prototype.componentDidMount=function(){this.props.AutoFocus&&this.focus()},t.prototype.focus=function(){this.textFieldRef.current&&this.textFieldRef.current.focus()},t.prototype.createReactNodes=function(){return[this.createLabel(),this.createValueContainer()]},t.prototype.createLabel=function(){var e=this.props,t=e.Options;if(e.Label||e.ShowRequiredStar)return i.createElement("div",null,i.createElement("span",{className:t&&t.classNameForInnerLabel},e.Label),e.ShowRequiredStar?i.createElement(m.a):void 0)},t.prototype.createValueContainer=function(){var e,r,n,s,l=this,d=this.props,f=d.Options,p="DesignPage.ShortCut.Clipboard",m=u.a.mergeReactProps(f&&f.HTMLPropsForInnerElement,{value:d.Value||"",className:"office-form-textfield-input form-control border-no-radius",placeholder:d.Placeholder,ref:this.textFieldRef,style:{height:d.MinimalHeight+"px",overflowY:d.TextFieldType===o.FixHeightMultiline?"auto":void 0},spellCheck:!0,disabled:d.Disabled,onChange:this.onChange.bind(this),maxLength:d.MaxLength?d.MaxLength:c.a.DefaultTextLength,onFocus:d.AutoSelection?function(){if(l.textFieldRef.current){var e=a.findDOMNode(l.textFieldRef.current);e&&e.select()}}:void 0,onKeyDown:u.a.onKeyboardEvent((function(e){if(e.ctrlKey){var r=new Date,n=String.fromCharCode(e.keyCode),o="Ctrl+"+n;switch(n){case"C":case"X":l.duration(t.prevTimeKeyDown,r.getTime())>t.minDuration&&l.logEngagementEvent(e,p,o),t.prevTimeKeyDown=r.getTime();break;case"V":l.logEngagementEvent(e,p,o);break;case"Y":case"Z":l.logEngagementEvent(e,"DesignPage.ShortCut.UndoRedo",o)}}})),onCopy:function(e){var r=new Date;l.duration(t.prevTimeOnCopy,r.getTime())>t.minDuration&&l.logEngagementEvent(e,p,"onCopy"),t.prevTimeOnCopy=r.getTime()},onPaste:function(e){l.logEngagementEvent(e,p,"onPaste")},onCut:function(e){var r=new Date;l.duration(t.prevTimeOnCut,r.getTime())>t.minDuration&&l.logEngagementEvent(e,p,"onCut"),t.prevTimeOnCut=r.getTime()}});switch(d.TextFieldType){case o.AutoHeightMultiline:var h=m,g=null==d.MinimalHeight?80:d.MinimalHeight>0?d.MinimalHeight:0;h.MinHeight=g.toString()+"px",e=function(e){return i.createElement(S,e)}(h);break;case o.FixHeightMultiline:r=i.createElement("textarea",m);break;case o.SingleLine:default:n=i.createElement("input",m)}if(d.ShowCharCounter){var y=!d.Value||m.maxLength>d.Value.length?"office-form-textfield-counter":"office-form-textfield-counter textfield-counter-warning";s=i.createElement("label",{className:y},this.getCounterString(d.Value,m.maxLength))}var b=u.a.combineAttributes("office-form-textfield",d.Options&&d.Options.classNameForInnerDiv);return i.createElement("div",{className:b},e,r,n,s)},t.prototype.onChange=function(e){if(!this.props.Disabled){var t=e.target,r=t.value;if(r&&r.length>t.maxLength&&(r=r.slice(0,t.maxLength)),this.props.onValueChange(r),this.props.ShowCharCounter){var n=a.findDOMNode(t).nextSibling;n&&(n.innerText=this.getCounterString(r,t.maxLength))}}},t.prototype.getCounterString=function(e,t){return(e||"").length.toString()+" / "+t.toString()},t.prototype.logEngagementEvent=function(e,t,r){var n;this.props.HTMLAttributes&&(n=this.props.HTMLAttributes.className),d.a.logData({name:t,extraData:{targetClassName:n,operation:r}})},t.prototype.duration=function(e,t){return t-e},t.prevTimeKeyDown=0,t.prevTimeOnCopy=0,t.prevTimeOnCut=0,t.minDuration=500,t}(p.a);var S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.textFieldRef=i.createRef(),t}return h(t,e),t.prototype.componentDidMount=function(){this.updateHeight(),this.windowResizeCallback=this.updateHeight.bind(this),window.addEventListener("resize",this.windowResizeCallback)},t.prototype.componentDidUpdate=function(){this.updateHeight()},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.windowResizeCallback)},t.prototype.focus=function(){this.textFieldRef.current&&this.textFieldRef.current.focus()},t.prototype.render=function(){var e=s.clone(this.props);return e.ref=this.textFieldRef,delete e.MinHeight,i.createElement("textarea",e)},t.prototype.updateHeight=function(){var e=a.findDOMNode(this),t=this.props,r=e.parentElement,n=r.style.height;r.style.height=window.getComputedStyle(r).height,e.style.height=t.MinHeight;var o=e.offsetHeight-e.clientHeight;e.style.height=e.scrollHeight+o+"px",r.style.height=n,e.style.minHeight=t.MinHeight},t}(f.a)},function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return a})),r.d(t,"a",(function(){return s}));var n=r(3),o=r(4);function i(e){var t=e.Synchronizer;t.observe((function(){return c(e)}),[t.Schema.CreationFailed,t.Schema.CreationInProcess,t.Schema.CreationScheduled,t.Schema.UpdateFailed,t.Schema.UpdateInProcess,t.Schema.UpdateScheduled]),c(e)}function a(e,t,r){var i=o.a.convertToArray(e.Model).map(o.a.getObjectMasterFromModel);function a(){var e=i.map((function(e){return e.getModelByFieldSchema(t)}));r(s(e))}a(),e.observe((function(e){e.AddedModels.length&&(i=i.concat(e.AddedModels.map(o.a.getObjectMasterFromModel))),e.RemovedModels.length&&e.RemovedModels.map(o.a.getObjectMasterFromModel).forEach((function(e){e.Synchronizer.deletedFromDataSource().done((function(){i=n.without(i,e),a()}))})),a()}),[t])}function s(e){return n.contains(e,"Saving")?"Saving":n.contains(e,"Scheduled")?"Scheduled":n.contains(e,"Failed")?"Failed":"Idle"}function c(e){var t=e.Synchronizer.Model;t.CreationInProcess||t.UpdateInProcess?e.Model.SavingState="Saving":t.CreationScheduled||t.UpdateScheduled?e.Model.SavingState="Scheduled":t.CreationFailed||t.UpdateFailed?e.Model.SavingState="Failed":e.Model.SavingState="Idle"}},function(e,t,r){"use strict";var n=r(3),o=r(4),i=r(1),a=r(2),s=r(43),c=r(64),u=r(6),l=r(9),d=r(93),f=r(55),p=r(30),m=r(42),h=r(16),g=r(23),y=r(8),b=function(){function e(e,t){this.element=e,this.dataProvider=g.a.getDataProviderByFormMaster(this.element.Form)}return Object.defineProperty(e.prototype,"FormId",{get:function(){return this.element.Form.Model.Id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ElementId",{get:function(){return this.element.Model.Id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ElementType",{get:function(){return this.element.Model.Type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ExtraQosData",{get:function(){var e=this.element.Form;return{WithSection:e.isFieldReady(e.Schema.DescriptiveElements)&&!!e.FormElementManager.SectionMasters.length}},enumerable:!0,configurable:!0}),e.prototype.add=function(e){var t=this;if(this.element.Form.SyncContext!==y.e.DesignTimeForm)throw Error("Trying to create an element without design type.");return this.element.createSyncJob((function(){return t.dataProvider.createFormDescriptiveElement(t.FormId,e,t.ExtraQosData)}))},e.prototype.delete=function(e){var t=this;if(!e||!e.id)throw Error("Trying to delete an empty element.");if(this.element.Form.SyncContext!==y.e.DesignTimeForm)throw Error("Trying to delete an element without design type.");return $.when(this.element.createSyncJob((function(){return t.dataProvider.deleteFormDescriptiveElement(t.FormId,e.id||"",t.ElementType,t.ExtraQosData)}))).then(null,(function(e){return e&&e.innerCode===h.b.CDBColumnNotFound?$.Deferred().resolve().promise():e}))},e.prototype.query=function(e){throw Error("No scenario to call this method currently.")},e.prototype.update=function(e,t){var r=this;return this.element.Form.SyncContext!==y.e.DesignTimeForm?$.Deferred().resolve().promise():this.element.createUploadSyncJob((function(){return r.dataProvider.updateFormDescriptiveElement(r.FormId,r.ElementId,r.ElementType,e,r.ExtraQosData)}))},e}(),v=r(81),S=r(82),I=r(15),M=r(38);r.d(t,"c",(function(){return P})),r.d(t,"b",(function(){return T})),r.d(t,"a",(function(){return w}));var F,O=(F=function(e,t){return(F=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}F(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),C={BranchInfo:i.a.fromMasterClass((function(){return d.a}),{IsLocalField:!0}),CoAuthors:i.a.collectionOf(i.a.reference(),{IsLocalField:!0}),FileUploadSPOInfo:i.a.create({driveId:i.a.string(),errorCode:i.a.string(),folderId:i.a.string()},{SourceFieldName:"fileUploadSPOInfo"}),FormsProRTQuestionTitle:i.a.string({SourceFieldName:"formsProRTQuestionTitle"}),FormsProRTSubtitle:i.a.string({SourceFieldName:"formsProRTSubtitle"}),Id:i.a.string({IsKeyField:!0,SourceFieldName:"id"}),ImageInfo:i.a.fromMasterClass((function(){return p.b}),{SourceFieldName:"image"}),ImageSettings:i.a.fromMasterClass((function(){return m.b}),{IsLocalField:!0}),IntegratedSavingState:i.a.reference({IsLocalField:!0}),Order:i.a.number({SourceFieldName:"order"}),QuestionInfo:i.a.string({SourceFieldName:"questionInfo"}),SavingState:i.a.reference({IsLocalField:!0}),ShowSubtitle:i.a.boolean({IsLocalField:!0}),Subtitle:i.a.string({SourceFieldName:"subtitle"}),Title:i.a.string({SourceFieldName:"title"}),Type:i.a.reference({SourceFieldName:"type"}),VideoInfo:i.a.create({Author:i.a.string(),OriginalHeight:i.a.number(),OriginalWidth:i.a.number(),ShowWarningBar:i.a.boolean(),Thumbnail_url:i.a.string(),Title:i.a.string(),Url:i.a.string()},{IsLocalField:!0})};function P(e){return o.a.getObjectMasterFromModel(e)}function T(){return{Title:a.a.LocalizedStrings.DesciptiveElementType_Section_DefaultTitle,Type:I.a.Section}}var w=function(e){function t(r){var o=this,i=$.Deferred();if(!r.InitialData)throw Error("Element model should created with initial data.");return(r=n.clone(r)).InitialData=n.clone(r.InitialData),r.InitialData.FormsProRTQuestionTitle||(r.InitialData.FormsProRTQuestionTitle=null),r.InitialData.FormsProRTSubtitle||(r.InitialData.FormsProRTSubtitle=null),o=e.call(this,r,{MasterReady:i.promise(),Scheduler:new f.a})||this,Object(M.b)(o),o.updateIntegratedSavingState(),o.initializeQuestionInfoBinder(r),Object(m.d)(o,t.Schema.ImageInfo,t.Schema.ImageSettings),t.Rules.forEach((function(e){return o.addRule(e)})),o.coAuthorTimers={},i.resolve(),o}return O(t,e),t.supportMobileDesign=function(e){return!1},Object.defineProperty(t.prototype,"Form",{get:function(){return this.Parent.Parent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ImageInfoMaster",{get:function(){return Object(p.d)(this.Model.ImageInfo)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ImageSettingsMaster",{get:function(){return Object(m.e)(this.Model.ImageSettings)},enumerable:!0,configurable:!0}),t.prototype.isFieldReady=function(r){return r=t.getSourceFields([r])[0],e.prototype.isFieldReady.call(this,r)},t.prototype.ensureFieldsReady=function(r){return e.prototype.ensureFieldsReady.call(this,t.getSourceFields(r))},t.prototype.fieldsReady=function(r){return e.prototype.fieldsReady.call(this,t.getSourceFields(r))},t.prototype.ensureCreationDone=function(){var e=this;return this.ImageInfoMaster.Synchronizer.flush().then((function(){return e.Synchronizer.flush()}))},t.prototype.setVideoUrl=function(e,r){var n=this.Model.VideoInfo;o.a.getObjectMasterFromModel(n).bulkEdit((function(){n.Url=c.a.generateEmbedURLLocally(e),n.Title="",n.Author="",n.Thumbnail_url="",n.OriginalWidth=t.defaultWidth,n.OriginalHeight=t.defaultHeight,n.ShowWarningBar=r&&c.a.isStreamUrl(e)}))},t.prototype.hasValidVideoUrl=function(){return Object(u.a)().Flighting.isEnabled("SupportStreamVideo")?this.videoUrlExist()&&c.a.isValidVideoUrl(this.Model.VideoInfo.Url):this.videoUrlExist()&&c.a.isYouTubeUrl(this.Model.VideoInfo.Url)},t.prototype.clearVideoInfo=function(){this.Model.VideoInfo={Author:"",OriginalHeight:t.defaultHeight,OriginalWidth:t.defaultWidth,ShowWarningBar:!1,Thumbnail_url:"",Title:"",Url:""}},t.prototype.resetBranchInfo=function(){t.getBranchInfoMaster(this.Model.BranchInfo).resetToDefault()},t.prototype.createSyncJob=function(e){var t=this,r=$.Deferred(),n=r.promise().then((function(){return t.Form.getQuestionSyncBlocker(n)})).then(e);return r.resolve(),n},t.prototype.createUploadSyncJob=function(e){var t=this,r=$.Deferred(),n=$.when(r,this.uploadJob).then((function(){return t.createSyncJob(e)}));return r.resolve(),this.uploadJob=s.a.always(n),n},t.prototype.updateCoAuthors=function(e){var t=this,r=n.filter(this.Model.CoAuthors,(function(t){return e.userId===t.userId}))[0],i=function(){r&&a.deleteItems([r]),e.userId in t.coAuthorTimers&&(clearTimeout(t.coAuthorTimers[e.userId]),delete t.coAuthorTimers[e.userId])},a=o.a.getCollectionMasterFromModel(this.Model.CoAuthors);a.bulkEdit((function(){i(),r=o.a.Collection.addItems(t.Model.CoAuthors,[e])[0]}));this.coAuthorTimers[e.userId]=window.setTimeout(i,1e4)},t.prototype.hasSectionBranching=function(){return t.getBranchInfoMaster(this.Model.BranchInfo).hasSectionBranching()},t.getBranchInfoMaster=function(e){return o.a.getObjectMasterFromModel(e)},t.prototype.initializeQuestionInfoBinder=function(e){this.questionInfoBinder=new v.a(this,t.Schema.QuestionInfo,t.QuestionInfoFieldSet),e.InitialData&&this.isFieldReady(t.Schema.QuestionInfo)&&(e.ExistingInDataSource||e.InitialData.QuestionInfo?this.questionInfoBinder.deserialize():this.questionInfoBinder.serialize())},t.prototype.updateIntegratedSavingState=function(){this.isFieldReady(t.Schema.ImageInfo)?this.Model.IntegratedSavingState=Object(M.a)([this.Model.ImageInfo.SavingState,this.Model.SavingState]):this.Model.IntegratedSavingState=this.Model.SavingState},t.prototype.videoUrlExist=function(){return this.Model.VideoInfo&&this.Model.VideoInfo.Url},Object.defineProperty(t,"QuestionInfoFieldSet",{get:function(){return t.questionInfoFieldSet||(t.questionInfoFieldSet=new S.a([t.Schema.BranchInfo,t.Schema.ImageSettings,t.Schema.ShowSubtitle,t.Schema.VideoInfo])),t.questionInfoFieldSet},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Rules",{get:function(){if(!t.rules){var e=t.Schema;t.rules=[{InterestedFields:[e.Id],Name:"block id changes",onChange:function(e){var t,r=e.Master.Model,n=r.Id,o=e.OldValues.Id;r.Id=o;try{throw Error("Changing element id")}catch(e){t=e}Object(l.a)({eventName:"UpdatingElementId",eventType:"error_event",extraData:{newId:n,oldId:o,stack:t.stack}})}},{InterestedFields:[e.ImageInfo.SavingState,e.SavingState],Name:"IntegrateSavingState",onChange:function(e){return e.Master.updateIntegratedSavingState()}}]}return t.rules},enumerable:!0,configurable:!0}),t.getSourceFields=function(e){return n.uniq(e.map((function(e){return t.QuestionInfoFieldSet.covers(e)?t.Schema.QuestionInfo:e})))},t.defaultWidth=459,t.defaultHeight=256,t}(o.a.createObjectMasterClass("DescriptiveElementMaster",C,(function(e,t){return new b(e,t)})))},function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"f",(function(){return M})),r.d(t,"d",(function(){return F})),r.d(t,"c",(function(){return O})),r.d(t,"e",(function(){return C})),r.d(t,"a",(function(){return _}));var n,o,i,a=r(3),s=r(11),c=r(24),u=r(45),l=r(113),d=r(187),f=r(47),p=r(49),m=r(27),h=r(5),g=r(28),y=r(13),b=r(46),v=r(6),S=r(7);function I(){return i||(i=new _),i}function M(){I().initialize(),Object(g.a)(O)}function F(){var e=I();return e&&e.SessionId}function O(){var e=$.Deferred(),t=I();return t?t.flush((function(){return e.resolve()})):e.resolve(),e.promise()}function C(){var e=c.a.GetHostString();if(e)return e;var t="origin",r=h.a.getQueries()[t];return r||(t="oembedsso",h.a.getQueries()[t]?"Forms WebPart":p.a.isPPTIntegration()?"PowerPoint":null)}function P(){switch(s.a.getEnvironmentType()){case"Int":case"MSInt":return"Int";case"WWProd":case"USGovProd":case"MSProd":case"ProTip":return"Prod";default:return"DevEnv"}}function T(e){return isNaN(e)?"0":e.toString()}function w(){var e=C();return"OneNoteUwp"===e||"PowerPointTaskpane"===e}!function(e){e[e.Unknown=0]="Unknown",e[e.Edu=1]="Edu",e[e.Biz=2]="Biz",e[e.MsaFree=4]="MsaFree",e[e.MSIT=8]="MSIT",e[e.MsaPaid=16]="MsaPaid",e[e.FastFood=32]="FastFood",e[e.Pro=64]="Pro",e[e.ProPaid=128]="ProPaid",e[e.ProSeeded=256]="ProSeeded",e[e.ProTrial=512]="ProTrial"}(n||(n={})),function(e){e[e.Designer=0]="Designer",e[e.Responder=1]="Responder",e[e.Unknown=2]="Unknown",e[e.AnalyzeViewer=3]="AnalyzeViewer",e[e.TeamsConfigUser=4]="TeamsConfigUser"}(o||(o={}));var _=function(){function e(){this.sessionId=OfficeFormServerInfo.serverSessionId||m.a.newGuid(),this.sessionDbId="",this.sessionDeviceId="",this.initialized=!1}return e.logData=function(t){e.BUFFER.queue(t)},Object.defineProperty(e.prototype,"SessionId",{get:function(){return this.sessionId},enumerable:!0,configurable:!0}),e.prototype.flush=function(e){this.initialized?AWTLogManager.flush(e):e()},e.prototype.initialize=function(){var t=this;l.a.Instance.ensureMuid(),this.msaTenantIdInUpperCase=s.a.getMsaTenantId().toUpperCase(),this.userRole=function(){switch(s.a.getPageType()){case"Design":return o.Designer;case"Response":return o.Responder;case"Analyze":return o.AnalyzeViewer;case"TeamsConfig":return o.TeamsConfigUser;default:return o.Unknown}}(),this.userType=n.Unknown,this.pathName=window.location.pathname.toLowerCase(),s.a.isOsi()&&"OneNoteUwp"!==C()&&b.a.getUserType().done((function(e){return t.userType=e})).always((function(){var r={disableCookiesUsage:!0};switch(s.a.getEnvironmentType()){case"USGovProd":r.collectorUri="https://tb.pipe.aria.microsoft.com/Collector/3.0";break;case"USDoDProd":r.collectorUri="https://pf.pipe.aria.microsoft.com/Collector/3.0"}var n=function(){switch(s.a.getEnvironmentType()){case"Int":case"MSInt":return"79beea9c4fdb49a5adab4843729e1fa0-19b42cd4-5bd4-4bf8-8e49-05dc0f7f97f8-7484";case"WWProd":case"MSProd":case"ProTip":return b.a.isMsaUser()||Object(u.c)()?"5f4ebf0f9a11474199e89f94bc7e2f50-61b8420a-22b1-4220-b531-4a4b96e4edb9-7406":s.a.isTip()?"d34df8693d35452c98f0e1cdfde6d6a8-44cd1abe-6b6d-4edc-a342-46ba159633a4-7645":Object(S.c)((function(){return"2ddc7e5f54754fc68f3ae1c5b7f3eb20-1883aa8c-4c7b-42d1-b3d6-c9cdb5956783-7092"}),(function(){return"34574250afbe400d814cda5bafaabbbf-e8b2d8de-469a-4779-8134-0c3b0fa0d78e-7592"}));case"USGovGccProd":return"aa96061debfd4ec7b9704f62060b4ca6-a498d428-fdba-43da-bc8b-4fe51865cb7f-7984";case"USGovProd":return"577e32a3275e48c5a639a92c9a8af033-4028cb75-b5f4-4ad0-835e-0e26d79ff209-6823";case"USDoDProd":return"291cebec6b9a4cbf9489bc8cf3a0cc50-06f4c682-bd49-4f88-a8c2-ac582180b7f9-7725";default:return"e132e188c609439ab47cd7b06511fc0a-433f81b3-fab9-415a-882a-ba9e2f91abea-6917"}}();AWTLogManager.initialize(n,r),t.initialized=!0,t.logger=AWTLogManager.getLogger(n),e.BUFFER.setFunctionToCall(t.logEvent.bind(t))}))},e.enrichEngagementInfo=function(e){var t={},r={};e.properties&&(t=JSON.parse(e.properties)),a.extend(r,t,{IsMobileView:s.a.isMobile()}),e.properties=JSON.stringify(r)},e.prototype.logEvent=function(t){"session_start"===t.eventType&&this.enrichSessionInfo(t),"engagement_event"===t.eventType&&s.a.isMobile()&&e.enrichEngagementInfo(t),this.logEventWorker(t)},e.prototype.enrichSessionInfo=function(e){if(e.properties){var t=JSON.parse(e.properties);t&&(this.sessionDbId=t.DbId,this.sessionDeviceId=t.DeviceId)}var r,n,o={BuildVersion:OfficeFormServerInfo.version,DbId:this.sessionDbId,DeviceId:this.sessionDeviceId,Flights:(r={},n=Object(v.a)().Flighting,r.PrefetchForm=n.isEnabled("PrefetchForm")&&(!y.w()||n.isEnabled("PrefetchFormAuthFix")),r.IsCdnEnabled=OfficeFormServerInfo.isCdnEnabled,r.PrefetchFormAuthFix=n.isEnabled("PrefetchFormAuthFix"),r.PrefetchFormInServer=n.isEnabled("PrefetchFormInServer"),r.MobilePrefetchForm=n.isEnabled("MobilePrefetchForm"),r.MobilePrefetchCommon=n.isEnabled("MobilePrefetchCommon"),r.MobilePrefetchResourceStrings=n.isEnabled("MobilePrefetchResourceStrings"),r.MobilePrefetchOtherJs=n.isEnabled("MobilePrefetchOtherJs"),r.FilterHashMapping=n.isEnabled("FilterHashMapping"),r.FilterServerFlights=n.isEnabled("FilterServerFlights"),r.ReactUpgrade=n.isEnabled("ReactUpgrade"),r.PrefetchUserLicenseInfo=n.isEnabled("PrefetchUserLicenseInfo"),r.IsAFDEnabled=OfficeFormServerInfo.isAFDEnabled,r),IsMobile:y.t(),JQueryLoaded:!!window.$,SessionRing:P(),SessionUrlPath:window.location.origin+window.location.pathname,UserAgent:navigator.userAgent},i=C(),a=navigator.connection;i&&(o.Origin=i),a&&(o.Connection={downLink:a.downLink||-1,effectiveType:a.effectiveType||"unsupported",rtt:a.rtt||-1}),o.IsMobile&&(o.IsMobileView=y.u()),this.tryTraceDuplicateSessionId(o),e.eventName=e.eventType,e.duration=0,e.properties=JSON.stringify(o),e.timeStamp=f.a.getTimeStamp()},e.prototype.tryTraceDuplicateSessionId=function(t){if("cc71d69e-a422-4da7-b4ea-bc4d28dba3e8"===this.sessionId)try{var r=document.referrer;if(r){var n=e.parseUrl(r);t.Referrer=n.origin+e.getHashCode(n.pathname)}}catch(e){t.Referrer="FailToParseReferrer:"+e}},e.parseUrl=function(e){var t=document.createElement("a");return t.href=e,t},e.getHashCode=function(e){var t=0;if(!e||!e.length)return t;for(var r=0;r<e.length;r++){t=(t<<5)-t+e.charCodeAt(r),t&=t}return t},e.prototype.logEventWorker=function(e){var t=new AWTEventProperties;t.setName(e.eventType),t.setProperty("event_name",e.eventName),t.setProperty("event_correlation_id",e.eventCorrelationId),t.setProperty("duration",T(e.duration)),t.setProperty("timestamp",T(e.timeStamp)),t.setProperty("properties",e.properties),e.eventName&&e.eventName.indexOf("IntelligenceStatistic")>=0||e.withoutUserInfo?this.sendSingleTelemetryEventWithoutUserInfo(t):this.sendSingleTelemetryEvent(t)},e.prototype.sendSingleTelemetryEventWithoutUserInfo=function(e){w()||(e.setProperty("source_application",Object(S.c)((function(){return"Office Forms BrowserApp"}),(function(){return"Office FormsPro BrowserApp"}))),e.setProperty("user_role",this.userRole),e.setProperty("user_type",this.userType),e.setProperty("page_type",this.pathName),this.logger.logEvent(e))},e.prototype.sendSingleTelemetryEvent=function(e){if(!w()){var t=OfficeFormServerInfo.userInfo.UserId,r=OfficeFormServerInfo.userInfo.TenantId,n=Object(u.a)();if(n&&e.setProperty("form_id",n),e.setProperty("source_application",Object(S.c)((function(){return"Office Forms BrowserApp"}),(function(){return"Office FormsPro BrowserApp"}))),e.setProperty("user_id",t),e.setProperty("user_tenant_id",r),e.setProperty("user_role",this.userRole),e.setProperty("user_type",this.userType),e.setProperty("session_id",this.sessionId),e.setProperty("page_type",this.pathName),e.setProperty("server_build_version",OfficeFormServerInfo.serverBuild),e.setProperty("server_dc",OfficeFormServerInfo.datacenter),e.setProperty("server_ring",OfficeFormServerInfo.ring),OfficeFormServerInfo&&OfficeFormServerInfo.serverInfoFromPageHeaders&&(e.setProperty("server_instance",OfficeFormServerInfo.serverInfoFromPageHeaders.serverInstance),e.setProperty("routing_build",OfficeFormServerInfo.serverInfoFromPageHeaders.routingBuild),e.setProperty("routing_dc",OfficeFormServerInfo.serverInfoFromPageHeaders.routingDataCenter),e.setProperty("routing_instance",OfficeFormServerInfo.serverInfoFromPageHeaders.routingInstance)),r)if(r.toUpperCase()===this.msaTenantIdInUpperCase){var o=OfficeFormServerInfo.userInfo.PUID;e.setProperty("UserInfo.Id",o),e.setProperty("UserInfo.IdType","MSAPUID")}else e.setProperty("UserInfo.Id",t),e.setProperty("UserInfo.IdType","UserObjectId"),e.setProperty("UserInfo.OMSTenantId",r);else t||e.setProperty("MUID",l.a.Instance.Muid);this.logger.logEvent(e)}},e.BUFFER=new d.a,e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"h",(function(){return s})),r.d(t,"g",(function(){return u})),r.d(t,"i",(function(){return l})),r.d(t,"d",(function(){return d})),r.d(t,"j",(function(){return f})),r.d(t,"e",(function(){return p})),r.d(t,"b",(function(){return m})),r.d(t,"c",(function(){return h})),r.d(t,"f",(function(){return S}));var n=r(3),o=r(4),i=r(9);function a(e,t){var r=c(e);o.a.Collection.itemsAddedInSource(t.Model.LocalizedResources,r)}function s(e){return{localizedResources:c(e)}}function c(e){var t=function(e){var t=e.filter((function(e){return!e.questionId})),r=n.groupBy(t,(function(e){return e.locale}));return n.map(r,(function(e){var t={footerText:null,formCloseMessage:null,formsprortlocalesubtitle:null,formsprortlocaletitle:null,localeId:null,localeName:null,questionResources:[],subtitle:null,thankYouMessage:null,title:null};return e.forEach((function(e){!function(e,t){switch(e.elementKey){case"thankyoumessage":t.thankYouMessage=e.elementValue;break;case"formclosemessage":t.formCloseMessage=e.elementValue;break;case"footertext":t.footerText=e.elementValue;break;default:g(e,t)}}(e,t)})),t}))}(e),r=function(e){var t=e.filter((function(e){return e.questionId})),r=n.groupBy(t,(function(e){return e.locale})),o={};return n["map"](r,(function(e,t){var r=n["groupBy"](e,(function(e){return e.questionId}));var o=n["map"](r,(function(e,r){var o={choices:[],choicesV1:[],formsprortlocaleldescription:null,formsprortlocalerdescription:null,formsprortlocalesubtitle:null,formsprortlocaletitle:null,leftDescription:null,localeId:t,localeName:null,option:null,questionId:r,rightDescription:null,subtitle:null,title:null};var i=e.filter((function(e){return e.elementKey&&e.elementKey.startsWith("choiceid_")}));if(i&&i.length>0){var a=n["map"](i,(function(e){var t={choiceId:null,description:null,key:null};v(e,t);return t}));o.choices=a}var s=e.filter((function(e){return e.elementKey&&!e.elementKey.startsWith("choiceid_")}));if(s){s.forEach((function(e){b(e,o)}))}return o}));return o})).forEach((function(e){var t=e.length>0&&e[0].localeId;t&&(o[t]=e)})),o}(e);return t.forEach((function(e){if(e.localeId){var t=r[e.localeId];t&&(e.questionResources=t)}})),t}function u(e){var t=y(e);return null!=e.formCloseMessage?(t.elementKey="formclosemessage",t.elementValue=e.formCloseMessage):null!=e.thankYouMessage?(t.elementKey="thankyoumessage",t.elementValue=e.thankYouMessage):null!=e.footerText&&(t.elementKey="footertext",t.elementValue=e.footerText),t}function l(e){var t=y(e);return null!=e.leftDescription?(t.elementKey="leftdescription",t.elementValue=e.leftDescription):null!=e.rightDescription?(t.elementKey="rightdescription",t.elementValue=e.rightDescription):null!=e.option&&'{"choicesV1":[]}'!==e.option?(t.elementKey="option",t.elementValue=e.option):null!=e.formsprortlocaleldescription?(t.elementKey="formsprortlocaleldescription",t.elementValue=e.formsprortlocaleldescription):null!=e.formsprortlocalerdescription&&(t.elementKey="formsprortlocalerdescription",t.elementValue=e.formsprortlocalerdescription),t}function d(e,t){var r=t.Model;if(!o.a.Collection.getItemWithKeyFields(r.LocalizedResources,{localeId:e.localeId})){var n={footerText:null,formCloseMessage:null,formsprortlocalesubtitle:null,formsprortlocaletitle:null,localeId:e.localeId,localeName:e.localeName,questionResources:[],subtitle:null,thankYouMessage:null,title:null};o.a.Collection.itemsAddedInSource(r.LocalizedResources,[n])}}function f(e,t){var r=t.Model,n=o.a.Collection.getItemWithKeyFields(r.LocalizedResources,{localeId:e});n&&o.a.Collection.itemsDeletedInSource(r.LocalizedResources,[n])}function p(e,t,r,i){var a={choices:[],choicesV1:[],formsprortlocaleldescription:null,formsprortlocalerdescription:null,formsprortlocalesubtitle:null,formsprortlocaletitle:null,leftDescription:null,localeId:e.localeId,localeName:e.localeName,option:null,questionId:t,rightDescription:null,subtitle:null,title:null},s=o.a.Collection.getItemWithKeyFields(i.Model.Questions,{Id:t});if(s&&s.ChoiceGroup&&s.ChoiceGroup.length>0){var c=n.map(s.ChoiceGroup,(function(e){return{choiceId:e.Id.toString(),description:null,key:e.Key}}));a.choices=c}var u=o.a.Collection.itemsAddedInSource(r.questionResources,[a]);return o.a.getObjectMasterFromModel(u[0])}function m(e,t,r){var n={choiceId:e,description:null,key:t},i=o.a.Collection.itemsAddedInSource(r.choices,[n]);return o.a.getObjectMasterFromModel(i[0])}function h(e){var t=o.a.Collection.itemsAddedInSource(e.choicesV1,[{choiceId:null,description:"",formsProDisplayRTText:""}]);return o.a.getObjectMasterFromModel(t[0])}function g(e,t){switch(t.localeId=e.locale,e.elementKey){case"title":t.title=e.elementValue;break;case"subtitle":t.subtitle=e.elementValue;break;case"localename":t.localeName=e.elementValue;break;case"formsprortlocaletitle":t.formsprortlocaletitle=e.elementValue;break;case"formsprortlocalesubtitle":t.formsprortlocalesubtitle=e.elementValue;break;default:var r=e.elementValue&&e.elementValue.length,n="Unexpected locale element key:["+e.elementKey+"], value length:"+r,o=new Error(n).stack;return console.log(o),void Object(i.a)({eventName:"UnexpectedLocaleElementKey",eventType:"error_event",extraData:n+", call stack:"+o})}}function y(e){var t={elementKey:null,elementValue:null,locale:null,questionId:null};return null!=e.title?(t.elementKey="title",t.elementValue=e.title):null!=e.subtitle?(t.elementKey="subtitle",t.elementValue=e.subtitle):null!=e.localeName?(t.elementKey="localename",t.elementValue=e.localeName):null!=e.formsprortlocaletitle?(t.elementKey="formsprortlocaletitle",t.elementValue=e.formsprortlocaletitle):null!=e.formsprortlocalesubtitle&&(t.elementKey="formsprortlocalesubtitle",t.elementValue=e.formsprortlocalesubtitle),t}function b(e,t){switch(t.questionId=e.questionId,e.elementKey){case"leftdescription":t.leftDescription=e.elementValue;break;case"rightdescription":t.rightDescription=e.elementValue;break;case"option":t.option=e.elementValue;break;case"formsprortlocaleldescription":t.formsprortlocaleldescription=e.elementValue;break;case"formsprortlocalerdescription":t.formsprortlocalerdescription=e.elementValue;break;default:g(e,t)}}function v(e,t){var r=e.elementKey;r&&r.startsWith("choiceid_")&&(t.choiceId=r.split("_")[1]),t.description=e.elementValue}function S(e,t){e&&e.length>0&&n.forEach(e,(function(e){var r=[];n.forEach(t,(function(t){var i=n.filter(e.questionResources,(function(e){return e.questionId===t.oldId}));n.forEach(i,(function(e){(e=n.clone(o.a.getObjectMasterFromModel(e).getSnapshot())).questionId=t.newId,r.push(e)}))})),o.a.Collection.addItems(e.questionResources,r)}))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"c",(function(){return i})),r.d(t,"e",(function(){return h})),r.d(t,"d",(function(){return g})),r.d(t,"b",(function(){return y}));var n,o,i,a=r(3),s=r(4),c=r(1),u=r(21),l=r(6),d=r(8),f=r(30),p=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),m={TargetResourceId:c.a.string(),Layout:c.a.enumeration((function(){return o})),Size:c.a.enumeration((function(){return i})),NaturalWidth:c.a.number(),NaturalHeight:c.a.number(),ContainerWidth:c.a.number(),ContainerHeight:c.a.number(),ActualWidth:c.a.number(),ActualHeight:c.a.number(),Left:c.a.number(),Top:c.a.number()};function h(e){return s.a.getObjectMasterFromModel(e)}function g(e,t,r){e.fieldsReady([t]).done((function(){var n=e.getModelByFieldSchema(t),o=Object(f.d)(n);e.ensureFieldsReady([r]).done((function(){var t=h(e.getModelByFieldSchema(r));o.SettingsMaster=t}))}))}!function(e){e[e.Horizontal=1]="Horizontal",e[e.Vertical=2]="Vertical",e[e.Square=3]="Square"}(o||(o={})),function(e){e[e.Small=1]="Small",e[e.Large=2]="Large"}(i||(i={}));var y=function(e){function t(t){var r=e.call(this,t)||this;return t.MasterTreeReady&&t.MasterTreeReady.done((function(){var e=r.Parent;e instanceof d.c&&e.fieldsReady([d.c.Schema.LogoInfo]).done((function(){e.Model.LogoInfo===r.Model&&(r.isFormLogo=!0)}))})),r}return p(t,e),Object.defineProperty(t.prototype,"IsFormLogo",{get:function(){return this.isFormLogo},enumerable:!0,configurable:!0}),t.prototype.initImageSetting=function(e,t,r){var n=this,o=this.Model;this.bulkEdit((function(){o.TargetResourceId=e.ResourceId,null==o.Layout&&(e.ResourceUrl||e.ImageProcessingStatus!==f.c.Idle?(o.NaturalWidth=e.Width||t,o.NaturalHeight=e.Height||r,n.initLayout(),n.applyDefaultImageSettings()):n.clear())}))},t.prototype.updateWith=function(e,t,r){var n=this;this.bulkEdit((function(){n.clear(),n.initImageSetting(e,t,r)}))},t.prototype.onImageStyleChange=function(e){var t=this,r=this.Model;r.Size!==e&&this.bulkEdit((function(){r.Size=e,t.applyDefaultImageSettings()}))},t.prototype.clear=function(){return this.setData({},s.a.getSubFieldSchemas(this.Schema))},t.prototype.validateImageSettings=function(e){var t=a.clone(this.getSnapshot());if(744===t.ContainerWidth&&(t.ContainerHeight=t.ContainerHeight*u.a.QuestionCarMaxWidth/t.ContainerWidth,t.ContainerWidth=u.a.QuestionCarMaxWidth,!e)){var r=this.Model;r.ContainerWidth=t.ContainerWidth,r.ContainerHeight=t.ContainerHeight}if(null==t.ContainerHeight||null==t.ContainerWidth||null==t.ActualHeight||null==t.ActualWidth||null==t.Top||this.IsFormLogo&&(120!==t.ContainerHeight||120!==t.ContainerWidth)||t.Left>0||t.ContainerWidth>t.Left+t.ActualWidth||t.Top>0||t.ContainerHeight>t.Top+t.ActualHeight){var n=this.getDefaultImageSettings();for(var o in n)t[o]=Math.round(n[o]),e||(this.Model[o]=t[o])}return t},t.prototype.calcLogoLayout=function(e){var t,r,n,i=(this.Model.NaturalWidth||u.a.ImageMaxWidth)/(this.Model.NaturalHeight||u.a.ImageMaxHeight),a=(e=e||{}).isSmallSize,s=e.isMobile,c=e.isSlimSize;if(s)(r=(t=c?30:a?70:80)*i)>t?(r=(t=c?40:t)*i,n=o.Vertical):n=o.Horizontal;else{var l=void 0;a?(t=70,l=125):c?(t=40,l=95):(t=120,l=215),(r=t*i)>l?(r=(t=c?30:a?40:70)*i,n=o.Vertical):n=o.Horizontal}return{ActualWidth:r=Math.min(r,750),ActualHeight:t,Layout:n}},t.prototype.initLayout=function(){var e=this.Model;if(this.IsFormLogo)e.Size=i.Small;else{var t=e.NaturalHeight/e.NaturalWidth;e.Layout=t>1?o.Vertical:t<1?o.Horizontal:o.Square,e.Size=t<.5?i.Large:i.Small}},t.prototype.applyDefaultImageSettings=function(){var e=this.Model,t=this.getDefaultImageSettings();for(var r in t)e[r]=Math.round(t[r])},t.prototype.getDefaultImageSettings=function(){var e,t=this.Model;t.NaturalHeight&&t.NaturalWidth?e={NaturalHeight:t.NaturalHeight,NaturalWidth:t.NaturalWidth}:e={NaturalHeight:t.NaturalHeight||u.a.ImageMaxHeight,NaturalWidth:t.NaturalWidth||u.a.ImageMaxWidth};if((!Object(l.a)().Flighting.isEnabled_Deprecated("DisableBrandingForMSA")||!OfficeFormServerInfo.userInfo.IsMsa)&&this.IsFormLogo)return e;var r=this.getImageLayoutPatten();if(null==r.Height?(e.ContainerWidth=r.Width,e.ContainerHeight=r.Width*e.NaturalHeight/e.NaturalWidth):null==r.Width?(e.ContainerWidth=r.Height*e.NaturalWidth/e.NaturalHeight,e.ContainerHeight=r.Height):(e.ContainerWidth=r.Width,e.ContainerHeight=r.Height),null==r.Height||null==r.Width)e.Left=0,e.Top=0,e.ActualWidth=e.ContainerWidth,e.ActualHeight=e.ContainerHeight;else{var n=Math.max(e.ContainerWidth/e.NaturalWidth,e.ContainerHeight/e.NaturalHeight);e.ActualWidth=n*e.NaturalWidth,e.ActualHeight=n*e.NaturalHeight,e.Left=(e.ContainerWidth-e.ActualWidth)/2,e.Top=(e.ContainerHeight-e.ActualHeight)/2}return e},t.prototype.getImageLayoutPatten=function(){var e=this.Model;if(this.IsFormLogo)return{Height:120,Width:120};if(null==e.Size||e.Size===i.Small)switch(e.Layout){case o.Square:return{Width:314,Height:314};case o.Vertical:return{Height:314};case o.Horizontal:default:return{Width:314}}else switch(e.Layout){case o.Square:return{Width:414,Height:414};case o.Vertical:return{Height:414};case o.Horizontal:default:return{Width:u.a.QuestionCarMaxWidth}}},t}(s.a.createObjectMasterClass("ImageSettingsMaster",m))},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){function e(){}return e.getRejectedPromise=function(e){return $.Deferred().reject(e).promise()},e.getResolvedPromise=function(e){return $.Deferred().resolve(e).promise()},e.always=function(t){return t?t.then(null,(function(){return e.getResolvedPromise()})):e.getResolvedPromise()},e.fromJavaScriptPromise=function(e){var t=$.Deferred();return e.then((function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t.resolve.apply(t,e)})).catch((function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t.reject.apply(t,e)})),t.promise()},e.State=function(){function e(){}return Object.defineProperty(e,"Pending",{get:function(){return"pending"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Resolved",{get:function(){return"resolved"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Rejected",{get:function(){return"rejected"},enumerable:!0,configurable:!0}),e}(),e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return l})),r.d(t,"c",(function(){return d}));var n=r(11),o=r(103),i=OfficeFormServerInfo.hashMapping,a=OfficeFormServerInfo.isCdnEnabled,s=OfficeFormServerInfo.addPrefixForProWhenNoCdn,c={defaultFolder:{css:"/css/dist/",js:"/Scripts/dists/"},vendorsFolder:{css:"/css/",js:"/Scripts/"}};function u(e){return e?a?f(e):s?"/FormsPro"+e:e:""}function l(e,t){if(!e)return"";var r=e.split(".").pop();if("js"!==r&&"css"!==r)return e;var n=function(e,t){return(/^vendors\//i.test(e)?c.vendorsFolder:c.defaultFolder)[t]}(e,r)+e;if(a&&void 0!==i){var o=i[e.toLowerCase()];if(void 0!==o)return f(n.replace(new RegExp(r+"$"),o+"."+r))}var u=n+(t?"?v="+OfficeFormServerInfo.version:"");return s?"/FormsPro"+u:u}function d(e){return e?a?f(e.replace(/\/intl\//i,"/intl_cdn/")):s?"/FormsPro"+e:e:""}function f(e){if(e=e.toLowerCase(),n.a.isOsi()){var t=Object(o.a)("CdnEndPoint");if(t)return t+e}return"/cdn"+e}},function(e,t,r){"use strict";r.d(t,"g",(function(){return a})),r.d(t,"a",(function(){return s})),r.d(t,"f",(function(){return c})),r.d(t,"d",(function(){return u})),r.d(t,"c",(function(){return l})),r.d(t,"e",(function(){return d})),r.d(t,"b",(function(){return f}));var n=r(11),o=r(36),i=null;function a(e){i=e}function s(){return i&&i()}function c(e){e}function u(){var e=Object(o.a)(s()||"");return!!e.OrgId&&e.OrgId.toLowerCase()===n.a.getMsftTenantId()}function l(){var e=Object(o.a)(s()||"");return!!e.OrgId&&e.OrgId.toLowerCase()===n.a.getMsaTenantId()}function d(){var e=Object(o.a)(s()||"");return!!e.OrgId&&-1!==n.a.getFastFoodTenantsId().indexOf(e.OrgId.toLowerCase())}function f(){var e=s();return e&&Object(o.a)(e)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return S}));var n,o,i,a,s,c,u,l,d,f=r(3),p=r(11),m=r(24),h=r(6),g=r(34),y=r(50),b=r(26),v=r(145);!function(e){e[e.OFFICE_FORMS_PLAN_2=0]="OFFICE_FORMS_PLAN_2",e[e.OFFICE_FORMS_PLAN_3=1]="OFFICE_FORMS_PLAN_3"}(n||(n={})),function(e){e[e.FORMS_PLAN_E1=0]="FORMS_PLAN_E1",e[e.FORMS_PLAN_E3=1]="FORMS_PLAN_E3",e[e.FORMS_PLAN_E5=2]="FORMS_PLAN_E5",e[e.FORMS_PLAN_K=3]="FORMS_PLAN_K"}(o||(o={})),function(e){e[e.FORMS_GOV_E1=0]="FORMS_GOV_E1",e[e.FORMS_GOV_E3=1]="FORMS_GOV_E3",e[e.FORMS_GOV_E5=2]="FORMS_GOV_E5",e[e.FORMS_GOV_F1=3]="FORMS_GOV_F1"}(i||(i={})),function(e){e[e.FORMS_GCCHIGH_E1=0]="FORMS_GCCHIGH_E1",e[e.FORMS_GCCHIGH_E3=1]="FORMS_GCCHIGH_E3",e[e.FORMS_GCCHIGH_E5=2]="FORMS_GCCHIGH_E5",e[e.FORMS_GCCHIGH_F1=3]="FORMS_GCCHIGH_F1"}(a||(a={})),function(e){e[e.FORMS_DOD_E1=0]="FORMS_DOD_E1",e[e.FORMS_DOD_E3=1]="FORMS_DOD_E3",e[e.FORMS_DOD_E5=2]="FORMS_DOD_E5",e[e.FORMS_DOD_F1=3]="FORMS_DOD_F1"}(s||(s={})),function(e){e[e.FORMS_PRO=0]="FORMS_PRO",e[e.Forms_Pro_USL=1]="Forms_Pro_USL",e[e.Forms_Pro_USL_GCC=2]="Forms_Pro_USL_GCC",e[e.Forms_Pro_CE=3]="Forms_Pro_CE",e[e.Forms_Pro_Service=4]="Forms_Pro_Service",e[e.Forms_Pro_FS=5]="Forms_Pro_FS",e[e.Forms_Pro_Marketing=6]="Forms_Pro_Marketing",e[e.Forms_Pro_Plan=7]="Forms_Pro_Plan",e[e.Forms_Pro_PS=8]="Forms_Pro_PS",e[e.Forms_Pro_SalesEnt=9]="Forms_Pro_SalesEnt",e[e.Forms_Pro_Talent=10]="Forms_Pro_Talent",e[e.Forms_Pro_Operations=11]="Forms_Pro_Operations",e[e.Forms_Pro_Relationship_Sales=12]="Forms_Pro_Relationship_Sales"}(c||(c={})),function(e){e[e.Forms_Pro_USL=0]="Forms_Pro_USL",e[e.Forms_Pro_USL_GCC=1]="Forms_Pro_USL_GCC"}(u||(u={})),function(e){e[e.Forms_Pro_CE=0]="Forms_Pro_CE",e[e.Forms_Pro_Service=1]="Forms_Pro_Service",e[e.Forms_Pro_FS=2]="Forms_Pro_FS",e[e.Forms_Pro_Marketing=3]="Forms_Pro_Marketing",e[e.Forms_Pro_Plan=4]="Forms_Pro_Plan",e[e.Forms_Pro_PS=5]="Forms_Pro_PS",e[e.Forms_Pro_SalesEnt=6]="Forms_Pro_SalesEnt",e[e.Forms_Pro_Talent=7]="Forms_Pro_Talent",e[e.Forms_Pro_Operations=8]="Forms_Pro_Operations",e[e.Forms_Pro_Relationship_Sales=9]="Forms_Pro_Relationship_Sales"}(l||(l={})),function(e){e[e.FORMS_PRO=0]="FORMS_PRO"}(d||(d={}));var S=function(){function e(){}return e.isEduUser=function(){return e.getUserInfo().then((function(){return e.userHasEduLicense}),(function(){return $.Deferred().resolve(!1).promise()}))},e.isBusinessUser=function(){return e.getUserInfo().then((function(){return e.userHasBusinessLicense}),(function(){return $.Deferred().resolve(!1).promise()}))},e.isE1User=function(){return e.getUserInfo().then((function(){return e.userBizLicense===o.FORMS_PLAN_E1||e.userGccLicense===i.FORMS_GOV_E1||e.userGccHighLicense===a.FORMS_GCCHIGH_E1||e.userDoDLicense===s.FORMS_DOD_E1}),(function(){return $.Deferred().resolve(!1).promise()}))},e.isE3User=function(){return e.getUserInfo().then((function(){return e.userBizLicense===o.FORMS_PLAN_E3||e.userGccLicense===i.FORMS_GOV_E3||e.userGccHighLicense===a.FORMS_GCCHIGH_E3||e.userDoDLicense===s.FORMS_DOD_E3}),(function(){return $.Deferred().resolve(!1).promise()}))},e.isE5User=function(){return e.getUserInfo().then((function(){return e.userBizLicense===o.FORMS_PLAN_E5||e.userGccLicense===i.FORMS_GOV_E5||e.userGccHighLicense===a.FORMS_GCCHIGH_E5||e.userDoDLicense===s.FORMS_DOD_E5}),(function(){return $.Deferred().resolve(!1).promise()}))},e.isMsaFreeUser=function(){return e.getUserInfo().then((function(){return e.isMsaUser()&&!e.userHasMsaPaidLicense}),(function(){return $.Deferred().resolve(!1).promise()}))},e.isMsaPaidUser=function(){return e.getUserInfo().then((function(){return e.isMsaUser()&&e.userHasMsaPaidLicense}),(function(){return $.Deferred().resolve(!1).promise()}))},e.isFormsProUser=function(){return e.getUserInfo().then((function(){return e.userHasFormsProLicense}),(function(){return $.Deferred().resolve(!1).promise()}))},e.isFormsProPaidUser=function(){return e.getUserInfo().then((function(){return!!e.userHasFormsProPaidLicense}),(function(){return $.Deferred().resolve(!1).promise()}))},e.isFormsProTrialUser=function(){return e.getUserInfo().then((function(){return!e.userHasFormsProPaidLicense&&!e.userHasFormsProSeededLicense&&!!e.userHasFormsProTrialLicense}),(function(){return $.Deferred().resolve(!1).promise()}))},e.isFormsProSeededUser=function(){return e.getUserInfo().then((function(){return!e.userHasFormsProPaidLicense&&!!e.userHasFormsProSeededLicense}),(function(){return $.Deferred().resolve(!1).promise()}))},e.isMsaUser=function(){var e=OfficeFormServerInfo.userInfo.TenantId;return!(!e||e.toLowerCase()!==p.a.getMsaTenantId())},e.isMsftUser=function(){var e=OfficeFormServerInfo.userInfo.TenantId;return!(!e||e.toLowerCase()!==p.a.getMsftTenantId())},e.isFastFoodTenant=function(){var e=OfficeFormServerInfo.userInfo.TenantId;return e&&-1!==p.a.getFastFoodTenantsId().indexOf(e.toLowerCase())},e.getUserType=function(){return e.getUserInfo().then((function(){var t=y.e.Unknown;return e.userHasEduLicense&&(t=y.e.Edu),e.userHasBusinessLicense&&(t|=y.e.Biz),e.isMsftUser()&&(t|=y.e.MSIT),e.isMsaUser()&&(e.userHasMsaPaidLicense?t|=y.e.MsaPaid:t|=y.e.MsaFree),e.userHasFormsProLicense&&(t|=y.e.Pro,e.userHasFormsProPaidLicense?t|=y.e.ProPaid:e.userHasFormsProSeededLicense?t|=y.e.ProSeeded:e.userHasFormsProTrialLicense&&(t|=y.e.ProTrial)),t}),(function(){return y.e.Unknown}))},e.getDataClassificationLevels=function(){return e.dataClassification||(e.dataClassification=$.Deferred(),$(document).ready((function(){b.a.getInstance().createDataProvider().getDataClassificationLabels().then((function(t){e.dataClassification.resolve(t)}),(function(t){return e.dataClassification.reject(t)})),e.dataClassification.fail((function(e){g.a.logData({errorInfo:e,errorName:"TenantDataClassificationLevelsGetFailure"})}))}))),e.dataClassification.promise()},e.getDataClassificationLabelDetail=function(e,t){if(!this.dataClassificationLabelDetail){var r=b.a.getInstance().createDataProvider();this.dataClassificationLabelDetail=r.getDataClassificationLabelDetail(e,t),this.dataClassificationLabelDetail.fail((function(e){g.a.logData({errorInfo:e,errorName:"TenantDataClassificationLevelDetailGetFailure"})}))}return this.dataClassificationLabelDetail},e.setUserEduLicenseState=function(t){for(var r in n)if(t.hasOwnProperty(n[r])){var o=t[n[r]];if(o&&o.length>0)return void(e.userHasEduLicense=!0)}e.userHasEduLicense=!1},e.setUserBusinessLicenseState=function(t){for(var r in o)if(t.hasOwnProperty(o[r])){var n=t[o[r]];if(n&&n.length>0)return e.userHasBusinessLicense=!0,void(e.userBizLicense=parseInt(r))}e.userHasBusinessLicense=!1},e.setGovLicenseState=function(t){for(var r in i){if(t.hasOwnProperty(i[r]))if((n=t[i[r]])&&n.length>0){e.userGccLicense=parseInt(r);break}}for(var r in a){if(t.hasOwnProperty(a[r]))if((n=t[a[r]])&&n.length>0){e.userGccHighLicense=parseInt(r);break}}for(var r in s){var n;if(t.hasOwnProperty(s[r]))if((n=t[s[r]])&&n.length>0){e.userDoDLicense=parseInt(r);break}}},e.setUserMsaLicenseState=function(t){e.isMsaUser()&&t?e.userHasMsaPaidLicense=!0:e.userHasMsaPaidLicense=!1},e.setUserFormsProLicenseState=function(t){for(var r in c)if(t.hasOwnProperty(c[r])){var n=t[c[r]];if(n&&n.length>0)return void(e.userHasFormsProLicense=!0)}e.userHasFormsProLicense=!1},e.setUserFormsProLicenseType=function(t){for(var r in u){if(t.hasOwnProperty(u[r]))(n=t[u[r]])&&n.length>0&&(e.userHasFormsProPaidLicense=!0)}for(var r in l){if(t.hasOwnProperty(l[r]))(n=t[l[r]])&&n.length>0&&(e.userHasFormsProSeededLicense=!0)}for(var r in d){var n;if(t.hasOwnProperty(d[r]))(n=t[d[r]])&&n.length>0&&(e.userHasFormsProTrialLicense=!0)}},e.getUserInfo=function(){return e.licenseReady||(e.licenseReady=$.Deferred(),$(document).ready((function(){if(OfficeFormServerInfo.userInfo.UserId||m.a.IsAssignmentsPage)try{if(OfficeFormServerInfo.userLicenseInfo&&OfficeFormServerInfo.userLicenseInfo.id){var t=OfficeFormServerInfo.userLicenseInfo;e.setUserLicenseStateAndResolve(t.licenses,t.isPaidUser)}else{(Object(h.a)().Flighting.isEnabled("BlockRestrictUser")||Object(h.a)().Flighting.isEnabled("PrefetchUserLicenseInfo")?v.a:b.a.getInstance().createDataProvider()).getUserInfo().then((function(t){e.setUserLicenseStateAndResolve(t.licenses,t.isPaidUser)}),(function(t){return e.licenseReady.reject(t)}))}}catch(t){e.licenseReady.reject(t)}else e.licenseReady.resolve({});e.licenseReady.fail((function(e){g.a.logData({errorInfo:e,errorName:"UserInfoGetFailure"})}))}))),e.licenseReady.promise()},e.setUserLicenseStateAndResolve=function(t,r){var n=f.object(t.map((function(e){var t=e.licenseName,r=e.skus;return[t,JSON.parse(r)]})));e.setUserEduLicenseState(n),e.setUserBusinessLicenseState(n),e.setGovLicenseState(n),e.setUserMsaLicenseState(r),e.setUserFormsProLicenseState(n),e.setUserFormsProLicenseType(n),e.licenseReady.resolve(n)},e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){function e(){}return e.isLocalDateEqual=function(e,t){return e&&t?e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate():void 0},e.compareLocalTime=function(e,t){return e&&t?1e3*(60*(60*e.getHours()+e.getMinutes())+e.getSeconds())+e.getMilliseconds()-(1e3*(60*(60*t.getHours()+t.getMinutes())+t.getSeconds())+t.getMilliseconds()):void 0},e.getTimeStamp=function(){return Date.now||(Date.now=function(){return(new Date).getTime()}),Math.floor(Date.now())},e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){function e(){}return e.AADAcquireTokenError="AADAcquireTokenError",e.AADAcquireTokenMfaCheckError="AADAcquireTokenMfaCheckError",e.LoginIECrossZoneError="LoginIECrossZoneError",e.ThirdPartyCookieBlockedError="ThirdPartyCookieBlockedError",e.AuthNoStorageError="AuthNoStorageError",e.TeamSiteNoGroupError="TeamSiteNoGroupError",e.OutlookInsertCardAsPropError="OutlookInsertCardAsPropError",e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(11),o=r(6),i=r(5),a=function(){function e(){}return e.isDebugMode=function(){return e.getFlightValue("debug")},e.isDarkFunctionalitiesEnabled=function(){return e.getFlightValue("d")},e.isMsaLoginEnabled=function(){return e.getFlightValue("msa")},e.isOembedTrialSSOEnabled=function(){return e.getFlightValue("oembedssotrial")&&n.a.isProduction()||e.getFlightValue("oembedsso")||e.getFlightValue("powerappembed")},e.isDebugOpenExcelInOneDrive=function(){return e.isDarkFunctionalitiesEnabled()&&!n.a.isProduction()},e.isStandalone=function(){return e.getFlightValue("standalone")&&!n.a.isProduction()},e.isPPTContentAddinSSOEnabled=function(){if(e.getFlightValue("pptcontentsso")){var t=i.a.getQueries().hostplatform;if("PC"===t)return!0;if("OfficeOnline"===t&&Object(o.a)().Flighting.isEnabled("PPTContentAddinSSO"))return!0}return!1},e.isPPTIntegration=function(){return e.getFlightValue("pptintegration")},e.isRuntimePageAutoRefreshEnabled=function(){return e.getFlightValue("runtimeautorefresh")},e.isStreamSSOEnabled=function(){return e.getFlightValue("streamsso")},e.getFlightValue=function(e,t){void 0===t&&(t=!1);var r=i.a.getQueries()[e];return""===r||(r?(Array.isArray(r)&&(r=r[0]),t?"false"!==r.toLowerCase():"true"===r.toLowerCase()):t)},e}()},function(e,t,r){"use strict";var n,o,i,a,s;r.d(t,"a",(function(){return n})),r.d(t,"c",(function(){return o})),r.d(t,"b",(function(){return i})),r.d(t,"e",(function(){return a})),r.d(t,"d",(function(){return s})),function(e){e[e.Invalid=0]="Invalid",e[e.StringMatch=1]="StringMatch",e[e.LcsStringMatch=2]="LcsStringMatch",e[e.AggregateMatch=3]="AggregateMatch"}(n||(n={})),function(e){e[e.None=0]="None",e[e.SpellChecker=1]="SpellChecker",e[e.AutoSuggest=2]="AutoSuggest",e[e.KeyPhrase=4]="KeyPhrase",e[e.ChoiceQuestionTypeSuggest=256]="ChoiceQuestionTypeSuggest",e[e.SuggestionForm=512]="SuggestionForm",e[e.SuggestionQuestion=2048]="SuggestionQuestion",e[e.OptionsSuggest=4096]="OptionsSuggest",e[e.LikertQuestionTypeSuggest=8192]="LikertQuestionTypeSuggest",e[e.AdoptKeyWord=16384]="AdoptKeyWord",e[e.ThemeSuggest=32768]="ThemeSuggest",e[e.TagSuggest=65536]="TagSuggest",e[e.TagTemplateSuggest=131072]="TagTemplateSuggest"}(o||(o={})),function(e){e[e.None=0]="None",e[e.SimilarMathQuestionSuggestions=1]="SimilarMathQuestionSuggestions"}(i||(i={})),function(e){e[e.Unknown=0]="Unknown",e[e.Edu=1]="Edu",e[e.Biz=2]="Biz",e[e.MsaFree=4]="MsaFree",e[e.MSIT=8]="MSIT",e[e.MsaPaid=16]="MsaPaid",e[e.FastFood=32]="FastFood",e[e.Pro=64]="Pro",e[e.ProPaid=128]="ProPaid",e[e.ProSeeded=256]="ProSeeded",e[e.ProTrial=512]="ProTrial"}(a||(a={})),function(e){e[e.TemplateSuggestion=1]="TemplateSuggestion"}(s||(s={}))},,function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(3),o=r(4),i=function(){function e(e){this.questionMaster=e}return e.supportMobileDesign=function(e){return!1},e.hasInvalidSettingOnMobile=function(e){return e.ShowSubtitle||!!e.ImageInfo.ResourceUrl||!!e.VideoInfo.Url},Object.defineProperty(e.prototype,"Master",{get:function(){return this.questionMaster},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Model",{get:function(){return this.questionMaster.Model},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(e){return!e},e.prototype.justifyNumberBoundaries=function(){throw Error("to be overridden")},e.prototype.supportsQuestionLevelBranching=function(){return!0},e.prototype.supportsChoiceLevelBranching=function(){return!1},e.prototype.getBranchedResult=function(e,t){var r=this.getBranchingResult(e);switch(r.Type){case"Next":r.TargetElement=t}return r},e.prototype.isNumberType=function(){return!1},e.prototype.getNumberValidationErrorMessage=function(e){throw Error("to be overridden")},e.prototype.getValidationErrorMessage=function(){throw Error("to be overridden")},e.prototype.getSnapshotWithoutBranchInfo=function(){var e=n.clone(this.Master.getSnapshot());return delete e.BranchInfo,delete e.BranchInfoForOtherChoice,e},e.prototype.resetBranchInfo=function(){this.getBranchInfoMaster(this.Model.BranchInfo).resetToDefault()},e.prototype.insertChoice=function(e,t){},e.prototype.getNormalizedAnswer=function(e){return e},e.prototype.hasAnswer=function(){return!0},e.prototype.hasCorrectAnswers=function(e){return!1},e.prototype.isCorrectAnswer=function(e){return!1},e.prototype.setAnswerKey=function(e,t){},e.prototype.createQuizResult=function(e){return null},e.prototype.autoGradeAnswer=function(e){var t=!this.Model.Point,r=null==e.Answer||""===e.Answer;(t||r)&&(e.Score=0,e.IsAutoGraded=!0)},e.prototype.autoGradeWithQuizResult=function(e,t){var r=this.Master.Parent;return(r&&r.Model||this.Model).Point||(null==e||""===e)?0:null},e.prototype.serializeAnswer=function(e){return e},e.prototype.deserializeAnswer=function(e){return e},e.prototype.justifyQuestionInfo=function(){},e.prototype.showAsDropdown=function(){},e.prototype.redressGradingBasis=function(){},e.prototype.getBranchInfoMaster=function(e){return o.a.getObjectMasterFromModel(e)},e.prototype.getBranchingResult=function(e){return this.getBranchInfoMaster(this.Model.BranchInfo).getBranchingResult()},e}()},function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e[e.NotSubmitted=0]="NotSubmitted",e[e.Submitting=1]="Submitting",e[e.Failed=2]="Failed",e[e.Succeed=3]="Succeed",e[e.SucceedWithQuizResult=4]="SucceedWithQuizResult"}(n||(n={}))},function(e,t,r){"use strict";r.d(t,"d",(function(){return u})),r.d(t,"f",(function(){return l})),r.d(t,"i",(function(){return d})),r.d(t,"k",(function(){return f})),r.d(t,"a",(function(){return p})),r.d(t,"e",(function(){return m})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return g})),r.d(t,"g",(function(){return y})),r.d(t,"l",(function(){return b})),r.d(t,"j",(function(){return v})),r.d(t,"h",(function(){return F}));var n=r(3),o=r(7),i=r(17),a=r(56),s=r(40),c=r(11);function u(e,t,r){var n=void 0;e&&(n="lang="+e),M("GetResourceStrings",n,void 0,t,r)}function l(e,t){return u(c.a.getExplictLocale(),e,t)}function d(e,t){M("GetRefreshedAntiForgeryToken",void 0,void 0,(function(t){OfficeFormServerInfo.antiForgeryToken=t,e&&e()}),t)}function f(e,t){M("GetUserInfo",void 0,void 0,(function(t){OfficeFormServerInfo.userInfo=t,e&&e()}),t)}function p(){return I("GetFormTemplates",void 0,void 0,void 0)}function m(){return I("GetMSATemplates",void 0,void 0,void 0)}function h(){return I("GetIntelligenceScenarioTemplates",void 0,void 0,void 0)}function g(){return I("GetIntelligenceTagTemplates",void 0,void 0,void 0)}function y(e){return I("GetThemes",void 0,JSON.stringify({name:e||""}),void 0)}function b(e){return I("GetUserInfo",void 0,void 0,S(e)).then((function(e){e&&(OfficeFormServerInfo.userInfo=e)}))}function v(e){return I("GetFlights",void 0,void 0,S(e)).then((function(e){e&&(OfficeFormServerInfo.flights=e)}))}function S(e){return{Accept:"application/json",Authorization:e?"Bearer "+e:""}}function I(e,t,r,i){var c;c="/"===window.location.pathname?"/Default.aspx/"+e:window.location.pathname+"/"+e,t&&(c+="?"+t),Object(o.e)((function(){i=n.extend({},i,{formspro:"enabled"})}));var u=new a.a("PageMethod.{0}".format(e));return u.start(),i=n.extend({},i,{"X-CorrelationId":u.CorrelationId,"X-UserSessionId":Object(s.d)()}),$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:c,data:r||"{}",dataType:"json",headers:i}).then((function(e){return u.end({resultType:"Success"}),e.d}),(function(t,r,n){return u.end({resultType:"Failure",extraData:{url:c,message:n}}),{message:n,name:"PageMethod CallWebMethod Failure: "+e}}))}function M(e,t,r,n,o){I(e,t,r,void 0).done(n).fail(o)}function F(e,t,r,n){var o=n||c.a.getExplictLocale()||navigator.language,a="https://uhf.microsoft.com/"+o+"/shell/xml/OfficeForms";e&&(a+="?"+e),$.ajax({type:"GET",url:a,dataType:"xml",success:function(e){t&&t(e)},error:function(n){i.a.logData({name:"Error.UHF.UniversalHeaderAndFooterError",extraData:{error:n}}),"en-us"!==o?F(e,t,r,"en-us"):r&&r(n)}})}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(43),o=function(){function e(e,t){var r=this;void 0===e&&(e=1e3),void 0===t&&(t=5e3),this.maxRetryTimesForUpdate=Number.MAX_VALUE,null==e&&(e=1e3),null==t&&(t=5e3),this.fast=e,this.slow=t,this.updateTrigger=function(){return r.clearUpdateSchedule().resolve()}}return e.prototype.scheduleUpdate=function(){if(this.deferred)throw Error("Calling scheduleUpdate() before the previous one is resolved.");return this.deferred=$.Deferred(),this.updateFastTimer=window.setTimeout(this.updateTrigger,this.fast),this.updateSlowTimer=window.setTimeout(this.updateTrigger,this.slow),this.deferred.promise()},e.prototype.postponeUpdate=function(){if(!this.deferred)throw Error("Calling postponeUpdate() before update scheduled.");window.clearTimeout(this.updateFastTimer),this.updateFastTimer=window.setTimeout(this.updateTrigger,this.fast)},e.prototype.cancelUpdate=function(){this.clearUpdateSchedule().reject()},e.prototype.isScheduled=function(){return!!this.deferred},e.prototype.setMaxRetryTimesForUpdate=function(e){this.maxRetryTimesForUpdate=e},e.prototype.clearUpdateSchedule=function(){window.clearTimeout(this.updateFastTimer),this.updateFastTimer=void 0,window.clearTimeout(this.updateSlowTimer),this.updateSlowTimer=void 0;var e=this.deferred;return this.deferred=void 0,e},e.prototype.retryForCreation=function(e){return e<3?n.a.getResolvedPromise():n.a.getRejectedPromise()},e.prototype.retryForUpdate=function(e){var t=this;if(e>=this.maxRetryTimesForUpdate)return n.a.getRejectedPromise();var r=a;e<s&&(r=i*Math.pow(2,e)),this.updateRetryTimer=window.setTimeout((function(){t.updateRetryTimer=void 0,o.resolve()}),r);var o=$.Deferred();return o.promise()},e.prototype.cancelRetryForUpdate=function(){window.clearTimeout(this.updateRetryTimer),this.updateRetryTimer=void 0},e}(),i=2500,a=6e5,s=Math.log(a/i)/Math.log(2)},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(3),o=r(27),i=r(84),a=function(){function e(e){this.qos=null,this.event={CorrelationId:o.a.newGuid(),Data:{},Duration:0,Name:e},this.qos=new i.a(e)}return Object.defineProperty(e.prototype,"Name",{get:function(){return this.event.Name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Duration",{get:function(){return this.event.Duration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CorrelationId",{get:function(){return this.qos.CorrelationId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Data",{get:function(){return this.event.Data},enumerable:!0,configurable:!0}),e.prototype.start=function(){this.qos.ExtraData=this.Data.extraData,this.qos.start()},e.prototype.end=function(e){var t=this.prepareEvent(e);this.qos.end({extraData:t.Data.extraData,logLevel:"Info",resultCode:t.Data.resultCode,resultType:t.Data.resultType})},e.prototype.log=function(e){var t=this.prepareEvent(e);this.qos.log({extraData:t.Data.extraData,logLevel:"Info",resultCode:t.Data.resultCode,resultType:t.Data.resultType})},e.prototype.prepareEvent=function(e){var t=n.clone(this.event);return t.Data=n.extend({},this.event.Data,e),t},e}()},function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e[e.Normal=0]="Normal",e[e.PhishingFromCustomerReport=1]="PhishingFromCustomerReport",e[e.PhishingFromContentScan=2]="PhishingFromContentScan",e[e.TempTakeDown=4]="TempTakeDown",e[e.AdminReviewPass=8]="AdminReviewPass",e[e.CopyrightInfringement=16]="CopyrightInfringement",e[e.OldPhishingTakeDown=32]="OldPhishingTakeDown",e[e.PhishingTakeDownConfirmed=64]="PhishingTakeDownConfirmed",e[e.Suspicious=128]="Suspicious",e[e.EqualOrOverContentScanMask=6]="EqualOrOverContentScanMask",e[e.EqualOrAboveCustomerReportMask=7]="EqualOrAboveCustomerReportMask",e[e.TakeDownConfirmedMask=80]="TakeDownConfirmedMask",e[e.TakeDown=100]="TakeDown"}(n||(n={}))},function(e,t,r){"use strict";var n=r(3),o=r(4),i=r(1),a=r(55),s=r(81),c=r(82),u=r(193),l=r(41),d=r(107),f=r(23),p=r(8),m=function(){function e(e){this.master=e,this.dataProvider=f.a.getDataProviderByFormMaster(this.master.Form)}return e.prototype.add=function(e){var t=this;if(this.master.Form.SyncContext!==p.e.DesignTimeForm)return $.Deferred().resolve().promise();var r=this.master.QuestionId;if(r){var o=this.master.Form.getElementById(r);if(o)return o.Synchronizer.existingInDataSource().then((function(){var r,o=[];for(r in e)if(e.hasOwnProperty(r)){var i=Object(l.i)(n.pick(e,[r]));i.elementKey&&(i.locale=t.master.Model.localeId,i.questionId=t.master.QuestionId,o.push(Object(d.a)(i,t.master.FormId)))}return $.when.apply($,o).then((function(e){}))}))}return $.Deferred().reject().promise()},e.prototype.delete=function(e){throw Error("No scenario to call this method currently.")},e.prototype.query=function(e){throw Error("No scenario to call this method currently.")},e.prototype.update=function(e,t){if(!t.ValuesBefore||this.master.Form.SyncContext!==p.e.DesignTimeForm)return $.Deferred().resolve().promise();var r,o=[];for(r in e)if(e.hasOwnProperty(r)){var i=null!==t.ValuesBefore[r],a=Object(l.i)(n.pick(e,[r]));a.locale=this.master.Model.localeId,a.questionId=this.master.QuestionId,o.push(i?this.dataProvider.updateLocaleItem(this.master.FormId,a):this.dataProvider.createLocaleItem(this.master.FormId,a))}return $.when.apply($,o).then((function(e){}))},e}();r.d(t,"a",(function(){return b}));var h,g=(h=function(e,t){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}h(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),y={choices:i.a.collectionOf((function(){return u.a})),choicesV1:i.a.collectionOf({choiceId:i.a.string({IsLocalField:!0}),description:i.a.string({SourceFieldName:"Description"}),formsProDisplayRTText:i.a.string({SourceFieldName:"FormsProDisplayRTText"})},{IsLocalField:!0}),formsprortlocaleldescription:i.a.string(),formsprortlocalerdescription:i.a.string(),formsprortlocalesubtitle:i.a.string(),formsprortlocaletitle:i.a.string(),leftDescription:i.a.string(),localeId:i.a.string({IsKeyField:!0}),localeName:i.a.string(),option:i.a.string(),questionId:i.a.string({IsKeyField:!0}),rightDescription:i.a.string(),subtitle:i.a.string(),title:i.a.string()},b=function(e){function t(t){var r=this,n=$.Deferred();return(r=e.call(this,t,{MasterReady:n.promise(),Scheduler:new a.a})||this).initializeOptionBinder(t),n.resolve(),r}return g(t,e),t.handleChoicesV1Deleted=function(e,t,r){e<0||n.forEach(r.Model.LocalizedResources,(function(r){n.filter(r.questionResources,(function(e){return e.questionId===t})).forEach((function(t){t.choicesV1.length>e&&o.a.Collection.itemsDeletedInSource(t.choicesV1,[t.choicesV1[e]])}))}))},t.handleChoicesV1Exchange=function(e,t,r,i){n.forEach(i.Model.LocalizedResources,(function(i){o.a.getCollectionMasterFromModel(i.questionResources).bulkEdit((function(o){n.filter(o,(function(e){return e.questionId===r})).forEach((function(r){var o,i,a=r.choicesV1;for(e>t?(o=t,i=e):(o=e,i=t);a.length<=i+1;)Object(l.c)(r);var s=n.map(a,(function(e){return e.description})),c=s.splice(e,1);s.splice(t,0,c[0]);for(var u=o;u<=i;++u)a[u].description=s[u]}))}))}))},Object.defineProperty(t.prototype,"Form",{get:function(){return this.FormLocalizedMaster.Form},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FormLocalizedMaster",{get:function(){return this.Parent.Parent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"QuestionId",{get:function(){return this.Model.questionId},enumerable:!0,configurable:!0}),t.prototype.getChoiceLocalizedMaster=function(e){var t=this,r=n.find(this.Form.Model.Questions,(function(e){return e.Id===t.QuestionId}));if(r){var i=n.find(r.ChoiceGroup,(function(t){return t.Id.toString()===e}));if(i){var a=o.a.Collection.getItemWithKeyFields(this.Model.choices,{choiceId:e});return a?o.a.getObjectMasterFromModel(a):Object(l.b)(e,i.Key,this.Model)}}throw Error("Question or Chocie don't exist for localization.")},t.prototype.getChoiceV1LocalizedMaster=function(e){var t=this,r=n.find(this.Form.Model.Questions,(function(e){return e.Id===t.QuestionId}));if(r&&r.Choices.length>e){for(;this.Model.choicesV1.length<r.Choices.length;)Object(l.c)(this.Model);return o.a.getObjectMasterFromModel(this.Model.choicesV1[e])}return null},t.prototype.initializeOptionBinder=function(e){t.Schema.option&&(this.optionBinder=new s.a(this,t.Schema.option,t.ChoicesV1FieldSet),e.InitialData&&this.isFieldReady(t.Schema.option)&&(e.ExistingInDataSource||e.InitialData.option?this.optionBinder.deserialize():this.optionBinder.serialize()))},Object.defineProperty(t,"ChoicesV1FieldSet",{get:function(){return t.choicesV1FieldSet||(t.choicesV1FieldSet=new c.a([t.Schema.choicesV1])),t.choicesV1FieldSet},enumerable:!0,configurable:!0}),t}(o.a.createObjectMasterClass("QuestionLocalizedItemMaster",y,(function(e){return new m(e)})))},function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(3),o=r(4),i=r(18),a=r(8),s=r(98),c=r(23),u=function(){function e(e,t){this.response=e,this.receiver=t,this.dataProvider=c.a.getDataProviderByFormMaster(this.response.Form)}return Object.defineProperty(e.prototype,"FormId",{get:function(){return this.response.FormId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ResponseId",{get:function(){return this.response.ResponseId},enumerable:!0,configurable:!0}),e.submitResponse=function(e,t){var r=n.map(t.Answers,(function(e){return{questionId:e.QuestionId,answer1:e.Answer}})),o={answers:JSON.stringify(r),startDate:t.StartDate instanceof Date?t.StartDate.toISOString():"",submitDate:t.SubmitDate instanceof Date?t.SubmitDate.toISOString():""};return o.emailReceiptConsent=t.EmailReceiptConsent,o.submitLanguage=t.SubmitLanguage,t.Responder&&(o.responder=t.Responder,o.responderName=t.ResponderName),c.a.getDataProviderByFormMaster(e).submitFormResponse(e.Model.Id,o)},e.getResponses=function(t,r,n){return c.a.getDataProviderByFormMaster(t).getFormResponses(t.Model.Id,null,r,n).then((function(t){return t.map(e.toClientPayload)}))},e.getRuntimeResponses=function(t){return c.a.getDataProviderByFormMaster(t).getRuntimeResponses(t.Model.Id).then((function(t){return t.map(e.toClientPayload)}))},e.deleteAllResponses=function(e){return c.a.getDataProviderByFormMaster(e).deleteFormResponses(e.Model.Id)},e.getReleasedResponsesByResponder=function(t,r){return c.a.getDataProviderByFormMaster(t).getRuntimeResponses(t.Model.Id,r).then((function(t){return t.filter((function(e){return"0001-01-01T00:00:00Z"!==e.releaseDate})).map(e.toClientPayload)}))},e.getRuntimeResponse=function(t,r){return c.a.getDataProviderByFormMaster(t).getRuntimeResponse(t.Model.Id,r).then(e.toClientPayload)},e.deleteResponses=function(e,t){var r=c.a.getDataProviderByFormId(e);return $.when.apply($,t.map((function(t){return r.deleteFormResponse(e,t)})))},e.toClientPayload=function(e){var t=o.a.convertFromSourceData(e,s.a.Schema);void 0!==t.StartDateAsString&&(t.StartDate=new Date(t.StartDateAsString)),void 0!==t.SubmitDateAsString&&(t.SubmitDate=new Date(t.SubmitDateAsString)),void 0!==t.ReleaseDateAsString&&(null===t.ReleaseDateAsString?t.ReleaseDate=new Date("0001-01-01T00:00:00Z"):t.ReleaseDate=new Date(t.ReleaseDateAsString));var r=[];if(t.AnswersAsString&&(r=JSON.parse(t.AnswersAsString).map((function(e){return{QuestionId:e.questionId,Answer:e.answer1}})),t.Answers=r),t.Comments){var i={},a=[];n.forEach(t.Comments,(function(e){var t=e.QuestionId||"___";i[t]&&a.push(i[t]),i[t]=e})),t.Comments=n.difference(t.Comments,a)}if(t.Comments){var c={};r.forEach((function(e){return c[e.QuestionId]=e})),n.forEach(t.Comments,(function(e){var n=e.QuestionId;if(n){var o=c[n];o||(o={QuestionId:n,Answer:null},r.push(o),c[n]=o),o.Feedback=e.Feedback,o.Score=e.Score}else t.Feedback=e.Feedback,t.TotalScore=e.Score}))}return t},e.prototype.add=function(e){return Object(i.c)("No scenario to call this method currently.")},e.prototype.delete=function(e){return this.dataProvider.deleteFormResponse(this.FormId,e.id)},e.prototype.query=function(e){return Object(i.c)("No scenario to call this method currently.")},e.prototype.update=function(e,t){var r=e.releaseDate,n=this.response.Form.SyncContext;return n!==a.e.DesignTimeForm&&n!==a.e.AnalysisTimeForm?$.Deferred().promise():void 0!==r?this.dataProvider.setResponseReleaseDate(this.FormId,this.ResponseId,r):$.Deferred().resolve().promise()},e}()},function(e,t,r){"use strict";r.d(t,"h",(function(){return c})),r.d(t,"g",(function(){return u})),r.d(t,"c",(function(){return d})),r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return p})),r.d(t,"d",(function(){return m})),r.d(t,"f",(function(){return h})),r.d(t,"e",(function(){return g})),r.d(t,"i",(function(){return y})),r.d(t,"j",(function(){return b}));var n=r(154),o=r(24),i=r(6),a=r(181),s=r(28);function c(e){return Object(a.a)(function(e){return e&&e.split(" ")[1]}(e)).exp<=Date.now()/1e3}function u(e){return e?$("<div/>").html(e).text():""}function l(e){return null==e}function d(e){if(l(e)||""===e.trim())return e;var t=e.replace(/&&/g,"__BR_AND_PAR__").replace(/\|\|/g,"__BR_OR_PAR__");return t=t.replace(/\(/g,"__BR_L_PAR__").replace(/\)/g,"__BR_R_PAR__")}function f(e){if(l(e)||""===e.trim())return e;var t=e.replace(/__BR_L_PAR__/g,"(").replace(/__BR_R_PAR__/g,")");return t=t.replace(/__BR_AND_PAR__/g,"&&").replace(/__BR_OR_PAR__/g,"||")}function p(e){var t=null;try{t=Object(n.decompressFromUTF16)(e),JSON.parse(t)}catch(e){t=null}return l(t)?e:t}function m(e){var t=$.Deferred();if(Object(i.a)().Flighting.isEnabled_Deprecated("EnableFormsProRoute")){var r=window.location.pathname;if(!e!=!r.toLowerCase().startsWith("/FormsPro".toLowerCase()))return r=e?"/FormsPro"+r:r.substring("/FormsPro".length),Object(s.e)(r),t.promise()}return t.resolve().promise()}function h(){if(o.a.IsIntegration)return{name:"type",operator:"ne",value:"'survey'"}}function g(e){var t=$.Deferred();if(!Object(i.a)().Flighting.isEnabled("ProRedirectInWeb"))return m(e);var r=window.location.pathname;if(!e!=!r.toLowerCase().startsWith("/FormsPro".toLowerCase())){var n="";if(e?(r="/FormsPro"+r,n="experienceType=base"):(r=r.substring("/FormsPro".length),n="experienceType=pro"),location.href.indexOf("experienceType=")>=0)Object(s.e)(r);else{n=0===location.search.length?"?"+n:"&"+n;var o=location.origin+r+location.search+n+location.hash;Object(s.f)(o)}return t.promise()}return t.resolve().promise()}function y(){var e=$.Deferred();if(Object(i.a)().Flighting.isEnabled("ProRedirectInWeb")){var t=location.href.indexOf("experienceType=");if(t>=0){var r=v(location.search,"experienceType"),n=window.location.pathname,o=n.toLowerCase().startsWith("/FormsPro".toLowerCase()),a=location.href.substring(t).toLowerCase().indexOf("pro")>=0;o&&a||!o&&!a?window.history.replaceState(null,null,n+r):(n=a?"/FormsPro"+n:n.substring("/FormsPro".length),Object(s.f)(location.origin+n+r))}return e.promise()}return e.resolve().promise()}function b(){var e=$.Deferred();if(Object(i.a)().Flighting.isEnabled("BaseProFRE")){if(location.href.indexOf("switch=")>=0){var t=v(location.search,"switch");window.history.replaceState(null,null,window.location.pathname+t)}return e.promise()}return e.resolve().promise()}function v(e,t){var r=window.location.search.substring(1);return r&&(r=r.split("&").filter((function(e){return!e.startsWith(t+"=")})).join("&")),r?"?"+r:""}FormsPro.encodeBranchingString=d,FormsPro.decodeBranchingString=f,FormsPro.compressString=function(e){var t=null;try{t=Object(n.compressToUTF16)(e)}catch(e){}return l(t)?e:t},FormsPro.decompressString=p},function(e,t,r){"use strict";var n=r(3),o=r(4),i=r(1),a=r(107),s=r(23),c=r(8),u=r(41),l=function(){function e(e){this.master=e,this.dataProvider=s.a.getDataProviderByFormMaster(this.master.Form)}return e.prototype.add=function(e){var t=this;if(this.master.Form.SyncContext!==c.e.DesignTimeForm)return $.Deferred().resolve().promise();var r=this.master.Form;return r?r.Synchronizer.existingInDataSource().then((function(){var r,o=[];for(r in e)if(e.hasOwnProperty(r)){var i=Object(u.g)(n.pick(e,[r]));null!==i.elementKey&&"localename"!==i.elementKey&&(i.locale=t.master.Model.localeId,i.questionId="",o.push(Object(a.a)(i,t.master.FormId)))}return $.when.apply($,o).then((function(e){}))})):$.Deferred().reject().promise()},e.prototype.delete=function(e){throw Error("No scenario to call this method currently.")},e.prototype.query=function(e){throw Error("No scenario to call this method currently.")},e.prototype.update=function(e,t){if(!t.ValuesBefore||this.master.Form.SyncContext!==c.e.DesignTimeForm)return $.Deferred().resolve().promise();var r,o=[];for(r in e)if(e.hasOwnProperty(r)){var i=null!==t.ValuesBefore[r],a=Object(u.g)(n.pick(e,[r]));a.locale=this.master.Model.localeId,a.questionId="",o.push(i?this.dataProvider.updateLocaleItem(this.master.FormId,a):this.dataProvider.createLocaleItem(this.master.FormId,a))}return $.when.apply($,o).then((function(e){}))},e}(),d=r(58);r.d(t,"a",(function(){return h}));var f,p=(f=function(e,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}f(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),m={footerText:i.a.string(),formCloseMessage:i.a.string(),formsprortlocalesubtitle:i.a.string(),formsprortlocaletitle:i.a.string(),localeId:i.a.string({IsKeyField:!0}),localeName:i.a.string(),questionResources:i.a.collectionOf((function(){return d.a})),subtitle:i.a.string(),thankYouMessage:i.a.string(),title:i.a.string()},h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return p(t,e),Object.defineProperty(t.prototype,"Form",{get:function(){return this.Parent.Parent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"LocaleId",{get:function(){return this.Model.localeId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"LocaleName",{get:function(){return this.Model.localeName},enumerable:!0,configurable:!0}),t.getFormResourceMaster=function(e,t){var r=n.find(t.Model.LocalizedResources,(function(t){return t.localeId===e}));if(r)return o.a.getObjectMasterFromModel(r);throw Error("This locale does not exist in form.")},t.getQuestionResourceMaster=function(e,t,r){var n=r.Model.LocalizedResources,i=o.a.Collection.getItemWithKeyFields(n,{localeId:e});if(i){if(i.questionResources||(i.questionResources=[]),i.questionResources.length>0){var a=o.a.Collection.getItemWithKeyFields(i.questionResources,{localeId:e,questionId:t});if(a)return o.a.getObjectMasterFromModel(a)}return Object(u.e)({localeId:e,localeName:i.localeName},t,i,r)}throw Error("This locale does not exist in form.")},t}(o.a.createObjectMasterClass("FormLocalizedItemMaster",m,(function(e){return new l(e)})))},function(e,t,r){"use strict";r.d(t,"b",(function(){return d})),r.d(t,"a",(function(){return f}));var n,o=r(0),i=r(20),a=r(3),s=r(5),c=r(12),u=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),l=function(){return(l=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function d(e){return o.createElement(f,l({},e))}var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.render=function(){var e=a.extend({},this.props.HTMLAttributes);switch(e.className=s.a.combineAttributes(e.className,"button-control"),e["aria-pressed"]=this.props.ToggleActive,this.props.ToggleActive&&(e.className=s.a.combineAttributes(e.className,"active")),this.props.ButtonStyle){case"LightBackground":e.className=s.a.combineAttributes(e.className,"light-background-button");break;case"DarkBackGround":e.className=s.a.combineAttributes(e.className,"dark-background-button")}return o.createElement("button",l({},e),o.createElement("div",{className:"button-content"},this.props.children))},t.prototype.focus=function(){i.findDOMNode(this).focus()},t.prototype.setTabIndex=function(e){i.findDOMNode(this).setAttribute("tabIndex",e.toString())},t}(c.a)},,function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(6),o=r(5),i=function(){function e(){}return e.isYouTubeUrl=function(e){return/^(https ?\:\/\/)?((www\.)?youtube\.com|youtu\.?be)\/.+$/.test(e)},e.isStreamUrl=function(e){return/^(https ?\:\/\/)?(?:msit|web)\.microsoftstream\.com\/.+$/.test(e)},e.isValidVideoUrl=function(t){return e.isYouTubeUrl(t)||e.isStreamUrl(t)},e.getVideoSrc=function(t){return e.isYouTubeUrl(t)?"YouTube":e.isStreamUrl(t)?"Stream":"Other"},e.isValidURL=function(e){var t=document.createElement("a");return t.href=e,t.host&&t.host!=window.location.host},e.generateEmbedURLLocally=function(t){return Object(n.a)().Flighting.isEnabled("SupportStreamVideo")?e.isYouTubeUrl(t)?e.generateEmbedYoutubeURLLocally(t):e.isStreamUrl(t)?e.generateEmbedStreamURLLocally(t):void 0:e.generateEmbedYoutubeURLLocally(t)},e.generateEmbedYoutubeURLLocally=function(e){var t=document.createElement("a");t.href=e;var r=t.pathname.split("/"),n=e.substring(e.indexOf("?")+1);return"https://www.youtube.com/embed/"+(o.a.getQueries(n).v||r[0]||r[1])+"?feature=oembed&modestbranding=1&rel=0"},e.generateEmbedStreamURLLocally=function(e){var t=e.indexOf("/video");return e.slice(0,t)+"/embed"+e.slice(t)+"?autoplay=false&amp;showinfo=true&amp;app=forms"},e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(35),o=function(){function e(){}return e.isSupported=function(){return n.a.supportsLocalStorage()},Object.defineProperty(e,"DetectAADInProgress",{get:function(){return function(e){var t=n.a.LocalStorage,r=e+".timestamp",o=t.getItem(r),i=o&&JSON.parse(o);if(!i||Date.now()>i)return t.removeItem(r),t.removeItem(e),null;var a=t.getItem(e);return a&&JSON.parse(a)}("officeforms.auth.detectAADInProgress")},set:function(e){!function(e,t,r){var o=e+".timestamp",i=n.a.LocalStorage;t?(i.setItem(o,JSON.stringify(Date.now()+r)),i.setItem(e,JSON.stringify(t))):(i.removeItem(o),i.removeItem(e))}("officeforms.auth.detectAADInProgress",e,5e3)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"DetectAADResult",{get:function(){return"true"===i("officeforms.auth.detectAADResult")},set:function(e){a("officeforms.auth.detectAADResult",e?"true":null)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"UseLegacyLoginDomain",{get:function(){return!!i("officeforms.uselegacylogindomain")},set:function(e){a("officeforms.uselegacylogindomain",e?"1":null)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"UserAccountName",{get:function(){var e=i("officeforms.userAccountNameKey");return e&&JSON.parse(e)},set:function(e){a("officeforms.userAccountNameKey",e?JSON.stringify(e):null)},enumerable:!0,configurable:!0}),e}();function i(e){return n.a.LocalStorage.getItem(e)}function a(e,t){t?n.a.LocalStorage.setItem(e,t):n.a.LocalStorage.removeItem("officeforms.uselegacylogindomain")}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return i}));var n=r(14),o=function(e){void 0===e&&(e={}),i(this,e)};function i(e,t,r){void 0===r&&(r=!1),Object(n.h)(e,"__nerve__",t,r)}},function(e,t,r){"use strict";function n(e,t){return a(t,e&&e.type,e&&e.statusCode)}function o(e,t){return a(t,e&&e.failureType,e&&e.statusCode)}function i(e){var t=e;if(t&&t.statusCode)return JSON.stringify({correlationId:t.correlationId,innerCode:t.innerCode,innerMessage:t.innerMessage,isServerError:t.isServerError,statusCode:t.statusCode,statusText:t.statusText,type:t.type});var r=e;return r&&r.message?JSON.stringify({message:r.message,name:r.name,stack:r.stack}):JSON.stringify(e||"")}function a(e,t,r){switch(e){case"Information":case"FormsProInformation":return!0;case"Error":return!1;default:switch(t){case"Failure":return!1;case"ExpectedFailure":return!0;default:var n=parseInt(r);if(n>=0&&n<500)return!0}}return!1}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return i}))},function(e,t,r){"use strict";r.d(t,"b",(function(){return y})),r.d(t,"c",(function(){return b})),r.d(t,"d",(function(){return v})),r.d(t,"a",(function(){return S})),r.d(t,"e",(function(){return M})),r.d(t,"h",(function(){return F})),r.d(t,"f",(function(){return O})),r.d(t,"g",(function(){return P}));var n=r(0),o=r(3),i=r(35),a=r(22),s=["mp3","aif","iff","m3u","m4a","mid","mpa","ra","wav","wma"],c=["xls","xlt","xlm","xlsx","xlsm","xltx","xltm"],u=["jpg","jpeg","png","gif","bmp","tiff","psd","thm","yuv","ai","drw","eps","ps","svg","3dm","max"],l=["ppt","pot","pps","pptx","pptm","potx","potm","ppam","ppsx","ppsm","sldx","sldm"],d=["pdf"],f=["avi","mp4","mov","wmv","asf","3g2","3gp","asx","flv","mpg","rm","swf","vob"],p=["doc","dot","wbk","docx","docm","dotx","dotm","docb"],m={};s.forEach((function(e){return m[e]="Audio"})),c.forEach((function(e){return m[e]="Excel"})),u.forEach((function(e){return m[e]="Image"})),l.forEach((function(e){return m[e]="PowerPoint"})),d.forEach((function(e){return m[e]="PDF"})),f.forEach((function(e){return m[e]="Video"})),p.forEach((function(e){return m[e]="Word"}));var h={Audio:s,Excel:c,Image:u,PDF:d,PowerPoint:l,Video:f,Word:p},g={Audio:{Color:"#666666",Name:"Microphone"},Excel:{Color:"#217346",Name:"ExcelDocument"},Image:{Color:"#666666",Name:"Photo2"},PDF:{Color:"#666666",Name:"PDF"},PowerPoint:{Color:"#B7472A",Name:"PowerPointDocument"},Text:{Color:"#666666",Name:"TextField"},Video:{Color:"#666666",Name:"Video"},Word:{Color:"#2B579A",Name:"WordDocument"}},y={"10MB":10,"100MB":100,"1GB":1e3};function b(e){var t=[];return Object.keys(e).forEach((function(r){e[r]&&(t=t.concat(h[r]))})),t}function v(e){var t=I(e),r={className:"forms-icon-size20x20 office-form-theme-quiz-point analyze-view-file-icon",style:{color:t.Color}};return n.createElement(a.a,{HTMLAttributes:r,IconName:t.Name})}function S(e,t){switch(t){case"Audio":return e.UploadFile_Type_Audio;case"Excel":return e.UploadFile_Type_Excel;case"Image":return e.UploadFile_Type_Image;case"PowerPoint":return e.UploadFile_Type_PowerPoint;case"PDF":return e.UploadFile_Type_PDF;case"Video":return e.UploadFile_Type_Video;case"Word":return e.UploadFile_Type_Word;default:return""}}function I(e){var t=e.split("."),r=t[t.length-1].toLowerCase();return g[m[r]]||{Color:"#666666",Name:"TextDocument"}}function M(e){var t=I(e);return'<i class="ms-Icon ms-Icon--'+t.Name+' forms-icon-size20x20 response-dialog-fileIcon office-form-theme-quiz-point" style="color: '+t.Color+';"></i>'}function F(e,t){var r=e.Model.Id;if(O(r)||!e.hasFileUpload()){var n=C(),a=o.find(n,(function(e){return e.FormId===r}));a?a.ShowConfirmDialog=a.ShowConfirmDialog&&t:n.push({FormId:r,ShowConfirmDialog:!0}),i.a.LocalStorage.setItem("officeforms.fileuploaddialogmap",JSON.stringify(n))}}function O(e){var t=o.find(C(),(function(t){return t.FormId===e}));return!!t&&t.ShowConfirmDialog}function C(){var e=[],t=i.a.LocalStorage.getItem("officeforms.fileuploaddialogmap");return t&&(e=JSON.parse(t)),e}function P(e){var t=e.Model.FileTypes;Object.keys(t).forEach((function(e){t[e]=!0}))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));var n,o={};!function(e){e[e.ApiFacadeEndPoint=0]="ApiFacadeEndPoint",e[e.FormsProUIHost=1]="FormsProUIHost",e[e.FormsHomeUrl=2]="FormsHomeUrl",e[e.FormsSingleSignOnHomeUrl=3]="FormsSingleSignOnHomeUrl",e[e.FormsProCdnHomeUrl=4]="FormsProCdnHomeUrl",e[e.PreviewSettingsDefaultDate=5]="PreviewSettingsDefaultDate",e[e.FormsProGeo=6]="FormsProGeo",e[e.FormsProLicensingServiceEndPoint=7]="FormsProLicensingServiceEndPoint",e[e.FormsProSampleFormTenantId=8]="FormsProSampleFormTenantId",e[e.FormsProMSRewardsAvailableCountryCodes=9]="FormsProMSRewardsAvailableCountryCodes",e[e.FormsProCSATEndpoint=10]="FormsProCSATEndpoint",e[e.FormsProCSATTenant=11]="FormsProCSATTenant",e[e.FormsProResponseLimit=12]="FormsProResponseLimit",e[e.UIFacadeEndPoint=13]="UIFacadeEndPoint"}(n||(n={})),o[n.ApiFacadeEndPoint]="https://mfpapifacadefaint.azurewebsites.net/",o[n.UIFacadeEndPoint]="https://mfpuifacadeint.projectsshimlaint.com/",o[n.FormsProUIHost]="https://mfpuiwebappint.azurewebsites.net",o[n.FormsHomeUrl]="https://forms.office-int.com",o[n.FormsSingleSignOnHomeUrl]="https://forms.office-int.com/formspro",o[n.FormsProCdnHomeUrl]="https://mfpembedcdnint.azureedge.net/mfpembedcontint/",o[n.PreviewSettingsDefaultDate]="2019-02-08",o[n.FormsProGeo]="INT",o[n.FormsProLicensingServiceEndPoint]="https://mfplicensingservicefaint.azurewebsites.net/",o[n.FormsProSampleFormTenantId]="558a6a52-809d-4de8-8b01-01a51502c93f",o[n.FormsProMSRewardsAvailableCountryCodes]="US",o[n.FormsProCSATEndpoint]="https://nps-int.onyx.azure.net",o[n.FormsProCSATTenant]="azureportal",o[n.FormsProResponseLimit]="50000";var i=function(){function e(){}return e.getSetting=function(t){var r=e.webSettingsMap[n[t].toString()];if(!r){var i=o[t];r=i||e.defaultValue}return r},e.webSettingsJson=decodeURI(OfficeFormServerInfo.webSettings||"{}"),e.webSettingsMap=JSON.parse(e.webSettingsJson),e.defaultValue="",e}();FormsPro.WebSettings=i,FormsPro.WebSettingKeys=n},function(e,t,r){"use strict";r.d(t,"c",(function(){return a})),r.d(t,"g",(function(){return s})),r.d(t,"e",(function(){return c})),r.d(t,"f",(function(){return u})),r.d(t,"d",(function(){return l})),r.d(t,"b",(function(){return d})),r.d(t,"a",(function(){return f}));var n,o=r(3),i=(r(286),r(25));function a(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(e&&document.activeElement&&e.contains(document.activeElement)){var n=$(":focusable");t&&t.forEach((function(e){n=n.not((function(t,r){return e.contains(r)}))}));var o=n.index(document.activeElement);if(!(o<0)){for(var i=o+1;i<n.length;++i){var a=n[i];if(!e.contains(a)&&!m(a))return void n[i].focus()}for(i=o-1;i>=0;--i){a=n[i];if(!e.contains(a)&&!m(a))return void n[i].focus()}}}}function s(e){$(e).on("keydown",p)}function c(e){$(e).off("keydown",p)}function u(e,t){n||(n={}),n[e]||delete n[e],n[e]=t}function l(e){n&&n[e]&&(n[e](),delete n[e])}function d(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=$(e).find(":focusable");t&&t.forEach((function(e){n=n.not((function(t,r){return e.contains(r)}))})),n[n.length-1].focus()}function f(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=$(e).find(":focusable");t&&t.forEach((function(e){n=n.not((function(t,r){return e.contains(r)}))})),n.length>0&&n[0].focus()}function p(e){if(e.keyCode===i.a.Tab){e.stopPropagation(),e.preventDefault();var t=$(this),r=o.union(t.filter(":focusable").toArray(),t.find(":focusable").toArray()),n=r.indexOf(document.activeElement);if(!(n<0)){var a=o.union(r.slice(n+1),r.slice(0,n));e.shiftKey&&a.reverse(),a.push(r[n]);var s=o.find(a,(function(e){return!m(e)}));s&&s.focus()}}}function m(e){var t=Number(e.getAttribute("tabindex"));return!isNaN(t)&&t<0}},function(e,t,r){"use strict";var n,o=r(0),i=r(7),a=r(12),s=r(118),c=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.prototype.render=function(){var e=this.props,t=e.Html;!Object(i.b)((function(){return!0}))&&e.RenderHtml||(t=Object(s.c)(e.Html));var r=Object(i.c)((function(){return t}),(function(){return i.a.sanitizeRichTextHTML(t)}));return o.createElement("span",{dangerouslySetInnerHTML:{__html:r}})},t}(a.a);r.d(t,"b",(function(){return f})),r.d(t,"a",(function(){return p}));var l=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),d=function(){return(d=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function f(e){return o.createElement(p,d({},e))}var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.render=function(){var e=this;return"RichText"===(this.props.RenderMode||"PlainText")?Object(i.c)((function(){return o.createElement(u,{Html:e.props.Text})}),(function(){return o.createElement(u,{Html:e.props.Text,RenderHtml:e.props.ContainsHtml})})):o.createElement("span",null,this.props.Text)},t}(a.a)},function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return a})),r.d(t,"a",(function(){return s})),r.d(t,"d",(function(){return c})),r.d(t,"e",(function(){return u}));var n=r(54),o=r(44),i="Customized Theme",a={BackgroundColor:"#E8F2F4",BackgroundImage:null,Name:"Default Theme",PrimaryColor:"#008272",SecondaryColor:"#004B50",Thumbnail:Object(o.a)("/Images/Theme/teal-thumbnail.png")},s=function(){function e(){}return e.loadThemes=function(t){return e.themes||(e.themes=Object(n.g)(t||a.Name).then(JSON.parse)),e.themes},e}();function c(e){return s.loadThemes(e).then((function(t){return u(t[e])||a}))}function u(e){if(!e)return e;var t=e.BackgroundImage;null!=t&&/^\/Images\//i.test(t)&&(e.BackgroundImage=Object(o.a)(t));var r=e.Thumbnail;return null!=r&&/^\/Images\//i.test(r)&&(e.Thumbnail=Object(o.a)(r)),e}},function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(3),o=r(27),i=r(34),a=function(e,t,r){this.answer=e,this.id=t||o.a.newGuid(),this.isMath=r},s=function(){function e(t){if(this.possibleCorrectAnswers=[],null!=t.GradingBasis)try{this.possibleCorrectAnswers=JSON.parse(t.GradingBasis)}catch(r){this.possibleCorrectAnswers=[],i.a.logData({errorName:"ShortTextGradingBasisJsonParseFailure",errorInfo:{gradingBasisLength:t.GradingBasis.length,nonAsciiDetected:e.doesContainNonAsciiCharacters(t.GradingBasis)}})}else this.possibleCorrectAnswers=[]}return e.prototype.serialize=function(){return JSON.stringify(this.possibleCorrectAnswers)},e.prototype.getAnswers=function(){return n.clone(this.possibleCorrectAnswers)},e.prototype.areAnyAnswersDefined=function(){return 0!==this.possibleCorrectAnswers.length},e.prototype.addAnswer=function(e,t){return!this.isInvalidAnswerCandidate(e)&&(!this.hasAnswerBeenPreviouslyAdded(e)&&(this.possibleCorrectAnswers.push(new a(e,void 0,t)),!0))},e.prototype.updateAnswer=function(e,t,r){if(this.isInvalidAnswerCandidate(t))return!1;if(this.hasAnswerBeenPreviouslyAdded(t,e))return!1;var n=this.getPossibleAnswerIndex(e);if(n<0)return!1;var o=this.possibleCorrectAnswers[n];return this.possibleCorrectAnswers[n]=new a(t,o.id,r),!0},e.prototype.deleteAnswer=function(e){var t=this.getPossibleAnswerIndex(e);t>=0&&this.possibleCorrectAnswers.splice(t,1)},e.prototype.isCorrect=function(e){return!this.isInvalidAnswerCandidate(e)&&(e=(e+="").trim().toUpperCase(),null!=n.find(this.possibleCorrectAnswers,(function(t){return t.answer.trim().toUpperCase()===e})))},e.prototype.hasAnswerBeenPreviouslyAdded=function(e,t){var r=(e+="").toUpperCase();return null!=n.find(this.possibleCorrectAnswers,(function(e){return e.answer.toUpperCase()===r&&e.id!==t}))},e.prototype.isInvalidAnswerCandidate=function(e){return null==e||""===e},e.prototype.getPossibleAnswerIndex=function(e){return n.findIndex(this.possibleCorrectAnswers,(function(t){return t.id===e}))},e.doesContainNonAsciiCharacters=function(e){for(var t=0;t<e.length;t++)if(e.charCodeAt(t)>127)return!0;return!1},e}()},function(e,t,r){"use strict";r.d(t,"c",(function(){return M})),r.d(t,"d",(function(){return F})),r.d(t,"a",(function(){return O})),r.d(t,"b",(function(){return C}));var n,o,i=r(16),a=r(6),s=r(9),c=r(84),u=r(48),l=r(11),d=r(49),f=r(5),p=r(28),m=r(13),h=r(116),g=r(65),y=r(161),b=OfficeFormServerInfo.signInLinkSilent,v=OfficeFormServerInfo.signInLinkSilentMsa,S=0,I=null;function M(e){var t=e&&e.response&&e.response.statusCode;if(Object(a.a)().Flighting.isEnabled("CookieAuth")&&t===i.a.Unauthorized){if(e&&e.response&&"Expired"===f.a.getHeaderIgnoreCase(e.response.headers,"X-FailureReason"))return!0;var r=e&&e.response&&m.I(e.response.body);if((r&&r.error&&parseInt(r.error.code))===i.b.TokenExpired)return!0}return!1}function F(){var e=$.Deferred();if(window.formsRefreshAuthTokenCallbacks||(window.formsRefreshAuthTokenCallbacks=[]),window.formsRefreshAuthTokenCallbacks.push((function(t,r){!r&&t?e.resolve():Object(a.a)().AuthContext.signIn().then(p.b)})),!window.formsRefreshAuthTokenCallback){var t=new c.a("Auth.RefreshToken");t.start();var r=function(e,r){try{t.end({extraData:{loggedIn:e},resultType:r?"ExpectedFailure":"Success"}),$("#refreshAuthTokenFrame").remove();var n=window.formsRefreshAuthTokenCallbacks;n&&(r?n&&n.length>0&&n[0](e,r):n.forEach((function(t){return t(e,r)})))}finally{window.formsRefreshAuthTokenCallback=void 0,window.formsRefreshAuthTokenCallbacks=void 0}};if(Object(a.a)().AuthContext.hasUserLoggedIn()){var n=OfficeFormServerInfo.userInfo.IsMsa?v:b,o=$('<iframe id="refreshAuthTokenFrame" style="display: none" src="'+n+'" />');o.on("load",(function(){window.setTimeout((function(){window.formsRefreshAuthTokenCallback&&window.formsRefreshAuthTokenCallback(!1,!0)}),5e3)})),window.formsRefreshAuthTokenCallback=r,$(document.body).append(o)}else r(!1,!0)}return e.promise()}function O(e,t){var r=$.Deferred();if(window.formsDetectUserLoggedInCallback)r.reject();else{var n="Msa"===e,o=n?"Auth.DetectUserLoggedInMSA":"Auth.DetectUserLoggedInAAD",i=new c.a(o);i.start();var a=n?v:b;t&&(a=f.a.updateUrlParam(a,n?"username":"login_hint",encodeURIComponent(t)));var s=$("<iframe id='detect-user-loggedIn-frame' style='display: none' src='"+a+"' />");s.on("load",(function(){window.setTimeout((function(){window.formsDetectUserLoggedInCallback&&window.formsDetectUserLoggedInCallback(!1,!0)}),5e3)})),window.formsDetectUserLoggedInCallback=function(e,t){window.formsDetectUserLoggedInCallback=void 0,i.end({resultType:t?"ExpectedFailure":"Success"}),$("#detect-user-loggedIn-frame").remove(),r.resolve(e)},$(document.body).append(s)}return r.promise()}function C(e){return d.a.isOembedTrialSSOEnabled()||d.a.isPPTContentAddinSSOEnabled()||d.a.isStreamSSOEnabled()?(o||(o=$.Deferred()),!d.a.isPPTContentAddinSSOEnabled()&&!d.a.isStreamSSOEnabled()&&I&&I.isAccessTokenFromHostValid()?(o.resolve(I.AccessToken),o.promise()):("pending"!==o.state()&&(o=$.Deferred()),I=null,window.addEventListener("message",P,!1),window.parent.postMessage("GetAccessTokenFromHost","*"),S=0,w(),o.promise())):m.g()?Object(h.a)().then(null,(function(){return T(e)})):T(e)}function P(e){if(e.data.startsWith("FormsAccessTokenFromHost:"))try{var t=e.data.indexOf("FormsAccessTokenFromHost:Bearer ");if(-1!==t){var r=e.data.substring(t+"FormsAccessTokenFromHost:Bearer ".length);I=new _(r)}}finally{window.removeEventListener("message",P,!1)}}function T(e){var t=$.Deferred();return Object(a.a)().Flighting.isEnabled("CookieAuth")?(t.resolve(null),t.promise()):e.getCachedUser()?(e.acquireToken(l.a.getFormsResourceId(),(function(r,o){if(!r&&o)return n=new Date,void t.resolve(o);var i;if(!e.getCachedToken(l.a.getAadClientId())){if(n){var a=(new Date).getTime()-n.getTime();Object(s.a)({eventName:"Auth.AcquireTokenIdleTime",eventType:"engagement_event",extraData:{error:r,idleTimeInMinutes:a/6e4}})}return e.clearCache(),void Object(p.d)()}if(e.clearCache(),r.match("^AADSTS50079:"))return Object(s.a)({eventName:"AADAcquireTokenMfaCheckFailure",eventType:"error_event",extraData:r}),(i=new Error).name=u.a.AADAcquireTokenMfaCheckError,i.message=r,void t.reject(i);if(!r.match("^AADSTS50058:"))return Object(s.a)({eventName:"AADAcquireTokenFailure",eventType:"error_event",extraData:r}),(i=new Error).name=u.a.AADAcquireTokenError,i.message=r,void t.reject(i);if(m.q()||m.o()){var c=g.a.UseLegacyLoginDomain;if(Object(s.a)({eventName:"LoginIECrossZone",eventType:"error_event",extraData:{useLegacyLoginDomain:!!c}}),g.a.UseLegacyLoginDomain)g.a.UseLegacyLoginDomain=!1;else if(g.a.isSupported())return g.a.UseLegacyLoginDomain=!0,void Object(p.d)()}else Object(s.a)({eventName:"AADAcquireTokenFailure",eventType:"error_event",extraData:r});(function(e){var t=$.Deferred();return function(e){var t=function(r){switch(r.data){case"TPC:NotSupported":e(!1),window.removeEventListener("message",t);break;case"TPC:Supported":e(!0),window.removeEventListener("message",t)}};window.addEventListener("message",t,!1);$("body").append('<iframe id="detectThirdPartyCookieFrame" style="display:none;" src=https://controls.officeppe.com/thirdpartycookie/check.html><iframe>')}((function(r){Object(s.a)({eventName:"Auth.ThirdPartyCookieSupport",eventType:"engagement_event",extraData:{allow:r}});var n=new Error(e);n.name=r?u.a.LoginIECrossZoneError:u.a.ThirdPartyCookieBlockedError,t.resolve(n)})),t.promise()})(r).done((function(e){return t.reject(e)}))})),t.promise()):(t.resolve(null),t.promise())}function w(){if(null!=I){var e=I.AccessToken;Object(y.a)(e).always((function(){return o.resolve(e)}))}else S<10?(S++,window.setTimeout(w,1e3)):(S=0,o.resolve(null))}var _=function(){function e(e){this.accessToken=e;this.tokenExpireTime=(new Date).getTime()+33e5}return Object.defineProperty(e.prototype,"AccessToken",{get:function(){return this.accessToken},enumerable:!0,configurable:!0}),e.prototype.isAccessTokenFromHostValid=function(){return!!this.accessToken&&(new Date).getTime()<this.tokenExpireTime},e}()},function(e,t,r){"use strict";r.d(t,"b",(function(){return d})),r.d(t,"d",(function(){return f})),r.d(t,"f",(function(){return p})),r.d(t,"e",(function(){return m})),r.d(t,"c",(function(){return h})),r.d(t,"a",(function(){return g})),r.d(t,"g",(function(){return y}));r(157);var n=r(3),o=r(4),i=r(36),a=r(80),s=r(8),c={},u={},l=new a.a.CallbackManager;function d(e,t,r,i){var a=s.c.FieldsForCreatingForm.map(o.a.getFieldSchemaInfo).map((function(e){return e.Name}));e=n.pick(e,a);var d=new s.c(s.e.DesignTimeForm,{ExistingInDataSource:!1,InitialData:e},"Group"===t,r,i);return u[d.getInstanceId()]=d,d.fieldsReady([s.c.Schema.Id]).done((function(){c[d.Model.Id]=d})),l.trigger(d),d}function f(e,t){var r=c[e.Id];if(r){var a=o.a.convertToSourceData(e,s.c.Schema);return r.Synchronizer.onSourceDataReceived(a),r}var d=Object(i.a)(e.Id);return(e=n.clone(e)).OwnerId=d.OwnerId,e.OwnerTenantId=d.OrgId,e.TableId=d.TableId,r=new s.c(s.e.DesignTimeForm,{ExistingInDataSource:!0,InitialData:e},d.IsGroupOwner,t),u[r.getInstanceId()]=r,c[e.Id]=r,l.trigger(r),r}function p(e){return u[e]}function m(e){return c[e]}function h(e){var t=Object(i.a)(e);return new s.c(s.e.ResponseTimeForm,{ExistingInDataSource:!0,InitialData:{Id:e,OwnerId:t.OwnerId,OwnerTenantId:t.OrgId,TableId:t.TableId}},t.IsGroupOwner,!1)}function g(e){var t=Object(i.a)(e);return new s.c(s.e.AnalysisTimeForm,{ExistingInDataSource:!0,InitialData:{Id:e,OwnerId:t.OwnerId,OwnerTenantId:t.OrgId,TableId:t.TableId}},t.IsGroupOwner,!1)}function y(e){l.register(e)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r(3),o=r(4),i=r(2),a=r(27),s=r(41),c=r(39),u=r(8),l=r(10),d=r(15),f=function(){function e(e){this.formMaster=e}return Object.defineProperty(e,"QuestionOrderFloor",{get:function(){return 500},enumerable:!0,configurable:!0}),Object.defineProperty(e,"QuestionOrderDefaultStep",{get:function(){return 100},enumerable:!0,configurable:!0}),e.isDescriptiveElement=function(e){return e===d.a.Section},e.isSection=function(e){return e===d.a.Section},Object.defineProperty(e.prototype,"TopQuestionMasters",{get:function(){return n.filter(this.formMaster.Model.Questions,(function(e){return!e.GroupId})).map(o.a.getObjectMasterFromModel)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"HeaderTopQuestionMasters",{get:function(){var e=this.SectionMasters,t=e.length&&e[0].Model.Order;return t>0?this.findQuestionsInBetween(null,t):this.TopQuestionMasters},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"HeaderQuestionMasters",{get:function(){var e=this.SectionMasters,t=e.length&&e[0].Model.Order;return t>0?this.findQuestionsInBetween(null,t,!0):this.QuestionMasters},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"QuestionMasters",{get:function(){return o.a.convertToArray(this.formMaster.Model.Questions).map(o.a.getObjectMasterFromModel)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DescriptiveElementMasters",{get:function(){return o.a.convertToArray(this.formMaster.Model.DescriptiveElements).map(o.a.getObjectMasterFromModel)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SectionMasters",{get:function(){return n.filter(this.DescriptiveElementMasters,(function(t){return e.isDescriptiveElement(t.Model.Type)}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AllElementMasters",{get:function(){return this.getAllElements().map(o.a.getObjectMasterFromModel)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TopElementMasters",{get:function(){return this.getFormElements(!0).map(o.a.getObjectMasterFromModel)},enumerable:!0,configurable:!0}),e.prototype.getQuestionById=function(e){var t=o.a.Collection.getItemWithKeyFields(this.formMaster.Model.Questions,{Id:e});return t&&Object(l.h)(t)},e.prototype.getElementMasterById=function(e){return this.getQuestionById(e)||this.getDescriptiveElementMasterById(e)},e.prototype.getDescriptiveElementMasterById=function(e){var t=o.a.Collection.getItemWithKeyFields(this.formMaster.Model.DescriptiveElements,{Id:e});return t&&Object(c.c)(t)},e.prototype.appendElement=function(t,r){var i=[];t.Id||((t=n.clone(t)).Id=e.createNewQuestionId());var a=this.getAllElements(),s=a.length>0?a[a.length-1].Order:e.QuestionOrderFloor;if(t.Order=s+e.QuestionOrderDefaultStep,r&&(i=r.map((function(r,o){return(r=n.clone(r)).Id=e.createNewQuestionId(),r.GroupId=t.Id,r.Order=t.Order+(o+1)*e.QuestionOrderDefaultStep,r}))),e.isDescriptiveElement(t.Type)){var u=o.a.Collection.addItems(this.formMaster.Model.DescriptiveElements,[t]);return Object(c.c)(u[0])}var d=[t];d=d.concat(i);u=o.a.Collection.addItems(this.formMaster.Model.Questions,d);return Object(l.h)(u[0])},e.prototype.duplicateElement=function(e){var t=e.getSnapshotWithoutBranchInfo();delete t.Id;var r=e.SubQuestionMasters.map((function(e){var t=e.getSnapshotWithoutBranchInfo();return delete t.Id,delete t.GroupId,delete t.QuestionInfo,t}));return this.insertElementAfter(t,e,r)},e.prototype.duplicateSectionAndSubElements=function(t){var r=this,a=this.findQuestionsInSection(t,!0),c=n.find(this.SectionMasters,(function(e){return e.Model.Order>t.Model.Order})),u=t.Model.Order,l=t.Model.Order+e.QuestionOrderDefaultStep*(a.length+1);a.length>0&&(u=n.last(a).Model.Order),c&&(l=c.Model.Order);var f=(l-u)/(a.length+2),p=n.clone(t.getSnapshot());p.Id=e.createNewQuestionId(),p.Order=u+f,p.Title=i.a.LocalizedStrings.Title_For_Duplicate_Section.format(p.Title);var m,h=[{newId:p.Id,oldId:t.Model.Id}],g=[];return a&&a.forEach((function(t,r){var o=n.clone(t.getSnapshot());switch(o.Id=e.createNewQuestionId(),o.Order=p.Order+f*(r+1),g.push(o),o.Type){case d.a.MatrixChoiceGroup:m=o.Id;break;case d.a.MatrixChoice:o.GroupId=m}h.push({newId:o.Id,oldId:t.Model.Id})})),this.formMaster.bulkEdit((function(){o.a.Collection.addItems(r.formMaster.Model.DescriptiveElements,[p]),o.a.Collection.addItems(r.formMaster.Model.Questions,g)})),Object(s.f)(t.Form.Model.LocalizedResources,h),this.getDescriptiveElementMasterById(p.Id)},e.prototype.deleteFormQuestion=function(e){o.a.Collection.itemsDeletedInSource(e.Form.Model.Questions,e.SubQuestionMasters.map((function(e){return e.Model}))),e.Deleted=!0},e.prototype.deleteSectionAndSubElements=function(e){var t=this,r=this.findQuestionsInSection(e);this.formMaster.bulkEdit((function(){r.forEach((function(e){return t.deleteFormQuestion(e)})),e.Deleted=!0}))},e.prototype.findQuestionsInSection=function(e,t){if(e){var r=this.SectionMasters,o=n.indexOf(r,e);return o>=0?this.findQuestionsInBetween(r[o].Model.Order,o+1<r.length?r[o+1].Model.Order:null,t):[]}return t?this.HeaderQuestionMasters:this.HeaderTopQuestionMasters},e.prototype.findContainerSection=function(e){var t=this.SectionMasters;return t[n.findLastIndex(t,(function(t){return t.Model.Order<=e.Model.Order}))]},e.prototype.moveElementDown=function(t){var r=this.TopElementMasters,o=n.indexOf(r,t);if(o!==r.length-1){var i=r[o+1],a=i instanceof l.d&&i.SubQuestionMasters.length>0?i.SubQuestionMasters[i.SubQuestionMasters.length-1].Model.Order:i.Model.Order,s=a+e.QuestionOrderDefaultStep;o+1<r.length-1&&(s=r[o+2].Model.Order);var c=t.SubQuestionMasters.map((function(e){return e.Model}));this.formMaster.bulkEdit((function(){return e.updateQuestionOrder(t.Model,c,a,s)}))}},e.prototype.moveElementUp=function(t){var r=this.TopElementMasters,o=n.indexOf(r,t);if(!(o<=0)){var i=e.QuestionOrderFloor,a=r[o-1],s=n.indexOf(this.AllElementMasters,a);s>0&&(i=this.AllElementMasters[s-1].Model.Order);var c=r[o-1].Model.Order,u=t.SubQuestionMasters.map((function(e){return e.Model}));this.formMaster.bulkEdit((function(){return e.updateQuestionOrder(t.Model,u,i,c)}))}},e.prototype.moveSectionTo=function(t,r){var o,i=e.QuestionOrderFloor,a=this.SectionMasters,s=n.indexOf(a,t),c=n.indexOf(a,r),u=n.last(this.HeaderTopQuestionMasters);u&&(i=u.Model.Order);var l=this.findQuestionsInSection(t,!0).map((function(e){return e.Model}));if(s>c){if(o=r.Model.Order,c>0)i=a[c-1].Model.Order,(d=this.findQuestionsInSection(a[c-1])).length>0&&(i=n.max(d,(function(e){return e.Model.Order})).Model.Order)}else{if(!(s<c))return;var d=this.findQuestionsInSection(r);i=a[c].Model.Order,d.length>0&&(i=n.max(d,(function(e){return e.Model.Order})).Model.Order),o=i+e.QuestionOrderDefaultStep*(l.length+1),c+1<a.length&&(o=a[c+1].Model.Order)}this.formMaster.bulkEdit((function(){return e.updateDescriptiveElementOrder(t.Model,l,i,o)}))},e.prototype.insertElementAfter=function(t,r,i){t=n.clone(t);var a=[];i&&(a=i.map(n.clone));var s=this.getAllElements(),u=e.QuestionOrderFloor,d=u+e.QuestionOrderDefaultStep;if(r){r instanceof l.d&&r.SubQuestionMasters.length>0&&(r=r.SubQuestionMasters[r.SubQuestionMasters.length-1]);var f=n.indexOf(s,r.Model);f!==s.length-1?(u=r.Model.Order,d=s[f+1].Order):(u=r.Model.Order,d=r.Model.Order+e.QuestionOrderDefaultStep)}else s.length>0&&(d=s[0].Order);if(e.updateQuestionOrder(t,a,u,d),t.Id||(t.Id=e.createNewQuestionId(),a.forEach((function(r){r.Id=e.createNewQuestionId(),r.GroupId=t.Id}))),e.isDescriptiveElement(t.Type)){var p=o.a.Collection.addItems(this.formMaster.Model.DescriptiveElements,[t]);return Object(c.c)(p[0])}var m=[t];m=m.concat(a);p=o.a.Collection.addItems(this.formMaster.Model.Questions,m);return Object(l.h)(p[0])},e.prototype.adjustElementOrders=function(){var t=this;if(this.formMaster.isFieldReady(u.c.Schema.Questions)){var r=this.formMaster.isFieldReady(u.c.Schema.DescriptiveElements),n=this.getAllElements();n.length&&this.formMaster.bulkEdit((function(){n.sort(e.questionComparer),n[0].Order||(n[0].Order=e.QuestionOrderFloor+e.QuestionOrderDefaultStep);for(var o=0,i=n[0].Order,a=1;a<=n.length;++a){var s=n[a]&&n[a].Order;if(!s)break;if(i!==s){var c=(s-i)/(a-o);for(i+=c;++o<a;)n[o].Order=i,i+=c}}for(;++o<n.length;)i+=e.QuestionOrderDefaultStep,n[o].Order=i;t.formMaster.Model.Questions=n.filter((function(t){return!e.isDescriptiveElement(t.Type)})).map((function(e){return e})),r&&(t.formMaster.Model.DescriptiveElements=n.filter((function(t){return e.isDescriptiveElement(t.Type)})))}))}},e.prototype.getSectionNodes=function(){var e=this,t=[],r=this.HeaderTopQuestionMasters;return r.length&&t.push({TopQuestionMasters:r}),this.SectionMasters.forEach((function(r){t.push({Section:r,TopQuestionMasters:e.findQuestionsInSection(r)})})),t},e.prototype.getFormElements=function(t){var r=o.a.convertToArray(this.formMaster.Model.Questions);t&&(r=n.filter(r,(function(e){return!e.GroupId})));var i=r;return this.formMaster.isFieldReady(u.c.Schema.DescriptiveElements)&&(i=i.concat(o.a.convertToArray(this.formMaster.Model.DescriptiveElements)).sort(e.questionComparer)),i},e.prototype.getAllElements=function(){return this.getFormElements(!1)},e.createNewQuestionId=function(){return"r"+a.a.newGuid().replace(/-/g,"")},e.questionComparer=function(e,t){var r=e.Order-t.Order;return e.Order&&t.Order||(r=-r),r||e.Id.localeCompare(t.Id)},e.updateQuestionOrder=function(e,t,r,n){var o=(n-r)/(t.length+2);e.Order=r+o,t.forEach((function(t,r){t.Order=e.Order+o*(r+1)}))},e.updateDescriptiveElementOrder=function(e,t,r,n){var o=(n-r)/(t.length+2);e.Order=r+o,t.forEach((function(t,r){t.Order=e.Order+o*(r+1)}))},e.prototype.findQuestionsInBetween=function(e,t,r){var n;return n=r?this.QuestionMasters:this.TopQuestionMasters,null!==t&&(n=n.filter((function(e){return t>e.Model.Order}))),null!==e&&(n=n.filter((function(t){return t.Model.Order>e}))),n},e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(0),o=r(2),i={};Object.defineProperty(i,"LocalizedStrings",{get:function(){return o.a.LocalizedStrings}});var a=n.createContext(i)},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(5),o=function(){function e(){}return e.notifyResponsePageHeightToParentWindow=function(){if(OfficeFormServerInfo.isOembedSPO&&$(".office-form.office-form-theme-shadow").height()&&$(".office-form-footer-container").height()){var t=$(".office-form.office-form-theme-shadow").height()+$(".office-form-footer-container").height()+e.responsePageBuffer;t+=$(".office-form-new-bottom-bar").height()?$(".office-form-new-bottom-bar").height():0;e.nofityPageHeightToParentWindow("ResponsePage",t)}},e.notifyAnalysisPageHeightToParentWindow=function(){if(OfficeFormServerInfo.isOembedSPO&&$(".analysis-page-content").height()){var t=$(".analysis-page-content").height()+e.analysisPageBuffer;e.nofityPageHeightToParentWindow("AnalysisPage",t)}},e.notifyResponsePageFixedHeightToParentWindow=function(t){OfficeFormServerInfo.isOembedSPO&&e.nofityPageHeightToParentWindow("ResponsePage",t)},e.nofityPageHeightToParentWindow=function(e,t){var r=n.a.getQueries().hostId;if(r)parent.postMessage("FormsPageHeight:"+r+":"+t.toString(),"*");else{var o=n.a.getQueries().id;parent.postMessage(e+"Height:"+o+":"+t.toString(),"*")}},e.notifyFormInfoToParentWindow=function(e){if(OfficeFormServerInfo.isOembedSPO){var t=e.Model.Title?e.Model.Title:"",r=e.Model.Description?e.Model.Description:"",o=n.a.getQueries().hostId;parent.postMessage("FormsInfo:"+o+":"+encodeURIComponent(t)+":"+encodeURIComponent(r),"*")}},e.notifyFormErrorToParentWindow=function(e){if(OfficeFormServerInfo.isOembedSPO){var t=e&&(e.innerCode||e.message||""),r=n.a.getQueries().hostId;parent.postMessage("FormsError:"+r+":"+encodeURIComponent(t),"*")}},e.analysisPageBuffer=50,e.responsePageBuffer=80,e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(6),o=r(32);function i(e,t){return Object(n.a)().AuthContext.getFormApiToken().then((function(r){var n;return e.headers=$.extend(!0,e.headers,(n=r||"",{__RequestVerificationToken:OfficeFormServerInfo.antiForgeryToken,Accept:"application/json",Authorization:n?"Bearer "+n:"","Content-Type":"application/json"})),Object(o.b)(e,t).then((function(e){return e?o.a.parseResponseDataValue(e):$.Deferred().reject().promise()}),o.a.parseAndTryHandleError)}))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(3),o=function(){};!function(e){var t=function(){function e(e,t){void 0===t&&(t=0),this.functionToCall=e,this.timeToWaitInMs=t}return e.prototype.callOnceLater=function(){var e=this;0!==this.timeToWaitInMs&&null!=this.handler&&this.clear(),null==this.handler&&(this.handler=window.setTimeout((function(){e.callImmediately()}),this.timeToWaitInMs))},e.prototype.flush=function(){null!=this.handler&&(this.clear(),this.functionToCall())},e.prototype.callImmediately=function(){null!=this.handler&&this.clear(),this.functionToCall()},e.prototype.clear=function(){clearTimeout(this.handler),this.handler=void 0},e}();e.CallLater=t;var r=function(){function e(){this.callbacks=[]}return e.prototype.register=function(e){this.callbacks.push(e)},e.prototype.unregister=function(e){this.callbacks=n.without(this.callbacks,e)},Object.defineProperty(e.prototype,"trigger",{get:function(){return this.triggerInternal},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this.callbacks=[]},e.prototype.triggerInternal=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.callbacks.forEach((function(t){return t.apply(void 0,e)}))},e}();e.CallbackManager=r;var o=function(){function e(){this.buffer=[]}return e.prototype.setFunctionToCall=function(e){var t=this;if(this.functionToCall!==e)if(this.functionToCall=e,e){var r=this.buffer;delete this.buffer,r&&r.length&&r.forEach((function(e){return t.functionToCall.apply(void 0,e)}))}else this.buffer=this.buffer||[]},Object.defineProperty(e.prototype,"queue",{get:function(){return this.functionToCall?this.functionToCall:this.defaultQueue},enumerable:!0,configurable:!0}),e.prototype.defaultQueue=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.buffer.push(e)},e}();e.BufferForCall=o;var i=function(){function e(e){this.queue=[],this.jobCountLeft=e}return e.prototype.queueJob=function(e){e&&(this.queue.push(e),this.tryProcessQueuedJob())},e.prototype.stopProcessingNewJob=function(){this.jobCountLeft=-1/0},e.prototype.tryProcessQueuedJob=function(){for(var e=this;this.jobCountLeft>0&&this.queue.length;){--this.jobCountLeft,this.queue.shift()().always((function(){++e.jobCountLeft,e.tryProcessQueuedJob()}))}},e}();e.Pool=i}(o||(o={}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return s}));var n=r(4),o=0,i=function(){function e(e,t,r){this.master=e,this.targetField=t,this.bindedFields=r.FieldSchemas,this.bind()}return e.prototype.serialize=function(){var e=this.master.getSnapshot(this.bindedFields),t=this.master.Schema,r={};this.bindedFields.forEach((function(t){var o=n.a.getFieldSchemaInfo(t).Name;r[o]=n.a.convertToSourceData(e[o],t)}));var i=n.a.getFieldSchemaInfo(this.targetField).Name,s=a(r,t,[]),c=s&&JSON.stringify(s),u=this.master.Model[i]!==c;(u||Math.random()<o)&&(u=!0,c=(s=a(r,t,null))&&JSON.stringify(s)),u&&(this.master.Model[i]=c)},e.prototype.deserialize=function(){var e=n.a.getFieldSchemaInfo(this.targetField).Name,t=this.master.Model[e],r=t?JSON.parse(t):{},o={};this.bindedFields.forEach((function(e){var t=n.a.getFieldSchemaInfo(e).Name;o[t]=n.a.convertFromSourceData(r[t],e)})),this.master.setData(o,this.bindedFields)},e.prototype.bind=function(){var e=this,t=n.a.getFieldSchemaInfo(this.targetField).Name;this.master.addRule({Name:"Deserialize - "+t,InterestedFields:[this.targetField],onChange:function(t){t.BeingDeleted||e.deserialize()}}),this.master.addRule({Name:"Serialize - "+t,InterestedFields:this.bindedFields,onChange:function(t){t.BeingDeleted||e.serialize()}})},e}();function a(e,t,r){if(null==e)return null;if(Array.isArray(e)){if(e.length){var o=t[0];return e.map((function(e){return a(e,o,r)}))}return r}var i={},s=0;return n.a.getSubFieldSchemas(t).forEach((function(t){var o=n.a.getFieldSchemaInfo(t),c=o.Attributes.SourceFieldName||o.Name,u=e[c];o.IsLeaf||(u=a(u,t,r)),null!=u&&(++s,i[c]=u)})),s>0?i:null}function s(e){o=e}},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(3),o=r(4),i=r(111),a=function(){function e(e){this.fieldSchemas=e.concat(),this.fieldNames=e.map((function(e){return o.a.getFieldSchemaInfo(e).Name}))}return Object.defineProperty(e.prototype,"FieldSchemas",{get:function(){return this.fieldSchemas.concat()},enumerable:!0,configurable:!0}),e.prototype.covers=function(e){return i.a.isString(e)?n.contains(this.fieldNames,e):n.contains(this.fieldSchemas,e)},e}()},function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return c}));var n=r(3),o=r(8),i=r(111),a=function(){function e(){}return e.SettingsAllowResponderGetAllResponses="Settings.AllowResponderGetAllResponses",e.DisableEditForm="DisableEditForm",e.ResponsePagePollView="ResponsePage.PollView",e}(),s={Poll:[a.SettingsAllowResponderGetAllResponses,a.DisableEditForm,a.ResponsePagePollView],"Teams Poll":[a.DisableEditForm]},c=function(){function e(){}return e.supportsExtensionPoint=function(e,t){var r;if(i.a.isString(e))r=e;else if(e){var a=e;if(a.isFieldReady(o.c.Schema.OwnerId)&&!a.IsGroupForm&&a.Model.OwnerId!==OfficeFormServerInfo.userInfo.UserId)return!1;r=a.Model.Category}return!!r&&n.contains(s[r],t)},e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(3),o=r(47),i=r(27),a=r(9),s=function(){function e(e){this.eventData={correlationId:i.a.newGuid(),duration:0,eventName:e,eventType:"qos_event",extraData:void 0},this.startTime=null}return Object.defineProperty(e.prototype,"EventName",{get:function(){return this.eventData.eventName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Duration",{get:function(){return this.eventData.duration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CorrelationId",{get:function(){return this.eventData.correlationId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ExtraData",{get:function(){return this.eventData.extraData},set:function(e){this.eventData.extraData=e},enumerable:!0,configurable:!0}),e.prototype.start=function(){this.startTime=o.a.getTimeStamp();var e=this.prepareEvent(this.eventData,"Start");Object(a.a)(e)},e.prototype.end=function(e){var t=this.prepareEvent(e,"End");Object(a.a)(t)},e.prototype.log=function(e){var t=this.prepareEvent(e,"Log");Object(a.a)(t)},e.prototype.prepareEvent=function(e,t){var r=n.clone(this.eventData);switch(null!==this.startTime&&"Start"!==t&&(r.duration=o.a.getTimeStamp()-this.startTime),e.logLevel&&(r.logLevel=e.logLevel),e.extraData&&(r.extraData=e.extraData),t){case"Start":r.eventName+="."+t;break;case"Log":r.eventName+="."+t,e.resultCode&&(r.eventName+="."+e.resultCode);break;case"End":e.resultType&&(r.eventName+="."+e.resultType)}return r},e}()},function(e,t,r){"use strict";r.d(t,"b",(function(){return s})),r.d(t,"a",(function(){return c}));var n,o=r(11),i=r(115),a=r(44);function s(e){return $.when.apply($,e.map(c))}function c(e){return y[e]||(y[e]=s(h[e]||[]).then((function(){return function(e){var t=$.Deferred();void 0===n&&(n=function(e){return Object.keys(e).reduce((function(t,r){return t[r]=function(e,t){if(m.indexOf(e)>=0)return t||"";return Object(a.b)(t,!1)}(r,e[r]),t}),{})}(p));var r=n[e];if(!r)throw Error("No script path for "+e);var o=document.getElementsByTagName("head")[0];if(!o)return t.reject(Error("No head element found!")).promise();var i=document.createElement("script");i.type="text/javascript",i.async=!0,i.src=r,OfficeFormServerInfo.isCdnEnabled&&OfficeFormServerInfo.isCrossOriginEnabled&&m.indexOf(e)<0&&(i.crossOrigin="anonymous");return i.onload=function(){t.resolve()},i.onerror=function(e){o.removeChild(i),t.reject(Error("Failed to load javascript file: "+r))},o.appendChild(i),t.promise()}(e)})),"undefined"!=typeof Forms&&Object(i.b)("script:"+e,y[e])),y[e]}var u=OfficeFormServerInfo.scriptSuffix,l=OfficeFormServerInfo.isCdnEnabled,d=OfficeFormServerInfo.reactUpgrade,f=!!OfficeFormServerInfo.signalrUpgrade,p={"combined-design":l?d?f?"Vendors/combinedmin/design_v3.min.js":"Vendors/combinedmin/design_v2.min.js":"Vendors/combinedmin/design.min.js":d?f?"Vendors/combined/design_v3_e982333.js":"Vendors/combined/design_v2_1cbe596.js":"Vendors/combined/design_eddd708.js","combined-response":l?d?"Vendors/combinedmin/response_v2.min.js":"Vendors/combinedmin/response.min.js":d?"Vendors/combined/response_v2_e8aff49.js":"Vendors/combined/response_e699f95.js",BootStrap:"Vendors/bootstrap/3.4.1/bootstrap."+u,DataTables:"Vendors/DataTables."+u,Chart:"Vendors/Chart-2.6."+u,Clipboard:"Vendors/clipboard-1.7.1.min.js",ColorThief:"Vendors/color-thief/color-thief.min.js",Cropper_Modified:"Vendors/cropper/cropper.modified."+u,D3:"Vendors/d3/d3."+u,FileSave:"Vendors/FileSaver.min.js",Heatmap:"Vendors/highcharts/heatmap.min.js",HighCharts:"Vendors/highcharts/highcharts.min.js",HighCharts_More:"Vendors/highcharts/highcharts-more.min.js",ImmersiveReader:"Vendors/ImmersiveReader/immersive-reader-sdk.0.0.2.min.js",Ivy:"//edera.cloudapp.net/javascripts/api/ivy.js",OfficeBrowserFeedback:"Vendors/officebrowserfeedback/1.4.2/officebrowserfeedback_floodgate.min.js",JQuery_RateIt:"Vendors/rating-1.1.0/jquery.rateit."+u,JQuery_Picker:"Vendors/pickadate-3.5.6/picker."+u,JQuery_Picker_Date:"Vendors/pickadate-3.5.6/picker.date."+u,JQuery_Picker_Time:"Vendors/pickadate-3.5.6/picker.time."+u,JQuery_QRCode:"Vendors/jquery.qrcode.min.js",Linkify:"Vendors/linkify-2.1.8/linkify.min.js",Linkify_JQuery:"Vendors/linkify-2.1.8/linkify-jquery.min.js",MathJax:o.a.isOsi()?"../scripts/vendors/mathjax/MathJax.js?config=TeX-AMS_HTML":"//cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS_HTML",MathQuill:"Vendors/mathquill/mathquill."+u,O365ShellBootstrap:OfficeFormServerInfo.o365ShellBootHost?OfficeFormServerInfo.o365ShellBootHost.concat("/api/shellbootstrapper/",OfficeFormServerInfo.userInfo.IsMsa?"consumer":"business","/oneshell"):"",Pattern_Fill:"Vendors/highcharts/pattern-fill.min.js",Mark:"Vendors/markjs-8.9.0/mark."+u,SignalR:f?"Vendors/SignalR/jquery.signalR-2.4.1.min.js":"Vendors/SignalR/jquery.signalR-2.2.0.min.js",Sortable:"Vendors/sortablejs-1.8.4/Sortable.modified."+u,WordCloud:"Vendors/highcharts/wordcloud.min.js",Xlsx:"Vendors/xlsx.core.min.js"};var m=["Ivy","MathJax","O365ShellBootstrap"];var h={};function g(e,t){h[e]=t}g("JQuery_Picker_Date",["JQuery_Picker"]),g("JQuery_Picker_Time",["JQuery_Picker"]),g("Linkify_JQuery",["Linkify"]),g("WordCloud",["HighCharts"]),g("HighCharts_More",["HighCharts"]),g("Heatmap",["HighCharts"]),g("Pattern_Fill",["HighCharts"]);var y={}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){function e(){}return e.isFormatedAsFloat=function(e){var t=(e||"").trim().replace(/[,]/g,"");return $.isNumeric(t)},e.formatAsFloat=function(e){var t=(e||"").trim().replace(/[,]/g,"");return $.isNumeric(t)?parseFloat(t).toString():""},e.isInteger=function(e){return Math.floor(e)===e},e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return m})),r.d(t,"d",(function(){return h})),r.d(t,"b",(function(){return g})),r.d(t,"c",(function(){return y})),r.d(t,"e",(function(){return S}));var n,o=r(0),i=r(45),a=r(57),s=r(2),c=r(5),u=r(7),l=r(22),d=r(31),f=r(12),p=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return p(t,e),t.prototype.render=function(){var e=this,t=Object(d.b)({ButtonStyle:"LightBackground",HTMLAttributes:{className:"phishing-message-button office-form-theme-button",onClick:function(){var t=""+window.location.origin+window.location.pathname+"#FormId="+e.props.formId;c.a.safeOpen(t,"_self")}},key:"refreshButton",ref:"refreshButton",Text:s.a.LocalizedStrings.Analyze_View_Phishing_Refresh_Button});return o.createElement("div",{className:"phishing-message-container"},o.createElement("div",{className:"phishing-message-content"},o.createElement("div",{className:"phishing-text-container"},o.createElement("span",{className:"phishing-warning-icon"},o.createElement(l.a,{IconName:"Warning"})),o.createElement("span",{className:"phishing-warning-message"},s.a.LocalizedStrings.Analyze_View_Phishing_Warning_Message)),t))},t}(f.a);function h(e){return b(e,a.a.TempTakeDown)}function g(e){return b(e,a.a.EqualOrOverContentScanMask)}function y(e){var t=b(e,a.a.EqualOrAboveCustomerReportMask);return!t||Object(i.c)()||e!==(a.a.PhishingFromCustomerReport|a.a.Suspicious)&&e!==a.a.PhishingFromCustomerReport&&e!==a.a.Suspicious||(t=!1),t}function b(e,t){return!!v(e,a.a.TakeDownConfirmedMask)||!v(e,a.a.AdminReviewPass)&&(e!==a.a.Suspicious&&v(e,t))}function v(e,t){return 0!=(e&t)}function S(e,t){switch(t){case"Design":case"Analyze":case"ShareForm":return function(e){return v(e,a.a.TakeDownConfirmedMask)?Object(u.c)((function(){return s.a.LocalizedStrings.Phishing_Form_Warning_Message_100}),(function(){return s.a.LocalizedStrings.Phishing_Survey_Warning_Message_100})):v(e,a.a.TempTakeDown)?Object(u.c)((function(){return s.a.LocalizedStrings.Phishing_Form_Warning_Message_4}),(function(){return s.a.LocalizedStrings.Phishing_Survey_Warning_Message_4})):v(e,a.a.PhishingFromContentScan)?Object(i.c)()?Object(u.c)((function(){return s.a.LocalizedStrings.Phishing_Form_Warning_Message_2}),(function(){return s.a.LocalizedStrings.Phishing_Survey_Warning_Message_2})):Object(u.c)((function(){return s.a.LocalizedStrings.Phishing_Form_Warning_Message_2_AAD}),(function(){return s.a.LocalizedStrings.Phishing_Survey_Warning_Message_2_AAD})):v(e,a.a.PhishingFromCustomerReport)?Object(u.c)((function(){return s.a.LocalizedStrings.Phishing_Form_Warning_Message_1}),(function(){return s.a.LocalizedStrings.Phishing_Survey_Warning_Message_1})):void 0}(e);case"Response":return function(e){return v(e,a.a.TempTakeDown)?Object(u.c)((function(){return s.a.LocalizedStrings.Phishing_Form_ResponsePage_Warning_Message_4}),(function(){return s.a.LocalizedStrings.Phishing_Survey_ResponsePage_Warning_Message_4})):v(e,a.a.PhishingFromContentScan)?Object(u.c)((function(){return s.a.LocalizedStrings.Phishing_Form_ResponsePage_Warning_Message_2}),(function(){return s.a.LocalizedStrings.Phishing_Survey_ResponsePage_Warning_Message_2})):v(e,a.a.PhishingFromCustomerReport)?Object(u.c)((function(){return s.a.LocalizedStrings.Phishing_Form_ResponsePage_Warning_Message_1}),(function(){return s.a.LocalizedStrings.Phishing_Survey_ResponsePage_Warning_Message_1})):void 0}(e);default:return}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n,o=r(0),i=r(7),a=r(71),s=r(101),c=r(108),u=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function l(e){return o.createElement(d,e)}var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.alerting=!1,t.mounted=!1,t}return u(t,e),t.prototype.componentDidMount=function(){var e=this;this.mounted=!0,this.alerting||window.setTimeout((function(){e.alerting=!0,e.mounted&&e.forceUpdate()}))},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.createReactNodes=function(){var e=this.props,t=e.ShowRequiredStar?o.createElement(c.a):void 0,r=e.ShowOrdinal?o.createElement("span",{className:"ordinal-number",key:"ordinalNumber"},this.props.Ordinal+"."):void 0;if(!e.Alert||this.alerting)var n=Object(a.b)({ContainsHtml:Object(i.e)((function(){return!!e.HtmlContent})),Text:e.Label,RenderMode:"RichText"});return e.Bold?[o.createElement("b",void 0,r,n,t),e.children]:[r,n,t,e.children]},t}(s.a)},function(e,t,r){"use strict";var n,o=r(0),i=r(20),a=r(3),s=r(85),c=r(13),u=r(12),l=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),d=function(){return(d=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};var f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mounted=!0,t}return l(t,e),t.prototype.componentWillMount=function(){var e=this;Object(s.a)("MathJax").done((function(){e.mounted&&e.setState({MathJaxLoaded:!0}),MathJax.Hub.processSectionDelay=2}))},t.prototype.componentDidMount=function(){this.state.MathJaxLoaded&&this.props.Formula&&this.renderFormula()},t.prototype.componentDidUpdate=function(){this.state.MathJaxLoaded&&this.props.Formula&&this.renderFormula()},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.shouldComponentUpdate=function(e,t){return e.Formula!==this.props.Formula||t.MathJaxLoaded!==this.state.MathJaxLoaded},t.prototype.render=function(){if(this.props.Formula){var e="formula-renderer-container unselectable-text";return t.isSafari9&&(e+=" formula-renderer-container-safari9"),o.createElement("div",{className:e,"aria-hidden":"true",onContextMenu:function(){return!1}},o.createElement("div",{className:"formula-loading",ref:"formulaLoading"},o.createElement("div",{className:"spinner-tile-animation"})),o.createElement("span",{className:"NotVisible",ref:"formulaElement"},this.props.Formula?"$"+this.props.Formula+"$":""))}return o.createElement("div",{className:"formula-renderer-container"})},t.prototype.renderFormula=function(){var e=this,t=function(t){var r=i.findDOMNode(e.refs.formulaElement);if(r){var n=e.props.Formula,o=p.get(n);if(o)return e.hideSpinnerAndShowFormula(r),r.innerHTML=o.dom,e.props.onRenderComplete&&e.props.onRenderComplete(o.originalText,o.mathML),void(t&&t());MathJax.Hub.Queue(["Typeset",MathJax.Hub,r]),MathJax.Hub.Queue((function(){if(e.mounted){e.hideSpinnerAndShowFormula(r);var o=MathJax.Hub.getAllJax(r),i=null,a=null;if(o.length>0)try{i=o[0].root.toMathML(""),a=o[0].originalText}catch(e){c.b(!1,"Failed to get mathML:"+n)}p.set(n,{dom:r.innerHTML,originalText:a,mathML:i}),e.props.onRenderComplete&&e.props.onRenderComplete(a,i)}t&&t()}))}else t&&t()};p.get(this.props.Formula)?t(null):m.enqueue(this.props.Formula,t)},t.prototype.hideSpinnerAndShowFormula=function(e){var t=i.findDOMNode(this.refs.formulaLoading);t&&(t.className="dn"),e.className=""},t.isSafari9=c.A(),t}(u.a),p=function(){function e(){}return e.set=function(t,r){if(t&&!e.cache[t]&&(e.order.push(t),e.cache[t]=r,e.order.length>e.cacheLimit)){var n=e.order.shift();delete e.cache[n]}},e.get=function(t){return t?e.cache[t]:null},e.cacheLimit=200,e.cache={},e.order=[],e}(),m=function(){function e(){}return e.enqueue=function(t,r){e.priorityMap[t]?(e.priorityMap[t].count++,e.internalEnqueue({key:t,priority:e.priorityMap[t].priority,task:r})):(e.currentPriority++,e.priorityMap[t]={priority:e.currentPriority,count:1},e.internalEnqueue({key:t,priority:e.currentPriority,task:r}))},e.internalEnqueue=function(t){e.queue.push(t),e.bubbleUp(e.queue.length-1),e.isProcessing||e.process()},e.process=function(){e.isProcessing=!0,e.queue[0].task(e.onRenderComplete)},e.onRenderComplete=function(){var t=e.queue.shift().key;e.priorityMap[t].count--,0===e.priorityMap[t].count&&delete e.priorityMap[t],e.queue.length>0?e.process():(c.b(a.isEqual(e.priorityMap,{}),"FormulaRenderQueue: priority map should be empty"),e.isProcessing=!1,e.currentPriority=0)},e.bubbleUp=function(t){for(var r=e.getParent(t);r>=0&&e.queue[r].priority>e.queue[t].priority;)e.swap(r,t),t=r,r=e.getParent(t)},e.swap=function(t,r){var n=e.queue[t];e.queue[t]=e.queue[r],e.queue[r]=n},e.getParent=function(e){return Math.floor((e-1)/2)},e.queue=[],e.priorityMap={},e.currentPriority=0,e.isProcessing=!1,e}();function h(e){return function(e){return o.createElement(f,d({},e))}(e)}r.d(t,"a",(function(){return h}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var n,o=r(0),i=r(5),a=r(13),s=r(6),c=r(7),u=r(71),l=r(77),d=r(12),f=r(155),p=r(112),m=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),h=function(){return(h=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isCompactPlus=Object(c.e)((function(){return Object(s.a)().Flighting.isEnabled("FormsProEmbedCompact")&&Object(s.a)().Flighting.isEnabled("FormsProEmbedCompactPlus")&&a.n()})),t}return m(t,e),t.prototype.render=function(){var e,t=this,r=this.props.TopExtraContent&&o.createElement("div",{className:"office-form-footer-block"},this.props.TopExtraContent),n=i.a.combineAttributes("office-form-footer-container office-form-padding-align",this.props.HTMLAttributes&&this.props.HTMLAttributes.className);e=Object(c.e)((function(){return Object(s.a)().Flighting.isEnabled("FormsProRTFooter")&&t.props.FooterText?Object(u.b)({ContainsHtml:!0,RenderMode:"RichText",Text:t.props.FooterText}):t.props.FooterText||null}));var a=this.isCompactPlus&&!Object(s.a)().Flighting.isEnabled("FormsProCustomFooter"),d=this.isCompactPlus&&Object(s.a)().Flighting.isEnabled("FormsProCustomFooter");return o.createElement(l.a.Consumer,null,(function(i){var s=i.LocalizedStrings;return o.createElement("div",{className:"office-form-footer office-form-theme-footer",role:"contentinfo"},o.createElement("div",{className:n},r,Object(c.c)((function(){return y(e||s.Response_Page_Footer_Statement_2,e||s.Response_Page_Footer_Statement,t.props.FooterType)||e}),(function(){return a?null:y(e||s.Response_Page_Footer_Statement_2,e||s.Response_Page_Footer_Statement,t.props.FooterType)||e})),Object(c.c)((function(){return t.createFooterBlock(s)}),(function(){return d?null:t.createFooterBlockPro(s)}))))}))},t.prototype.createFooterBlock=function(e){return o.createElement("div",{className:"office-form-footer-block"},b(e.Form_Footer_Powered)," | ",o.createElement(f.a,{LocalizedStrings:e})," | ",o.createElement(p.a,{FormMaster:this.props.FormMaster,LocalizedStrings:e,ForceUseCommercialTermsLink:this.props.ForceUseCommercialTermsLink}))},t.prototype.createFooterBlockPro=function(e){var t=!Object(s.a)().Flighting.isEnabled("FormsProHidePrivacyLink")||null==this.props.FooterText;return this.isCompactPlus?o.createElement("div",{className:"office-form-footer-block"},o.createElement(f.a,{LocalizedStrings:e})):o.createElement("div",{className:"office-form-footer-block"},b(e.FormPro_Footer_Powered)," | ",t&&o.createElement(f.a,{LocalizedStrings:e}),t&&" | ",o.createElement(p.a,{FormMaster:this.props.FormMaster,LocalizedStrings:e}))},t}(d.a);function y(e,t,r){switch(r){case"ShowStatement":return o.createElement("div",{className:"office-form-footer-block"},e);case"ShowStatementWithNotice":return o.createElement("div",{className:"office-form-footer-block"},t);default:return null}}function b(e){return a.x()?(r=e,n={className:a.x()?"office-form-theme-spo-link":void 0,href:window.location.origin,target:"_blank"},o.createElement("div",{className:"office-form-footer-inline-without-margin"},o.createElement("a",h({},n),r))):(t=e,o.createElement("div",{className:"office-form-footer-inline-without-margin"},t));var t,r,n}},function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n,o=r(4),i=r(1),a=r(13),s=r(7),c=r(19),u=r(10),l=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),d={Answer:i.a.reference(),AnswerEntity:i.a.reference(),BranchedElement:i.a.reference(),BranchingType:i.a.string(),NextQuestionInOrder:i.a.reference(),NextQuestionInitialized:i.a.boolean(),QuizResult:i.a.reference(),ShowPhishingFormWarning:i.a.boolean(),Visible:i.a.reference(),FormsProOrdinal:i.a.reference(),FormsProRuntimeTitle:i.a.reference(),FormsProRuntimeSubtitle:i.a.reference(),InitialFormsProLocalizedRuntimeTitle:i.a.reference(),InitialFormsProLocalizedRuntimeSubtitle:i.a.reference(),SelectedChoice:i.a.reference()},f=function(e){function t(t,r){var n=e.call(this)||this;return n.calculateNextQuestionCallback=function(){return n.updateBranchedQuestion()},n.question=t,n.question.observe(n.calculateNextQuestionCallback),n.formRuntimeMaster=r,n.addRule({Name:"UpdateBranchedQuestion",onChange:function(e){return n.updateBranchedQuestion()}}),Object(s.e)((function(){return!0}))&&n.addRule({Name:"executeFormsProBranching",onChange:function(e){return n.executeFormsProBranching()},InterestedFields:[n.Schema.Answer]}),n}return l(t,e),Object.defineProperty(t.prototype,"Question",{get:function(){return this.question},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SubQuestions",{get:function(){return this.Question.SubQuestionMasters},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SubQuestionRuntimeMasters",{get:function(){var e=this;return this.SubQuestions.map((function(t){return e.getSubQuestionRuntimeById(t.Model.Id)}))},enumerable:!0,configurable:!0}),t.prototype.getSubQuestionRuntimeById=function(e){return this.formRuntimeMaster?this.formRuntimeMaster.getOrCreateQuestionRuntimeById(e):null},t.prototype.verifyAnswer=function(){if(0===this.SubQuestionRuntimeMasters.length){if(this.Question.Model.IsMathQuiz){var e=a.I(this.Model.Answer||"{}"),t=null==e.Answer?this.Model.Answer:e.Answer;return this.Question.verify(t)===u.e.Success}return this.Question.verify(this.Model.Answer)===u.e.Success}return this.SubQuestionRuntimeMasters.every((function(e){return e.Question.verify(e.Model.Answer)===u.e.Success}))},t.prototype.release=function(){this.question.unobserve(this.calculateNextQuestionCallback)},t.prototype.getAnswerEntity=function(){return{Answer:this.Question.getNormalizedAnswer(this.Model.Answer),QuestionId:this.Question.Model.Id}},t.prototype.calculateQuizResultFromModel=function(){0===this.SubQuestionRuntimeMasters.length?this.Model.QuizResult=this.Question.createQuizResult(this.Model.Answer):this.Model.QuizResult={IsAnswerCorrect:!1}},t.prototype.getScore=function(){var e=this.Model.AnswerEntity,t=e&&e.Score;return null!=t?t:this.Question.autoGradeWithQuizResult(this.Model.Answer,this.Model.QuizResult)},t.prototype.createOD4BTempFolder=function(){if(this.formRuntimeMaster)return this.formRuntimeMaster.createOD4BTempFolder();throw Error("No FormRuntimeMaster specified.")},t.prototype.updateBranchedQuestion=function(){if(!this.Question.Deleted){var e=this.Model,t=this.Question.getBranchedResult(e.Answer,e.NextQuestionInOrder);this.bulkEdit((function(e){e.BranchedElement=t.TargetElement,e.BranchingType=t.Type}))}},t.prototype.executeFormsProBranching=function(){var e=this;if(this.formRuntimeMaster){var t=Object(c.b)().Model;this.formRuntimeMaster.ensureProRuleManager().done((function(r){t.FormsProBranchingData&&e.formRuntimeMaster.CurrentRuleManager().execute(e.Question.Model.Id,e.formRuntimeMaster.Answers)}))}},t}(o.a.createObjectMasterClass("QuestionRuntime",d))},function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e[e.Desktop=0]="Desktop",e[e.Mobile=1]="Mobile",e[e.Auto=2]="Auto"}(n||(n={}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n,o=r(4),i=r(1),a=r(39),s=r(76),c=r(10),u=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),l={TargetQuestionId:i.a.string(),ToTheEnd:i.a.boolean()};var d=function(e){function t(r){var n=e.call(this,r)||this;return n.initialized=!1,n._isValid=!1,n.observedElementChangeCallback=function(e){return n.onObservedElementChange()},r.MasterTreeReady.done((function(){n.Deleted||(t.normalize(n,{},!1),n.addRule({Name:"normalize",onChange:function(e){t.normalize(n,e.OldValues,!0)}}),n.observe((function(e){n.Deleted||n.observeTargetElement()})))})),n}return u(t,e),Object.defineProperty(t.prototype,"ElementMaster",{get:function(){var e=this.Parent;do{if(e instanceof c.d||e instanceof a.a)return e}while(e=e.Parent);return null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TargetElementMaster",{get:function(){if(this.Deleted)return null;var e=this.ElementMaster.Form.FormElementManager;if(!this.Model.TargetQuestionId)return null;var t=e.getElementMasterById(this.Model.TargetQuestionId);return t&&t.Deleted?null:t?s.a.isSection(t.Model.Type)?t:e.findContainerSection(this.ElementMaster)===e.findContainerSection(t)&&t:t},enumerable:!0,configurable:!0}),t.prototype.resetToDefault=function(){var e=this;this.bulkEdit((function(){e.Model.ToTheEnd=null,e.Model.TargetQuestionId=null}))},t.prototype.isDefault=function(){return!this.Model.ToTheEnd&&!this.Model.TargetQuestionId},t.prototype.getBranchingResult=function(){var e=this.Model;return this.IsValid?e.ToTheEnd?{Type:"End"}:{Type:"Specified",TargetElement:this.TargetElementMaster}:{Type:"Next"}},t.prototype.hasSectionBranching=function(){var e=this.ElementMaster,t=this.TargetElementMaster;return s.a.isSection(e.Model.Type)||t&&s.a.isSection(t.Model.Type)},t.normalize=function(e,t,r){var n=e.Model;n.ToTheEnd?t.ToTheEnd&&n.TargetQuestionId||(n.TargetQuestionId=null):n.ToTheEnd=null,r&&e.calculateValidity()},Object.defineProperty(t.prototype,"IsValid",{get:function(){return this.initialized||(this.calculateValidity(),this.observeTargetElement()),this._isValid},enumerable:!0,configurable:!0}),t.prototype.calculateValidity=function(){this.initialized=!0,this._isValid=!(!this.Model.ToTheEnd&&!this.TargetElementMaster)},t.prototype.observeTargetElement=function(){var e=this.TargetElementMaster,t=this.observedElement;e!==t&&(t instanceof c.d?t.unobserve(this.observedElementChangeCallback):t instanceof a.a&&t.unobserve(this.observedElementChangeCallback),this.observedElement=e,e instanceof c.d?e.observe(this.observedElementChangeCallback):e instanceof a.a&&e.observe(this.observedElementChangeCallback))},t.prototype.onObservedElementChange=function(){if(this.observedElement.Deleted)this.Model.TargetQuestionId=null;else if(this.observedElement instanceof c.d){var e=this.ElementMaster.Form.FormElementManager;e.findContainerSection(this.ElementMaster)!==e.findContainerSection(this.observedElement)&&(this.Model.TargetQuestionId=null)}},t}(o.a.createObjectMasterClass("BranchInfoMaster",l))},function(e,t,r){"use strict";var n=r(0),o=r(3),i=r(83),a=r(11),s=r(21),c=r(106),u=r(5),l=r(13),d=r(143),f=r(26),p=r(19),m=r(8),h=r(10),g=r(15),y=r(30),b=r(42),v=r(61),S=r(58),I=r(6),M=r(7),F=r(123),O=r(22),C=r(2),P=r(96),T=r(237),w=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n},_=function(){function e(){}return e.createQuizPointLabel=function(e){var t=e.Master.Question.Model,r=e.Master.SubQuestionRuntimeMasters,o=r[r.length-1];if(e.IsStudentViewMode){if(!(c=(o||e.Master).getScore())&&!t.Point)return;var i=t.Point?t.Point:"-",a=null!=c?c:"-",s=C.a.LocalizedStrings.RuntimeView_TotalPoints_Content.format(a,i);return n.createElement("span",{className:"office-form-theme-quiz-point",key:"quizPointLabel"},C.a.LocalizedStrings.Quiz_Points_BracketsText.format(s))}if(t.IsQuiz&&!e.HiddenPoint){if(!t.Point)return;if(!e.ShowDesignInfo&&e.ShowQuizResult){var c;a=null!=(c=(o||e.Master).getScore())?c:"-",s=C.a.LocalizedStrings.RuntimeView_TotalPoints_Content.format(a,t.Point);return n.createElement("span",{className:"office-form-theme-quiz-point",key:"quizPointLabel"},C.a.LocalizedStrings.Quiz_Points_BracketsText.format(s))}return n.createElement("span",{className:"office-form-theme-quiz-point",key:"quizPointLabel"},T.a.getBracketPointText(t.Point))}},e.createWrongResultLabel=function(t){if(!t.IsMobile){var r=[];if(e.isWrongQuestion(t)){var o=Object(O.b)({Accessible:!0,HTMLAttributes:{"aria-label":C.a.LocalizedStrings.Response_Preview_WrongReponseIcon.format(t.Ordinal),className:"validation-error-message-wrong-Icon office-form-answerkey"},IconName:"Cancel"});r=[n.createElement("div",{className:"validation-error-circle-big"}),n.createElement("div",{className:"validation-error-circle-small"}),o]}return n.createElement.apply(n,w(["div",{"aria-live":"assertive",role:"alert"}],r))}},e.isWrongQuestion=function(e){var t=e.Master.Model,r=e.Master.Question.Model,n=r.Type===P.a.getElementTypeName(),o=r.Type===g.a.TextField&&!r.Multiline,i=r.Type===g.a.Ranking,a=n||o||i;return!!(r.IsQuiz&&e.ShowQuizResult&&a&&t.QuizResult)&&!t.QuizResult.IsAnswerCorrect},e}(),E=r(108),R=r(88),D=r(207),A=r(89),L=r(140),N=r(138),k=r(12),x=r(199),j=r(204);r.d(t,"a",(function(){return Q}));var U,z=(U=function(e,t){return(U=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}U(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),B=function(){return(B=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Q=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.questionElementRef=n.createRef(),t.videoRatioHeight=9,t.videoRatioWidth=16,t.idPrefix=o.uniqueId("question"),t.immersiveReaderDebounceTime=400,t.uxstateMaster=Object(p.b)(),t.handleLaunchImmersiveReader=function(){var e={chunks:t.getFormattedDataForImmersiveReader(),title:""},r={uiLang:a.a.getExplictLocale()||navigator.language};Object(f.b)().getImmersiveReaderToken().then((function(t){t&&ImmersiveReader&&ImmersiveReader.launchAsync(t,null,e,r)}))},t}return z(t,e),t.prototype.componentWillMount=function(){var e=this;this.update=function(){return e.forceUpdate((function(){var t=e.props.onHeightChange;t&&t()}))};var t=this.props.Master;t.Question.Form.observe(this.update,[m.c.Schema.HasQuestionMedia]),t.observe(this.update),t.Question.observe(this.update),this.uxstateMaster.observe(this.update,[this.uxstateMaster.Schema.FormsTenantSettings]);var r=y.b.Schema;t.Question.ImageInfoMaster.observe(this.update,[r.ResourceUrl,r.ContentType,r.OriginalFileName]),t.Question.ImageSettingsMaster.observe(this.update),this.getQuestionLocalizedItemMaster(this.props),Object(M.e)((function(){if(Object(I.a)().Flighting.isEnabled("FormsProAnswerTag")){var t=e.questionLocalizedItemMaster,r=t&&t.Model,n=e.props.Master.Question.Model.FormsProRTQuestionTitle||e.props.Master.Question.Model.Title,o=e.props.Master.Question.Model.FormsProRTSubtitle||e.props.Master.Question.Model.Subtitle;r?(e.props.Master.Model.InitialFormsProLocalizedRuntimeTitle=r.formsprortlocaletitle||r.title||n,e.props.Master.Model.InitialFormsProLocalizedRuntimeSubtitle=r.formsprortlocalesubtitle||r.subtitle||o):(e.props.Master.Model.InitialFormsProLocalizedRuntimeTitle=void 0,e.props.Master.Model.InitialFormsProLocalizedRuntimeSubtitle=void 0)}e.props.Master.Question.Form.SettingMaster.observe(e.update)}))},t.prototype.componentWillReceiveProps=function(e){var t=this;this.getQuestionLocalizedItemMaster(e),Object(M.e)((function(){if(Object(I.a)().Flighting.isEnabled("FormsProAnswerTag")){var e=t.questionLocalizedItemMaster,r=e&&e.Model,n=t.props.Master.Question.Model.FormsProRTQuestionTitle||t.props.Master.Question.Model.Title,o=t.props.Master.Question.Model.FormsProRTSubtitle||t.props.Master.Question.Model.Subtitle;r?(t.props.Master.Model.InitialFormsProLocalizedRuntimeTitle=r.formsprortlocaletitle||r.title||n,t.props.Master.Model.InitialFormsProLocalizedRuntimeSubtitle=r.formsprortlocalesubtitle||r.subtitle||o):(t.props.Master.Model.InitialFormsProLocalizedRuntimeTitle=void 0,t.props.Master.Model.InitialFormsProLocalizedRuntimeSubtitle=void 0)}}))},t.prototype.componentWillUnmount=function(){var e=this,t=this.props.Master;t.Question.ImageSettingsMaster.unobserve(this.update),t.Question.ImageInfoMaster.unobserve(this.update),t.Question.unobserve(this.update),t.unobserve(this.update),t.Question.Form.unobserve(this.update),this.uxstateMaster.unobserve(this.update),Object(M.e)((function(){t.Question.Form.SettingMaster.unobserve(e.update)})),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.update)},t.prototype.componentDidMount=function(){var e=$(this.questionElementRef.current),t=e.find(".office-form-question-formula span"),r=e.find(".office-form-question-choice-formula span"),n=e.find(".design-formula-mixer span");Object(c.a)(e.find("span").not(t).not(r).not(n))},t.prototype.render=function(){var e=this,t={className:"__question__ office-form-question",ref:this.questionElementRef};if(this.getValidationStyle()===E.b.Error||_.isWrongQuestion(this.props)){var r=this.props.IsMobile?"office-form-error-question-mobile":"office-form-error-question";t.className=u.a.combineAttributes(t.className,r)}Object(M.e)((function(){if(null==e.props.Master.Model.Visible?t.hidden=!1:t.hidden=!e.props.Master.Model.Visible&&!!e.props.EnableShowHideQuestion,Object(I.a)().Flighting.isEnabled("FormsProQuestionVisibility")&&e.props.EnableShowHideQuestion){var r=e.props.Master.Model.Visible;t.hidden=null==r?!!e.props.Master.Question.Model.Hidden:!r}}));var o=this.createFeedbackBox(),i=null;return void 0!==o&&(t.className=u.a.combineAttributes(t.className,"office-form-studentview-question"),i=n.createElement("div",{className:"office-form-feedback-marginbottom-box"})),n.createElement("div",B({},t),this.createCoAuthorFacePile(),this.createQuestionContent(),o,i)},Object.defineProperty(t.prototype,"QuestionElementRef",{get:function(){return this.questionElementRef},enumerable:!0,configurable:!0}),t.prototype.createWrongResultLabel=function(){return _.createWrongResultLabel(this.props)},t.prototype.createReactNodes=function(){throw Error("to be overridden.")},t.prototype.createQuestionContent=function(){var e={className:"office-form-question-content office-form-theme-focus-border"},t=this.props.HTMLAttributes;t&&(e=u.a.mergeReactProps(t,e));var r=u.a.combineAttributes("office-form-question-element",this.isImageLayout()?"with-image":""),o=null;return this.isRequiredQuestionError()&&(o=Object(R.a)({HTMLAttributes:{className:"validation-error-message-label",role:"alert"},Label:this.props.LocalizedStrings.Required_Question_Error_Message})),n.createElement("div",B({},e),this.createWrongResultLabel(),this.createTitleContainer(),n.createElement("div",{className:r},this.createReactNodes()),o)},t.prototype.isRequiredQuestionError=function(){if(!this.props.ShowValidationStyle)return!1;var e=this.props.Master,t=e.Question.verify(e.Model.Answer);return e.SubQuestionRuntimeMasters.forEach((function(e){e.Question.verify(e.Model.Answer)===h.e.RequiredError&&(t=h.e.RequiredError)})),t===h.e.RequiredError},t.prototype.getValidationStyle=function(){if(!this.props.ShowValidationStyle)return E.b.None;var e=this.props.Master,t=e.Question.verify(e.Model.Answer);return e.SubQuestionRuntimeMasters.forEach((function(e){e.Question.verify(e.Model.Answer)===h.e.RequiredError&&(t=h.e.RequiredError)})),t===h.e.Success?E.b.Success:E.b.Error},t.prototype.getQuestionId=function(){return this.idPrefix},t.prototype.getRequiredId=function(){return this.props.Master.Question.Model.Required?this.idPrefix+"-required":void 0},t.prototype.getQuestionTypeId=function(){return this.idPrefix+"-questiontype"},t.prototype.getElementProps=function(e){var t={"aria-describedby":this.getSubtitleId(),"aria-labelledby":u.a.combineAttributes(this.getOrdinalId(),this.getTitleId(),this.getRequiredId(),this.getQuestionTypeId())};return e?u.a.mergeReactProps(e,t):t},t.prototype.getFormattedDataForImmersiveReader=function(){var e=this.props.Master.Question.Model,t=[];if(t.push({content:this.props.Ordinal+". "+e.Title+(e.Required?" *":"")+"\n"}),e.Point){var r=_.createQuizPointLabel(this.props);t.push({content:r.props.children.toString()+"\n\n"})}else t.push({content:"\n"});if(e.Subtitle){var n=e.Subtitle;if("undefined"!=typeof MathJax){var i=MathJax.Hub.getAllJax(null),a=o.find(i,(function(t){return t.originalText===e.Subtitle}));if(a){var s=a.root&&a.root.toMathML&&a.root.toMathML();s&&(s=s.replace(/\n\s*/g,""),n="\x3c!--[if mathML]&#62;"+u.a.encodeHTML(s,!0)+"&#60;![endif]--\x3e")}}t.push({content:""+n,mimeType:"text/html"}),t.push({content:"\n\n"})}var c=document.createElement("i");return c.textContent=u.a.encodeHTML(this.props.LocalizedStrings.ImmersiveReader_InputAnswer,!0),t.push({content:c.outerHTML,mimeType:"text/html"}),t},t.prototype.getQuestionLocalizedItemMaster=function(e){var t=e.Master,r=e.LocaleId;this.questionLocalizedItemMaster&&(this.questionLocalizedItemMaster.unobserve(this.update),this.questionLocalizedItemMaster=void 0),r&&(this.questionLocalizedItemMaster=v.a.getQuestionResourceMaster(r,t.Question.Model.Id,t.Question.Form),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.update,[S.a.Schema.title,S.a.Schema.subtitle]))},t.prototype.createFeedbackBox=function(){var e=this.props.Master.SubQuestionRuntimeMasters,t=e[e.length-1],r=(t&&t.Model||this.props.Master.Model).AnswerEntity,o=r&&r.Feedback;if(this.props.IsStudentViewMode&&o){var i={HTMLAttributes:{className:u.a.combineAttributes("feedback-icon forms-icon-size16x16",l.o()?"edge":void 0,l.q()?"ie":void 0),role:"presentation"},IconName:"Chat"};return n.createElement("div",{className:"office-form-feedback-box"},Object(O.b)(i),n.createElement("div",{className:"office-form-feedback-content"},Object(D.a)({content:o})))}},t.prototype.createTitleLabel=function(){var e=this,t=this.props.Master.Question.Model,r=this.questionLocalizedItemMaster,o=r&&r.Model,a=this.props.Master.Question.Form.Model.HasQuestionMedia,s=o&&o.title||t.Title,c=Object(M.c)((function(){return s}),(function(){return Object(I.a)().Flighting.isEnabled("FormsProAnswerTag")?e.props.Master.Model.FormsProRuntimeTitle||o&&o.formsprortlocaletitle||o&&o.title||t.FormsProRTQuestionTitle||t.Title:o&&o.formsprortlocaletitle||o&&o.title||t.FormsProRTQuestionTitle||t.Title})),u=!this.props.HideMedia&&(t.ImageInfo&&t.ImageInfo.ResourceUrl||a)?"office-form-question-title with-image":"office-form-question-title",l=this.props.Master.Question.Form,d=i.a.supportsExtensionPoint(l,i.b.ResponsePagePollView),f=Object(M.c)((function(){return!(e.isImageLayout()||d)}),(function(){return!(e.isImageLayout()||d)&&(null==l.SettingMaster.Model.ShowQuestionNumbers||l.SettingMaster.Model.ShowQuestionNumbers)})),p={"aria-level":2,className:u,id:this.getTitleId(),role:"heading"},m=t.Required?this.props.LocalizedStrings.Accessibility_RequiredAnswer:void 0,h=null;m&&(h=n.createElement("div",{key:"accessibilityNode"},n.createElement("span",{className:"accessibility-reader-no-display",id:this.getRequiredId()},m)));var g=this.createImmersiveReaderButton(),y=this.createQuestionTypeHint(),b=null;y&&(b=n.createElement("div",{key:"questionTypeNode"},n.createElement("span",{className:"accessibility-reader-no-display",id:this.getQuestionTypeId()},y)));var v={children:[g,h,b,_.createQuizPointLabel(this.props)],HTMLAttributes:p,key:this.getQuestionId().toString(),Label:c,Ordinal:this.props.Ordinal,ShowOrdinal:f,ShowRequiredStar:t.Required,Theme:this.props.Theme};return Object(M.e)((function(){v.HtmlContent=!0,v.Ordinal=e.props.Master.Model.FormsProOrdinal||v.Ordinal})),Object(R.a)(v)},t.prototype.createQuestionTypeHint=function(){var e=this.props.Master.Question.Model,t="";switch(e.Type){case g.a.Choice:t=e.ChoiceType===h.a.MultiChoice?this.props.LocalizedStrings.QuestionType_MultiChoice:this.props.LocalizedStrings.QuestionType_SingleChoice;break;case g.a.DateTime:t=this.props.LocalizedStrings.QuestionType_DateTime;break;case g.a.Rating:t=this.props.LocalizedStrings.QuestionType_Rating;break;case g.a.TextField:t=e.Multiline?this.props.LocalizedStrings.QuestionType_MultiLineText:this.props.LocalizedStrings.QuestionType_SingleLineText;break;case g.a.Ranking:t=this.props.LocalizedStrings.QuestionType_Ranking;break;case g.a.MatrixChoiceGroup:t=this.props.LocalizedStrings.QuestionType_MatrixChoiceGroup}return t},t.prototype.createTitleOrdinal=function(){return n.createElement("div",{className:"office-form-question-ordinal office-form-theme-primary-background"},n.createElement("span",{id:this.getOrdinalId()},this.props.Ordinal))},t.prototype.createTitleContainer=function(){var e,t,r,o,i=this,a=this.props.Master.Question,c=a.Model,f=a.Form.Model.HasQuestionMedia,p={},m="office-form-question-subtitle",h=this.props.IsMobile||l.B()||c.ImageSettings.Layout===b.a.Horizontal&&c.ImageSettings.Size===b.c.Large,g=a.hasValidVideoUrl(),v=h||g;if(this.props.HideMedia||g||!(c.ImageInfo&&c.ImageInfo.ResourceUrl||f||c.ImageInfo.ImageProcessingStatus===y.c.Uploading||c.ImageInfo.ImageProcessingStatus===y.c.Picking)){if(!this.props.HideMedia&&g){var S=l.t();m="office-form-question-subtitle with-video";var O=c.VideoInfo;if(p.className=u.a.combineAttributes(p.className,"question-title-container office-form-theme-video-question-background"),Object(d.c)(O.Url))o=n.createElement(x.a,{IsMobile:S,LocalizedStrings:this.props.LocalizedStrings,VideoUrl:O.Url});else{var C={allowFullScreen:!0,frameBorder:"0",height:this.calcVideoDisplayHeight(),sandbox:"allow-scripts allow-same-origin allow-popups allow-forms",src:O.Url,width:"100%"};e=n.createElement("div",{className:"office-form-question-video-container"},n.createElement("iframe",B({},C)))}}}else{p.className="question-title-container office-form-theme-image-question-background",m="office-form-question-subtitle with-image";var P=h?"office-form-question-horizontal-large-image-container office-form-theme-image-container-border":"office-form-question-image-container office-form-theme-image-container-border";if(c.ImageInfo&&c.ImageInfo.ResourceUrl){var T=a.ImageSettingsMaster.validateImageSettings(),w={className:P,style:h?void 0:{width:"{0}px".format(T.ContainerWidth)}},_=Object(F.c)(c.ImageInfo);e=n.createElement("div",B({},w),n.createElement(F.a,{Image:a.ImageInfoMaster,ImageSettings:a.ImageSettingsMaster,ImageType:"Question"}),_,n.createElement(j.a,null,this.props.Master.Question.ImageInfoMaster.Model.AltText))}else if(c.ImageInfo.ImageProcessingStatus===y.c.Uploading||c.ImageInfo.ImageProcessingStatus===y.c.Picking){w={className:P,style:{height:"{0}px".format(s.a.ImagePlaceHolderHeight),width:"{0}px".format(s.a.ImagePlaceHolderWidth)}};e=n.createElement("div",B({},w),Object(F.c)())}}if(this.isSubtitleLayout())if(c.IsMathQuiz&&!c.IsPlainTextInMathField){var E=Object(A.a)({DisableLinebreaks:this.props.DisableFormulaLinebreak,Formula:c.Subtitle,onRenderComplete:this.props.onHeightChange});t=n.createElement("div",{className:"office-form-question-formula"},E)}else{var D=this.questionLocalizedItemMaster,L=D&&D.Model,N=Object(M.c)((function(){return L&&L.subtitle||c.Subtitle}),(function(){return Object(I.a)().Flighting.isEnabled("FormsProAnswerTag")?i.props.Master.Model.FormsProRuntimeSubtitle||L&&L.formsprortlocalesubtitle||L&&L.subtitle||c.FormsProRTSubtitle||c.Subtitle:L&&L.formsprortlocalesubtitle||L&&L.subtitle||c.FormsProRTSubtitle||c.Subtitle}));r=Object(R.a)({HTMLAttributes:{className:m,id:this.getSubtitleId()},HtmlContent:Object(M.e)((function(){return!0})),Label:N})}return n.createElement("div",{className:"question-title-box"},n.createElement("div",B({},p),v?void 0:e,v?void 0:o,this.isImageLayout()?this.createTitleOrdinal():void 0,this.createTitleLabel(),r,v?e:void 0,v?o:void 0,t))},t.prototype.createImmersiveReaderButton=function(){return!l.q()&&Object(I.a)().Flighting.isEnabled("ImmersiveReaderInForms")?n.createElement("button",{className:"immersive-reader-button","data-locale":a.a.getExplictLocale()||navigator.language,onClick:o.debounce(this.handleLaunchImmersiveReader,this.immersiveReaderDebounceTime,!0)}):null},t.prototype.createCoAuthorFacePile=function(){var e,t=this,r=this.props.Master.Question.Model;return r.CoAuthors&&r.CoAuthors.length>0?r.CoAuthors[r.CoAuthors.length-1].userId!==OfficeFormServerInfo.userInfo.UserId&&(e=o.map(r.CoAuthors,(function(e){if(e.userId!==OfficeFormServerInfo.userInfo.UserId){var r={ariaLabel:t.props.LocalizedStrings.DesignPage_NavBar_CoAuthor_Screen_Reader.format(e.displayName||e.userId,t.props.Ordinal||0),displayText:Object(N.a)(e.displayName,e.firstName,e.lastName),email:e.email,isCoAuthUser:!0,key:e.userId,name:e.displayName,tooltip:e.displayName||e.userId};return n.createElement(L.a,B({},r))}}))):e=void 0,n.createElement("div",{className:"question-coAuthor-notification-container-render-mode","aria-live":"polite"},e)},t.prototype.calcVideoDisplayHeight=function(){if(l.t()){var e=$(window).width();return 0===e&&(e=document.body.scrollWidth),e/(this.videoRatioWidth/this.videoRatioHeight)}return s.a.DefaultVideoHeight},t.prototype.getOrdinalId=function(){return this.isImageLayout()?this.idPrefix+"-ordinal":void 0},t.prototype.getTitleId=function(){return this.idPrefix+"-title"},t.prototype.getSubtitleId=function(){return this.isSubtitleLayout()?this.idPrefix+"-subtitle":void 0},t.prototype.isImageLayout=function(){return this.props.Master.Question.Form.Model.HasQuestionMedia&&!this.props.HideMedia},t.prototype.isSubtitleLayout=function(){var e=this.props.Master.Question.Model;return e.ShowSubtitle&&!!e.Subtitle},t}(k.a)},,function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return p}));var n,o=r(3),i=r(4),a=r(2),s=r(7),c=r(52),u=r(10),l=r(15),d=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d(t,e),Object.defineProperty(t,"MinimumOptionsForDropDown",{get:function(){return 7},enumerable:!0,configurable:!0}),t.getElementTypeName=function(){return l.a.Choice},t.createDefaultDefinition=function(){var e=[{Description:a.a.LocalizedStrings.Designer_Choices_DefaultDescription.format(1),IsGenerated:!0},{Description:a.a.LocalizedStrings.Designer_Choices_DefaultDescription.format(2),IsGenerated:!0}];return{Type:t.getElementTypeName(),Title:a.a.LocalizedStrings.Question_DefaultTitle,Choices:e,ChoiceType:u.a.SingleChoice,OptionDisplayStyle:u.c.ListAll,QuestionTagForIntelligence:"Unknown",IsFromSuggestion:!1}},t.supportMobileDesign=function(e){return!t.hasInvalidSettingOnMobile(e)&&e.OptionDisplayStyle!==u.c.Dropdown},t.prototype.verify=function(e){return!this.Model.Required||e&&"[]"!==e?e&&e.length>t.MaxAnswerLength?u.e.MultiChoiceQuestionLengthLimitError:u.e.Success:u.e.RequiredError},t.prototype.isEmpty=function(e){return this.Model.ChoiceType===u.a.SingleChoice?!e:!e||"[]"===e},t.prototype.getTypeDisplayName=function(){switch(this.Model.ChoiceType){case u.a.SingleChoice:return a.a.LocalizedStrings.QuestionType_SingleChoice;case u.a.MultiChoice:return a.a.LocalizedStrings.QuestionType_MultiChoice;default:throw Error("Choice Question Type Not Supported")}},t.prototype.supportsQuestionLevelBranching=function(){return this.Model.ChoiceType!==u.a.SingleChoice},t.prototype.supportsChoiceLevelBranching=function(){return this.Model.ChoiceType===u.a.SingleChoice},t.prototype.getSnapshotWithoutBranchInfo=function(){var t=e.prototype.getSnapshotWithoutBranchInfo.call(this);return t.Choices=i.a.convertToArray(t.Choices).map((function(e){return delete(e=o.clone(e)).BranchInfo,e})),t},t.prototype.resetBranchInfo=function(){var t=this;e.prototype.resetBranchInfo.call(this),i.a.convertToArray(this.Model.Choices).filter((function(e){return t.getBranchInfoMaster(e.BranchInfo).resetToDefault()})),this.getBranchInfoMaster(this.Model.BranchInfoForOtherChoice).resetToDefault()},t.prototype.insertChoice=function(e,t){var r=this.Model.Choices,n=o.find(r,(function(e){return e.IsGenerated}));if(!n||t&&""!==n.Description){var a=i.a.Collection.addItems(r,[{Description:e,IsMathOption:t}]);n=a[0]}else{var c=i.a.getObjectMasterFromModel(n);Object(s.c)((function(){c.bulkEdit((function(){n.Description=e,n.IsGenerated=null,n.IsMathOption=t}))}),(function(){var o=[];o.push(n);var a=i.a.Collection.addItems(r,[{IsGenerated:null,Description:e,IsMathOption:t}]);r=i.a.Collection.deleteItems(r,o),n=a[0]}))}return n},t.prototype.hasCorrectAnswers=function(e){return e?o.some(e.IsAnswerKeys):o.some(this.Model.Choices,(function(e){return e.IsAnswerKey}))},t.prototype.isCorrectAnswer=function(e){var t=p(e,this.Model),r=i.a.convertToArray(this.Model.Choices).filter((function(e){return e.IsAnswerKey})).map((function(e){return e.Description})).sort();return o.isEqual(r,t.SelectedOptions.sort())},t.prototype.justifyQuestionInfo=function(){var e=this.Master.Model;if(null==e.OptionDisplayStyle){var r=e.ChoiceType===u.a.SingleChoice&&!e.IsMathQuiz&&!e.AllowOtherAnswer&&e.Choices.length>=t.MinimumOptionsForDropDown;e.OptionDisplayStyle=r?u.c.Dropdown:u.c.ListAll}},t.prototype.showAsDropdown=function(){return this.Master.Model.OptionDisplayStyle===u.c.Dropdown},t.prototype.setAnswerKey=function(e,t){var r=this;this.Master.bulkEdit((function(){e.IsAnswerKey=t,r.Model.ChoiceType===u.a.SingleChoice&&e.IsAnswerKey&&i.a.convertToArray(r.Model.Choices).forEach((function(t){t.IsAnswerKey&&t!==e&&(t.IsAnswerKey=!1)}))}))},t.prototype.createQuizResult=function(e){if(this.Model.IsQuiz){var t=i.a.convertToArray(this.Model.Choices);return t.some((function(e){return e.IsAnswerKey}))?{IsAnswerCorrect:this.isCorrectAnswer(e),AnswerHints:t.map((function(e){return e.AnswerHint})),IsAnswerKeys:t.map((function(e){return e.IsAnswerKey})),Choices:t.map((function(e){return e.Description})),GradingBasis:this.Model.GradingBasis}:void 0}},t.prototype.autoGradeAnswer=function(t){if(o.some(this.Model.Choices,(function(e){return e.IsAnswerKey}))){var r=this.Model.Point?this.Model.Point:0;t.Score=this.isCorrectAnswer(t.Answer)?r:0,t.IsAutoGraded=!0}else e.prototype.autoGradeAnswer.call(this,t)},t.prototype.autoGradeWithQuizResult=function(e,t){return t?t.IsAnswerCorrect?this.Model.Point:0:null},t.prototype.getBranchingResult=function(t){var r=this;if(this.Model.ChoiceType!==u.a.SingleChoice)return e.prototype.getBranchingResult.call(this,t);var n=i.a.convertToArray(this.Model.Choices),a=n.filter((function(e){return e.BranchInfo&&i.a.getObjectMasterFromModel(e.BranchInfo).IsValid})),s=i.a.getObjectMasterFromModel(this.Model.BranchInfoForOtherChoice);if(0===a.length&&!s.IsValid)return e.prototype.getBranchingResult.call(this,t);var c,l=n.filter((function(e){return r.selected(t,e)})),d=o.intersection(l,a);d.length>0||l.length>0?c=(d[0]||l[0]).BranchInfo:this.isEmpty(t)||(c=this.Model.BranchInfoForOtherChoice);return c?this.getBranchInfoMaster(c).getBranchingResult():{Type:"Pending"}},t.prototype.selected=function(e,t){return t.Description===e},t.MaxAnswerLength=4e3,t}(c.a);function p(e,t){var r=t.ChoiceType===u.a.SingleChoice;if(null!=e){var n=i.a.convertToArray(t.Choices).map((function(e){return e.Description}));if(!r||!t.AllowOtherAnswer&&!o.contains(n,e))try{var a=JSON.parse(e);if(Array.isArray(a)){if(!a.some((function(e){return!o.isString(e)})))return{IsSingleChoiceAnswer:!1,IsLegacyChoiceAnswer:!1,SelectedOptions:a}}else if(o.isObject(a)){var s=o.values(a);if(!s.some((function(e){return!o.isString(e)})))return{IsSingleChoiceAnswer:r&&s.length<=1,IsLegacyChoiceAnswer:!0,SelectedOptions:s}}}catch(e){}}return{IsSingleChoiceAnswer:r,IsLegacyChoiceAnswer:!1,SelectedOptions:null==e?[]:[e]}}},function(e,t,r){"use strict";r.d(t,"f",(function(){return o})),r.d(t,"a",(function(){return i})),r.d(t,"c",(function(){return a})),r.d(t,"b",(function(){return c})),r.d(t,"j",(function(){return u})),r.d(t,"d",(function(){return l})),r.d(t,"e",(function(){return d})),r.d(t,"g",(function(){return f})),r.d(t,"i",(function(){return p})),r.d(t,"h",(function(){return m}));function n(e){var t=[e.R,e.G,e.B].map((function(e){return(e/=255)<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}));return.2126*t[0]+.7152*t[1]+.0722*t[2]}function o(e){return(n({R:255,G:255,B:255})+.05)/(n(e)+.05)>4.5}function i(e){for(var t=46;!o(e)&&t>=25;){var r=u(e);r.V=.01*t,e=l(r),t--}return e}function a(e){return o(e)?{R:255,G:255,B:255}:{R:0,G:0,B:0}}function s(e){var t=e.toString(16);return 1===t.length?"0"+t:t}function c(e){return"#"+s(e.R)+s(e.G)+s(e.B)}function u(e){var t,r=e.R,n=e.G,o=e.B,i=Math.max(r,n,o),a=Math.min(r,n,o),s=i-a,c=0===i?0:s/i,u=i/255;switch(i){case a:t=0;break;case r:t=n-o+s*(n<o?6:0),t/=6*s;break;case n:t=o-r+2*s,t/=6*s;break;case o:t=r-n+4*s,t/=6*s}return{H:t,S:c,V:u}}function l(e){var t,r,n,o,i,a,s,c,u=e.H,l=e.S,d=e.V;switch(a=d*(1-l),s=d*(1-(i=6*u-(o=Math.floor(6*u)))*l),c=d*(1-(1-i)*l),o%6){case 0:t=d,r=c,n=a;break;case 1:t=s,r=d,n=a;break;case 2:t=a,r=d,n=c;break;case 3:t=a,r=s,n=d;break;case 4:t=c,r=a,n=d;break;case 5:t=d,r=a,n=s}return{R:Math.round(255*t),G:Math.round(255*r),B:Math.round(255*n)}}function d(e){e.startsWith("#")&&(e=e.substring(1));var t=parseInt(e,16);return{R:t>>16&255,G:t>>8&255,B:255&t}}function f(e){var t=d(e),r=u(t);return n(t)>186&&(r.V=.45,t=l(r)),c(t)}function p(e){var t=u(d(e));return c(l({H:t.H,S:t.S,V:t.V-.1}))}function m(e){var t,r=u(d(e));return t=r.S>.05?.05:0,c(l({H:r.H,S:t,V:.95}))}},function(e,t,r){"use strict";r.d(t,"c",(function(){return f})),r.d(t,"b",(function(){return p})),r.d(t,"a",(function(){return m}));var n,o=r(38),i=r(4),a=r(1),s=r(59),c=r(55),u=r(146),l=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),d={Id:a.a.number({IsKeyField:!0,SourceFieldName:"id"}),Comments:a.a.collectionOf((function(){return u.a}),{SourceFieldName:"comments"}),AnswersAsString:a.a.string({SourceFieldName:"answers"}),StartDateAsString:a.a.string({SourceFieldName:"startDate"}),SubmitDateAsString:a.a.string({SourceFieldName:"submitDate"}),Responder:a.a.string({SourceFieldName:"responder"}),ResponderName:a.a.string({SourceFieldName:"responderName"}),QuizResult:a.a.string({SourceFieldName:"quizResult"}),ReleaseDateAsString:a.a.string({SourceFieldName:"releaseDate"}),Answers:a.a.collectionOf({QuestionId:a.a.string({IsKeyField:!0,SourceFieldName:"questionId"}),Answer:a.a.reference({SourceFieldName:"answer1"}),Feedback:a.a.string({IsLocalField:!0}),Score:a.a.number({IsLocalField:!0}),IsAutoGraded:a.a.boolean({IsLocalField:!0}),IsMathAnswer:a.a.boolean({IsLocalField:!0})},{IsLocalField:!0}),StartDate:a.a.reference({IsLocalField:!0}),SubmitDate:a.a.reference({IsLocalField:!0}),ReleaseDate:a.a.reference({IsLocalField:!0}),Feedback:a.a.string({IsLocalField:!0}),TotalScore:a.a.number({IsLocalField:!0}),IntegratedSavingState:a.a.reference({IsLocalField:!0}),SavingState:a.a.reference({IsLocalField:!0}),EmailReceiptConsent:a.a.boolean({SourceFieldName:"emailReceiptConsent"}),SubmitLanguage:a.a.string({SourceFieldName:"submitLanguage"}),MSRewardsData:a.a.reference({SourceFieldName:"msRewardsData"})};d.Answers[0];function f(e){return i.a.getObjectMasterFromModel(e)}function p(e,t){return s.a.deleteResponses(e.Model.Id,t)}var m=function(e){function t(r){var n=this,o=$.Deferred();return(n=e.call(this,r,{Scheduler:new c.a,MasterReady:o.promise()})||this).initializeSavingStateIntegration(),t.Rules.forEach((function(e){return n.addRule(e)})),o.resolve(),n}return l(t,e),Object.defineProperty(t.prototype,"Form",{get:function(){return this.Parent.Parent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ResponseId",{get:function(){return this.Model.Id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Comment",{get:function(){return this.getCommentByQuestionId(null)},enumerable:!0,configurable:!0}),t.prototype.updateWithNormalizedResponse=function(e){var r=this;this.bulkEdit((function(){r.Synchronizer.onSourceDataReceived(i.a.convertToSourceData(e,t.Schema)),r.setData(e)}))},t.prototype.getAnswerByQuestionId=function(e){var t=i.a.Collection.getItemWithKeyFields(this.Model.Answers,{QuestionId:e});return t&&i.a.getObjectMasterFromModel(t)},t.prototype.getCommentByQuestionId=function(e){var t=i.a.Collection.getItemWithKeyFields(this.Model.Comments,{QuestionId:e});return t&&Object(u.b)(t)},t.prototype.setAnswerGrading=function(e,t,r){var n=this.Form.getQuestionById(e);if(n){var o=n.SubQuestionMasters;o.length>0&&(e=o[o.length-1].Model.Id);var a=this.getCommentByQuestionId(e);if(a)a.bulkEdit((function(){a.Model.Score=t,a.Model.Feedback=r}));else{var s={QuestionId:e,Feedback:r,Score:t};i.a.Collection.addItems(this.Model.Comments,[s])}}},t.prototype.initializeSavingStateIntegration=function(){var e=this;this.commentsSavingState="Idle";var t=i.a.getCollectionMasterFromModel(this.Model.Comments);Object(o.c)(t,t.Schema[0].SavingState,(function(t){e.commentsSavingState=t,e.updateIntegratedSavingState()})),Object(o.b)(this),this.updateIntegratedSavingState()},t.prototype.ensureAnswerByQuestionId=function(e){var t=this.getAnswerByQuestionId(e);if(t)return t;var r=i.a.Collection.addItems(this.Model.Answers,[{QuestionId:e}])[0];return i.a.getObjectMasterFromModel(r)},t.prototype.updateIntegratedSavingState=function(){this.Model.IntegratedSavingState=Object(o.a)([this.Model.SavingState,this.commentsSavingState])},Object.defineProperty(t,"Rules",{get:function(){if(!t.rules){var e=t.Schema;t.rules=[{Name:"ResponseComment",InterestedFields:[e.Feedback,e.TotalScore],onChange:function(e){var t=e.Master,r=t.getCommentByQuestionId(null);r?r.bulkEdit((function(){r.Model.Feedback=t.Model.Feedback,r.Model.Score=t.Model.TotalScore})):i.a.Collection.addItems(t.Model.Comments,[{QuestionId:null,Feedback:t.Model.Feedback,Score:t.Model.TotalScore}])}},{Name:"AnswerComment",InterestedFields:[e.Answers[0].Feedback,e.Answers[0].Score,e.Answers[0].IsAutoGraded],onChange:function(e){var t=e.Master,r=t.Model.Answers,n=function(e){e.IsAutoGraded||t.setAnswerGrading(e.QuestionId,e.Score,e.Feedback)};e.SubChanges.filter((function(e){return e.Master.Model===r})).forEach((function(e){e.AddedModels.forEach(n),e.SubChanges.forEach((function(e){return n(e.Master.Model)}))}))}},{Name:"ApplyCommentChange",InterestedFields:[e.Comments],onChange:function(e){var t=e.Master,r=t.Model.Comments,n=function(e){var r=e.QuestionId;if(r){var n=t.ensureAnswerByQuestionId(r);n.bulkEdit((function(){n.Model.Feedback=e.Feedback,n.Model.Score=e.Score,n.Model.IsAutoGraded=!1}))}else t.bulkEdit((function(){t.Model.Feedback=e.Feedback,t.Model.TotalScore=e.Score}))};e.SubChanges.filter((function(e){return e.Master.Model===r})).forEach((function(e){e.AddedModels.forEach(n),e.SubChanges.forEach((function(e){return n(e.Master.Model)}))}))}}],t.rules=t.rules.concat(t.getRulesForSyncBetweenDateFields(e.StartDate,e.StartDateAsString),t.getRulesForSyncBetweenDateFields(e.SubmitDate,e.SubmitDateAsString),t.getRulesForSyncBetweenDateFields(e.ReleaseDate,e.ReleaseDateAsString))}return t.rules},enumerable:!0,configurable:!0}),t.getRulesForSyncBetweenDateFields=function(e,t){var r=i.a.getFieldSchemaInfo(e).Name,n=i.a.getFieldSchemaInfo(t).Name;return[{Name:"update "+r,InterestedFields:[t],onChange:function(e){var t=e.Master.Model;t[r]=new Date(t[n])}},{Name:"update "+n,InterestedFields:[e],onChange:function(e){var t=e.Master.Model;t[n]=t[r].toISOString()}}]},t}(i.a.createObjectMasterClass("Response",d,(function(e,t){return new s.a(e,t)})))},,function(e,t,r){"use strict";var n=r(47);function o(){if(window.performance&&window.performance.getEntriesByType){for(var e=function(){for(var e=[],t=window.performance.getEntriesByType("navigation"),r=0,n=t;r<n.length;r++){var o=n[r],a=i(o);a.redirectStart=Math.round(o.redirectStart),a.redirectEnd=Math.round(o.redirectEnd),a.domainLookupEnd=Math.round(o.domainLookupEnd),a.secureConnectionStart=Math.round(o.secureConnectionStart),a.connectEnd=Math.round(o.connectEnd),a.type=o.type,a.initiatorType=o.initiatorType,a.domComplete=Math.round(o.domComplete),a.domContentLoadedEventStart=Math.round(o.domContentLoadedEventStart),a.domContentLoadedEventEnd=Math.round(o.domContentLoadedEventEnd),a.domInteractive=Math.round(o.domInteractive),a.duration=Math.round(o.duration),e.push(a)}return e}(),t=0,r=window.performance.getEntriesByType("resource");t<r.length;t++){var n=r[t];n&&n.name&&(/(basics|design|response).+\.js/.test(n.name.toLowerCase())&&e.push(i(n)))}return e}}function i(e){return{connectStart:Math.round(e.connectStart),decodedBodySize:e.decodedBodySize||-1,domainLookupStart:Math.round(e.domainLookupStart),encodedBodySize:e.encodedBodySize||-1,fetchStart:Math.round(e.fetchStart),name:(t=e.name,t.substring(t.lastIndexOf("/")+1,t.indexOf("?")>0?t.indexOf("?"):t.length)),requestStart:Math.round(e.requestStart),responseEnd:Math.round(e.responseEnd),responseStart:Math.round(e.responseStart),transferSize:e.transferSize||-1};var t}r.d(t,"a",(function(){return a}));var a=function(){function e(){}return e.getExtraDataToLog=function(){if(!window.performance)return{};var t=window.performance.timing.navigationStart,r=n.a.getTimeStamp(),i=window.NavKeyPoints,a=e.extraData;return a.navigationStart=t,a.serverPageTime=i?i.ServerPageTime:0,a.pageLoaded=i?i.PageStartTime:0,a.basicJsLoaded=i?i.BasicJsLoadedTime:0,a.mainJsLoaded=i?i.MainJsLoadedTime:0,a.formRenderEnd=r,a.timeToContentReady=r-t,a.timeToSpin=a.pageLoaded-t,a.resourceTiming=o(),a.page=window.location.pathname,a},e.setExtraData=function(t,r){e.extraData[t]=r},e.clearExtraData=function(){e.extraData={}},e.extraData={},e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n,o=r(0),i=r(3),a=r(5),s=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),c=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n},u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.render=function(){var e=i.extend({},this.props.HTMLAttributes);return this.props.ValidationStyle&&(e.className=a.a.combineAttributes(e.className,this.props.ValidationStyle)),this.props.Hidden&&(e.style=e.style||{},e.style.display="none"),o.createElement.apply(o,c(["div",e],this.createReactNodes()))},t.prototype.createReactNodes=function(){throw Error("to be overridden.")},t}(o.Component)},function(e,t,r){(function(e){var n=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++)r[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return r},o=/%[sdj%]/g;t.format=function(e){if(!y(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(s(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,i=n.length,a=String(e).replace(o,(function(e){if("%%"===e)return"%";if(r>=i)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}})),c=n[r];r<i;c=n[++r])h(c)||!S(c)?a+=" "+c:a+=" "+s(c);return a},t.deprecate=function(r,n){if(void 0!==e&&!0===e.noDeprecation)return r;if(void 0===e)return function(){return t.deprecate(r,n).apply(this,arguments)};var o=!1;return function(){if(!o){if(e.throwDeprecation)throw new Error(n);e.traceDeprecation?console.trace(n):console.error(n),o=!0}return r.apply(this,arguments)}};var i,a={};function s(e,r){var n={seen:[],stylize:u};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),m(r)?n.showHidden=r:r&&t._extend(n,r),b(n.showHidden)&&(n.showHidden=!1),b(n.depth)&&(n.depth=2),b(n.colors)&&(n.colors=!1),b(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=c),l(n,e,n.depth)}function c(e,t){var r=s.styles[t];return r?"["+s.colors[r][0]+"m"+e+"["+s.colors[r][1]+"m":e}function u(e,t){return e}function l(e,r,n){if(e.customInspect&&r&&F(r.inspect)&&r.inspect!==t.inspect&&(!r.constructor||r.constructor.prototype!==r)){var o=r.inspect(n,e);return y(o)||(o=l(e,o,n)),o}var i=function(e,t){if(b(t))return e.stylize("undefined","undefined");if(y(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(g(t))return e.stylize(""+t,"number");if(m(t))return e.stylize(""+t,"boolean");if(h(t))return e.stylize("null","null")}(e,r);if(i)return i;var a=Object.keys(r),s=function(e){var t={};return e.forEach((function(e,r){t[e]=!0})),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(r)),M(r)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return d(r);if(0===a.length){if(F(r)){var c=r.name?": "+r.name:"";return e.stylize("[Function"+c+"]","special")}if(v(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(I(r))return e.stylize(Date.prototype.toString.call(r),"date");if(M(r))return d(r)}var u,S="",O=!1,C=["{","}"];(p(r)&&(O=!0,C=["[","]"]),F(r))&&(S=" [Function"+(r.name?": "+r.name:"")+"]");return v(r)&&(S=" "+RegExp.prototype.toString.call(r)),I(r)&&(S=" "+Date.prototype.toUTCString.call(r)),M(r)&&(S=" "+d(r)),0!==a.length||O&&0!=r.length?n<0?v(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special"):(e.seen.push(r),u=O?function(e,t,r,n,o){for(var i=[],a=0,s=t.length;a<s;++a)w(t,String(a))?i.push(f(e,t,r,n,String(a),!0)):i.push("");return o.forEach((function(o){o.match(/^\d+$/)||i.push(f(e,t,r,n,o,!0))})),i}(e,r,n,s,a):a.map((function(t){return f(e,r,n,s,t,O)})),e.seen.pop(),function(e,t,r){if(e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1];return r[0]+t+" "+e.join(", ")+" "+r[1]}(u,S,C)):C[0]+S+C[1]}function d(e){return"["+Error.prototype.toString.call(e)+"]"}function f(e,t,r,n,o,i){var a,s,c;if((c=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?s=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(s=e.stylize("[Setter]","special")),w(n,o)||(a="["+o+"]"),s||(e.seen.indexOf(c.value)<0?(s=h(r)?l(e,c.value,null):l(e,c.value,r-1)).indexOf("\n")>-1&&(s=i?s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),b(a)){if(i&&o.match(/^\d+$/))return s;(a=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function p(e){return Array.isArray(e)}function m(e){return"boolean"==typeof e}function h(e){return null===e}function g(e){return"number"==typeof e}function y(e){return"string"==typeof e}function b(e){return void 0===e}function v(e){return S(e)&&"[object RegExp]"===O(e)}function S(e){return"object"==typeof e&&null!==e}function I(e){return S(e)&&"[object Date]"===O(e)}function M(e){return S(e)&&("[object Error]"===O(e)||e instanceof Error)}function F(e){return"function"==typeof e}function O(e){return Object.prototype.toString.call(e)}function C(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(r){if(b(i)&&(i=e.env.NODE_DEBUG||""),r=r.toUpperCase(),!a[r])if(new RegExp("\\b"+r+"\\b","i").test(i)){var n=e.pid;a[r]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",r,n,e)}}else a[r]=function(){};return a[r]},t.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=p,t.isBoolean=m,t.isNull=h,t.isNullOrUndefined=function(e){return null==e},t.isNumber=g,t.isString=y,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=b,t.isRegExp=v,t.isObject=S,t.isDate=I,t.isError=M,t.isFunction=F,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=r(284);var P=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function T(){var e=new Date,t=[C(e.getHours()),C(e.getMinutes()),C(e.getSeconds())].join(":");return[e.getDate(),P[e.getMonth()],t].join(" ")}function w(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",T(),t.format.apply(t,arguments))},t.inherits=r(285),t._extend=function(e,t){if(!t||!S(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e};var _="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function E(e,t){if(!e){var r=new Error("Promise was rejected with a falsy value");r.reason=e,e=r}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(_&&e[_]){var t;if("function"!=typeof(t=e[_]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,_,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,r,n=new Promise((function(e,n){t=e,r=n})),o=[],i=0;i<arguments.length;i++)o.push(arguments[i]);o.push((function(e,n){e?r(e):t(n)}));try{e.apply(this,o)}catch(e){r(e)}return n}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),_&&Object.defineProperty(t,_,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,n(e))},t.promisify.custom=_,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function r(){for(var r=[],n=0;n<arguments.length;n++)r.push(arguments[n]);var o=r.pop();if("function"!=typeof o)throw new TypeError("The last argument must be of type Function");var i=this,a=function(){return o.apply(i,arguments)};t.apply(this,r).then((function(t){e.nextTick(a,null,t)}),(function(t){e.nextTick(E,t,a)}))}return Object.setPrototypeOf(r,Object.getPrototypeOf(t)),Object.defineProperties(r,n(t)),r}}).call(this,r(247))},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=decodeURI(OfficeFormServerInfo.webSettings||"{}"),o=JSON.parse(n);function i(e){var t=o[e];return t||(t=""),t}},function(e,t,r){"use strict";var n=r(4),o=r(1),i=r(27),a=r(93),s=r(55),c=r(81),u=r(82),l=r(38),d=r(18),f=r(34),p=r(23),m=r(8),h=function(){function e(e,t){this.choice=e,this.dataProvider=p.a.getDataProviderByFormMaster(this.choice.Form)}return Object.defineProperty(e.prototype,"FormId",{get:function(){return this.choice.FormId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"QuestionId",{get:function(){return this.choice.QuestionId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ChoiceId",{get:function(){return this.choice.Model.Id},enumerable:!0,configurable:!0}),e.prototype.add=function(e){if(this.choice.Form.SyncContext===m.e.DesignTimeForm)return this.dataProvider.createQuestionChoice(this.FormId,this.QuestionId,e);Object(d.c)("Trying to create a choice out of design time.")},e.prototype.delete=function(e){if(this.choice.Form.SyncContext===m.e.DesignTimeForm)return this.dataProvider.deleteQuestionChoice(this.FormId,this.QuestionId,this.ChoiceId);Object(d.c)("Trying to delete a choice out of design time.")},e.prototype.query=function(e){return this.dataProvider.getQuestionChoice(this.FormId,this.QuestionId,this.ChoiceId)},e.prototype.update=function(e,t){if(this.choice.Form.SyncContext===m.e.DesignTimeForm){if(e)return this.dataProvider.updateQuestionChoice(this.FormId,this.QuestionId,this.ChoiceId,e);try{throw Error("patch choice body null error")}catch(e){f.a.logData({errorName:"DataSourceUpdatingChoiceNull",errorInfo:{stack:e.stack}})}return $.Deferred().resolve().promise()}Object(d.c)("Trying to update a choice out of design time.")},e}();r.d(t,"b",(function(){return v})),r.d(t,"a",(function(){return S}));var g,y=(g=function(e,t){return(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}g(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),b={Id:o.a.number({IsSourceGenerated:!0,IsKeyField:!0,SourceFieldName:"id"}),AnswerHint:o.a.string({SourceFieldName:"description"}),CustomProperties:o.a.string({SourceFieldName:"customProperties"}),Description:o.a.string({SourceFieldName:"displayText"}),FormsProDisplayRTText:o.a.string({SourceFieldName:"formsProDisplayRTText"}),Order:o.a.number({SourceFieldName:"order"}),Key:o.a.string({SourceFieldName:"key"}),IsGenerated:o.a.boolean({IsLocalField:!0}),IsMathOption:o.a.boolean({IsLocalField:!0}),BranchInfo:o.a.fromMasterClass((function(){return a.a}),{IsLocalField:!0}),SavingState:o.a.reference({IsLocalField:!0})};function v(e){return n.a.getObjectMasterFromModel(e)}var S=function(e){function t(t){var r=this,n=$.Deferred();return r=e.call(this,t,{Scheduler:new s.a,MasterReady:n.promise()})||this,Object(l.b)(r),r.fieldsReady([r.Schema.Id,r.Schema.Key]).done((function(){r.Model.Key||(r.Model.Key=i.a.newGuid())})),r.initializeCustomPropertiesBinder(t),n.resolve(),r}return y(t,e),Object.defineProperty(t.prototype,"Question",{get:function(){return this.Parent.Parent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"QuestionId",{get:function(){return this.Question.Model.Id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Form",{get:function(){return this.Question.Form},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!0,configurable:!0}),t.prototype.initializeCustomPropertiesBinder=function(e){this.customPropertiesBinder=new c.a(this,t.Schema.CustomProperties,t.CustomPropertiesFieldSet),e.InitialData&&this.isFieldReady(t.Schema.CustomProperties)&&(e.ExistingInDataSource||e.InitialData.CustomProperties?this.customPropertiesBinder.deserialize():this.customPropertiesBinder.serialize())},Object.defineProperty(t,"CustomPropertiesFieldSet",{get:function(){return t.customPropertiesFieldSet||(t.customPropertiesFieldSet=new u.a([t.Schema.BranchInfo,t.Schema.IsGenerated,t.Schema.IsMathOption])),t.customPropertiesFieldSet},enumerable:!0,configurable:!0}),t}(n.a.createObjectMasterClass("ChoiceV2Master",b,(function(e,t){return new h(e,t)})))},function(e,t,r){"use strict";r.d(t,"b",(function(){return p})),r.d(t,"a",(function(){return m}));var n,o=r(0),i=r(20),a=r(3),s=r(25),c=r(5),u=r(12),l=r(22),d=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),f=function(){return(f=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function p(e){return o.createElement(m,f({},e))}var m=function(e){function t(r){var n=e.call(this,r)||this;n.controlId=a.uniqueId(t.name),n.placeholderId=n.controlId+"_placeholder",n.placeholderRef=o.createRef(),n.onBlur=n.onBlur.bind(n),n.onKeyDown=n.onKeyDown.bind(n);var i=n.getSelectOptions(),s=a.findIndex(i,(function(e){return e.Value===n.props.Value}));return n.selectedOptionKey=s<0?void 0:i[s].Key,n.state={Expanded:!1},n}return d(t,e),t.prototype.componentWillUpdate=function(e,r){var n=t.GetSelectOptions(e),o=a.findIndex(n,(function(t){return t.Value===e.Value}));this.selectedOptionKey=o<0?void 0:n[o].Key},t.prototype.componentDidUpdate=function(){if(this.scrollToSelectedOption(),this.state.Expanded){this.adjustOptionPanelLayout();var e=this.refs[this.selectedOptionKey];if(e){var t=i.findDOMNode(e);t&&t.focus()}}},t.prototype.adjustOptionPanelLayout=function(){var e=document.getElementById(this.controlId),t=window.getComputedStyle(e),r=e.offsetWidth,n=i.findDOMNode(this.refs.menu);(this.props.AllowWrap||n.offsetWidth<r)&&(n.style.width=r+"px"),n.style.top=e.offsetHeight-parseInt(t.borderTopWidth)+"px",n.style.left="-"+t.borderLeftWidth},t.prototype.render=function(){var e=this,t=a.extend({},this.props.HTMLAttributes),r=c.a.mergeReactProps(t,{"aria-describedby":this.placeholderId,"aria-expanded":this.state.Expanded,"aria-label":t["aria-label"]||this.props.Label||this.props.Placeholder,className:"select-control",id:this.controlId,onBlur:this.onBlur,onClick:t.disabled?void 0:function(){return e.onClick()},onKeyDown:this.onKeyDown,ref:this.placeholderRef,role:"combobox",tabIndex:t.disabled?-1:0});return o.createElement("div",f({},r),this.createPlaceholder(),this.createOptions())},t.GetSelectOptions=function(e){var t=e.SelectOptions;if(t)return t;var r=e.SelectOptionGroups;return a.flatten(r.map((function(e){return e.SelectOptions})))},t.prototype.getSelectOptions=function(){return t.GetSelectOptions(this.props)},t.prototype.isGroupOptions=function(){return!!this.getSelectOptionGroups()},t.prototype.getSelectOptionGroups=function(){return this.props.SelectOptionGroups},t.prototype.createPlaceholder=function(){var e,t=this,r=this.getSelectOptions(),n=a.findIndex(r,(function(e){return void 0===t.selectedOptionKey?e.Value===t.props.Value:e.Key===t.selectedOptionKey}));n>=0&&(e=this.props.DisplayValue?this.props.Value:r[n].DisplayContent||r[n].DisplayName),e||(e=this.props.Placeholder||"");var i=this.selectedOptionKey?"select-placeholder-text":"select-placeholder-text default",s=this.state.Expanded?"off":"polite",c=this.props.PlaceholderIcon&&o.createElement("div",{className:"select-placeholder-icon"},o.createElement(l.a,{IconName:this.props.PlaceholderIcon}));return o.createElement("div",{className:"select-placeholder"},c,o.createElement("span",{"aria-live":s,id:this.placeholderId,className:i,role:"textbox","aria-label":this.getPlaceholderText(r[n])},e),this.createArrow())},t.prototype.getPlaceholderText=function(e){return this.props.DisplayValue&&this.props.Value?this.props.Value.toString():e&&e.DisplayName?e.DisplayName:this.props.Placeholder||""},t.prototype.createArrow=function(){var e={HTMLAttributes:{className:"select-placeholder-arrow forms-icon-size14x14"},IconName:this.state.Expanded?"ChevronUp":"ChevronDown"};return o.createElement(l.a,f({},e))},t.prototype.createOptions=function(){var e=this;if(this.state.Expanded){var t={className:"select-option-menu-container",ref:"menu",onWheel:function(t){t.preventDefault();var r=t.deltaY,n=i.findDOMNode(e.refs.menu),o=n.scrollTop+r;if(r>=0){var a=n.scrollHeight-n.clientHeight;n.scrollTop=Math.min(o,a)}else n.scrollTop=Math.max(o,0)},role:"listbox"};return o.createElement("ul",f({},t),this.createOptionItems())}},t.prototype.createOptionItems=function(){var e=this;return this.isGroupOptions()?this.getSelectOptionGroups().map((function(t,r){return e.groupToItems(t,r)})):this.optionsToItems(this.getSelectOptions())},t.prototype.groupToItems=function(e,t){var r=!(!e.SelectOptions.length||!e.DisplayName)&&o.createElement("h5",{className:"select-group-header office-form-theme-primary-color",key:"group_header"+t},e.DisplayName);return o.createElement(o.Fragment,{key:"group_"+t},r,this.optionsToItems(e.SelectOptions))},t.prototype.optionsToItems=function(e){var t=this;return e.map((function(e){return t.createOption(e)}))},t.prototype.createOption=function(e){var t=this,r=e.Key===this.selectedOptionKey,n={"aria-selected":r,"aria-disabled":e.Disabled,className:this.props.AllowWrap?"select-option-nocheck":"select-option",tabIndex:r?0:-1,key:e.Key,ref:e.Key&&e.Key.toString(),role:"option"};e.AriaLabel&&(n["aria-label"]=e.AriaLabel),e.Disabled?n.className=c.a.combineAttributes(n.className,"disabled"):n.onClick=function(r){i.findDOMNode(t).focus(),t.selectedOptionKey&&t.selectedOptionKey===e.Key||t.props.onValueChange(e.Value),t.setState({Expanded:!1}),r.stopPropagation()};var a,s="select-option-state forms-icon-size14x14";this.props.PlaceholderIcon&&(s=c.a.combineAttributes(s,"hasPlaceholderIcon")),this.props.AllowWrap||(a=o.createElement(l.a,{HTMLAttributes:{className:s},IconName:"CheckMark"})),r&&(n.className=c.a.combineAttributes(n.className,"selected"));var u=e.DisplayContent;return u||(u=o.createElement("span",null,e.DisplayName)),o.createElement("li",f({},n),o.createElement("div",{className:"select-option-content"},a,u))},t.prototype.onBlur=function(e){var t=i.findDOMNode(this),r=c.a.getTargetElementOfFocusEvent(e);t.contains(r)||this.setState({Expanded:!1})},t.prototype.onKeyDown=function(e){var t=this;switch(e.stopPropagation(),e.keyCode){case s.a.Space:this.setState({Expanded:!0}),e.preventDefault();break;case s.a.Enter:this.onClick(!0),e.preventDefault();break;case s.a.Tab:this.state.Expanded&&(this.setState({Expanded:!1},(function(){t.placeholderRef.current&&t.placeholderRef.current.focus()})),e.preventDefault());break;case s.a.Esc:this.state.Expanded&&this.setState({Expanded:!1},(function(){t.placeholderRef.current&&t.placeholderRef.current.focus()})),e.preventDefault();break;case s.a.ArrowLeft:case s.a.ArrowRight:this.state.Expanded||(e.keyCode===s.a.ArrowLeft?this.selectPreviousOption():this.selectNextOption()),e.preventDefault();break;case s.a.ArrowUp:case s.a.ArrowDown:e.altKey?this.setState({Expanded:!this.state.Expanded}):e.keyCode===s.a.ArrowUp?this.selectPreviousOption():this.selectNextOption(),e.preventDefault()}},t.prototype.selectPreviousOption=function(){for(var e=this,t=this.getSelectOptions(),r=a.findIndex(t,(function(t){return t.Key===e.selectedOptionKey}));r>0;){var n=t[r-1];if(!n.Disabled){this.props.onValueChange(n.Value);break}r--}},t.prototype.selectNextOption=function(){for(var e=this,t=this.getSelectOptions(),r=a.findIndex(t,(function(t){return t.Key===e.selectedOptionKey}));r<t.length-1;){var n=t[r+1];if(!n.Disabled){this.props.onValueChange(n.Value);break}r++}},t.prototype.onClick=function(e){var t=this.getSelectOptions();this.state.Expanded?i.findDOMNode(this).focus():e&&void 0===this.selectedOptionKey&&t[0]&&this.props.onValueChange(t[0].Value);this.setState({Expanded:!this.state.Expanded})},t.prototype.scrollToSelectedOption=function(){if(this.state.Expanded){var e=$(i.findDOMNode(this.refs.menu)),t=e.find(".select-option.selected");c.a.scrollToShowSubelement(t,e)}},t.prototype.focus=function(){i.findDOMNode(this).focus()},t}(u.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(45),o=r(6),i=r(9),a=r(103);function s(e){if(!Object(n.c)()){if(e.linkify(),Object(o.a)().Flighting.isEnabled("LinkifyEscape")){var t=/^[a-z0-9]\.|\.xxx/i,r=Object(a.a)("LinkifyEscapeRegex");r&&(t=new RegExp(r,"i")),e.find("a.linkified").each((function(e,r){$(r).text().match(t)&&$(r).contents().unwrap()}))}e.find("a.linkified").length&&Object(i.a)({eventName:"NeedLinkify",eventType:"engagement_event"})}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(23),o=r(75),i=r(192),a={};function s(e,t){return a.hasOwnProperty(t)||(a[t]=new i.a((function(e){return function(e,t){var r=e.length,i=Object(o.e)(t);if(i)return n.a.getDataProviderByFormMaster(i).copyLocaleResources(t,e).then((function(){for(var e=[],t=0;t<r;++t)e.push({Succeeded:!0,Value:void 0});return e}),(function(e){for(var t=[],n=0;n<r;++n)t.push({Error:e,Succeeded:!1});return t}));return $.Deferred().resolve().promise()}(e,t)}))),a[t].insert(e)}},function(e,t,r){"use strict";r.d(t,"b",(function(){return s})),r.d(t,"a",(function(){return c}));var n,o=r(0),i=r(12),a=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),s=function(){function e(){}return Object.defineProperty(e,"None",{get:function(){return""},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Success",{get:function(){return"has-success"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Warning",{get:function(){return"has-warning"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Error",{get:function(){return"has-error"},enumerable:!0,configurable:!0}),e}(),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(){return o.createElement("span",{className:"required-star"})},t}(i.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return R}));var n,o=r(0),i=r(119),a=r(74),s=r(48),c=r(11),u=r(24),l=r(2),d=r(135),f=r(49),p=r(5),m=r(28),h=r(78),g=r(13),y=r(16),b=r(67),v=r(6),S=r(7),I=r(9),M=r(84),F=r(40),O=r(195),C=r(29),P=r(31),T=r(12),w=r(90),_=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),E=function(){return(E=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},R=function(e){function t(t){var r=e.call(this,t)||this;return r.state={ShowErrorDetail:!1},r.isDefaultTitle=!1,r.onClickMoreDetailButton=r.onClickMoreDetailButton.bind(r),r}return _(t,e),t.createActionButton=function(e,t){var r={ButtonStyle:"LightBackground",HTMLAttributes:{"aria-describedby":"errorPageSubtitle",className:"office-form-info-error-action-button",onClick:t},Text:e},n=o.createElement(P.a,E({},r));return o.createElement("div",{className:"office-form-info-error-action-button-container"},n)},t.prototype.componentDidMount=function(){var e=this.props.Error,t=l.a.LocalizedStrings;Object(I.a)({correlationId:e&&e.correlationId,eventName:Object(b.a)(e,this.props.ErrorType)?"Error.ErrorPage.Information":"Error.ErrorPage.Error",eventType:"engagement_event",extraData:{Error:Object(b.c)(e),ErrorMessage:this.props.ErrorMessage,ErrorTitle:this.props.ErrorTitle,isDefaultTitle:this.isDefaultTitle,isEmptyMessage:!t["Error_Message_"+this.props.Error.innerCode]}});h.a.notifyResponsePageFixedHeightToParentWindow(450)},t.prototype.render=function(){var e,r=l.a.LocalizedStrings,n=this.props.Error||{},i=r["Error_Message_"+n.innerCode+"_title"]||l.a.LocalizedStrings.Error_Page_DefaultErrorTitle,a=r["Error_Message_"+n.innerCode]||l.a.LocalizedStrings.Error_Page_DefaultMessage,u=Object(d.a)(this.props.Error),f=this.props.ErrorType;switch(f){case"Error":i=i||l.a.LocalizedStrings.Error_Page_DefaultErrorTitle,a=a||u;break;case"Information":i?a=a||u:i=u}switch(n.innerCode){case y.b.NoPermission:this.props.IsResponsePage?(i=r["Error_Message_"+n.innerCode+"_title_2"],a=void 0):this.props.IsAnalysisPage?(i=r["Error_Message_"+n.innerCode+"_title_3"],a=void 0):i=r["Error_Message_"+n.innerCode+"_title_1"];break;case y.b.FormClosed:if(Object(v.a)().Flighting.isEnabled("FormCustomizedMessage"))i=n.customizedMessage?n.customizedMessage:l.a.LocalizedStrings.Error_Message_FormClosed;else if("This form is closed."===n.innerMessage)i=l.a.LocalizedStrings.Error_Message_FormClosed;else{var p=n.innerMessage.indexOf("Inner Message:")+"Inner Message:".length,m=n.innerMessage.length;i=n.innerMessage.substring(p,m).trim()}a="";break;case y.b.ExceedMaximumFormLimition:a=r["Error_Message_"+n.innerCode+"_recyclebin"];break;case y.b.FailedToCheckUserLicense||y.b.NotAllowedBySetting||y.b.NotSupportComposeFormId:a=r.Error_Page_DelayTryMessage;break;case y.b.NotAllowedByResponseOwnership:case y.b.ResponseNotFound:a=void 0;break;case y.b.MSAOwnerDisabled:i=r.Error_Inline_MSAUserDisabled,a=r.Error_SubTitle_MSAUserDisabled;break;case y.b.RestrictUser:i=r.Error_Message_6100_title,a=r.Error_Message_6100;break;case y.b.RestrictedUserNotFound:i=r.AdminUnblockRestrictedUser_Page_User_NotFound,a=void 0}switch(n.message===l.a.LocalizedStrings.Error_Message_FormClosed&&(i=Object(v.a)().Flighting.isEnabled("FormCustomizedMessage")&&n.customizedMessage?n.customizedMessage:n.message),n.innerCode){case y.b.FormEnded:case y.b.FormNotStarted:i=r["Error_Message_"+n.innerCode+"_title"],a=""}switch(n.message){case l.a.LocalizedStrings.TakeATest_Win10:case l.a.LocalizedStrings.TakeATest_NotWin10:i=n.message,a=l.a.LocalizedStrings.TakeATest_Subtitle,e=t.createLinkMessage(l.a.LocalizedStrings.TakeATest_LearnMore,t.onClickHelpLinkButton)}var h,b=this.createErrorDetail();n.innerCode===y.b.LoginNotSupportInCurrentBrowser&&(i="",a=o.createElement("div",{dangerouslySetInnerHTML:{__html:a}}),b=void 0),this.props.ShowCreateFormLink&&this.props.IsResponsePage&&n.name!==s.a.LoginIECrossZoneError&&n.name!==s.a.ThirdPartyCookieBlockedError&&n.name!==s.a.AuthNoStorageError&&n.name!==s.a.AADAcquireTokenMfaCheckError&&n.name!==s.a.TeamSiteNoGroupError&&n.innerCode!==y.b.DisabledByTenantAdmin&&n.innerCode!==y.b.LoginNotSupportInCurrentBrowser&&(h=this.createPropotionMessage());var M=g.x()?"office-form-page-padding office-form-error-page-container office-form-spo-embed":"office-form-page-padding office-form-error-page-container",C=!1,P=!1;return Object(S.e)((function(){switch(C="FormsProInformation"===f,n.innerCode){case y.b.DisabledByTenantAdmin:case y.b.LicenseNotFound:case y.b.LicenseNotValid:Object(v.a)().Flighting.isEnabled("FormsProTrial")&&location.href.lastIndexOf("FormId=")>-1&&(P=!0),Object(v.a)().Flighting.isEnabled("FormsProSignupInformationPage")?(C=!0,i=l.a.LocalizedStrings.INFORMATION_MESSAGE_8001_TITLE,a=l.a.LocalizedStrings.INFORMATION_MESSAGE_8001,Object(I.c)({eventInfo:{Geo:null!=document.getElementById("Geo")?document.getElementById("Geo").value:"",sessionId:Object(F.d)(),tenantId:OfficeFormServerInfo.userInfo.TenantId,userId:OfficeFormServerInfo.userInfo.UserId},type:"MFP_SignupThroughMarketingDelayed"})):(i=l.a.LocalizedStrings.ERROR_MESSAGE_703_751_752_TITLE,a=l.a.LocalizedStrings.ERROR_MESSAGE_703_751_752)}if(C){8e3===n.innerCode&&(i=l.a.LocalizedStrings.INFORMATION_MESSAGE_8000_TITLE,a=l.a.LocalizedStrings.INFORMATION_MESSAGE_8000)}})),this.isDefaultTitle=i===l.a.LocalizedStrings.Error_Page_DefaultErrorTitle,i=i&&o.createElement("div",{className:"office-form-info-title"},i),a=a&&o.createElement("div",{className:"office-form-info-subtitle",id:"errorPageSubtitle"},a),e=e&&o.createElement("div",{className:"office-form-info-subtitle"},e),P?o.createElement("div",{className:M},o.createElement(S.a.InvalidLicenseView,null)):C?o.createElement("div",{className:M},o.createElement("div",{className:"office-form office-form-info-container"},i,a,o.createElement("div",{className:"office-form-info-other"},h),!g.x()&&o.createElement(w.a))):o.createElement(o.Fragment,null,Object(v.a)().Flighting.isEnabled("AddUPNToAdminPhishingReviewPage")&&"AdminPhishingReviewPage"===c.a.getPageType()&&o.createElement(O.a,{ErrorCode:n.innerCode,FormId:this.props.FormId}),o.createElement("div",{className:M},o.createElement("div",{className:"office-form office-form-info-container"},i,a,e,b,o.createElement("div",{className:"office-form-info-other"},h),!g.x()&&Object(S.c)((function(){return o.createElement(w.a,null)}),(function(){return o.createElement(w.a)})))))},t.prototype.onClickMoreDetailButton=function(){this.setState({ShowErrorDetail:!this.state.ShowErrorDetail})},t.prototype.getTechnicalMessage=function(){var e=this.props.Error;if(e)return e.correlationId?l.a.LocalizedStrings.Error_TechnicalMessage2.format(Object(F.d)(),e.correlationId):l.a.LocalizedStrings.Error_TechnicalMessage.format(Object(F.d)())},t.prototype.createErrorDetail=function(){var e=this,r=l.a.LocalizedStrings;if("Information"!==this.props.ErrorType&&!Object(S.e)((function(){return"FormsProInformation"===e.props.ErrorType}))){var n,i=this.getTechnicalMessage(),a=Object(C.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{"aria-hidden":!0,"aria-label":l.a.LocalizedStrings.Error_More_Detail,className:"office-form-info-error-detail-button office-form-info-error-children",onClick:this.onClickMoreDetailButton},Icon:this.state.ShowErrorDetail?"ChevronUp":"ChevronDown",IconClassName:"forms-icon-size12x12"});this.state.ShowErrorDetail&&(n=o.createElement("div",{className:"office-form-info-error-detail"},i));var s=null;switch(this.props.Error.innerCode){case y.b.NotRolloutMsaUser:t.signOutInIframe(),s=t.createActionButton(r.Error_Message_BackToLoginButton,t.signInWithOtherAccount);break;case y.b.AntiForgeryTokenValidationError:s=t.createActionButton(r.Error_Message_RefreshPageButton,(function(){return Object(m.d)()}));break;case y.b.CoAuthNotAllowedForMsa:s=t.createActionButton(r.Error_Message_SignInButton,t.forceAadSignIn)}return o.createElement("div",{className:"office-form-info-error-detail-container"},a,o.createElement("span",{className:"office-form-info-error-children office-form-info-children"},r.Error_More_Detail),n,s)}},t.prototype.createPropotionMessage=function(){if(this.props.IsResponsePage&&!f.a.isPPTIntegration()&&!u.a.IsAssignmentsIntegration)return t.createLinkMessage(l.a.LocalizedStrings.Renderer_PromotionMessage,t.onClickPropotionLinkButton)},t.createLinkMessage=function(e,t){var r="office-form-info-premotion office-form-info-children";return g.x()&&(r=p.a.combineAttributes(r,"office-form-theme-spo-link")),o.createElement("div",null,o.createElement("a",{className:r,onClick:t},e))},t.onClickPropotionLinkButton=function(){var e="DesignPage.aspx",t=g.w()||g.x();Object(S.c)((function(){if(t){var r=g.j(),n="../Pages/DesignPage.aspx?"+jQuery.param(r);e=p.a.getAbsoluteUrl(n)}}),(function(){e=p.a.getAbsoluteUrl(c.a.getFormsHomeUrl())})),Object(I.a)({eventName:"ResponsePage.ThanksView.NavigateToPortal",eventType:"engagement_event"});var r=t?"_blank":"_self";p.a.safeOpen(e,r)},t.onClickHelpLinkButton=function(){Object(I.a)({eventName:"ResponsePage.ThanksView.LearnMoreForTakeATest",eventType:"engagement_event"}),p.a.safeOpen(l.a.LocalizedStrings.TakeATest_LearnMoreLink,"_blank")},t.signInWithOtherAccount=function(){Object(I.a)({eventName:"Error.ErrorPage.SignInWithOtherAccount",eventType:"engagement_event"}),c.a.isOsi()&&Object(a.a)("Msa").then((function(e){e?(Object(I.a)({eventName:"Error.ErrorPage.SignOutInIframeInProgress",eventType:"engagement_event"}),Object(m.c)(OfficeFormServerInfo.signOutLink)):Object(i.b)()}))},t.forceAadSignIn=function(){var e=window.location.href;e=p.a.updateUrlParam(e,u.a.AuthProviderParam,"OrgId"),Object(m.f)(e)},t.signOutInIframe=function(){if(c.a.isOsi()){var e=new M.a("Auth.SignOutInIframe");e.start();var t=$('<iframe style="display: none" src="'+OfficeFormServerInfo.signOutLink+'" />');t.on("load",(function(){return e.end({resultType:"Success"})})),$(document.body).append(t)}},t}(T.a)},,function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){function e(){}return e.isNumber=function(e){return"number"==typeof e},e.isString=function(e){return"string"==typeof e},e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return d})),r.d(t,"c",(function(){return f}));var n,o=r(0),i=r(8),a=r(12),s=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),c=function(){return(c=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},u="https://go.microsoft.com/fwlink/?linkid=866263",l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.render=function(){var e=f();this.props.ForceUseCommercialTermsLink?e=d():this.props.FormMaster&&(e=function(e){if(e.SyncContext!==i.e.AdminPhishingReviewForm&&(e.SyncContext===i.e.SharedTimeForm||e.Model.Settings.IsAnonymous||e.Model.Settings.NotRecordIdentity))return u;return"http://go.microsoft.com/fwlink/p/?LinkId=2083423"}(this.props.FormMaster));var t={href:e,target:"_blank"};return o.createElement("a",c({},t),this.props.LocalizedStrings.TermsLink)},t}(a.a);function d(){return"http://go.microsoft.com/fwlink/p/?LinkId=2083423"}function f(){return u}},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(56),o=r(11),i=r(13),a=function(){function e(){this.deferred=null,this.muid=null}return Object.defineProperty(e,"Instance",{get:function(){return null==e.instance&&(e.instance=new e),e.instance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Muid",{get:function(){return this.muid},enumerable:!0,configurable:!0}),e.prototype.ensureMuid=function(){var t=this;if(null==this.deferred)if(this.deferred=$.Deferred(),this.muid=e.readMuid(),null==this.muid){var r=new n.a("Function.GetMuid");r.start(),e.loadMuid((function(){t.muid=e.readMuid(),null!=t.muid?(t.deferred.resolve(t.muid),r.end({resultType:"Success"})):(t.deferred.reject(),r.end({resultType:navigator.cookieEnabled?"Failure":"ExpectedFailure"}))}))}else this.deferred.resolve(this.muid);return this.deferred.promise()},e.loadMuid=function(e){var t=o.a.getMuidHost();if(t){var r=document.createElement("img");r.style.display="none",r.src=t+"/c.gif",r.hidden=!0,r["aria-hidden"]="true",r.onload=r.onerror=e}else e()},e.readMuid=function(){return i.i("MUID")},e.instance=null,e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n,o=r(0),i=r(3),a=r(12),s=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),c=function(){return(c=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderingElement=o.createRef(),t}return s(t,e),t.prototype.componentDidMount=function(){var e=this;this.props.LazyRendering&&(this.renderingElement.current&&console.log(this.renderingElement.current),window.setTimeout((function(){return e.setState({Mounted:!0})})))},t.prototype.render=function(){var e=i.clone(this.props.HTMLAttributes||{});switch(this.props.Role){case"Alert":e.role="alert";break;case"Log":e.role="log",e["aria-live"]=e["aria-live"]||"polite",e["aria-relevant"]=e["aria-relevant"]||"additions text";break;case"Marquee":e.role="marquee";break;case"Status":e.role="status"}return this.props.LazyRendering&&!this.state.Mounted?(e["aria-label"]=void 0,e.children=null,e.ref=this.renderingElement,o.createElement("div",c({},e))):o.createElement("div",c({},e),this.props.children)},t}(a.a)},function(e,t,r){"use strict";r.d(t,"b",(function(){return c})),r.d(t,"a",(function(){return u}));var n=r(9),o=Date.now(),i={},a={},s=function(){try{var e="FormsVersion"+window.location.pathname,t=window.localStorage.getItem(e),r=OfficeFormServerInfo.version;return t===r||(window.localStorage.setItem(e,r),!1)}catch(e){return!1}}();function c(e,t){var r=Date.now(),n={sa:r-o};return i[e]=n,t.done((function(){n.d=Date.now()-r})).fail((function(){n.d=Date.now()-r,n.f=1}))}function u(){var e=window.NavKeyPoints;Object(n.a)({eventName:"Forms.PerformanceAnalysis",eventType:"engagement_event",extraData:{checkPoints:a,requests:i,requestsAll:Date.now()-o,scriptCached:s,scriptDownload:e&&e.PageStartTime&&o-e.PageStartTime,version:1}})}},function(e,t,r){"use strict";var n;function o(e){n=e}function i(){return n?n():$.Deferred().reject("GetAddinAccessTokenFailed").promise()}r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return i}))},,function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"c",(function(){return i})),r.d(t,"d",(function(){return a})),r.d(t,"b",(function(){return s}));var n=r(3),o=function(){function e(){}return e.tagNames=["strong","em","u","sup","sub","a"],e.openingTags=n.map(e.tagNames,(function(e){return"<"+e+">"})),e.closingTags=n.map(e.tagNames,(function(e){return"</"+e+">"})),e.encodedOpeningTags=n.map(e.tagNames,(function(e){return"&lt;"+e+"&gt;"})),e.encodedClosingTags=n.map(e.tagNames,(function(e){return"&lt;/"+e+"&gt;"})),e}();function i(e){return function(e){var t=document.createElement("span");return t.innerHTML=e,e=t.innerHTML}(s(e))}function a(e){return o.openingTags.forEach((function(t){e=e.replaceAll(t,"")})),o.closingTags.forEach((function(t){e=e.replaceAll(t,"")})),e}function s(e){var t=n.escape(e);return o.tagNames.forEach((function(e,r){t=t.replaceAll(o.encodedOpeningTags[r],o.openingTags[r]).replaceAll(o.encodedClosingTags[r],o.closingTags[r])})),t}},function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return u}));var n=r(6),o=r(11),i=r(5),a=r(28),s=r(74),c=function(){function e(){}return e.prototype.getFormApiToken=function(){return Object(s.b)()},e.prototype.handleAuthForContentPage=function(e){},e.prototype.handleAuthForAddinPage=function(){},e.prototype.hasUserLoggedIn=function(){return!!OfficeFormServerInfo.userInfo.UserId},e.prototype.isValid=function(){return Object(n.a)().Flighting.isEnabled("CookieAuth")},e.prototype.redirectToLogin=function(){var e=encodeURIComponent(window.location.href),t=OfficeFormServerInfo.userInfo.IsMsa,r="Response"===o.a.getPageType(),n=OfficeFormServerInfo.signInLink;return!t||r?n=i.a.updateUrlParam(n,"state",e):(n=OfficeFormServerInfo.signInLinkMsa,n=i.a.updateUrlParam(n,"redirecturl",e)),Object(a.f)(n),$.Deferred().promise()},e.prototype.refreshToken=function(){return Object(s.d)()},e.prototype.signIn=function(){return this.redirectToLogin()},e.prototype.signOut=function(){return Object(a.c)(OfficeFormServerInfo.signOutLink).then((function(){return $.Deferred().promise()}))},e}();function u(e){var t;if(e){var r=encodeURIComponent(e);t=window.location.origin+"/?redirecturl="+r+"#Login=True"}else t=window.location.origin+"#Login=True";Object(a.f)(t)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n,o=r(0),i=r(44),a=r(12),s=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),c=function(){return(c=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},u=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.render=function(){var e=this.props,t=e.src,r=u(e,["src"]);return o.createElement("img",c({src:Object(i.a)(t)},r))},t}(a.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(9),o=function(){function e(){}return e.logData=function(e){Object(n.a)({eventName:e.name,eventType:"nav_perf_event",extraData:e.extraData})},e}()},function(e,t,r){"use strict";r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return g})),r.d(t,"a",(function(){return y}));var n,o=r(21),i=r(2),a=r(86),s=r(13),c=r(6),u=r(7),l=r(52),d=r(10),f=r(15),p=r(73),m=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function h(e){var t=d.b[e];return FormsPro.proOnly((function(){Object(c.a)().Flighting.isEnabled("FormsProTextFieldValidation")&&(t="None"===t?"OnlyNumber":t)})),i.a.LocalizedStrings["NumberValidation"+t]}function g(e){var t=d.g[e];return i.a.LocalizedStrings["ValidationType"+t]}var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),t.getElementTypeName=function(){return f.a.TextField},t.createDefaultDefinition=function(){return t.createDefaultSingleLineDefinition()},t.createDefaultSingleLineDefinition=function(){var e={Type:t.getElementTypeName(),Title:i.a.LocalizedStrings.Question_DefaultTitle,Multiline:!1,QuestionTagForIntelligence:"Unknown",IsFromSuggestion:!1};return Object(u.e)((function(){Object(c.a)().Flighting.isEnabled("FormsProCalculateSentiment")&&(e.FormsProCalculateSentiment=!1)})),e},t.createDefaultMultiLineDefinition=function(){var e={Type:t.getElementTypeName(),Title:i.a.LocalizedStrings.Question_DefaultTitle,Multiline:!0,QuestionTagForIntelligence:"Unknown",IsFromSuggestion:!1};return Object(u.e)((function(){Object(c.a)().Flighting.isEnabled("FormsProCalculateSentiment")&&(e.FormsProCalculateSentiment=!1)})),e},t.supportMobileDesign=function(e){return!t.hasInvalidSettingOnMobile(e)&&!e.IsNumber},t.prototype.verify=function(e){var t=e;if(this.Model.IsMathQuiz&&t){var r=s.I(e);if((t=null==r.Answer?e:r.Answer).length>o.a.MathInputLength)return d.e.MathLengthError}if(this.Model.Required&&!t)return d.e.RequiredError;if(t&&FormsPro.proOnly((function(){return Object(c.a)().Flighting.isEnabled("FormsProTextFieldValidation")}))&&this.Model.HasTFRestrictionForPro&&(d.g.Email===this.Model.FormsProValidationType||d.g.Custom===this.Model.FormsProValidationType)){var n=d.g.Email===this.Model.FormsProValidationType?o.a.RegExpForEmailValidation:new RegExp(this.Model.FormsProCustomRegEx);if(!this.verifyRegEx(t,n))return d.e.RegExValidationError}else if(t&&this.Model.IsNumber&&!this.verifyNumber(t))return d.e.NumberValidationError;return d.e.Success},t.prototype.getTypeDisplayName=function(){return this.Model.Multiline?i.a.LocalizedStrings.QuestionType_MultiLineText:this.Model.IsNumber?i.a.LocalizedStrings.QuestionType_Number:i.a.LocalizedStrings.QuestionType_SingleLineText},t.prototype.isNumberType=function(){return!!this.Model.IsNumber},t.prototype.justifyNumberBoundaries=function(){var e=this;this.Master.bulkEdit((function(){var t=e.Master.Model,r=a.a.formatAsFloat(t.NumberMinBoundary)||"1",n=a.a.formatAsFloat(t.NumberMaxBoundary)||"10";switch(t.NumberValidationRule){case d.b.Greater:case d.b.GreaterOrEqual:case d.b.Equal:case d.b.NotEqual:n=null;break;case d.b.Less:case d.b.LessOrEqual:r=null;break;case d.b.Between:case d.b.NotBetween:if(parseFloat(r)>parseFloat(n)){var o=r;r=n,n=o}}t.NumberMinBoundary=r,t.NumberMaxBoundary=n}))},t.prototype.getValidationErrorMessage=function(){var e;switch(this.Model.FormsProValidationType){case d.g.Email:e=i.a.LocalizedStrings.EmailValidFormatError;break;case d.g.Custom:e=this.Model.FormsProCustomPlaceholder?this.Model.FormsProCustomPlaceholder:i.a.LocalizedStrings.CustomValidFormatError;break;default:e=this.getNumberValidationErrorMessage()}return e},t.prototype.getNumberValidationErrorMessage=function(e){var t=this.Model.NumberValidationRule;if(null!=t)return(e||i.a.LocalizedStrings)["NumberValidation_ErrorMessage_"+d.b[t]].format(this.Model.NumberMinBoundary,this.Model.NumberMaxBoundary)},t.prototype.hasCorrectAnswers=function(e){return!(!this.Model.IsQuiz||this.Model.Multiline)&&new p.a(e||this.Model).areAnyAnswersDefined()},t.prototype.isCorrectAnswer=function(t){return this.Model.IsQuiz&&!this.Model.Multiline?new p.a(this.Model).isCorrect(t):e.prototype.isCorrectAnswer.call(this,t)},t.prototype.createQuizResult=function(e){if(new p.a(this.Model).areAnyAnswersDefined()&&this.Model.IsQuiz)return{IsAnswerCorrect:this.isCorrectAnswer(e),GradingBasis:this.Model.GradingBasis}},t.prototype.autoGradeAnswer=function(t){if(this.Model.IsQuiz&&!this.Model.Multiline){var r=new p.a(this.Model);if(r.areAnyAnswersDefined()){var n=this.Model.Point?this.Model.Point:0;t.Score=r.isCorrect(t.Answer)?n:0,t.IsAutoGraded=!0}else e.prototype.autoGradeAnswer.call(this,t)}else e.prototype.autoGradeAnswer.call(this,t)},t.prototype.autoGradeWithQuizResult=function(t,r){return r?this.Model.IsQuiz&&!this.Model.Multiline?r.IsAnswerCorrect?this.Model.Point:0:e.prototype.autoGradeWithQuizResult.call(this,t,r):null},t.prototype.verifyRegEx=function(e,t){return void 0===e||""===e||!!t.test(e)},t.prototype.verifyNumber=function(e){if(void 0===e||""===e)return!0;if(!a.a.isFormatedAsFloat(e))return!1;var t=parseFloat(a.a.formatAsFloat(e)),r=parseFloat(this.Model.NumberMinBoundary),n=parseFloat(this.Model.NumberMaxBoundary);switch(this.Model.NumberValidationRule){case d.b.None:return!0;case d.b.Between:return t>=r&&t<=n;case d.b.NotBetween:return!(t>=r&&t<=n);case d.b.Greater:return t>r;case d.b.GreaterOrEqual:return t>=r;case d.b.Less:return t<n;case d.b.LessOrEqual:return t<=n;case d.b.Equal:return t===r;case d.b.NotEqual:return t!==r;default:return!0}},t.prototype.deserializeAnswer=function(e){if(this.Model.IsMathQuiz&&e&&""!=e){var t=s.I(e);return this.Model.IsAnswerPlainText=!t.IsMath,null==t.Answer?e:t.Answer}return e},t}(l.a)},function(e,t,r){"use strict";r.d(t,"b",(function(){return m})),r.d(t,"c",(function(){return h})),r.d(t,"a",(function(){return y}));var n,o=r(0),i=r(20),a=r(11),s=r(6),c=r(78),u=r(30),l=r(42),d=r(17),f=r(12),p=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function m(e){return o.createElement(y,{Image:e.Image,ImageSettings:e.ImageSettings,ImageType:e.ImageType})}function h(e){var t;return t=Object(s.a)().Flighting.isEnabled("FromsSpinnerControl")?"common-spinner-circle":"spinner-tile-animation",o.createElement("div",{className:"image-spinner",id:e&&g(e)},o.createElement("div",{className:t}))}function g(e){return"imageSpinner-"+e.ResourceId}var y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mounted=!0,t.update=function(){return t.forceUpdate()},t.drawCanvasCallback=function(){return t.drawImageCanvas()},t}return p(t,e),t.prototype.componentDidMount=function(){var e=u.b.Schema,t=l.b.Schema;this.props.ImageSettings.observe(this.update),this.props.Image.observe(this.update,[e.ResourceUrl,e.ContentType,e.OriginalFileName]),this.props.ImageSettings.observe(this.drawCanvasCallback,[t.ContainerHeight,t.ContainerWidth,t.Left,t.Top]),this.props.Image.observe(this.drawCanvasCallback,[e.AltText]),this.applyImageEdit()},t.prototype.componentDidUpdate=function(){this.applyImageEdit()},t.prototype.componentWillUnmount=function(){this.mounted=!1,this.props.ImageSettings.unobserve(this.update),this.props.Image.unobserve(this.update),this.props.ImageSettings.unobserve(this.drawCanvasCallback),this.props.Image.unobserve(this.drawCanvasCallback)},t.prototype.render=function(){var e=this,t=this.props.Image.Model,r=this.props.ImageSettings.validateImageSettings(!0),n=0;return o.createElement("img",{src:t.ResourceUrl,title:t.AltText,alt:t.AltText,height:r.ContainerHeight+"px",width:r.ContainerWidth+"px",style:{visibility:"hidden"},onLoad:function(){d.a.logData({name:"Image.ImageOnLoad.Success",extraData:{imageType:e.props.ImageType,location:"1"}})},onError:function(r){if(n<3&&"Response"===a.a.getPageType()){var o=i.findDOMNode(e);n++;var s=t.ResourceUrl+"?"+n;window.setTimeout((function(){$(o).attr("src",s)}),1e3)}else d.a.logData({name:"Image.ImageOnLoad.Failure",extraData:{imageSrc:t.ResourceUrl,imageType:e.props.ImageType,location:"1"}})}})},t.prototype.applyImageEdit=function(){var e=this,t=this.props.Image&&this.props.Image.Model;if(t&&t.ResourceUrl&&!this.underSyncing()){var r=i.findDOMNode(this),n=0;r&&this.props.ImageSettings&&(r.onload=function(){return e.drawImageCanvas()},r.onerror=function(o){if(n<3&&"Response"===a.a.getPageType()){n++;var i=t.ResourceUrl+"?"+n;window.setTimeout((function(){$(r).attr("src",i)}),1e3)}else{d.a.logData({name:"Image.CanvasOnLoad.Failure",extraData:{imageSrc:r.src,imageType:e.props.ImageType,location:"1"}});var s=document.getElementById(g(t));s&&$(s).css("display","none"),$(r).css("visibility","visible")}})}},t.prototype.drawImageCanvas=function(){if(this.mounted){var e=this.props.Image&&this.props.Image.Model;if(e&&e.ResourceUrl&&!this.underSyncing()){var t=i.findDOMNode(this);if($(t).siblings("canvas").remove(),t&&this.props.ImageSettings)try{var r=document.createElement("canvas"),n=this.props.ImageSettings.validateImageSettings(!0);null!=e.AltText&&(r.title=e.AltText),r.tabIndex=-1;var o=1*n.NaturalWidth/n.ActualWidth,a=Math.abs(n.Left*o);a=Math.floor(Math.min(a,n.NaturalWidth));var s=Math.abs(n.Top*o);s=Math.floor(Math.min(s,n.NaturalHeight));var u=n.ContainerWidth*o||n.NaturalWidth;u=Math.floor(Math.min(u,n.NaturalWidth));var l=n.ContainerHeight*o||n.NaturalHeight;l=Math.floor(Math.min(l,n.NaturalHeight));try{var f=isNaN(window.devicePixelRatio)?1:window.devicePixelRatio;f=Math.ceil(Math.max(f,o)),r.width=Math.floor(n.ContainerWidth*f),r.height=Math.floor(n.ContainerHeight*f),r.getContext("2d").drawImage(t,a,s,u,l,0,0,r.width,r.height)}catch(e){$(t).css("visibility","visible");var p=e.message||void 0,m=e.stack||void 0;return void d.a.logData({name:"Image.CanvasRender.Failure",extraData:{imageSrc:t.src,imageType:this.props.ImageType,location:"1",error:p+" "+m,Exception:"DrawImageCanvas"}})}var h=document.getElementById(g(e));h&&$(h).css("display","none"),$(t).css("display","none"),$(t).parent().append(r),d.a.logData({name:"Image.CanvasRender.Success",extraData:{imageType:this.props.ImageType,location:"1"}}),c.a.notifyResponsePageHeightToParentWindow()}catch(e){p=e.message||void 0,m=e.stack||void 0;throw d.a.logData({name:"Image.CanvasRender.Failure",extraData:{imageSrc:t.src,imageType:this.props.ImageType,location:"1",error:p+" "+m,Exception:"CreateImageCanvas"}}),e}}}},t.prototype.underSyncing=function(){var e=this.props.Image.Model,t=this.props.ImageSettings.Model;return e.ResourceId!==t.TargetResourceId||e.ImageProcessingStatus!==u.c.Idle},t}(f.a)},function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return s})),r.d(t,"c",(function(){return c}));var n=r(26),o=r(24),i=r(45);function a(){var e=Object(i.b)();return Object(n.b)().getPrivacySettings(e&&e.OrgId,OfficeFormServerInfo.userInfo.TenantId).then((function(e){return e&&e.privacyUrl}))}function s(){var e={ar:"ar-sa",bg:"bg-bg",ca:"es-es",cs:"cs-cz",da:"da-dk",de:"de-de",el:"el-gr",en_us:"en-us",es:"es-es",et:"et-ee",eu:"es-es",fi:"fi-fi",fr:"fr-fr",gl:"es-es",he:"he-il",hi:"hi-in",hr:"hr-hr",hu:"hu-hu",id:"id-id",it:"it-it",ja:"ja-jp",kk:"kk-kz",ko:"ko-kr",lt:"lt-lt",lv:"lv-lv",ms:"ms-my",nb_no:"nb-no",nl:"nl-nl",pl:"pl-pl",pt_br:"pt-br",pt_pt:"pt-pt",ro:"ro-ro",ru:"ru-ru",sk:"sk-sk",sl:"sl-si",sr_cyrl_rs:"sr-cyrl-rs",sr_latn_rs:"sr-latn-rs",sv:"sv-se",sy_latn_rs:"sy-latn-rs",th:"th-th",tr:"tr-tr",uk:"uk-ua",vi:"vi-vn",zh_cn:"zh-cn",zh_tw:"zh-tw"},t=OfficeFormServerInfo.cultureInfo.Name.toLowerCase(),r="en-us";for(var n in e)if(t===e[n]||t===n){r=e[n];break}return"http://o15.officeredir.microsoft.com/r/rlidOfficeWebHelp?p1=microsoftforms&clid="+r+"&ver=16&mode=Touch"}function c(e){var t="https://www.office.com/launch/forms?flight=FormsStart,FormQuizCreateOn&auth=2";switch(o.a.StartPageRouteType){case"appitems":t="https://www.office.com/launch/forms/appitems?flight=FormsStart,FormQuizCreateOn&auth=2";break;case"groupitems":e&&(t="https://www.office.com/launch/forms/groupitems?flight=FormsStart,FormQuizCreateOn&auth=2&groupId="+e);break;case"start":break;default:return}window.location.assign(t)}},,,function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n,o=r(0),i=r(5),a=r(6),s=r(12),c=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.prototype.render=function(){var e,t=this.props.Ignorable?i.a.combineAttributes(this.props.ClassName,"optional-cell"):this.props.ClassName;return e=Object(a.a)().Flighting.isEnabled("FromsSpinnerControl")?"common-spinner-circle":"loading-spinner-animation",o.createElement("div",{className:t},o.createElement("div",{className:e}),this.createLoadingDescription())},t.prototype.createLoadingDescription=function(){if(this.props.LoadingDescription)return o.createElement("div",{className:"loading-control-description",role:"status"},this.props.LoadingDescription)},t}(s.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n,o=r(0),i=r(97),a=r(2),s=r(13),c=r(72),u=r(12),l=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mounted=!0,t.imgToLoadBackground=new Image,t}return l(t,e),t.prototype.componentWillMount=function(){var e=this,t=this.props.ThemeMaster;t&&(this.observerCallback=function(t){t.NewValues.Name===a.a.LocalizedStrings.Customized_Theme_Name&&t.NewValues.BackgroundImage!==e.state.ImageUrl?e.setState({ImageUrl:t.NewValues.BackgroundImage,IsBackgroundImgCached:!1}):e.forceUpdate()},t.observe(this.observerCallback))},t.prototype.componentWillUnmount=function(){var e=this.props.ThemeMaster;this.mounted=!1,e&&e.unobserve(this.observerCallback)},t.prototype.render=function(){var e,r=this,n=this.props.ThemeMaster;if(!(e=s.x()&&OfficeFormServerInfo.themeInfo?t.getSPOTheme(OfficeFormServerInfo.themeInfo):n&&n.Model))return null;var i=e.Name,c=e.PrimaryColor,u=e.SecondaryColor,l=e.BackgroundColor,d=e.BackgroundImage;d&&d.match("url((.*))")&&(d=d.substring(4,d.length-1)),i===a.a.LocalizedStrings.Customized_Theme_Name&&d&&(this.state.IsBackgroundImgCached||(this.imgToLoadBackground.src=d,this.imgToLoadBackground.onload=function(e){r.mounted&&r.setState({ImageUrl:d,IsBackgroundImgCached:!0})},d+="_mo"));var f="";return f+=".office-form-theme-primary-color { color:"+c+"; }",f+=".office-form-theme-secondary-color { color:"+u+"; }",f+=".office-form-theme-primary-background { background:"+c+"; color:#FFFFFF; }",f+=".office-form-theme-secondary-background { background:"+u+"; }",f+=".office-form-theme-primary-foreground, ",f+=".office-form-theme-primary-foreground a, ",f+=".office-form-theme-primary-foreground.rateit .rateit-selected, ",f+=".office-form-theme-primary-foreground.rateit .rateit-hover",f+="{ color:"+c+"; } ",f+=".office-form-theme-border-top { border-top-color:"+c+"; }",f+=".office-form-theme-border-bottom-for-mobile { border-bottom-color:"+c+"; }",f+=".office-form-theme-border { border-color:"+c+";}",f+=".office-form-theme-interactive-background.active { background-color:"+c+"; }",f+=".office-form-theme-interactive-background:hover { background-color:"+u+"; }",f+=".office-form-theme-interactive-background:focus { background-color:"+u+"; }",f+=".office-form-theme-interactive-background:active { background-color:"+u+"; }",f+=".office-form-theme-button-lightbackground { color:"+c+"; }",f+=".office-form-theme-button-lightbackground.active { background-color:"+u+"; }",f+=".office-form-theme-interactive-color { color:"+c+"; }",f+=".office-form-theme-interactive-color:hover { color:"+u+"; }",f+=".office-form-theme-interactive-color:focus { color:"+u+"; }",f+=".office-form-theme-interactive-color:active { color:"+u+"; }",f+=".office-form-theme-button { color: white; background:"+c+"; }",f+=".office-form-theme-button:hover { background:"+u+"; }",f+=".office-form-theme-button:focus { background:"+u+"; }",f+=".office-form-dark-theme-button {color:"+u+"}",f+=".office-form-dark-theme-button:hover { color:"+u+"; }",f+=".office-form-dark-theme-button:focus { color:"+u+"; }",f+=".office-form-theme-page-background-active.active { background :"+c+"; color: #FFFFFF; }",f+=".office-form-theme-page-foreground-active.active, ",f+=".office-form-theme-select-color.active *{ color: "+c+"; }",f+=".office-form-theme-toggle.active { background: "+c+"; border-color:"+c+"; }",f+=".office-form-theme-border { border-color:"+c+"; }",f+=".office-form-theme-outline { outline-color:"+c+"; }",f+=".office-form-theme-button-foreground.active,.office-form-theme-button-foreground.touch.active:hover { color: white; background: "+c+"; outline-color:"+c+"; }",f+=".office-form-theme-button-foreground.active:hover { background: "+u+"; outline-color:"+u+"; }",f+=".office-form-theme-quiz-point { color:"+u+"; }",f+=".office-form-theme-quiz-totalPoints-bar {color:"+c+"; }",f+=".office-form-theme-image-question-background, .office-form-theme-video-question-background { background-color: "+l+"; outline: 1px solid transparent; }",f+=".office-form-theme-image-container-border { border: 3px solid "+l+"; }",f+=".office-form-sortable-chosen .office-form-sort-item { background: "+c+"; color:white; }",f+=".office-form-theme-sort-item { color: white; background:"+c+"; }",f+=".office-form-theme-sort-item:hover { background:"+u+"; }",f+=".office-form-theme-focus-border .office-form-textfield-input:focus,.office-form-theme-focus-border .form-control:focus,.office-form-theme-focus-border .select-control:focus,.office-form-theme-focus-border .picker--focused .picker__holder:focus{ border-color: "+c+"; outline-color:"+c+"; }",f+=".office-form-theme-bgcolor-hover:hover { background:"+l+"; }",f+=".office-form-theme-button-color:hover *{ color:"+u+"; }",f+=".form-intelligence-question-row.office-form-intelligence-theme-li { outline: 1px solid "+u+"; background-color:"+l+";}",f+=".form-intelligence-question-row.mobile-office-form-intelligence-theme-li { outline: 1px solid "+c+"; background-color:"+l+"; color:"+c+";}",f+=".office-form-insight-theme-control .simple-data-control-content { color : "+c+"; }",f+=".office-form-insight-theme-control .simple-data-control-description { color : "+c+"; }",f+=".office-form-insight-theme-control .simple-data-control-description:hover { color : "+u+"; }",f+=".office-form-insight-theme-control .simple-data-control-description:focus { color : "+u+"; }",f+=".office-form-insight-theme-control .simple-data-control-description:active { color : "+u+"; }",f+=".office-form-info-container .office-form-info-children.office-form-theme-spo-link { color: "+c+"; }",f+=".office-form-info-container .office-form-info-children.office-form-theme-spo-link:hover{color:"+u+"; }",f+=".office-form-spo-embed .office-form-footer-block .office-form-theme-spo-link { color: "+c+"; }",f+=".office-form-spo-embed .office-form-footer-block .office-form-theme-spo-link:hover { color: "+u+"; }",f+=".office-form-theme-spo-link { color:"+c+"; }",f+=".office-form-theme-spo-link:hover { color:"+u+"; }",s.x()||(d?(f+=".thank-you-page-content { opacity:.97; }",f+=".introduction-for-responser-container { opacity:.97; }",s.t()?(f+=".office-form-theme-page-background { background-color:"+l+"; }",f+=".office-form-theme-footer { background: rgba(255,255,255,.4); }"):(f+=".office-form-theme-page-background { background-image: url("+d+"); }",f+=".office-form-theme-footer { background: rgba(244,244,244,.8); }"),f+=".preview-mobile-container.office-form-theme-page-background { background:"+l+"; }",f+=".preview-mobile-container .office-form-theme-footer { background: rgba(255,255,255,.4); }"):(f+=".office-form-theme-footer { background : rgba(255,255,255,.4); }",f+=".office-form-theme-page-background { background-color:"+l+"; }")),d&&i!==a.a.LocalizedStrings.Customized_Theme_Name?f+=".office-form-theme-shadow { box-shadow : none; }":f+=".office-form-theme-shadow { box-shadow: 0 0 11px rgba(0,0,0,.12); }",i===a.a.LocalizedStrings.Customized_Theme_Name&&(f+=".office-form-body { opacity: 0.97; }"),o.createElement("style",null,f)},t.getSPOTheme=function(e){var t=Object(i.g)(e);return{BackgroundColor:Object(i.h)(t),BackgroundImage:null,Name:c.b,PrimaryColor:t,SecondaryColor:Object(i.i)(t),Thumbnail:null}},t}(u.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(0),o=function(){return(o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function i(e){return e.SubMenu||!e.Active?e.children:n.createElement("div",o({},e.HTMLAttributes),e.children)}},,,function(e,t,r){"use strict";r.d(t,"a",(function(){return I}));var n,o=r(3),i=r(4),a=r(1),s=r(5),c=r(86),u=r(80),l=r(26),d=r(6),f=r(7),p=r(19),m=r(8),h=r(15),g=r(236),y=r(91),b=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),v=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n},S={QuestionRuntimeMasters:a.a.collectionOf(a.a.reference()),RuntimeSectionId:a.a.string(),UploadingFileCount:a.a.number(),BranchChangeVersion:a.a.number()},I=function(e){function t(t,r){var n=e.call(this)||this;return n.questionRuntimeMasters={},n.answerChangeNotifier=new u.a.CallbackManager,n.questionAnswerChangeCallback=function(){return n.answerChangeNotifier.trigger()},n.answertagChangeCallback=function(e){return n.replaceAnswerTagsWithValue(e.Master)},n.onQuestionListChangeCallback=function(e){return n.updateQuestionList(e)},n.updateQuestionListCallback=function(){return n.updateQuestionList()},n.branchingChangeCallback=function(){return n.calculation.callOnceLater()},n.calculation=new u.a.CallLater((function(){return n.calculateQuestionRuntimeList()}),0),n.formMaster=t,Object(f.e)((function(){if(Object(d.a)().Flighting.isEnabled("FormsProBranchingV2")){var e=Object(p.b)();t&&!e.Model.FormMaster&&(e.Model.FormMaster=t)}})),n.elementManager=Object(g.a)(n),r=r||{},n.disableShuffle=r.disableShuffle,n.disableBranching=r.disableBranching,n.updateQuestionList(),n.calculation.callImmediately(),n.Model.UploadingFileCount=0,i.a.getCollectionMasterFromModel(t.Model.Questions).observe(n.onQuestionListChangeCallback),t.observe(n.updateQuestionListCallback,[m.c.Schema.HasValidBranching,m.c.Schema.Settings.ShuffleQuestionOrder]),n}return b(t,e),Object.defineProperty(t.prototype,"Form",{get:function(){return this.formMaster},enumerable:!0,configurable:!0}),t.prototype.ElementManager=function(){return this.elementManager},Object.defineProperty(t.prototype,"IsDisableBranching",{get:function(){return this.disableBranching},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Answers",{get:function(){return i.a.convertToArray(this.Model.QuestionRuntimeMasters).filter((function(e){return e.Question.hasAnswer()})).map((function(e){return e.getAnswerEntity()}))},set:function(e){var t=this,r={};o.forEach(e,(function(e){return r[e.QuestionId]=e.Answer})),this.bulkEdit((function(){t.formMaster.FormElementManager.QuestionMasters.map((function(e){return t.getOrCreateQuestionRuntime(e)})).forEach((function(e){e.Model.Answer=r[e.Question.Model.Id]}))})),this.calculation.flush()},enumerable:!0,configurable:!0}),t.prototype.TopQuestionRuntimeMasters=function(){return i.a.convertToArray(this.Model.QuestionRuntimeMasters).filter((function(e){return!e.Question.Model.GroupId}))},t.prototype.CurrentRuleManager=function(){return this.formsProRuleManager},t.prototype.isDefaultAnswer=function(){var e=this.formMaster.getDefaultResponse();return i.a.convertToArray(this.Model.QuestionRuntimeMasters).every((function(t){var r=t.Question.Model.Id;return e[r]===t.Model.Answer}))},t.prototype.updateWithResponse=function(e){var t=this,r={};e&&e.Answers&&o.forEach(e.Answers,(function(e){return r[e.QuestionId]=e})),this.bulkEdit((function(){t.formMaster.FormElementManager.QuestionMasters.map((function(e){return t.getOrCreateQuestionRuntime(e)})).forEach((function(e){var t=e.Question.Model.Id,n=r[t];e.bulkEdit((function(){e.Model.Answer=n&&n.Answer,e.Model.AnswerEntity=n}))}))})),this.updateQuestionList()},t.prototype.setQuizResults=function(e){var t=this;e.forEach((function(e){var r=t.questionRuntimeMasters[e.id];r&&(r.Model.QuizResult={IsAnswerCorrect:e.isAnswerCorrect,AnswerHints:e.answerHints,IsAnswerKeys:e.answerKeys,Choices:o.map(r.Question.Model.Choices,(function(e){return e.Description})),GradingBasis:e.gradingBasis})}))},t.prototype.clearQuizResult=function(){for(var e in this.questionRuntimeMasters)this.questionRuntimeMasters[e].Model.QuizResult=void 0},t.prototype.resetQuestions=function(){if(Object(d.a)().Flighting.isEnabled("FormsProAnswerTag"))for(var e in this.Form.Model.FormsProAnswerTagMapRT=[],this.questionRuntimeMasters)this.questionRuntimeMasters[e].Model.FormsProRuntimeTitle=void 0,this.questionRuntimeMasters[e].Model.FormsProRuntimeSubtitle=void 0,this.questionRuntimeMasters[e].Model.InitialFormsProLocalizedRuntimeTitle=void 0,this.questionRuntimeMasters[e].Model.InitialFormsProLocalizedRuntimeSubtitle=void 0},t.prototype.getQuestionResponseFromQueryString=function(){var e=s.a.getQueries().questionId,t=s.a.getQueries().answer;return s.a.getQueries().vt&&e&&t?[{Answer:t,QuestionId:e}]:null},t.prototype.calculateQuizResultFromModel=function(){i.a.convertToArray(this.Model.QuestionRuntimeMasters).forEach((function(e){return e.calculateQuizResultFromModel()}))},t.prototype.formsProQuestionVisiblityCheck=function(e){return!(!0!==e.Model.Visible&&(!Object(d.a)().Flighting.isEnabled("FormsProQuestionVisibility")||null!=e.Model.Visible||e.Question.Model.Hidden))},t.prototype.getQuestionsWithWrongAnswer=function(e){var t=this;if(Object(f.e)((function(){e=e.filter((function(e){return t.formsProQuestionVisiblityCheck(e)}))})),e.length<=0)return[];var r=this.TopQuestionRuntimeMasters();Object(f.e)((function(){r=r.filter((function(e){return t.formsProQuestionVisiblityCheck(e)}))}));var n=o.findIndex(r,(function(t){return t.Question.Model.Id===e[0].Question.Model.Id}))+1;return e.map((function(e,t){return e.verifyAnswer()?-1:t+n})).filter((function(e){return e>0}))},t.prototype.getOrCreateQuestionRuntimeById=function(e){var t=this.formMaster.getQuestionById(e);return t&&this.getOrCreateQuestionRuntime(t)},t.prototype.observeAnswerChange=function(e){this.answerChangeNotifier.register(e)},t.prototype.unobserveAnswerChange=function(e){this.answerChangeNotifier.unregister(e)},t.prototype.release=function(){var e=this;for(var t in this.questionRuntimeMasters){var r=this.questionRuntimeMasters[t];r.unobserve(this.branchingChangeCallback),r.unobserve(this.questionAnswerChangeCallback),Object(f.e)((function(){r.unobserve(e.answertagChangeCallback)})),r.release()}i.a.getCollectionMasterFromModel(this.formMaster.Model.Questions).unobserve(this.onQuestionListChangeCallback),this.formMaster.unobserve(this.updateQuestionListCallback),this.clearOD4BTempFolder()},t.prototype.createOD4BTempFolder=function(){return this.od4bTempFolder||(this.od4bTempFolder=Object(l.b)().createOD4BSessionTempFolder(this.formMaster.Model.Id)),this.od4bTempFolder},t.prototype.clearOD4BTempFolder=function(){this.od4bTempFolder=null},t.prototype.getOrCreateQuestionRuntime=function(e){var t=e.Model.Id;return this.questionRuntimeMasters[t]||(this.questionRuntimeMasters[t]=this.createQuestionRuntimeMaster(e)),this.questionRuntimeMasters[t]},t.prototype.createQuestionRuntimeMaster=function(e){var t=this,r=new y.a(e,this);return r.observe(this.branchingChangeCallback,[y.a.Schema.BranchedElement,y.a.Schema.BranchingType]),r.observe(this.questionAnswerChangeCallback,[y.a.Schema.Answer]),Object(f.e)((function(){r.observe(t.answertagChangeCallback,[y.a.Schema.Answer])})),r},t.prototype.updateQuestionList=function(e){var t,r=this,n=this.formMaster.Model.Settings,i=this.formMaster.FormElementManager;this.questionMasters=i.TopQuestionMasters;var a=this.Form.hasSection();if(!a&&!this.disableShuffle&&!this.formMaster.Model.HasValidBranching&&n.ShuffleQuestionOrder)if(n.ShuffleAllQuestions||null==n.ShuffleAllQuestions)this.questionMasters=o.shuffle(this.questionMasters);else if(c.a.isInteger(n.LockGivenQuestionsStartDisplayOrder)&&c.a.isInteger(n.LockGivenQuestionsEndDisplayOrder)){var s=n.LockGivenQuestionsStartDisplayOrder-1,u=n.LockGivenQuestionsEndDisplayOrder-1,l=this.questionMasters.splice(s,u-s+1);this.questionMasters=o.shuffle(this.questionMasters),(t=this.questionMasters).splice.apply(t,v([s,0],l))}a?i.getSectionNodes().forEach((function(e){return r.buildQuestionRuntimeChain(e.TopQuestionMasters)})):this.buildQuestionRuntimeChain(this.questionMasters),e&&(e.AddedModels.length||e.RemovedModels.length)&&this.calculation.callOnceLater()},t.prototype.buildQuestionRuntimeChain=function(e){var t=this;e.forEach((function(r,n){t.getOrCreateQuestionRuntime(r).bulkEdit((function(t){t.NextQuestionInOrder=e[n+1],t.NextQuestionInitialized=!0})),r.SubQuestionMasters.forEach((function(e){return t.getOrCreateQuestionRuntime(e)}))}))},t.prototype.ensureProRuleManager=function(){var e=this,t=Object(p.b)(),r=this.formMaster;return this.formsProRuleManager?$.Deferred().resolve("").promise():t.getFormsProBranching(r).done((function(){e.formsProRuleManager=FormsPro.getRuleManager(e.formMaster,e.Model.QuestionRuntimeMasters,e)}))},t.prototype.updateRuntimeLabel=function(e,t,r){if(null!=e){var n=i.a.convertToArray(this.Form.Model.FormsProAnswerTagMapRT),o=e.match(/\[\[(.*?)\]\]/g);null!=o&&o.length>0&&o.forEach((function(o){if(""!=o){var i=n.filter((function(e){return e.name==o}))[0];null!=i&&(""!=i.value&&null!=i.value||(i.value=i.name),null!=e&&(t[r]=e.replaceAll(o,i.value),e=t[r]))}}))}else t[r]=e},t.prototype.calculateQuestionRuntimeList=function(){this.elementManager.calculateQuestionRuntimeList(this.questionMasters)},t.prototype.replaceAnswerTagsWithValue=function(e){var t=this;if(Object(d.a)().Flighting.isEnabled("FormsProAnswerTag")&&e&&e.Question&&e.Question.Model.FormsProEnableAnswerTag&&""!=e.Question.Model.FormsProAnswerTag&&null!=e.Question.Model.FormsProAnswerTag){var r=i.a.convertToArray(this.Form.Model.FormsProAnswerTagMapRT),n=e.Question.Model.FormsProAnswerTag;n="[["+n+"]]";var o=null!=e.Model.Answer&&s.a.encodeHTML(e.Model.Answer.toString());null!=e.Model.SelectedChoice&&""!=e.Model.SelectedChoice&&(o=e.Model.SelectedChoice);var a=r.filter((function(e){return e.name==n}))[0];a?a.value=o:r.push({name:n,value:o}),this.Form.Model.FormsProAnswerTagMapRT=r,i.a.convertToArray(this.Model.QuestionRuntimeMasters).forEach((function(e){var r=null!=e.Question.Model.FormsProRTQuestionTitle?JSON.parse(JSON.stringify(e.Question.Model.FormsProRTQuestionTitle)):JSON.parse(JSON.stringify(e.Question.Model.Title)),n=null!=e.Question.Model.FormsProRTSubtitle?JSON.parse(JSON.stringify(e.Question.Model.FormsProRTSubtitle)):JSON.parse(JSON.stringify(e.Question.Model.Subtitle));null!=e.Model.InitialFormsProLocalizedRuntimeTitle&&(r=JSON.parse(JSON.stringify(e.Model.InitialFormsProLocalizedRuntimeTitle))),null!=e.Model.InitialFormsProLocalizedRuntimeSubtitle&&(n=JSON.parse(JSON.stringify(e.Model.InitialFormsProLocalizedRuntimeSubtitle))),t.updateRuntimeLabel(r,e.Model,"FormsProRuntimeTitle"),null!=e.Model.InitialFormsProLocalizedRuntimeSubtitle&&(n=JSON.parse(JSON.stringify(e.Model.InitialFormsProLocalizedRuntimeSubtitle))),t.updateRuntimeLabel(n,e.Model,"FormsProRuntimeSubtitle")}))}},t.prototype.clearFileUploadAnswers=function(){this.Model.UploadingFileCount=0;var e=this.Model.QuestionRuntimeMasters;i.a.convertToArray(e).filter((function(e){return e.Question.Model.Type===h.a.FileUpload})).forEach((function(e){return e.Model.Answer=void 0}))},t}(i.a.createObjectMasterClass("FormRuntime",S))},function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n,o=r(2),i=r(52),a=r(10),s=r(15),c=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.getElementTypeName=function(){return s.a.DateTime},t.createDefaultDefinition=function(){return{Type:t.getElementTypeName(),Title:o.a.LocalizedStrings.Question_DefaultTitle,Date:!0,Time:!1,QuestionTagForIntelligence:"Unknown",IsFromSuggestion:!1}},t.supportMobileDesign=function(e){return!t.hasInvalidSettingOnMobile(e)},t.prototype.verify=function(e){return this.Model.Required&&!e?a.e.RequiredError:a.e.Success},t.prototype.getTypeDisplayName=function(){return o.a.LocalizedStrings.QuestionType_DateTime},t}(i.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){function e(){}return e.mathSeparator="",e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(48),o=r(11),i=r(2);function a(e){var t=i.a.LocalizedStrings,r="";if(e)if(e.correlationId){var a=e;a.innerCode&&(r=t["Error_Message_"+a.innerCode]||i.a.LocalizedStrings.Error_Message_Default.format(a.innerCode))}else{switch(e.name){case n.a.LoginIECrossZoneError:r=i.a.LocalizedStrings.Error_Message_Client_LoginIECrossZoneError.format(window.location.origin,o.a.getAadInstance());break;case n.a.ThirdPartyCookieBlockedError:r=i.a.LocalizedStrings.Error_Message_Client_ThirdPartyCookieError.format(o.a.getAadInstance());break;case n.a.AuthNoStorageError:r=i.a.LocalizedStrings.Error_Message_Client_AuthNoStorageError;break;case n.a.AADAcquireTokenMfaCheckError:r=i.a.LocalizedStrings.Error_Message_705;break;case n.a.TeamSiteNoGroupError:r=i.a.LocalizedStrings.Error_Message_Client_TeamSiteNoGroupError}}return r}},function(e,t,r){"use strict";r.d(t,"a",(function(){return F}));var n=r(3),o=r(11),i=r(24),a=r(54),s=r(35),c=r(36),u=r(27),l=r(5),d=r(28),f=r(13),p=r(19),m=r(6),h=r(7),g=r(56),y=r(9),b=r(40),v=r(16),S=r(46),I=r(32),M=function(){return(M=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},F=function(){function e(e,t){this.aadLauncherSesstionStorageKey="aadFormLauncher",this.msaLauncherSesstionStorageKey="msaFormLauncher",this.serviceUrl=e,this.ownerServiceUrl=t,this.partialUpdateHttpMethod=Object(m.a)().Flighting.isEnabled_Deprecated("PartialPut")?"PUT":"PATCH"}return Object.defineProperty(e,"AnalysisFormEntityCollectionName",{get:function(){return"analysisForms"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"FormEntityCollectionName",{get:function(){return"forms"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"RuntimeFormEntityCollectionName",{get:function(){return"runtimeForms"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ResponseDetailRuntimeFormEntityCollectionName",{get:function(){return"responseDetailRuntimeForms"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"QuestionEntityCollectionName",{get:function(){return"questions"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"DescriptiveElementEntityCollectionName",{get:function(){return"descriptiveQuestions"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ChoiceEntityCollectionName",{get:function(){return"choices"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ResponseEntityCollectionName",{get:function(){return"responses"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"RuntimeResponseEntityCollectionName",{get:function(){return"runtimeresponses"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CommentEntityCollectionName",{get:function(){return"comments"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"GetSharedForm",{get:function(){return"GetSharedForm"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"GetCachedForms",{get:function(){return"memorybasedforms"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"PermissionEntityCollectionName",{get:function(){return"permissions"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"PermissionTokenEntityCollectionName",{get:function(){return"permissionTokens"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"SharedWithMeFormEntityCollectionName",{get:function(){return"sharedWithMeForms"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"GetAggregateQuizDataFunctionName",{get:function(){return"GetAggregateQuizData"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"GetAggregateSurveyDataFunctionName",{get:function(){return"GetAggregateSurveyData"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"GetOrCreatePermissionTokenFunctionName",{get:function(){return"Microsoft.FormServices.GetOrCreatePermissionToken"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CreateOneDriveSessionTempFolderFunctionName",{get:function(){return"Microsoft.FormServices.CreateOneDriveSessionTempFolder"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"MoveFormFunctionName",{get:function(){return"MoveForm"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"LocaleResourceEntityCollectionName",{get:function(){return"localeResource"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"InviteEntityCollectionName",{get:function(){return"invites"},enumerable:!0,configurable:!0}),e.addDefaultHeader=function(t,r){null===e.customizedHeaders&&(e.customizedHeaders={}),e.customizedHeaders[t]=r},e.prototype.getForms=function(t,r){var n=this.getSurveyWebOwnerServiceUrl()+"light/";return n+=e.FormEntityCollectionName+e.getQueryParameters("?",t,r),this.sendRequest({requestUri:n,qosEventName:"Forms.Get"})},e.prototype.getFormsSharedWithCurrentUser=function(){var t=this.getSurveyWebOwnerServiceUrl()+e.SharedWithMeFormEntityCollectionName;return this.sendRequest({requestUri:t,qosEventName:"Forms.Get.SharedWithMe"})},e.prototype.getFormId=function(e,t,r){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"GetFormId(tenantid='{0}',userid='{1}',tableid='{2}')".format(e,t,r),method:"GET",qosEventName:"Function.GetFormId"})},e.prototype.getCachedSimpleForms=function(t,r){var n=""+this.serviceUrl+t+"/users/"+r+"/"+e.GetCachedForms;return this.sendRequest({requestUri:n,qosEventName:"Forms.GetCachedSimpleForms"})},e.prototype.getDesignForm=function(t,r){var n=this.getSurveyWebOwnerServiceUrl()+"light/";return n+=e.FormEntityCollectionName+"('"+t+"')",n+=e.getQueryParameters("?",r),this.sendRequest({requestUri:n,qosEventName:"DesignForm.Get"})},e.prototype.getRuntimeForm=function(t,r){var n=this.getSurveyWebOwnerServiceUrl()+"light/"+e.RuntimeFormEntityCollectionName+"('"+t+"')";return n+=e.getQueryParameters("?",r),this.sendRequest({requestUri:n,qosEventName:"ResponseForm.Get"})},e.prototype.getResponseDetailRuntimeForm=function(t,r){var n=l.a.getQueries();if(n.GetResponseToken&&n.rid){var o={GetResponseToken:n.GetResponseToken},i=this.getSurveyWebOwnerServiceUrl()+"light/"+e.ResponseDetailRuntimeFormEntityCollectionName+"('"+t+"')/"+n.rid;return i+=e.getQueryParameters("?",r),this.sendRequest({requestUri:i,qosEventName:"QosEvent.ServiceEndpoints.Form.GetResponseDetailRuntimeForm",headers:o})}return $.Deferred().resolve(null).promise()},e.prototype.getAnalysisTimeForm=function(t){var r="$expand="+e.QuestionEntityCollectionName+"($expand="+e.ChoiceEntityCollectionName+")",n=this.getSurveyWebOwnerServiceUrl()+"light/"+e.AnalysisFormEntityCollectionName+"('"+t+"')?"+r;return this.sendRequest({requestUri:n,method:"GET",qosEventName:"AnalysisForm.Get"})},e.prototype.getSharedForm=function(t){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+e.GetSharedForm+"(formid='"+t+"',token='"+l.a.getQueries().sharetoken+"')",method:"GET",headers:{"Content-Type":"application/json;odata.metadata=minimal"},body:'{"value" : "'+l.a.getQueries().sharetoken+'"}',qosEventName:"SharedForm.Get"})},e.prototype.createOD4BSessionTempFolder=function(t){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+e.RuntimeFormEntityCollectionName+"('"+t+"')/"+e.CreateOneDriveSessionTempFolderFunctionName,method:"POST",qosEventName:"Form.CreateOD4BSessionTempFolder"}).then((function(e){return e?e.itemId:$.Deferred().reject(new Error("Failed to create OneDriveForBusiness session temp folder.")).promise()}))},e.prototype.changeSharingStatus=function(e,t){var r=t?"On":"Off";return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"/forms('"+e+"')/Microsoft.FormServices.Turn"+r+"AllowCopySetting",method:"POST",qosEventName:t?"FormDefinition.TurnOnFormSharing":"FormDefinition.TurnOffFormSharing"})},e.prototype.createPermissionLink=function(t,r){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+e.FormEntityCollectionName+"('"+t+"')/"+e.PermissionEntityCollectionName,method:"POST",data:r,qosEventName:"FormDefinition.CreateFormPermissionLink"})},e.prototype.deletePermissionLink=function(t,r){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+e.FormEntityCollectionName+"('"+t+"')/"+e.PermissionEntityCollectionName+"('"+r+"')",method:"DELETE",qosEventName:"FormDefinition.DeleteFormPermissionLink"})},e.prototype.getFormPermissions=function(t){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+e.FormEntityCollectionName+"('"+t+"')/"+e.PermissionEntityCollectionName,method:"GET",qosEventName:"FormDefinition.GetFormPermissions"})},e.prototype.createPermissionToken=function(t,r){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+e.FormEntityCollectionName+"('"+t+"')/"+e.PermissionTokenEntityCollectionName,method:"POST",data:r,qosEventName:"FormDefinition.CreateFormPermissionToken"})},e.prototype.getOrCreateFormPermissionToken=function(t,r,n){var o={};return i.a.IsTeamsIntegration&&(o["x-ms-form-request-source"]="ms-teams"),this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+e.FormEntityCollectionName+"('"+t+"')/"+e.GetOrCreatePermissionTokenFunctionName,method:"POST",headers:o,data:{type:r,name:n},qosEventName:"Form.GetOrCreatePermissionToken"})},e.prototype.deletePermissionToken=function(t,r){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+e.FormEntityCollectionName+"('"+t+"')/"+e.PermissionTokenEntityCollectionName+"('"+r+"')",method:"DELETE",qosEventName:"FormDefinition.DeleteFormPermissionToken"})},e.prototype.getFormPermissionsTokens=function(t){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+e.FormEntityCollectionName+"('"+t+"')/"+e.PermissionTokenEntityCollectionName,method:"GET",qosEventName:"FormDefinition.GetFormPermissionsToken"})},e.prototype.getIdentityProviderType=function(e){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"authinfo/idptype?username="+encodeURIComponent(e),method:"GET",qosEventName:"Form.GetIdentityProviderType"}).then((function(e){return e.ProviderType}))},e.prototype.createForm=function(t){var r={__TimezoneOffset:(new Date).getTimezoneOffset().toString()};return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+e.FormEntityCollectionName,method:"POST",data:t,headers:r,qosEventName:"Form.Create",qosExtraData:{FormType:this.getFormType(t)}})},e.prototype.updateForm=function(t,r){var n=this;return Object(h.e)((function(){var e=u.a.newGuid(),t=new Error;if(Object(y.c)({type:"MFPUI_PatchFormIsNull",eventInfo:{tenantId:OfficeFormServerInfo.userInfo.TenantId,requestId:e,Component:"FormUpdate",sessionId:Object(b.d)(),mfpStack:t.stack,formObject:r}}),!r.ownerUserType&&n.shouldFetchUserType()){var o=Object(p.b)();$.when(S.a.getUserType()).done((function(e){e&&o.Model.FormMaster.Model.OwnerUserType!==e.toString()&&(r.ownerUserType=e.toString(),o.bulkEdit((function(t){t.FormMaster.Model.OwnerUserType=e.toString()})))})).fail((function(){n.logUserTypeEvent()}))}})),this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+e.FormEntityCollectionName+"('"+t+"')",method:this.partialUpdateHttpMethod,data:r,qosEventName:"Form.Update",qosExtraData:{SoftDeleted:r.softDeleted}})},e.prototype.postFormShareAction=function(t){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"light/"+e.FormEntityCollectionName+"('"+t+"')/shareaction",method:"POST",qosEventName:"Form.PostShareAction"})},e.prototype.createFormImageFromUrl=function(t,r,n){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+e.FormEntityCollectionName+"('"+t+"')/"+r,method:"POST",data:n,qosEventName:"logo"===r?"FormImage.CreateFromUrl":"ThemeImage.CreateFromUrl",qosExtraData:{FormProperty:r}})},e.prototype.deleteForm=function(t,r,n){void 0===r&&(r=""),void 0===n&&(n="");var o=Object(h.c)((function(){}),(function(){return{BusinessCdsId:r,BusinessCdsRegion:n}}));return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+e.FormEntityCollectionName+"('"+t+"')",method:"DELETE",data:o,qosEventName:"Form.Delete"})},e.prototype.dupFormForExcel=function(t,r){var n={id:t,xlWorkbookId:r};return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+e.FormEntityCollectionName,method:"POST",data:n,qosEventName:"Excel.DuplicateFormForExcel"})},e.prototype.moveForm=function(t,r,n){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"light/"+e.FormEntityCollectionName+"('"+t+"')/"+e.MoveFormFunctionName,method:"POST",data:{newOwnerId:r,isNewOwnerGroup:n},qosEventName:"Function.MoveForm",qosExtraData:{FormId:t,NewOwnerId:r,IsNewOwnerGroup:n,IsDelegateMode:i.a.isDelegateMode()}})},e.prototype.postRecentForm=function(e,t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"recent/forms/"+e,data:t,method:"POST",qosEventName:"Function.PostRecentForm"})},e.prototype.getRecentForms=function(e){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"recent/forms"+(null==e?"":"?ownerType="+encodeURIComponent(e)),method:"GET",qosEventName:"Function.GetRecentForms"})},e.prototype.removeRecentForm=function(e){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"recent/forms/"+e,method:"DELETE",qosEventName:"Function.RemoveRecentForm"})},e.prototype.updateExperienceType=function(e,t,r){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+e+"/users/"+t+"/experiencetype/"+r+"/UpdateExperienceType",method:"POST",qosEventName:"Function.UpdateExperienceType"})},e.prototype.updateLastUsedEnv=function(e,t,r){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+e+"/users/"+t+"/UpdateLastUsedEnv",data:r,method:"POST",qosEventName:"Function.UpdateLastUsedEnv"})},e.prototype.updateFormsProLicense=function(e,t){var r="";e||(r="FORMS_PRO");var n="";return n="UpdateFormsProUserLicenses(licenseNames='{0}',isOptOutAction={1})".format(r,t?"true":"false"),this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+n,method:"DELETE",qosEventName:"Function.UpdateFormsProLicense"})},e.prototype.updateRecentForm=function(e,t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"recent/forms/"+e+"?title="+encodeURIComponent(t),method:"PUT",qosEventName:"Function.UpdateRecentForm"})},e.prototype.getFormsTenantSettings=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"GetFormsTenantSettings",method:"GET",qosEventName:"Function.GetFormsTenantSettings"})},e.prototype.getFormCreatorPhotoDefinition=function(e){return this.sendRequestWithToken({requestUri:this.getSurveyWebServiceUrl()+"light/GetFormCreatorDefinition('"+e+"','')",method:"GET",qosEventName:"Function.GetFormCreatorPhotoDefinition"})},e.prototype.getFormCreatorPhotoValue=function(e){return this.sendRequestWithToken({blobResponseType:!0,requestUri:this.getSurveyWebServiceUrl()+"light/GetFormCreatorPhotoValue('"+e+"','')/$value",method:"GET",qosEventName:"Function.GetFormCreatorPhotoValue"})},e.prototype.getCurrentUserPhotoValue=function(){return this.sendRequestWithToken({blobResponseType:!0,requestUri:this.getSurveyWebServiceUrl()+"GetCurrentUserPhotoValue",method:"GET",qosEventName:"Function.GetCurrentUserPhotoValue"})},e.prototype.getPrivacySettings=function(e,t){var r={};return e&&(r.ownerTenantId=e),t&&(r.currentUserTenantId=t),this.sendRequest({method:"GET",requestUri:this.getSurveyWebServiceUrl()+"privacy?"+$.param(r),qosEventName:"Function.GetPrivacy"})},e.prototype.getDataClassificationLabels=function(){return this.sendRequest({method:"GET",requestUri:this.getSurveyWebServiceUrl()+"/GetDataClassificationLabels",qosEventName:"Function.GetDataClassificationLabels"})},e.prototype.getDataClassificationLabelDetail=function(e,t){return this.sendRequestWithoutToken({method:"GET",requestUri:this.getSurveyWebServiceUrl()+"/dataClassificationLabelInfo/"+e+"/"+encodeURIComponent(t),qosEventName:"Function.GetDataClassificationLabelDetails"})},e.prototype.getFormQuestion=function(t,r,n){var o=this.getSurveyWebOwnerServiceUrl()+e.FormEntityCollectionName+"('"+t+"')/"+e.QuestionEntityCollectionName+"('"+r+"')";return n&&(o=o+"?$select="+n.toString()),this.sendRequest({requestUri:o,qosEventName:"Question.Get"})},e.prototype.getFormQuestionCount=function(t){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+e.FormEntityCollectionName+"('"+t+"')/"+e.QuestionEntityCollectionName+"/$count",qosEventName:"QuestionCount.Get"})},e.prototype.createFormQuestion=function(t,r,n,o){var i=this,a=M({IsQuiz:r.isQuiz,QuestionId:r.id,QuestionType:r.type},n),s={requestUri:this.getSurveyWebOwnerServiceUrl()+e.FormEntityCollectionName+"('"+t+"')/"+e.QuestionEntityCollectionName,method:"POST",data:r,qosEventName:"Question.Create",qosExtraData:a};return Object(h.e)((function(){i.callUpdateForm(t)})),o?this.sendRequestWithToken(s,{},o):this.sendRequest(s)},e.prototype.createQuestionImageFromUrl=function(t,r,n){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+e.FormEntityCollectionName+"('"+t+"')/"+e.QuestionEntityCollectionName+"('"+r+"')/image",method:"POST",data:n,qosEventName:"QuestionImage.CreateFromUrl",qosExtraData:{QuestionId:r}})},e.prototype.updateFormQuestion=function(t,r,n,o,i){var a=this,s=this.getSurveyWebOwnerServiceUrl()+e.FormEntityCollectionName+"('"+t+"')/"+e.QuestionEntityCollectionName+"('"+r+"')",c=M({QuestionType:n},i);return Object(h.e)((function(){a.callUpdateForm(t)})),this.sendRequest({requestUri:s,method:this.partialUpdateHttpMethod,data:o,qosEventName:"Question.Update",qosExtraData:c},{disableLog:!0})},e.prototype.deleteFormQuestion=function(t,r,n,o){var i=this,a=M({QuestionType:n,QuestionId:r},o);return Object(h.e)((function(){i.callUpdateForm(t)})),this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+e.FormEntityCollectionName+"('"+t+"')/"+e.QuestionEntityCollectionName+"('"+r+"')",method:"DELETE",qosEventName:"Question.Delete",qosExtraData:a})},e.prototype.callUpdateForm=function(e){var t=this;if(e&&this.shouldFetchUserType()){var r=Object(p.b)();$.when(S.a.getUserType()).done((function(n){if(n&&r.Model.FormMaster.Model.OwnerUserType!==n.toString()){var o={};o.ownerUserType=n.toString(),r.bulkEdit((function(e){e.FormMaster.Model.OwnerUserType=n.toString()})),t.updateForm(e,o)}})).fail((function(){t.logUserTypeEvent()}))}},e.prototype.shouldFetchUserType=function(){if(Object(m.a)().Flighting.isEnabled("OwnerInfoOnResponsePage")){var e=Object(p.b)();if(e&&e.Model.FormMaster&&e.Model.FormMaster.Model.OwnerId===OfficeFormServerInfo.userInfo.UserId)return!0}return!1},e.prototype.logUserTypeEvent=function(){Object(y.c)({eventInfo:{Component:"FormAPI_fetchOwnerUserType",message:"Failed to fetch user type",pageName:"DesignPage",tenantId:OfficeFormServerInfo.userInfo.TenantId,userId:OfficeFormServerInfo.userInfo.UserId},type:"MFPUI_UserTypeFetchFailed"})},e.prototype.createUploadSession=function(t,r,n){var o=this.getSurveyWebOwnerServiceUrl()+e.RuntimeFormEntityCollectionName+"('"+t+"')/"+e.QuestionEntityCollectionName+"('"+r+"')/CreateUploadSession";return this.sendRequest({requestUri:o,method:"POST",data:{value:n},qosEventName:"Question.CreateUploadSession"})},e.prototype.cancelOrDeleteUploadFile=function(e){return this.sendRequest({method:"DELETE",qosEventName:"FileUpload.CancelOrDeleteUploadFile",requestUri:e})},e.prototype.getFormDescriptiveElement=function(t,r,n){var o=this.getSurveyWebOwnerServiceUrl()+e.FormEntityCollectionName+"('"+t+"')/"+e.DescriptiveElementEntityCollectionName+"('"+r+"')";return n&&(o=o+"?$select="+n.toString()),this.sendRequest({requestUri:o,qosEventName:"DescriptiveElement.Get"})},e.prototype.createFormDescriptiveElement=function(t,r,n){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+e.FormEntityCollectionName+"('"+t+"')/"+e.DescriptiveElementEntityCollectionName,method:"POST",data:r,qosEventName:"DescriptiveElement.Create",qosExtraData:M({QuestionId:r.id,QuestionType:r.type},n)})},e.prototype.updateFormDescriptiveElement=function(t,r,n,o,i){var a=this.getSurveyWebOwnerServiceUrl()+e.FormEntityCollectionName+"('"+t+"')/"+e.DescriptiveElementEntityCollectionName+"('"+r+"')";return this.sendRequest({requestUri:a,method:this.partialUpdateHttpMethod,data:o,qosEventName:"DescriptiveElements.Update",qosExtraData:M({QuestionType:n},i)},{disableLog:!0})},e.prototype.deleteFormDescriptiveElement=function(t,r,n,o){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+e.FormEntityCollectionName+"('"+t+"')/"+e.DescriptiveElementEntityCollectionName+"('"+r+"')",method:"DELETE",qosEventName:"DescriptiveElement.Delete",qosExtraData:M({QuestionType:n},o)})},e.prototype.createQuestionChoice=function(t,r,n){var o=this.getSurveyWebOwnerServiceUrl()+e.FormEntityCollectionName+"('"+t+"')/"+e.QuestionEntityCollectionName+"('"+r+"')/"+e.ChoiceEntityCollectionName;return this.sendRequest({requestUri:o,method:"POST",data:n,qosEventName:"Choice.Create"})},e.prototype.getQuestionChoice=function(t,r,n){var o=this.getSurveyWebOwnerServiceUrl()+e.FormEntityCollectionName+"('"+t+"')/"+e.QuestionEntityCollectionName+"('"+r+"')/"+e.ChoiceEntityCollectionName+"("+n+")";return this.sendRequest({requestUri:o,method:"GET",qosEventName:"Choice.Get"})},e.prototype.updateQuestionChoice=function(t,r,n,o){var i=this.getSurveyWebOwnerServiceUrl()+e.FormEntityCollectionName+"('"+t+"')/"+e.QuestionEntityCollectionName+"('"+r+"')/"+e.ChoiceEntityCollectionName+"("+n+")";return this.sendRequest({requestUri:i,method:this.partialUpdateHttpMethod,data:o,qosEventName:"Choice.Update"})},e.prototype.deleteQuestionChoice=function(t,r,n){var o=this.getSurveyWebOwnerServiceUrl()+e.FormEntityCollectionName+"('"+t+"')/"+e.QuestionEntityCollectionName+"('"+r+"')/"+e.ChoiceEntityCollectionName+"("+n+")";return this.sendRequest({requestUri:o,method:"DELETE",qosEventName:"Choice.Delete"})},e.prototype.getFormResponses=function(t,r,o,i){var a=["$expand="+e.CommentEntityCollectionName];r&&a.push("$filter={0}+{1}+{2}".format(r.name,r.operator,r.value)),o>=0&&i>=0&&a.push("$top={0}&$skip={1}".format(o,i));var s=a.filter((function(e){return!!e})).join("&");s=s&&"?"+s;var c=this.getSurveyWebOwnerServiceUrl()+"light/";return this.sendRequest({requestUri:c+e.FormEntityCollectionName+"('"+t+"')/"+e.ResponseEntityCollectionName+s,qosEventName:n.any(a,(function(e){return-1===e.indexOf("$filter")}))?"Responses.Get":"Responses.Get.Filter"})},e.prototype.getRuntimeResponses=function(t,r){var n="?$expand="+e.CommentEntityCollectionName,o=r?"&$filter=responder+eq+'"+encodeURIComponent(r.replace(/\'/g,"''"))+"'":"",i=this.getSurveyWebOwnerServiceUrl();return this.sendRequest({requestUri:i+e.FormEntityCollectionName+"('"+t+"')/"+e.RuntimeResponseEntityCollectionName+n+o,qosEventName:"RuntimeResponses.Get"})},e.prototype.getRuntimeResponse=function(t,r){var n="?$expand="+e.CommentEntityCollectionName,o=l.a.getQueries(),i={};return o.GetResponseToken&&(i={GetResponseToken:o.GetResponseToken}),this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"light/"+e.FormEntityCollectionName+"('"+t+"')/"+e.RuntimeResponseEntityCollectionName+"("+r+")"+n,qosEventName:"RuntimeResponse.Get",headers:i})},e.prototype.getAnalysisTimeResponses=function(t,r,n){var o="?$expand="+e.CommentEntityCollectionName,i=this.getSurveyWebOwnerServiceUrl()+e.AnalysisFormEntityCollectionName+"('"+t+"')/"+e.ResponseEntityCollectionName+o;return r>=0&&n>=0&&(i+="&$top={0}&$skip={1}".format(r,n)),this.sendRequest({requestUri:i,method:"GET",qosEventName:"AnalysisTimeResponses.Get"})},e.prototype.getFormsResponseCount=function(){return this.sendRequestWithToken({requestUri:this.getSurveyWebServiceUrl()+"light/GetRespCounts()",method:"GET",qosEventName:"Function.GetFormsResponseCount"})},e.prototype.getFormResponseCount=function(t){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+e.FormEntityCollectionName+"('"+t+"')/"+e.ResponseEntityCollectionName+"/$count",qosEventName:"ResponseCount.Get"},{disableLog:!0})},e.prototype.submitFormResponse=function(t,r){var n=Object(c.a)(t),i="AAD";return null==n.OrgId?i="Unknown":n.OrgId.toLowerCase()===o.a.getMsaTenantId()&&(i="MSA"),this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+e.FormEntityCollectionName+"('"+t+"')/"+e.ResponseEntityCollectionName,method:"POST",data:r,qosEventName:"Response.Submit",qosExtraData:{OwnerSource:i}})},e.prototype.deleteFormResponses=function(t){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+e.FormEntityCollectionName+"('"+t+"')/"+e.ResponseEntityCollectionName,method:"DELETE",qosEventName:"Responses.Delete"})},e.prototype.deleteFormResponse=function(t,r){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+e.FormEntityCollectionName+"('"+t+"')/"+e.ResponseEntityCollectionName+"("+r+")/",method:"DELETE",qosEventName:"Response.Delete"})},e.prototype.deleteFormInvites=function(t,r){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"light/"+e.FormEntityCollectionName+"('"+t+"')/"+e.InviteEntityCollectionName,method:"DELETE",data:r,qosEventName:"Invites.Delete"})},e.prototype.addFormResponseComment=function(t,r,n){var o={feedback:n.feedback,score:n.score,questionId:n.questionId};return n.id&&(o.id=n.id),this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+e.FormEntityCollectionName+"('"+t+"')/"+e.ResponseEntityCollectionName+"("+r+")/"+e.CommentEntityCollectionName,method:"POST",data:o,qosEventName:"Comment.Add"})},e.prototype.setResponseReleaseDate=function(t,r,n){var o={releaseDate:n};return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+e.FormEntityCollectionName+"('"+t+"')/"+e.ResponseEntityCollectionName+"("+r+")",method:this.partialUpdateHttpMethod,data:o,qosEventName:"Response.Update"})},e.prototype.createExportFile=function(t){var r=this;return this.getToken().then((function(n){var o,i=r.createHiddenIFrame("cdb-export-iframe");if((o=document.createElement("form")).style.display="none",o.method="POST",o.action=r.getSurveyWebServiceUrl()+e.FormEntityCollectionName+"('"+t+"')/Microsoft.FormServices.CreateExportFile",o.target="cdb-export-iframe",null!==n){var a=document.createElement("input");a.type="hidden",a.name="Authorization",a.value="Bearer "+n,o.appendChild(a)}if(null!==OfficeFormServerInfo.antiForgeryToken){var s=document.createElement("input");s.type="hidden",s.name="__RequestVerificationToken",s.value=OfficeFormServerInfo.antiForgeryToken,o.appendChild(s)}document.body.appendChild(i),$(i).ready((function(){i.contentDocument.body.appendChild(o)})),o.submit()}))},e.prototype.downloadExcelFile=function(e,t,r){var i=this;return this.getToken().then((function(a){var s=new g.a("Function.DownloadExcelFileApi");s.start();var c=$.Deferred(),u=i.createHiddenIFrame("download-excel-iframe");return document.body.appendChild(u),$(u).ready((function(){var l="downloadCookie"+(new Date).getTime(),d=i.getDownloadExcelRequestUrlParameters(e,t,r,l,s.CorrelationId,a),p=i.getDownloadExcelRequestUrl(d),h={sourceUrl:p,innerCode:v.b.DownloadExcelFileFailed,innerMessage:void 0},g=24,y=function(){if("success"===Object(f.i)(l))return s.end({resultType:"Success"}),window.clearInterval(b),Object(f.c)(l),void c.resolve();if(g--<0){u.onload=null,window.clearInterval(b);var e=n.clone(h);if(!o.a.isOsi())return s.end({resultType:"Success"}),void c.resolve();e.innerMessage="TimeOut",e.innerCode=v.b.DownloadExcelFileTimeout,s.end({resultType:"Failure",extraData:{ServiceError:e}}),c.reject({innerCode:v.b.DownloadExcelFileTimeout,innerMessage:e.innerMessage})}},b=window.setInterval(y,5e3),S=3,I=function(){g=24,b=window.setInterval(y,5e3),u.contentWindow.location.href=p};$(u).on("load",(function(){var e="";if(Object(m.a)().Flighting.isEnabled_Deprecated("LogDownloadExcelErrorMessage"))try{e=u.contentDocument.body.innerText}catch(t){e="Cross-origin so doesn't get the error message."}if(window.clearInterval(b),S>0)S--,i.downloadExcelCheckAndHandleAuthFailure(e,I);else{var t=n.clone(h);t.innerMessage="Error",s.end({resultType:"Failure",extraData:{ServiceError:t,errorMessage:e}}),c.reject({innerCode:v.b.DownloadExcelFileFailed,innerMessage:t.innerMessage})}})),u.contentWindow.location.href=p})),c.promise()}))},e.prototype.getShellServiceInfo=function(e){var t,r=this,n=s.a.SessionStorage;return(t=n.getItem(this.aadLauncherSesstionStorageKey))?$.Deferred().resolve(JSON.parse(t)).promise():this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"GetShellServiceInfo(culture='{0}')".format(e),method:"GET",qosEventName:"Function.GetShellServiceInfo"}).then((function(e){return n.setItem(r.aadLauncherSesstionStorageKey,JSON.stringify(e)),e}))},e.prototype.getConsumerShellServiceInfo=function(e){var t,r=this;return(t=s.a.SessionStorage.getItem(this.msaLauncherSesstionStorageKey))?$.Deferred().resolve(JSON.parse(t)).promise():this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"GetConsumerShellServiceInfo(culture='{0}')".format(e),method:"GET",qosEventName:"Function.GetConsumerShellServiceInfo"}).then((function(e){return window.sessionStorage.setItem(r.msaLauncherSesstionStorageKey,JSON.stringify(e)),e}))},e.prototype.getShellNavBarData=function(e){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"GetShellServiceInfo(culture='{0}')".format(e),method:"GET",qosEventName:"QosEvent.ServiceEndpoints.Function.GetShellNavBarData"})},e.prototype.getOrNewExcelInOneDrive=function(e,t){var r=this.getSurveyWebOwnerServiceUrl()+"GetOrNewExcelInOneDrive(formid='"+e+"',forcereexport='"+t+"')";return this.sendRequest({requestUri:r,method:"GET",headers:{__TimezoneOffset:(new Date).getTimezoneOffset().toString()},qosEventName:"Action.OpenExcelInOneDrive"})},e.prototype.getYoutubeVideoInfo=function(e){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"embed?youtubeurl="+encodeURIComponent(e),method:"GET",qosEventName:"Function.GetYouTubeVideoInfo"})},e.prototype.getUserInfo=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"userInfo",method:"GET",qosEventName:"Function.GetUserInfo"})},e.prototype.getUserFeatureSettings=function(){return this.sendRequestWithToken({requestUri:this.getSurveyWebServiceUrl()+"userfeaturesettings",method:"GET",qosEventName:"Function.GetUserFeatureSettings"})},e.prototype.updateUserFeatureSettings=function(e){return this.sendRequestWithToken({data:e,requestUri:this.getSurveyWebServiceUrl()+"userfeaturesettings",method:"PATCH",qosEventName:"Function.UpdateUserFeatureSettings"})},e.prototype.getXlWorkbookId=function(e){var t=this.getSurveyWebServiceUrl()+"GetXlWorkbookId(formid='"+e+"')";return this.sendRequest({requestUri:t,method:"GET",headers:{__TimezoneOffset:(new Date).getTimezoneOffset().toString()},qosEventName:"Action.GetXlWorkbookId"})},e.prototype.isMemberOf=function(e){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"light/IsMemberOf('"+e+"')",method:"GET",qosEventName:"Function.IsMemberOf"},{disableXMsHeader:!0})},e.prototype.mathCalculation=function(e){if(!e||!e.Mathml){return $.Deferred().resolve({Aria:"",Responses:[]}).promise()}var t={Context:e.Context,Formulas:[e.Mathml],InputFormat:"MathML",Locale:navigator.language,Mode:1,OutputFormat:"latex",RequiredIncorrectAnswerCount:e.IncorrectAnswerCount};return this.sendRequest({data:t,method:"POST",requestUri:this.getSurveyWebServiceUrl()+"math/calculation?formId="+e.FormId+"&questionId="+e.QuestionId,qosEventName:"Question.MathCalculation"})},e.prototype.mathQuestionGeneration=function(e){if(!e.Context){return $.Deferred().resolve({Features:0,Results:[]}).promise()}var t={Features:e.Features,Input:e.Context,InputFormat:"MathML",Locale:navigator.language,Origin:e.Origin,OutputFormat:"latex",RequiredQuestionsCount:e.QuestionCount,RequiredIncorrectAnswerCount:e.IncorrectAnswerCount};return this.sendRequest({data:t,method:"POST",requestUri:this.getSurveyWebServiceUrl()+"mathapi/questions?formId="+e.FormId+"&questionId="+e.QuestionId,qosEventName:"Question.MathQuestionGeneration"})},e.prototype.browseImage=function(e,t,r){var n={resourceId:e,itemCount:t,skipToken:r};return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/browseimage",method:"POST",data:n,qosEventName:"Decomposition.BrowseImage"})},e.prototype.getToken=function(){return Object(m.a)().AuthContext.getFormApiToken()},e.prototype.searchImage=function(e,t,r,n,o){var i={query:e,itemCount:r,lcid:OfficeFormServerInfo.cultureInfo.Name.toLowerCase(),parameters:{license:t},skipToken:n.toString(),url:o};return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/searchimage",method:"POST",data:i,qosEventName:"Decomposition.SearchImage"})},e.prototype.getCdbToken=function(){var e=$.Deferred();return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/getTokenForResource?resourceType=CollabDB",method:"GET",qosEventName:"Decomposition.GetCdbToken"}).then((function(t){t?e.resolve(t):e.reject(new Error("Failed to get CDB token via GetTokenForResource"))}),(function(t){e.reject(t)})),e.promise()},e.prototype.getOD4BToken=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/getTokenForResource?resourceType=MSGraph",method:"GET",qosEventName:"Decomposition.GetOD4BToken"}).then((function(e){return e?"Bearer "+e:$.Deferred().reject(new Error("Failed to get OneDriveForBusiness token via GetTokenForResource")).promise()}))},e.prototype.getFormsProToken=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/getTokenForResource?resourceType=FormsPro",method:"GET",qosEventName:"Decomposition.GetFormsProToken"}).then((function(e){return e?"Bearer "+e:$.Deferred().reject(new Error("Failed to get FormsPro token via GetTokenForResource")).promise()}))},e.prototype.getImmersiveReaderToken=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/getTokenForResource?resourceType=ImmersiveReader",method:"GET",qosEventName:"Decomposition.GetImmersiveReaderToken"}).then((function(e){return e||$.Deferred().reject(new Error("Failed to get ImmersiveReader token via GetTokenForResource")).promise()}))},e.prototype.reportAbuse=function(e){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"contentvalidation/report",method:"POST",data:e,qosEventName:"OnlineSafety.ReportAbuse",qosExtraData:{Category:e.Category}})},e.prototype.unblockPhishingForm=function(e){return this.sendRequest({requestUri:this.getAdminPhishingReviewPageBaseUrl(e)+"/unblock",method:"PATCH",qosEventName:"AdminPage.UnblockPhishingForm"})},e.prototype.getAdminPhishingReviewForm=function(t,r){var n=this.getAdminPhishingReviewPageBaseUrl(t);return n+=e.getQueryParameters("?",r),this.sendRequest({requestUri:n,method:"GET",qosEventName:"AdminPage.GetPhisingReviewForm"})},e.prototype.createAdminPhishingReviewPermissionLink=function(e,t){return this.sendRequest({requestUri:this.getAdminPhishingReviewPageBaseUrl(e)+"/permissions",method:"POST",data:t,qosEventName:"AdminPage.CreateFormPermissionLink"})},e.prototype.getRestrictedUser=function(e){return this.sendRequest({requestUri:this.getAdminPhishingReviewPageRestrictedUserBaseUrl(e),method:"GET",qosEventName:"AdminPage.GetRestrictedUser"})},e.prototype.unblockRestrictedUser=function(e){return this.sendRequest({requestUri:this.getAdminPhishingReviewPageRestrictedUserBaseUrl(e),method:"DELETE",qosEventName:"AdminPage.UnblockRestrictedUser"})},e.prototype.getGroups=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"groups",method:"GET",qosEventName:"Groups.Get"})},e.prototype.getGroupId=function(e){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"groupinfo/getgroupid?onedriveweburl="+encodeURIComponent(e),method:"GET",qosEventName:"Form.GetGroupId"})},e.prototype.getGroup=function(e){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"groups('"+e+"')",method:"GET",qosEventName:"Group.Get"})},e.prototype.getGroupOwners=function(e){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"groups('"+e+"')/owners",method:"GET",qosEventName:"Group.GetOwners"})},e.prototype.getGroupMembers=function(e){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"groups('"+e+"')/members",qosEventName:"Group.GetMembers"})},e.prototype.getGroupPhotoDefinition=function(e){return this.sendRequestWithToken({requestUri:this.getSurveyWebServiceUrl()+"groups('"+e+"')/photo",method:"GET",qosEventName:"Group.GetPhotoDefinition"})},e.prototype.getGroupPhotoValue=function(e){return this.sendRequestWithToken({blobResponseType:!0,requestUri:this.getSurveyWebServiceUrl()+"groups('"+e+"')/photo/$value",method:"GET",qosEventName:"Group.GetPhotoValue"})},e.prototype.getGroupMemberPhotoDefinition=function(e,t){return this.sendRequestWithToken({requestUri:this.getSurveyWebServiceUrl()+"groups('"+e+"')/members('"+t+"')/photo",method:"GET",qosEventName:"Group.GetMemberPhotoDefinition"})},e.prototype.getGroupMemberPhotoValue=function(e,t){return this.sendRequestWithToken({blobResponseType:!0,requestUri:this.getSurveyWebServiceUrl()+"groups('"+e+"')/members('"+t+"')/photo/$value",method:"GET",qosEventName:"Group.GetMemberPhotoValue"})},e.prototype.getAnalysisSurveyData=function(t){var r=this.getSurveyWebOwnerServiceUrl()+e.FormEntityCollectionName+"('"+t+"')/"+e.GetAggregateSurveyDataFunctionName;return this.sendRequest({requestUri:r,qosEventName:"Analysis.AggregateSurveyData"})},e.prototype.getAnalysisQuizData=function(t){var r=this.getSurveyWebOwnerServiceUrl()+e.FormEntityCollectionName+"('"+t+"')/"+e.GetAggregateQuizDataFunctionName;return this.sendRequest({requestUri:r,qosEventName:"Analysis.AggregateQuizData"})},e.prototype.getResultSharingAnalysisSurveyData=function(t){var r=this.getSurveyWebOwnerServiceUrl()+e.AnalysisFormEntityCollectionName+"('"+t+"')/"+e.GetAggregateSurveyDataFunctionName;return this.sendRequest({requestUri:r,qosEventName:"Analysis.ResultSharingAggregateSurveyData"})},e.prototype.getResultSharingAnalysisQuizData=function(t){var r=this.getSurveyWebOwnerServiceUrl()+e.AnalysisFormEntityCollectionName+"('"+t+"')/"+e.GetAggregateQuizDataFunctionName;return this.sendRequest({requestUri:r,qosEventName:"Analysis.ResultSharingAggregateQuizData"})},e.prototype.getInsights=function(e){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"insights/getinsights?formId="+encodeURIComponent(e),method:"GET",qosEventName:"Form.GetInsights"})},e.prototype.getFormsWithToken=function(t,r,n){void 0===t&&(t=!1);var o=this.getSurveyWebServiceUrl()+e.FormEntityCollectionName+e.getQueryParameters("?",r);return this.sendRequestWithToken({requestUri:o,qosEventName:"Forms.Get"},{skipExpiredTokenCheck:!!n},n)},e.prototype.createFormWithToken=function(t,r){var n={__TimezoneOffset:(new Date).getTimezoneOffset().toString()};return this.sendRequestWithToken({requestUri:this.getSurveyWebServiceUrl()+e.FormEntityCollectionName,method:"POST",data:t,headers:n,qosEventName:"Form.Create",qosExtraData:{FormType:this.getFormType(t)}},{},r)},e.prototype.checkAnonymousAccess=function(t){var r=this.getSurveyWebOwnerServiceUrl()+"light/"+e.RuntimeFormEntityCollectionName+"('"+t+"')";return Object(I.b)({requestUri:r,headers:[]},{disableLog:!0,skipExpiredTokenCheck:!0}).then((function(){return!0}),(function(e){var t=I.a.convertToResponseError(e);return t.statusCode===v.a.Unauthorized?$.Deferred().resolve(!1).promise():t}))},e.prototype.getMeetingInfo=function(e){var t=this.getSurveyWebServiceUrl()+"light/meetingInfo?meetingId="+e;return this.sendRequest({requestUri:t,method:"GET",qosEventName:"MeetingInfo.GetMeetingInfo"})},e.prototype.experimentationGetVariations=function(){var e=this.getSurveyWebServiceUrl()+"experimentation/getvariations";return this.sendRequest({requestUri:e,method:"GET",qosEventName:"Experimentation.GetVariations"})},e.prototype.experimentationActivate=function(e){var t=this.getSurveyWebServiceUrl()+"experimentation/activate?experimentKey="+e;return this.sendRequest({requestUri:t,method:"GET",qosEventName:"Experimentation.Activate"})},e.prototype.experimentationTrack=function(e,t){var r=this.getSurveyWebServiceUrl()+"experimentation/track?experimentKey="+e+"&eventKey="+t;return this.sendRequest({requestUri:r,method:"GET",qosEventName:"Experimentation.Track"})},e.prototype.getInactiveUserByIdOrEmail=function(e){var t=this.getSurveyWebServiceUrl()+"deleteduserinfo/byidemail/"+encodeURIComponent(e);return this.sendRequest({requestUri:t,method:"GET",qosEventName:"InactiveUserByIdOrEmail.Get"})},e.prototype.getUserSettings=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"userSettings",method:"GET",qosEventName:"UserSettings.Get"})},e.prototype.updateUserSettings=function(e){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"userSettings",method:this.partialUpdateHttpMethod,data:e,qosEventName:"UserSettings.Update"}).then((function(){return null}))},e.prototype.getAllLocaleResources=function(e){var t=this.getMultilingualBaseUrl(e);return this.sendRequest({requestUri:t,method:"GET",qosEventName:"Locale.GetAll"})},e.prototype.getLocaleResource=function(e,t){var r=this.getMultilingualBaseUrl(e)+"/'"+t+"'",n=Object(h.e)((function(){return l.a.getQueries().vt}));return this.sendRequest({requestUri:r,headers:{ValidationToken:n||""},method:"GET",qosEventName:"Locale.Get"})},e.prototype.createLocaleItem=function(e,t){return this.sendRequest({requestUri:this.getMultilingualBaseUrl(e),method:"POST",data:t,qosEventName:"LocaleItem.Create"})},e.prototype.updateLocaleItem=function(e,t){var r=this.getMultilingualBaseUrl(e)+"/'"+t.locale+"'/";return r+=t.questionId?"question/'"+t.questionId+"'/'":"form/'",r+=t.elementKey+"'",this.sendRequest({requestUri:r,method:this.partialUpdateHttpMethod,data:{ElementValue:t.elementValue},qosEventName:"LocaleItem.Update"})},e.prototype.deleteLocale=function(e,t){return this.sendRequest({requestUri:this.getMultilingualBaseUrl(e)+"/'"+t+"'",method:"DELETE",qosEventName:"Locale.Delete"})},e.prototype.copyLocaleResources=function(t,r){var n=this.getSurveyWebOwnerServiceUrl()+"batch/"+e.FormEntityCollectionName+"('"+t+"')/"+e.LocaleResourceEntityCollectionName;return this.sendRequest({requestUri:n,method:"POST",data:r,qosEventName:"LocaleItem.Copy"})},e.getQueryParameters=function(t,r,o){if(!r)return t+"$expand="+e.QuestionEntityCollectionName;var i="$select="+(r=n.union(["id"],r)).join(","),a={permissions:"permissions"};a[e.QuestionEntityCollectionName]=e.QuestionEntityCollectionName+"($expand="+e.ChoiceEntityCollectionName+")",a[e.PermissionTokenEntityCollectionName]="permissionTokens";var s=r.map((function(e){return a[e]})).filter((function(e){return e}));return s.length&&(i+="&$expand="+s.join(",")),o&&(i+="&$filter="+o.name+"+"+o.operator+"+"+o.value),i&&t+i},e.prototype.sendRequestWithToken=function(e,t,r){var n=this;return $.when(r||this.getToken()).then((function(r){return e.headers=$.extend(!0,e.headers,n.getCommonHeaders(r)),Object(I.b)(e,t).then(I.a.parseResponseDataValue,I.a.parseAndTryHandleError)}))},e.prototype.sendRequestWithoutToken=function(e,t){return e.headers=$.extend(!0,e.headers,this.getCommonHeaders("")),Object(I.b)(e,t).then(I.a.parseResponseDataValue,I.a.parseAndTryHandleError)},e.prototype.getDownloadExcelRequestUrlParameters=function(e,t,r,n,o,i){var a={formid:e,timezoneOffset:(new Date).getTimezoneOffset().toString(),downloadCookie:n,minResponseId:t,maxResponseId:r,"X-CorrelationId":o,"X-UserSessionId":Object(b.d)()};return Object(m.a)().Flighting.isEnabled("CookieAuth")||(a.Authorization=i),a},e.prototype.getDownloadExcelRequestUrl=function(e){return this.getExcelServiceBaseUrl()+"formapi/DownloadExcelFile.ashx?"+$.param(e)},e.prototype.downloadExcelCheckAndHandleAuthFailure=function(e,t){var r=Object(f.I)(e),n=r&&(r.error&&parseInt(r.error.code)||parseInt(r.ErrorCode));n===v.b.TokenExpired||n===v.b.RequireLogin?Object(m.a)().AuthContext.refreshToken().done((function(){Object(a.i)(t,(function(){return Object(d.d)()}))})):t()},e.prototype.sendRequestInner=function(e,t,r){var n=this;return this.getToken().then((function(e){return t.headers=$.extend(!0,t.headers,n.getCommonHeaders(e)),Object(I.b)(t,r).then(I.a.convertToAsyncResult,I.a.parseAndTryHandleError)})).then(e)},e.prototype.sendRequest=function(e,t){return this.sendRequestInner((function(e){return e&&e.value}),e,t)},e.prototype.createHiddenIFrame=function(e){var t=document.getElementById(e);return t&&t.parentNode.removeChild(t),(t=document.createElement("iframe")).id=e,t.name=e,t.hidden=!0,t},e.prototype.getCommonHeaders=function(t){var r={Accept:"application/json",Authorization:t?"Bearer "+t:"",__RequestVerificationToken:OfficeFormServerInfo.antiForgeryToken,AnalyzerToken:l.a.getQueries().AnalyzerToken,ValidationToken:l.a.getQueries().vt,ContextParams:l.a.getQueries().ctx},o=l.a.getHashes().Token;return Object(m.a)().Flighting.isEnabled("GetShareInvitationKeyFromQuery")?r.ShareInvitationKey=o||l.a.getQueries().Token:r.ShareInvitationKey=o,r=n.extend({},r,e.customizedHeaders)},e.prototype.getSurveyWebServiceUrl=function(){return this.serviceUrl},e.prototype.getSurveyWebOwnerServiceUrl=function(){return this.ownerServiceUrl},e.prototype.getExcelServiceBaseUrl=function(){return this.serviceUrl.slice(0,-12)},e.prototype.getAdminPhishingReviewPageBaseUrl=function(t){return this.getSurveyWebOwnerServiceUrl()+"admin/"+e.FormEntityCollectionName+"('"+t+"')"},e.prototype.getAdminPhishingReviewPageRestrictedUserBaseUrl=function(e){return this.getSurveyWebOwnerServiceUrl()+"admin/RestrictedUsers/"+e},e.prototype.getMultilingualBaseUrl=function(t){return this.getSurveyWebOwnerServiceUrl()+e.FormEntityCollectionName+"('"+t+"')/"+e.LocaleResourceEntityCollectionName},e.prototype.getFormType=function(e){var t=null;if(e&&e.settings){if(Object(h.e)((function(){return"survey"==e.type})))return"Survey";var r=null;try{r=JSON.parse(e.settings)}catch(e){}e.category&&e.category.split(" ").indexOf("Poll")>=0?t="Poll":r&&void 0!==r.IsQuizMode&&(t=r.IsQuizMode?"Quiz":"Form")}return t||void 0},e.customizedHeaders={},e}()},,function(e,t,r){"use strict";r.d(t,"b",(function(){return m})),r.d(t,"a",(function(){return h}));var n=r(13),o=new RegExp("\\(([^)]*)\\)","gi"),i=new RegExp("(?:[\0-/:-@[-^`{--]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udbff](?![\udc00-\udfff])|(?:[^\ud800-\udbff]|^)[\udc00-\udfff]) ","gi"),a=new RegExp("\\s+","gi"),s=new RegExp("[--]"),c=new RegExp("[-|-|-|-|-]"),u=new RegExp("[---]|[\ud840-\ud868][\udc00-\udfff]|\ud869[\udc00-\uded6\udf00-\udfff]|[\ud86a-\ud86c][\udc00-\udfff]|\ud86d[\udc00-\udf34\udf40-\udfff]|\ud86e[\udc00-\udc1d]");function l(e,t){var r=e.replace(/\s/,"");return t?r[r.length-1]:r[0]}function d(e,t){var r=e.replace(/\s/,"");return r.length<=2?t?r[0]:r[r.length-1]:t?r.substr(0,2):r.substr(r.length-2,r.length)}function f(e,t){var r="",n=e.split(" ");return 2===n.length?(r+=n[0].charAt(0).toUpperCase(),r+=n[1].charAt(0).toUpperCase()):3===n.length?(r+=n[0].charAt(0).toUpperCase(),r+=n[2].charAt(0).toUpperCase()):0!==n.length&&(r+=n[0].charAt(0).toUpperCase()),t&&r.length>1?r.charAt(1)+r.charAt(0):r}function p(e){return e=(e=(e=(e=e.replace(o,"")).replace(i,"")).replace(a," ")).trim()}function m(e,t){return null==e?"":(arguments.length<2&&(t=n.z()),e=p(e),s.test(e)?l(e,!!t):c.test(e)||u.test(e)?d(e,!!t):f(e,!!t))}function h(e,t,r){return m(e?e.trim():((t||"")+" "+(r||"")).trim())}},,function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return d}));var n,o=r(0),i=r(97),a=r(22),s=r(12),c=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),u=function(){return(u=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},l=function(e){function t(t){return e.call(this,t)||this}return c(t,e),t.prototype.render=function(){var e=this.createColorInfo(),t=this.props.displayText?this.props.displayText.toLocaleUpperCase():Object(a.b)({HTMLAttributes:{className:"author-notification-icon"},IconName:"Contact"}),r={backgroundColor:e.backgroundColor,color:e.textColor},n={"aria-label":this.props.ariaLabel||this.props.tooltip,className:"author-notification-content",style:r,title:this.props.tooltip};return o.createElement("div",u({},n),o.createElement("span",{"aria-hidden":!0},t))},t.createColor=function(e){for(var r=0,n=e.length-1;n>=0;n--){var o=e.charCodeAt(n),i=n%8;r^=(o<<i)+(o>>8-i)}var a=r%t.COLOR_SWATCHES_LOOKUP.length;return t.COLOR_SWATCHES_LOOKUP[a]},t.prototype.createColorInfo=function(){var e=this.props,r="",n="";e.backgroundColor&&(r=Object(i.b)(e.backgroundColor)),e.textColor&&(n=Object(i.b)(e.textColor));var o=e.email||e.name;return""!==n&&""!==r||!o||(r=r||t.createColor(o),n=n||Object(i.b)(Object(i.c)(Object(i.e)(r)))),{backgroundColor:r=r||t.defaultBackgroundColor,textColor:n=n||t.defaultTextColor}},t.COLOR_SWATCHES_LOOKUP=["#3765E4","#D83B01","#B91C49","#910A19","#E40089","#971497","#8150FD","#562685","#2C5797","#007B8A","#11723F","#6F292A","#A16412"],t.defaultBackgroundColor=t.COLOR_SWATCHES_LOOKUP[0],t.defaultTextColor="#FFFFFF",t}(s.a);function d(e){return o.createElement(l,e)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n,o=r(2),i=r(52),a=r(10),s=r(15),c=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.getElementTypeName=function(){return s.a.Rating},t.createDefaultDefinition=function(){return{Type:t.getElementTypeName(),Title:o.a.LocalizedStrings.Question_DefaultTitle,Length:5,RatingShape:a.f.Star,LeftDescription:"",RightDescription:"",MinRating:1,QuestionTagForIntelligence:"Unknown",IsFromSuggestion:!1}},t.supportMobileDesign=function(e){return!t.hasInvalidSettingOnMobile(e)&&!e.ShowRatingLabel},t.prototype.verify=function(e){return this.Model.Required&&!e?a.e.RequiredError:a.e.Success},t.prototype.getTypeDisplayName=function(){return o.a.LocalizedStrings.QuestionType_Rating},t.prototype.isNumberType=function(){return!0},t}(i.a)},function(e,t,r){"use strict";r.d(t,"b",(function(){return s})),r.d(t,"a",(function(){return c}));var n,o=r(3),i=r(80),a=r(13);function s(){return n||(n=new c)}var c=function(){function e(){this.userStateChangeCallbackManager=new i.a.CallbackManager,this.users={}}return e.isValidUser=function(e){return!!(e&&e.userId&&e.displayName)},e.prototype.registerUsersStateChange=function(e){this.userStateChangeCallbackManager.register(e)},e.prototype.unregisterUsersStateChange=function(e){this.userStateChangeCallbackManager.unregister(e)},e.prototype.getUser=function(e){return o.clone(this.users[e])},e.prototype.getAllUsers=function(){return o.values(a.e(this.users))},e.prototype.getUserCount=function(){return o.keys(this.users).length},e.prototype.addOrUpdateUser=function(t){if(e.isValidUser(t)){var r=this.users[t.userId];if(null!=r){if(e.isValidUser(r))return;o.extend(r,t)}else this.users[t.userId]=t;this.userStateChangeCallbackManager.trigger()}},e.prototype.removeUser=function(e){delete this.users[e.userId]&&this.userStateChangeCallbackManager.trigger()},e.prototype.removeAllUsers=function(){this.getUserCount()>0&&(this.users={},this.userStateChangeCallbackManager.trigger())},e}()},function(e,t,r){"use strict";r.d(t,"c",(function(){return s})),r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return u}));var n=r(3),o=r(64),i=r(19),a=r(6);function s(e){return!c()&&o.a.isYouTubeUrl(e)}function c(){var e=Object(i.b)().Model.FormsTenantSettings;return!(Object(a.a)().Flighting.isEnabled("YouTubeAdminControl")&&e&&!e.bingImageSearch)}function u(e){var t=Object(i.b)().Model;if(!c()){var r=e.FormElementManager.TopQuestionMasters,o=e.FormElementManager.SectionMasters,a=n.some(r,l)||n.some(o,l);a&&!t.IsShowYouTubeDisableMessage?t.IsShowYouTubeDisableMessage=!0:!a&&t.IsShowYouTubeDisableMessage&&(t.IsShowYouTubeDisableMessage=!1)}}function l(e){var t=e.Model.VideoInfo&&e.Model.VideoInfo.Url;return t&&o.a.isYouTubeUrl(t)}},function(e,t,r){"use strict";var n,o=r(96),i=r(133),a=r(176),s=r(52),c=r(10),u=r(15),l=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.getElementTypeName=function(){return u.a.MatrixChoice},t.prototype.verify=function(e){return!this.Model.Required||e&&0!==e.length?c.e.Success:c.e.RequiredError},t.prototype.getTypeDisplayName=function(){return"MatrixChoice"},t.prototype.getNormalizedAnswer=function(e){return e},t}(s.a),f=r(162),p=r(177),m=r(178),h=r(141),g=r(122);r.d(t,"a",(function(){return v}));var y={};function b(e){y[e.getElementTypeName()]=e}function v(e){return y[e]}b(g.a),b(h.a),b(m.a),b(p.a),b(f.a),b(d),b(a.a),b(i.a),b(o.a)},function(e,t,r){"use strict";var n,o=r(26),i=r(158),a=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),s=function(e){function t(){var r=this;return t.instance?t.instance:((r=e.call(this,window.FormPrefetchCache&&window.FormPrefetchCache.userLicenseInfoCache)||this).init(),t.instance=r,r)}return a(t,e),t.getInstance=function(){return new t},t.prototype.onPrefetchSucceed=function(){try{var e=JSON.parse(this.cache.data);this.prefetchDeferred.resolve(e)}catch(e){this.fallBackToNormalBoot()}},t.prototype.onPrefetchFaied=function(){this.fallBackToNormalBoot()},t.prototype.fallBackToNormalBoot=function(){var e=this;o.a.getInstance().createDataProvider().getUserInfo().done((function(t){return e.prefetchDeferred.resolve(t)})).fail((function(t){return e.prefetchDeferred.reject(t)}))},t}(i.a),c=r(6);r.d(t,"a",(function(){return u}));var u=function(){function e(){}return e.getUserInfo=function(){return Object(c.a)().Flighting.isEnabled("PreferUserInfoFromAspx")&&OfficeFormServerInfo.userLicenseInfo&&OfficeFormServerInfo.userLicenseInfo.licenses?$.Deferred().resolve(OfficeFormServerInfo.userLicenseInfo).promise():Object(c.a)().Flighting.isEnabled("PrefetchUserLicenseInfo")?s.getInstance().getPromise():o.a.getInstance().createDataProvider().getUserInfo()},e.getUserFeatureSettings=function(){return o.a.getInstance().createDataProvider().getUserFeatureSettings()},e.updateUserFeatureSettings=function(e){return o.a.getInstance().createDataProvider().updateUserFeatureSettings(e)},e}()},function(e,t,r){"use strict";r.d(t,"b",(function(){return f})),r.d(t,"a",(function(){return p}));var n,o=r(4),i=r(1),a=r(55),s=r(38),c=r(34),u=r(191),l=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),d={QuestionId:i.a.string({IsKeyField:!0,SourceFieldName:"questionId"}),Id:i.a.number({SourceFieldName:"id"}),Feedback:i.a.string({SourceFieldName:"feedback"}),Score:i.a.number({SourceFieldName:"score"}),SavingState:i.a.reference({IsLocalField:!0})};function f(e){return o.a.getObjectMasterFromModel(e)}var p=function(e){function t(t){var r=e.call(this,t,{Scheduler:new a.a})||this;return Object(s.b)(r),r.observe(m),r}return l(t,e),Object.defineProperty(t.prototype,"Response",{get:function(){return this.Parent.Parent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FormId",{get:function(){return this.Response.FormId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ResponseId",{get:function(){return this.Response.ResponseId},enumerable:!0,configurable:!0}),t}(o.a.createObjectMasterClass("Comment",d,(function(e,t){return new u.a(e,t)})));function m(e){if(e.BeingDeleted&&e.Master.Synchronizer.Model.UpdateScheduled)try{throw Error("DeletingComment")}catch(e){c.a.logData({errorName:"ModelError",errorInfo:e.stack})}}},function(e,t,r){"use strict";r.d(t,"b",(function(){return h})),r.d(t,"a",(function(){return g}));var n,o=r(0),i=r(20),a=r(3),s=r(25),c=r(5),u=r(22),l=r(12),d=r(70),f=r(29),p=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),m=function(){return(m=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function h(e){return o.createElement(g,m({},e))}var g=function(e){function t(r){var n=e.call(this,r)||this;return n.descriptionId=a.uniqueId(t.name),n.createButtonWithProps=n.createButtonWithProps.bind(n),n}return p(t,e),t.prototype.componentDidMount=function(){Object(d.g)(i.findDOMNode(this))},t.prototype.shouldComponentUpdate=function(e){return!a.isEqual(this.props,e)},t.prototype.render=function(){var e=this;if(this.props.ShowDialog){var t={className:this.props.ClassName||"simple-dialog-container",key:"dialogContainer",ref:"dialogContainer",tabIndex:-1,onBlur:function(t){var r=c.a.getTargetElementOfFocusEvent(t);i.findDOMNode(e.refs.dialogContainer).contains(r)||e.props.onBlur&&e.props.onBlur()},onKeyDown:function(t){return e.onKeyDown(t)},onMouseLeave:this.props.onMouseLeave,onMouseOver:this.props.onMouseOver};return o.createElement("div",m({},t),this.createDialogIcon(),this.createDescription(),this.createButtons(),this.createBranchingRulesWarning())}return null},t.prototype.createDialogIcon=function(){var e=this.props;if(e.IconName){var t={HTMLAttributes:{className:e.IconClassName},IconName:e.IconName,key:"icon"};return o.createElement(u.a,m({},t))}},t.prototype.createDescription=function(){if(this.props.Description){var e=c.a.combineAttributes("description-container",this.props.TextClassName);return o.createElement("div",{className:e,id:this.descriptionId,key:"descriptionContainer"},this.props.Description)}return null},t.prototype.createBranchingRulesWarning=function(){return this.props.WarningMessage?o.createElement("div",{className:"warning-container",id:this.descriptionId+"_warning",key:"warningContainer"},this.props.WarningMessage):null},t.prototype.createButtonWithProps=function(e,t){return Object(f.a)({ButtonStyle:e.ButtonStyle,GlyphButtonStyle:e.GlyphButtonStyle,HTMLAttributes:{"aria-describedby":e.ConveyDescription?this.descriptionId:"",autoFocus:0===t,className:e.ClassName,title:e.Title,onClick:function(t){t.preventDefault(),t.stopPropagation(),e.onClick&&e.onClick(t)}},Icon:e.IconClass,IconClassName:c.a.combineAttributes(e.IconClassName,"forms-icon-size24x24"),IsDisabled:e.IsDisabled,key:e.Key,ref:e.ref,Text:e.Text,TextClassName:e.TextClassName})},t.prototype.createButtons=function(){var e=this.props.ButtonsProps||[];return o.createElement("div",{className:"buttons-container",key:"buttonsContainer"},e.filter((function(e){return!!e})).map(this.createButtonWithProps))},t.prototype.onKeyDown=function(e){e.keyCode===s.a.Esc&&(e.stopPropagation(),e.preventDefault(),this.props.onDismiss&&this.props.onDismiss())},t}(l.a)},function(e,t,r){"use strict";var n=r(3),o=r(4),i=r(1),a=r(21),s=r(18),c=r(23),u=function(){function e(e,t){this.permissionToken=e,this.dataProvider=c.a.getDataProviderByFormMaster(this.permissionToken.Form)}return Object.defineProperty(e.prototype,"FormId",{get:function(){return this.permissionToken.FormId},enumerable:!0,configurable:!0}),e.prototype.add=function(e){return this.dataProvider.createPermissionToken(this.FormId,e)},e.prototype.delete=function(e){return this.dataProvider.deletePermissionToken(this.FormId,e.principalId)},e.prototype.query=function(e){return Object(s.c)("No scenario to call this method currently.")},e.prototype.update=function(e,t){return Object(s.c)("No scenario to call this method currently.")},e}();r.d(t,"b",(function(){return m})),r.d(t,"a",(function(){return h}));var l,d=(l=function(e,t){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}l(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),f={PrincipalId:i.a.string({IsSourceGenerated:!0,SourceFieldName:"principalId"}),Type:i.a.reference({SourceFieldName:"type"}),Name:i.a.string({SourceFieldName:"name"})};function p(e,t){return{Type:e,Name:t}}function m(e){return o.a.getObjectMasterFromModel(e)}var h=function(e){function t(t){return e.call(this,t)||this}return d(t,e),Object.defineProperty(t.prototype,"Form",{get:function(){return this.Parent.Parent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!0,configurable:!0}),t.appendPermissionToken=function(e,t,r){var n=m(o.a.Collection.addItems(e.Model.PermissionTokens,[p(t,r)])[0]);return n.Synchronizer.existingInDataSource().then((function(){return n.Model.PrincipalId}))},t.removePermissionToken=function(e,t){if(t)return o.a.Collection.deleteItems(e.Model.PermissionTokens,[t]),m(t).Synchronizer.deletedFromDataSource().done()},t.getShareResultPermissionToken=function(e){return e.Synchronizer.existingInDataSource().then((function(){var r=t.getShareResultPermissions(e);if(!r)return null;var n=m(r);return n?n.Synchronizer.existingInDataSource().then((function(){return n.Model.PrincipalId})):void 0}))},t.getShareResultPermissions=function(e){return n.filter(e.Model.PermissionTokens,(function(e){return"AnalyzerToken"===e.Type&&e.Name===a.a.AnalysisTokenName}))[0]},t}(o.a.createObjectMasterClass("PermissionToken",f,(function(e,t){return new u(e,t)})))},function(e,t,r){"use strict";var n,o=r(3),i=r(4),a=r(1),s=r(8),c=r(75),u=r(26),l=function(){function e(e){this.mruDocumentCollection=e}return e.prototype.add=function(e){throw Error("No scenario to call this method currently.")},e.prototype.delete=function(e){throw Error("No scenario to call this method currently.")},e.prototype.query=function(e){var t,r=Object(u.b)();switch(this.mruDocumentCollection.Model.Extension){case m.Form:t="User";break;case m.GroupForm:t="Group";break;default:t=null}return r.getRecentForms(t).then((function(e){return{documents:e}}))},e.prototype.update=function(e,t){return $.Deferred().promise()},e}(),d=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),f={App:a.a.string({SourceFieldName:"app"}),Category:a.a.string({SourceFieldName:"category"}),Extension:a.a.string({SourceFieldName:"extension"}),FormCategory:a.a.string({SourceFieldName:"formCategory"}),FormType:a.a.string({SourceFieldName:"formType"}),IsPinned:a.a.boolean({SourceFieldName:"isPinned"}),MruId:a.a.string({SourceFieldName:"mruId"}),NotExist:a.a.boolean({IsLocalField:!0}),OwnerId:a.a.string({SourceFieldName:"ownerId"}),OwnerName:a.a.string({SourceFieldName:"ownerName"}),OwnerTenantId:a.a.string({SourceFieldName:"ownerTenantId"}),OwnerType:a.a.reference({SourceFieldName:"ownerType"}),ServerDocId:a.a.string({SourceFieldName:"serverDocId"}),Timestamp:a.a.string({SourceFieldName:"timestamp"}),Title:a.a.string({SourceFieldName:"title"}),Type:a.a.string({SourceFieldName:"type"}),Url:a.a.string({SourceFieldName:"url"})},p=function(e){function t(t){var r=e.call(this,t)||this;return r.Model.NotExist=!1,r}return d(t,e),Object.defineProperty(t.prototype,"FormMaster",{get:function(){return this.formMaster||(this.formMaster=Object(s.h)({Id:this.Model.ServerDocId})),this.formMaster},enumerable:!0,configurable:!0}),t.prototype.matchSearchStrings=function(e){var t=(this.Model.Title+" "+(this.Model.OwnerName||"")).toLowerCase();return o.all(e,(function(e){return t.indexOf(e)>=0}))},t}(i.a.createObjectMasterClass("MruDocument",f));r.d(t,"b",(function(){return m})),r.d(t,"a",(function(){return y}));var m,h=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),g={Extension:a.a.enumeration((function(){return m}),{IsLocalField:!0}),Knowledge:a.a.string({IsSourceGenerated:!0,SourceFieldName:"knowledge"}),MruDocuments:a.a.collectionOf((function(){return p}),{SourceFieldName:"documents"}),ResponseCode:a.a.string({IsSourceGenerated:!0,SourceFieldName:"responseCode"})};!function(e){e[e.Form=0]="Form",e[e.GroupForm=1]="GroupForm",e[e.Unspecified=2]="Unspecified"}(m||(m={}));var y=function(e){function t(){var t=e.call(this,{ExistingInDataSource:!0,InitialData:{Extension:m.GroupForm,Knowledge:""}})||this;return t.listChangeCallbacks=[],t}return h(t,e),t.getInstance=function(){return this.instance||(this.instance=new t),this.instance},Object.defineProperty(t.prototype,"Documents",{get:function(){return this.isFieldReady(this.Schema.MruDocuments)?i.a.convertToArray(this.Model.MruDocuments).sort((function(e,t){return Date.parse(t.Timestamp)-Date.parse(e.Timestamp)})).map((function(e){return i.a.getObjectMasterFromModel(e)})):[]},enumerable:!0,configurable:!0}),t.prototype.removeDocument=function(e){this.isFieldReady(this.Schema.MruDocuments)&&i.a.Collection.deleteItems(this.Model.MruDocuments,o.filter(this.Model.MruDocuments,(function(t){return t.ServerDocId===e})))},t.prototype.initializeFormList=function(){var e=this,r=t.Schema;return this.ensureFieldsReady([r.Knowledge,r.MruDocuments]).then((function(){o.forEach(e.Model.MruDocuments,(function(e){var t=Object(c.d)({Id:e.ServerDocId},!1);t.fieldsReady([s.c.Schema.Title]).done((function(){t.observe((function(r){r.BeingDeleted||(e.Title=t.Model.Title)}),[s.c.Schema.Title]),e.Title=t.Model.Title}))}))}),(function(e){return $.Deferred().resolve().promise()}))},t.prototype.observeListChange=function(e){if(this.findListChangeCallbackIndex(e)<0){var t=function(t){(t.AddedModels.length||t.RemovedModels.length)&&e()};this.listChangeCallbacks.push({originCallback:e,registeredCallback:t}),this.getDocumentCollectionMaster().done((function(e){return e.observe(t)}))}},t.prototype.unobserveListChange=function(e){var t=this.findListChangeCallbackIndex(e);if(t>=0){var r=this.listChangeCallbacks[t];this.listChangeCallbacks.splice(t,1),this.getDocumentCollectionMaster().done((function(e){return e.unobserve(r.registeredCallback)}))}},t.prototype.getDocumentCollectionMaster=function(){var e=this;return this.fieldsReady([this.Schema.MruDocuments]).then((function(){return i.a.getCollectionMasterFromModel(e.Model.MruDocuments)}))},t.prototype.findListChangeCallbackIndex=function(e){return o.findIndex(this.listChangeCallbacks,(function(t){return t.originCallback===e}))},t}(i.a.createObjectMasterClass("MruDocumentCollection",g,(function(e){return new l(e)})))},function(e,t,r){"use strict";r.d(t,"e",(function(){return s})),r.d(t,"c",(function(){return c})),r.d(t,"a",(function(){return u})),r.d(t,"d",(function(){return l})),r.d(t,"b",(function(){return d}));var n=r(46),o=r(6),i={af:"Afrikaans","am-et":" ()",ar:"","as-in":" ()","az-latn-az":"azrbaycan (Azrbaycan)",be:"",bg:"","bn-bd":" ()","bn-in":" ()","bs-latn-ba":"bosanski (Bosna i Hercegovina)",ca:"catal","ca-es-valencia":"valenci (Espanya)",cs:"etina","cy-gb":"Cymraeg (Y Deyrnas Unedig)",da:"dansk",de:"Deutsch",el:"","en-gb":"English (United Kingdom)","en-us":"English (United States)",es:"espaol","es-mx":"espaol (Mxico)",et:"eesti",eu:"euskara",fa:"",fi:"suomi","fil-ph":"Filipino (Pilipinas)",fr:"franais","fr-ca":"franais (Canada)","ga-ie":"Gaeilge (ire)",gd:"Gidhlig",gl:"galego",gu:"","ha-latn-ng":"Hausa (Najeriya)",he:"",hi:"",hr:"hrvatski",hu:"magyar",hy:"",id:"Indonesia",is:"slenska",it:"italiano",ja:"",ka:"",kk:" ","km-kh":" ()",kn:"",ko:"",kok:"",ky:"","lb-lu":"Ltzebuergesch (Ltzebuerg)",lo:"",lt:"lietuvi",lv:"latvieu","mi-nz":"te reo Mori (Aotearoa)",mk:"",ml:"",mn:"",mr:"",ms:"Melayu","mt-mt":"Malti (Malta)","nb-no":"norsk bokml (Norge)","ne-np":" ()",nl:"Nederlands","nn-no":"nynorsk (Noreg)","or-in":" ()",pa:"",pl:"polski","prs-af":" ()","pt-br":"portugus (Brasil)","pt-pt":"portugus (Portugal)","quz-pe":"Runasimi (Per)",ro:"romn",ru:"","sd-arab-pk":" ()","si-lk":" ( )",sk:"slovenina",sl:"slovenina",sq:"shqip","sr-cyrl-ba":" (  )","sr-cyrl-rs":" ()","sr-latn-rs":"srpski (Srbija)",sv:"svenska",sw:"Kiswahili",ta:"",te:"",th:"","tk-tm":"Trkmen dili (Trkmenistan)",tr:"Trke",tt:"",ug:"",uk:"",ur:"","uz-latn-uz":"ozbek (Ozbekiston)",vi:"Ting Vit","zh-cn":"","zh-hk":"","zh-tw":""},a=["ar","fa","he","prs-af","sd-arab-pk","ug","ur"];function s(e){return-1!==a.indexOf(e.toLowerCase())}function c(){return i}function u(){return"en-us"}function l(){var e=$.Deferred();return n.a.isMsaUser()?e.resolve(!1):e.resolve(Object(o.a)().Flighting.isEnabled("MultiLingualMVP1")),e.promise()}function d(e){return"zh-hk"===e?"zh-tw":e}},function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e[e.DesignPage=0]="DesignPage",e[e.DesignPageRtl=1]="DesignPageRtl",e[e.ResponsePage=2]="ResponsePage",e[e.ResponsePageRtl=3]="ResponsePageRtl",e[e.MobileDesignPage=4]="MobileDesignPage",e[e.MobileDesignPageRtl=5]="MobileDesignPageRtl"}(n||(n={}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n,o,i=r(17),a=r(44);function s(e){return c(e)}function c(e){var t=$.Deferred();void 0===o&&(o={DesignPage:Object(a.b)(OfficeFormServerInfo.scriptName+".min.css",!0),DesignPageRtl:Object(a.b)(OfficeFormServerInfo.scriptName+".rtl.min.css",!0),ResponsePage:Object(a.b)(OfficeFormServerInfo.responsePageCssName+"min.css",!0),ResponsePageRtl:Object(a.b)(OfficeFormServerInfo.responsePageCssName+"rtl.min.css",!0),MobileDesignPage:Object(a.b)(OfficeFormServerInfo.scriptName+".min.css",!0),MobileDesignPageRtl:Object(a.b)(OfficeFormServerInfo.scriptName+".rtl.min.css",!0)});var r=o[n[e]];if(!r)throw Error("No path for "+n[e]);var s=document.getElementsByTagName("head")[0];if(!s)return t.reject(Error("No head element found!")).promise();var c=document.createElement("link");c.rel="stylesheet",c.href=r;var u=document.getElementById("form-page-css"),l=$(u).attr("href");return l&&r.toLowerCase()===l.toLowerCase()?t.resolve().promise():(s.removeChild(u),c.id="form-page-css",c.onload=function(){return t.resolve()},c.onerror=function(){s.removeChild(c),t.reject(Error("Failed to load css file: "+r)),i.a.logData({name:"Error.CssLoadingError.FailedToLoadCss",extraData:{name:n[e],url:r}})},s.appendChild(c),t.promise())}!function(e){e[e.DesignPage=0]="DesignPage",e[e.DesignPageRtl=1]="DesignPageRtl",e[e.ResponsePage=2]="ResponsePage",e[e.ResponsePageRtl=3]="ResponsePageRtl",e[e.MobileDesignPage=4]="MobileDesignPage",e[e.MobileDesignPageRtl=5]="MobileDesignPageRtl"}(n||(n={}))},,function(e,t,r){var n,o=function(){var e=String.fromCharCode,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",n={};function o(e,t){if(!n[e]){n[e]={};for(var r=0;r<e.length;r++)n[e][e.charAt(r)]=r}return n[e][t]}var i={compressToBase64:function(e){if(null==e)return"";var r=i._compress(e,6,(function(e){return t.charAt(e)}));switch(r.length%4){default:case 0:return r;case 1:return r+"===";case 2:return r+"==";case 3:return r+"="}},decompressFromBase64:function(e){return null==e?"":""==e?null:i._decompress(e.length,32,(function(r){return o(t,e.charAt(r))}))},compressToUTF16:function(t){return null==t?"":i._compress(t,15,(function(t){return e(t+32)}))+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:i._decompress(e.length,16384,(function(t){return e.charCodeAt(t)-32}))},compressToUint8Array:function(e){for(var t=i.compress(e),r=new Uint8Array(2*t.length),n=0,o=t.length;n<o;n++){var a=t.charCodeAt(n);r[2*n]=a>>>8,r[2*n+1]=a%256}return r},decompressFromUint8Array:function(t){if(null==t)return i.decompress(t);for(var r=new Array(t.length/2),n=0,o=r.length;n<o;n++)r[n]=256*t[2*n]+t[2*n+1];var a=[];return r.forEach((function(t){a.push(e(t))})),i.decompress(a.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":i._compress(e,6,(function(e){return r.charAt(e)}))},decompressFromEncodedURIComponent:function(e){return null==e?"":""==e?null:(e=e.replace(/ /g,"+"),i._decompress(e.length,32,(function(t){return o(r,e.charAt(t))})))},compress:function(t){return i._compress(t,16,(function(t){return e(t)}))},_compress:function(e,t,r){if(null==e)return"";var n,o,i,a={},s={},c="",u="",l="",d=2,f=3,p=2,m=[],h=0,g=0;for(i=0;i<e.length;i+=1)if(c=e.charAt(i),Object.prototype.hasOwnProperty.call(a,c)||(a[c]=f++,s[c]=!0),u=l+c,Object.prototype.hasOwnProperty.call(a,u))l=u;else{if(Object.prototype.hasOwnProperty.call(s,l)){if(l.charCodeAt(0)<256){for(n=0;n<p;n++)h<<=1,g==t-1?(g=0,m.push(r(h)),h=0):g++;for(o=l.charCodeAt(0),n=0;n<8;n++)h=h<<1|1&o,g==t-1?(g=0,m.push(r(h)),h=0):g++,o>>=1}else{for(o=1,n=0;n<p;n++)h=h<<1|o,g==t-1?(g=0,m.push(r(h)),h=0):g++,o=0;for(o=l.charCodeAt(0),n=0;n<16;n++)h=h<<1|1&o,g==t-1?(g=0,m.push(r(h)),h=0):g++,o>>=1}0==--d&&(d=Math.pow(2,p),p++),delete s[l]}else for(o=a[l],n=0;n<p;n++)h=h<<1|1&o,g==t-1?(g=0,m.push(r(h)),h=0):g++,o>>=1;0==--d&&(d=Math.pow(2,p),p++),a[u]=f++,l=String(c)}if(""!==l){if(Object.prototype.hasOwnProperty.call(s,l)){if(l.charCodeAt(0)<256){for(n=0;n<p;n++)h<<=1,g==t-1?(g=0,m.push(r(h)),h=0):g++;for(o=l.charCodeAt(0),n=0;n<8;n++)h=h<<1|1&o,g==t-1?(g=0,m.push(r(h)),h=0):g++,o>>=1}else{for(o=1,n=0;n<p;n++)h=h<<1|o,g==t-1?(g=0,m.push(r(h)),h=0):g++,o=0;for(o=l.charCodeAt(0),n=0;n<16;n++)h=h<<1|1&o,g==t-1?(g=0,m.push(r(h)),h=0):g++,o>>=1}0==--d&&(d=Math.pow(2,p),p++),delete s[l]}else for(o=a[l],n=0;n<p;n++)h=h<<1|1&o,g==t-1?(g=0,m.push(r(h)),h=0):g++,o>>=1;0==--d&&(d=Math.pow(2,p),p++)}for(o=2,n=0;n<p;n++)h=h<<1|1&o,g==t-1?(g=0,m.push(r(h)),h=0):g++,o>>=1;for(;;){if(h<<=1,g==t-1){m.push(r(h));break}g++}return m.join("")},decompress:function(e){return null==e?"":""==e?null:i._decompress(e.length,32768,(function(t){return e.charCodeAt(t)}))},_decompress:function(t,r,n){var o,i,a,s,c,u,l,d=[],f=4,p=4,m=3,h="",g=[],y={val:n(0),position:r,index:1};for(o=0;o<3;o+=1)d[o]=o;for(a=0,c=Math.pow(2,2),u=1;u!=c;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=r,y.val=n(y.index++)),a|=(s>0?1:0)*u,u<<=1;switch(a){case 0:for(a=0,c=Math.pow(2,8),u=1;u!=c;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=r,y.val=n(y.index++)),a|=(s>0?1:0)*u,u<<=1;l=e(a);break;case 1:for(a=0,c=Math.pow(2,16),u=1;u!=c;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=r,y.val=n(y.index++)),a|=(s>0?1:0)*u,u<<=1;l=e(a);break;case 2:return""}for(d[3]=l,i=l,g.push(l);;){if(y.index>t)return"";for(a=0,c=Math.pow(2,m),u=1;u!=c;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=r,y.val=n(y.index++)),a|=(s>0?1:0)*u,u<<=1;switch(l=a){case 0:for(a=0,c=Math.pow(2,8),u=1;u!=c;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=r,y.val=n(y.index++)),a|=(s>0?1:0)*u,u<<=1;d[p++]=e(a),l=p-1,f--;break;case 1:for(a=0,c=Math.pow(2,16),u=1;u!=c;)s=y.val&y.position,y.position>>=1,0==y.position&&(y.position=r,y.val=n(y.index++)),a|=(s>0?1:0)*u,u<<=1;d[p++]=e(a),l=p-1,f--;break;case 2:return g.join("")}if(0==f&&(f=Math.pow(2,m),m++),d[l])h=d[l];else{if(l!==p)return null;h=i+i.charAt(0)}g.push(h),d[p++]=i+h.charAt(0),i=h,0==--f&&(f=Math.pow(2,m),m++)}}};return i}();void 0===(n=function(){return o}.call(t,r,t,e))||(e.exports=n)},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n,o=r(0),i=r(124),a=r(13),s=r(12),c=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),u=function(){return(u=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},l=function(e){function t(t){var r=e.call(this,t)||this;return r.mounted=!1,r.state={PrivacyUrl:"https://go.microsoft.com/fwlink/?LinkId=521839"},r.refreshPrivacy=r.refreshPrivacy.bind(r),r}return c(t,e),t.prototype.componentDidMount=function(){this.mounted=!0,this.refreshPrivacy()},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.render=function(){var e={className:a.x()?"office-form-theme-spo-link":void 0,href:this.state.PrivacyUrl,target:"_blank"};return o.createElement("div",{className:this.props.Multiline?"office-form-footer-block":"office-form-footer-inline"},o.createElement("a",u({},e),this.props.LocalizedStrings.Form_Footer_PrivacyStatement))},t.prototype.refreshPrivacy=function(){var e=this;Object(i.b)().done((function(t){e.mounted&&e.setState({PrivacyUrl:t||""})}))},t}(s.a)},,function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n,o=r(4),i=r(1),a=r(8),s=r(72),c=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),u={BackgroundColor:i.a.string({IsLocalField:!0}),BackgroundImage:i.a.string({IsLocalField:!0}),Name:i.a.string(),PrimaryColor:i.a.string({IsLocalField:!0}),SecondaryColor:i.a.string({IsLocalField:!0}),Thumbnail:i.a.string({IsLocalField:!0})},l=function(e){function t(t){var r=e.call(this,t)||this;if(t.MasterTreeReady){var n=a.c.Schema;t.MasterTreeReady.then((function(){return r.Form.fieldsReady([n.Theme])})).then((function(){return r.Form.ensureFieldsReady([n.PrimaryCustomizedThemeColor,n.SecondaryCustomizedThemeColor,n.TertiaryCustomizedThemeColor,n.Background])})).done((function(){return r.initialize()}))}return r}return c(t,e),Object.defineProperty(t.prototype,"Form",{get:function(){return this.Parent},enumerable:!0,configurable:!0}),t.prototype.isCustomized=function(){return this.Model.Name===s.b},t.prototype.getCustomizedTheme=function(){var e=this.Form.Model;return{BackgroundColor:e.TertiaryCustomizedThemeColor||s.c.BackgroundColor,BackgroundImage:e.Background.ResourceUrl,Name:s.b,PrimaryColor:e.PrimaryCustomizedThemeColor||s.c.PrimaryColor,SecondaryColor:e.SecondaryCustomizedThemeColor||s.c.SecondaryColor,Thumbnail:null}},t.prototype.initialize=function(){var e=this;this.addRule({Name:"calculate theme basing on name",onChange:function(t){t.BeingDeleted||e.calculateThemeProperties()}});var t=a.c.Schema;this.Form.observe((function(){return e.calculateThemeProperties()}),[t.PrimaryCustomizedThemeColor,t.SecondaryCustomizedThemeColor,t.TertiaryCustomizedThemeColor,t.Background.ResourceUrl]),this.calculateThemeProperties()},t.prototype.calculateThemeProperties=function(){var e=this,t=this.Model.Name;t===s.b?this.setData(this.getCustomizedTheme()):Object(s.d)(t).done((function(t){return e.setData(t)}))},t}(o.a.createObjectMasterClass("FormTheme",u))},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){function e(e){this.prefetchDeferred=$.Deferred(),this.cache=e}return e.prototype.init=function(){if(this.cache)switch(this.cache.state){case 3:this.onPrefetchSucceed();break;case 4:this.onPrefetchFaied();break;case 2:this.cache.successCallback=this.onPrefetchSucceed.bind(this),this.cache.errorCallback=this.onPrefetchFaied.bind(this);break;default:this.fallBackToNormalBoot()}else this.fallBackToNormalBoot()},e.prototype.getPromise=function(){return this.prefetchDeferred.promise()},e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n=r(0),o=r(15),i=r(256),a=r(248),s=r(257),c=r(250),u=r(252),l=r(253),d=r(254),f=r(255);function p(e,t){h[e]=t}function m(e){var t=e.Master.Question.Model.Type,r=h[t];if(r)return n.createElement(r,e);throw Error('Type "'+t+'" has not been registered.')}var h={};p(o.a.TextField,f.a),p(o.a.Rating,d.a),p(o.a.Ranking,l.a),p(o.a.NPS,u.a),p(o.a.MatrixChoiceGroup,c.a),p(o.a.FileUpload,s.a),p(o.a.DateTime,a.a),p(o.a.Choice,i.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return u}));var n,o,i=r(3),a=r(100);!function(e){e.FP_CreateFormMasterStart="forms.boot.create.fm.start",e.FP_ParseFormResponseStart="forms.boot.parse.rf.start",e.FP_RenderResponseFormStart="forms.boot.render.rf.start",e.FP_ParseResourceStringStart="forms.boot.parse.rs.start"}(n||(n={})),function(e){e.FP_CreateFormMaster="forms.boot.create.fm",e.FP_ParseFormResponse="forms.boot.parse.rf",e.FP_RenderResponseForm="forms.boot.render.rf",e.FP_ParseResourceString="forms.boot.parse.rs"}(o||(o={}));var s=window.performance,c=function(){function e(){}return e.mark=function(e){s&&s.mark(e)},e.measure=function(e,t){s&&s.measure(e,t)},e.getMeasures=function(){var e=[];return s&&Object.keys(o).forEach((function(t){var r=s.getEntriesByName(o[t]);r&&1===r.length&&e.push({duration:Math.round(r[0].duration),name:r[0].name,startTime:Math.round(r[0].startTime)})})),e},e}();function u(e){if(e&&e.Model.Questions){var t=e.Model.Questions,r={};i.forEach(t,(function(e){var t=e.Type;t&&(t=t.substr(t.indexOf(".")+1),r[t]?r[t]++:r[t]=1)})),r.Total=t.length,a.a.setExtraData("questionCount",r)}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n,o,i=r(6),a=r(9),s=r(54),c=r(43);function u(e){try{return $.when(function(e){n&&n.state()!==c.a.State.Rejected||(n=Object(s.l)(e).done((function(){Object(a.a)({eventName:"AddinPage.PageMethod.GetAddinUserInfoSuccess",eventType:"engagement_event"})})).fail((function(e){Object(a.a)({eventName:"AddinPage.PageMethod.GetAddinUserInfoFailed",eventType:"engagement_event",extraData:{error:e}})})));return n}(e),function(e){o&&o.state()!==c.a.State.Rejected||(o=Object(s.j)(e).done((function(){Object(a.a)({eventName:"AddinPage.PageMethod.GetFlightsSuccess",eventType:"engagement_event"})})).fail((function(e){Object(a.a)({eventName:"AddinPage.PageMethod.GetFlightsFailed",eventType:"engagement_event",extraData:{error:e}})})).always((function(){return Object(i.a)().setFlightsBasingOnAuth_Deprecated(OfficeFormServerInfo.flights)})));return o}(e))}catch(e){return Object(a.a)({eventName:"TeamsTab.Auth.RefreshInfoFailed",eventType:"engagement_event"}),$.Deferred().resolve().promise()}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n,o=r(2),i=r(52),a=r(10),s=r(15),c=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.getElementTypeName=function(){return s.a.MatrixChoiceGroup},t.createDefaultDefinition=function(){var e=[{Description:o.a.LocalizedStrings.Designer_Choices_DefaultDescription.format(1),IsGenerated:!0,Id:1,Order:1},{Description:o.a.LocalizedStrings.Designer_Choices_DefaultDescription.format(2),IsGenerated:!0,Id:2,Order:2},{Description:o.a.LocalizedStrings.Designer_Choices_DefaultDescription.format(3),IsGenerated:!0,Id:3,Order:3},{Description:o.a.LocalizedStrings.Designer_Choices_DefaultDescription.format(4),IsGenerated:!0,Id:4,Order:4},{Description:o.a.LocalizedStrings.Designer_Choices_DefaultDescription.format(5),IsGenerated:!0,Id:5,Order:5}];return{Type:t.getElementTypeName(),Title:o.a.LocalizedStrings.Question_DefaultTitle,ChoiceGroup:e,QuestionTagForIntelligence:"Unknown",IsFromSuggestion:!1}},t.createSubQuestionsDefinition=function(){return[{Title:o.a.LocalizedStrings.Desinger_Likert_DefaultDescription.format(1),Type:"Question.MatrixChoice"},{Title:o.a.LocalizedStrings.Desinger_Likert_DefaultDescription.format(2),Type:"Question.MatrixChoice"}]},t.prototype.verify=function(e){return a.e.Success},t.prototype.getTypeDisplayName=function(){return o.a.LocalizedStrings.QuestionType_Likert},t.prototype.hasAnswer=function(){return!1},t}(i.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(47),o=r(100),i=function(){function e(){}return e.startNavigationInPage=function(t){e.navigationStartTime=Date.now(),e.isNavigating=!0,e.isModelCached=t},e.getExtraDataToLogAndReset=function(){var t=e.getNavigationStartTime(),r={};return"boot"===e.getNavigationType()&&(r=o.a.getExtraDataToLog()),r.navigationStart=t,r.cached=e.isModelCached,r.type=e.getNavigationType(),r.formRenderEnd=n.a.getTimeStamp(),e.reset(),r},e.getNavigationStartTime=function(){return e.navigationStartTime>0?e.navigationStartTime:window.performance?window.performance.timing.navigationStart:Number.NaN},e.getNavigationType=function(){return e.navigationStartTime>0?"withinPage":"boot"},e.reset=function(){e.isNavigating=!1,e.isModelCached=!1,e.navigationStartTime=0},e.isNavigating=!0,e.isModelCached=!1,e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return u}));var n,o=r(0),i=r(2),a=r(5),s=r(7),c=r(71);function u(e,t,r,u,l,d,f,p,m,h,g,y){var b,v={className:"office-form-rating-container-"+(b=e===n.Star?"star":"number")+" container-margin-right"},S={className:"office-form-rating-container-"+b+" container-margin-left"};""===r&&(v.className=a.a.combineAttributes(v.className,"container-empty")),p===m&&(v.className=a.a.combineAttributes(v.className,"container-"+b+"-max-width"),S.className=a.a.combineAttributes(S.className,"container-"+b+"-max-width"));var I=Object(c.b)({Text:Object(s.c)((function(){return r}),(function(){return g||r})),RenderMode:"RichText",ContainsHtml:!0}),M=Object(c.b)({Text:Object(s.c)((function(){return u}),(function(){return y||u})),RenderMode:"RichText",ContainsHtml:!0}),F=Object(s.c)((function(){return o.createElement("div",v,o.createElement("div",{className:"office-form-question-rating-description-"+b},r))}),(function(){return o.createElement("div",v,o.createElement("div",{className:"office-form-question-rating-description-"+b},I))})),O=Object(s.c)((function(){return o.createElement("div",S,o.createElement("div",{className:"office-form-question-rating-description-"+b},u))}),(function(){return o.createElement("div",S,o.createElement("div",{className:"office-form-question-rating-description-"+b},M))}));if(r||u){var C=r,P=u;Object(s.e)((function(){C=C?C.replace(/<[^>]*>/g,""):C,P=P?P.replace(/<[^>]*>/g,""):P}));var T=o.createElement("div",{className:"office-form-response-rating-description"},o.createElement("div",{className:"office-form-rating-description-label"},l),o.createElement("div",{className:"rating-option-description"},i.a.LocalizedStrings.Colon.format(C))),w=o.createElement("div",{className:"office-form-response-rating-description"},o.createElement("div",{className:"office-form-rating-description-label"},d),o.createElement("div",{className:"rating-option-description"},i.a.LocalizedStrings.Colon.format(P))),_=o.createElement("div",{className:"office-form-rating-description-container",id:h},T,w);return[o.createElement("div",{className:"office-form-question-rating-container",key:"container",ref:t},F,f,O),_]}return[o.createElement("div",{className:"office-form-question-rating-container",key:"container",ref:t},F,f,O)]}!function(e){e[e.Star=0]="Star",e[e.Number=1]="Number"}(n||(n={}))},,function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(6),o=r(184),i=r(119),a=function(){function e(){}return e.prototype.getFormApiToken=function(){return this.getAuthenticator().getFormApiToken()},e.prototype.handleAuthForContentPage=function(e){return this.getAuthenticator().handleAuthForContentPage(e)},e.prototype.handleAuthForAddinPage=function(){return this.getAuthenticator().handleAuthForAddinPage()},e.prototype.hasUserLoggedIn=function(){return this.getAuthenticator().hasUserLoggedIn()},e.prototype.isValid=function(){return this.getAuthenticator().isValid()},e.prototype.redirectToLogin=function(){return this.getAuthenticator().redirectToLogin()},e.prototype.refreshToken=function(){return this.getAuthenticator().refreshToken()},e.prototype.signIn=function(){return this.getAuthenticator().signIn()},e.prototype.signOut=function(){return this.getAuthenticator().signOut()},e.prototype.getAuthenticator=function(){return this.authenticator||(Object(n.a)().Flighting.isEnabled("CookieAuth")?this.authenticator=new i.a:this.authenticator=new o.a),this.authenticator},e}()},,,function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n,o,i=r(26);function a(e){return(n&&"rejected"!==n.state()||(n=Object(i.b)().getOD4BToken()),n).then(e).then((function(e){return e}),(function(t){return t&&t.response&&t.response.statusCode===o.Unauthorized?(n&&"pending"===n.state()||(n=Object(i.b)().getOD4BToken()),n).then(e):t}))}!function(e){e[e.Unauthorized=401]="Unauthorized"}(o||(o={})),FormsPro.sendRequestWithToken=a},function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n,o,i=r(0),a=r(21),s=r(30),c=r(6),u=r(9),l=r(127),d=r(12),f=r(204),p=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),m=function(){return(m=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};!function(e){e[e.Loading=0]="Loading",e[e.Success=1]="Success",e[e.Error=2]="Error"}(o||(o={}));var h=function(e){function t(t){var r=e.call(this,t)||this;return r.state={ImageLoadStatus:o.Loading,RetryCount:0},r.onLoad=r.onLoad.bind(r),r.onError=r.onError.bind(r),r.updateImage=r.updateImage.bind(r),r}return p(t,e),t.prototype.componentDidMount=function(){var e=s.b.Schema;this.props.ImageInfoMaster.observe(this.updateImage,[e.AltText,e.ResourceId,e.ResourceUrl])},t.prototype.componentWillUnmount=function(){this.retryTimeId&&window.clearTimeout(this.retryTimeId),this.props.ImageInfoMaster.unobserve(this.updateImage)},t.prototype.render=function(){var e,r;this.props.FullFilled?(e="100%",r="auto"):(e=this.props.ImageWidth||a.a.ImagePlaceHolderWidth,r=this.props.ImageHeight||a.a.ImagePlaceHolderHeight);var n,s,c=this.state.RetryCount,u=this.props.ImageInfoMaster.Model,l=u.ResourceUrl;this.state.ImageLoadStatus===o.Error&&c>0&&(l+="?"+c),this.showSpinner()?s=t.createSpinner():this.state.ImageLoadStatus===o.Success&&(n="visiable");var d=u.AltText||"";return i.createElement("div",{className:"office-form-title-image-box"},i.createElement("img",{alt:d,className:n,height:r,onError:this.onError,onLoad:this.onLoad,src:l,title:d,width:e}),s,i.createElement(f.a,null,this.props.ImageInfoMaster.Model.AltText))},t.prototype.showSpinner=function(){var e=this.props.ImageInfoMaster.Model,t=this.props.ImageSettingMaster.Model;return this.state.ImageLoadStatus!==o.Success||e.ResourceId!==t.TargetResourceId||e.ImageProcessingStatus!==s.c.Idle},t.createSpinner=function(){var e;if(Object(c.a)().Flighting.isEnabled("FromsSpinnerControl")){e=i.createElement(l.a,m({},{ClassName:"designPage-question-titleLoadImage-spinner",Ignorable:!1}))}else e=i.createElement("div",{className:"spinner-tile-animation"});return i.createElement("div",{className:"image-spinner"},e)},t.prototype.onLoad=function(){Object(u.a)({eventName:"Image.ImageOnLoad.Success",eventType:"engagement_event",extraData:{imageType:this.props.ImageType,location:"1"}}),this.setState({ImageLoadStatus:o.Success})},t.prototype.onError=function(){var e=this,t=this.state.RetryCount;t<3?this.retryTimeId=window.setTimeout((function(){return e.setState({RetryCount:++t})}),1e3):(Object(u.a)({eventName:"Image.ImageOnLoad.Failure",eventType:"engagement_event",extraData:{imageSrc:this.props.ImageInfoMaster.Model.ResourceUrl,imageType:this.props.ImageType,location:"1"}}),this.setState({ImageLoadStatus:o.Error}))},t.prototype.updateImage=function(){this.forceUpdate()},t}(d.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){function e(){this.initialVisibility=document.visibilityState,this.initializeTime=new Date,this.onVisibilityChange=this.onVisibilityChange.bind(this),document.addEventListener("visibilitychange",this.onVisibilityChange)}return e.prototype.stop=function(){document.removeEventListener("visibilitychange",this.onVisibilityChange)},e.prototype.onVisibilityChange=function(){this.visiToggleTime=new Date},e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n,o=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t}(Error)},,,function(e,t,r){"use strict";var n=r(0),o=r(20),i=r(3),a=r(2),s=function(){function e(){}return e.getId=function(t){return e.currentIds[t]||(e.currentIds[t]=1),t+e.currentIds[t]++},e.getLabelId=function(){return e.getId("l")},e.getDropdownId=function(){return e.getId("Dropdown")},e.currentIds={},e}(),c=r(5),u=r(13),l=r(7),d=r(17),f=r(101),p=r(164);r.d(t,"a",(function(){return g}));var m,h=(m=function(e,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}m(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function g(e){return n.createElement(y,e)}var y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.containerRef=n.createRef(),t.currentConfig=t.getRateitConfig(),t.containerWidth=0,t.needSync=!1,t}return h(t,e),t.prototype.createReactNodes=function(){var e=this.props,t={className:"rateit margin-left office-form-theme-primary-foreground","data-rateit-icon":"","data-rateit-iconforempty":"","data-rateit-mode":"font","data-rateit-marginleft":this.currentConfig.MarginLeft,"data-rateit-marginright":this.currentConfig.MarginRight,"data-rateit-starwidth":this.currentConfig.FontSize,"data-rateit-max":e.Length,"data-rateit-value":e.Value,"data-rateit-step":1,"data-rateit-resetable":!1,"data-rateit-ispreset":!0,style:{fontSize:this.currentConfig.FontSize},ref:"rateit",key:"rateit"},r=n.createElement("div",t);return e.ShowRatingLabel?Object(p.b)(p.a.Star,this.containerRef,e.LeftDescription,e.RightDescription,e.LeftDescriptionTitle,e.RightDescriptionTitle,r,e.Length,10,this.ratingDescriptionId,Object(l.e)((function(){return e.FormsProRTLeftDescription})),Object(l.e)((function(){return e.FormsProRTRightDescription}))):[n.createElement("div",{className:"office-form-question-rating-container",key:"container",ref:this.containerRef},r)]},t.prototype.componentWillMount=function(){this.ratingDescriptionId=s.getLabelId(),this.adjustStarStyleWhenResize=this.adjustStarStyleWhenResize.bind(this)},t.prototype.componentDidMount=function(){this.initialzeRateit(),window.addEventListener("resize",this.adjustStarStyleWhenResize),this.needSyncToRateIt()?this.forceUpdate():this.updateRatingAttributes()},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.adjustStarStyleWhenResize)},t.prototype.componentDidUpdate=function(e){this.needSyncToRateIt()?this.forceUpdate():this.updateRatingAttributes(e)},t.prototype.needSyncToRateIt=function(){var e=this.containerRef.current;if(e&&e.clientWidth>0){this.containerWidth=e.clientWidth;var t=this.getRateitConfig();if(!i.isEqual(t,this.currentConfig))return this.currentConfig=t,this.needSync=!0,!0}return!1},t.prototype.initialzeRateit=function(){var e=this,t=this.props,r=$(o.findDOMNode(this.refs.rateit));r.rateit(),r.on("rated",(function(){return t.onValueChange(r.rateit("value"))})),r.on("over",(function(t,r){return e.updateTooltip(r)}));var n=r.find(".rateit-range");if(n&&t.Options&&t.Options.HTMLPropsForInnerElement)for(var i in n.removeAttr("aria-label"),t.Options.HTMLPropsForInnerElement)n.attr(i,t.Options.HTMLPropsForInnerElement[i]);if(n){var a=n.attr("aria-labelledby");a&&(a=c.a.combineAttributes(a,this.ratingDescriptionId),n.attr("aria-labelledby",a))}},t.prototype.adjustStarStyleWhenResize=function(){var e=this;this.resizeTimeId||(this.resizeTimeId=window.setTimeout((function(){e.resizeTimeId=null,e.needSyncToRateIt()&&e.forceUpdate()}),100))},t.prototype.updateRatingAttributes=function(e){var t=$(o.findDOMNode(this.refs.rateit));if(!this.needSync&&e&&this.props.Disabled==e.Disabled&&this.props.Value===e.Value&&this.props.Length===e.Length||(this.needSync=!1,t.rateit("batchUpdate",{value:this.props.Value,max:this.props.Length,readonly:this.props.Disabled,starwidth:this.currentConfig.FontSize,marginleft:this.currentConfig.MarginLeft,marginright:this.currentConfig.MarginRight}),this.updateTooltip()),this.props.NoTabFocus){var r=t.find(".rateit-range");r&&r.removeAttr("tabindex")}t.children(".rateit-range").removeAttr("aria-readonly"),this.checkRatingValue()},t.prototype.updateTooltip=function(e){e=e||this.props.Value||0;var t=$(o.findDOMNode(this.refs.rateit)),r=a.a.LocalizedStrings.Renderer_RatingControlText.format(e);t.attr("title",r)},t.prototype.getRateitConfig=function(){var e={MarginLeft:4,MarginRight:4,FontSize:24};if(this.containerWidth>0)if(this.isMobile()){e.MarginLeft=4;var t=this.props.Length,r=t>6?24:28;e.FontSize=r,e.MarginRight=t<4?27:(this.containerWidth-e.MarginLeft*(t+1)-r*t)/(t-1)}else if(this.containerWidth>380)return{MarginLeft:5,MarginRight:5,FontSize:this.props.Compact?24:28};return e},t.prototype.checkRatingValue=function(){this.props.Value>this.props.Length&&d.a.logData({name:"DesignPage.Questions.RatingValueOutOfBounds",extraData:{operation:"RatingValueOutOfBounds"}})},t.prototype.isMobile=function(){return this.props.IsMobile||u.t()},t}(f.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n,o=r(2),i=r(68),a=r(52),s=r(10),c=r(15),u=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.getElementTypeName=function(){return c.a.FileUpload},t.createDefaultDefinition=function(){var e=i.b;return{Type:t.getElementTypeName(),Title:o.a.LocalizedStrings.Question_DefaultTitle,HasSpecificFileType:!1,FileTypes:{Word:!0,Excel:!0,PowerPoint:!0,PDF:!0,Image:!0,Video:!0,Audio:!0},QuestionTagForIntelligence:"Unknown",IsFromSuggestion:!1,MaxFileCount:1,MaxFileSize:e[Object.keys(e)[0]]}},t.prototype.verify=function(e){return this.Model.Required&&!e?s.e.RequiredError:s.e.Success},t.prototype.getTypeDisplayName=function(){return o.a.LocalizedStrings.QuestionType_UploadFile},t}(a.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n,o=r(2),i=r(52),a=r(10),s=r(15),c=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.getElementTypeName=function(){return s.a.NPS},t.createDefaultDefinition=function(){return{Type:t.getElementTypeName(),Title:o.a.LocalizedStrings.NPS_DefaultTitle,LeftDescription:o.a.LocalizedStrings.NPS_LeftDescription,RightDescription:o.a.LocalizedStrings.NPS_RightDescription,QuestionTagForIntelligence:"Unknown",IsFromSuggestion:!1}},t.prototype.verify=function(e){return this.Model.Required&&!e&&0!==e?a.e.RequiredError:a.e.Success},t.prototype.getTypeDisplayName=function(){return o.a.LocalizedStrings.QuestionType_NPS},t.prototype.isNumberType=function(){return!0},t}(i.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n,o=r(3),i=r(4),a=r(2),s=r(27),c=r(52),u=r(10),l=r(15),d=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d(t,e),t.getElementTypeName=function(){return l.a.Ranking},t.createDefaultDefinition=function(){var e=[{Description:a.a.LocalizedStrings.Designer_Choices_DefaultDescription.format(1),Order:1,Key:s.a.newGuid()},{Description:a.a.LocalizedStrings.Designer_Choices_DefaultDescription.format(2),Order:2,Key:s.a.newGuid()},{Description:a.a.LocalizedStrings.Designer_Choices_DefaultDescription.format(3),Order:3,Key:s.a.newGuid()}];return{Type:t.getElementTypeName(),Title:a.a.LocalizedStrings.Question_DefaultTitle,AllowMultipleValues:!0,ChoiceGroup:e,QuestionTagForIntelligence:"Unknown",IsFromSuggestion:!1}},t.prototype.verify=function(e){return!this.Model.Required||e&&0!==e.length?u.e.Success:u.e.RequiredError},t.prototype.getTypeDisplayName=function(){return a.a.LocalizedStrings.QuestionType_Ranking},t.prototype.isCorrectAnswer=function(e){var t=this;if(!e)return!1;var r,n=JSON.parse(this.Model.GradingBasis);r=o.isString(e)?JSON.parse(e):o.map(o.sortBy(e,(function(e){return e.answerOrder})),(function(e){return e.id}));var i=o.map(n,(function(e){return o.findWhere(t.Model.ChoiceGroup,{Key:e}).Id}));return r.length===i.length&&o.isEqual(i,r)},t.prototype.createQuizResult=function(e){if(this.Model.IsQuiz)return{IsAnswerCorrect:this.isCorrectAnswer(e),GradingBasis:this.Model.GradingBasis}},t.prototype.autoGradeAnswer=function(e){var t=this.Model.Point||0;e.Score=this.isCorrectAnswer(e.Answer)?t:0,e.IsAutoGraded=!0},t.prototype.autoGradeWithQuizResult=function(e,t){return t?t.IsAnswerCorrect?this.Model.Point:0:null},t.prototype.getNormalizedAnswer=function(e){return e||[]},t.prototype.hasCorrectAnswers=function(e){return!0},t.prototype.redressGradingBasis=function(){var e=this;this.Master.fieldsReady([u.d.Schema.ChoiceGroup,u.d.Schema.GradingBasis]).done((function(){var t=i.a.convertToArray(e.Master.Model.ChoiceGroup).sort((function(e,t){return e.Order-t.Order})).map((function(e){return e.Key}));e.Master.Model.GradingBasis=JSON.stringify(t)}))},t}(c.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return m}));var n,o=r(0),i=r(3),a=r(2),s=r(27),c=r(5),u=r(7),l=r(12),d=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),f=function(){return(f=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},p=function(e){function t(r){var n=e.call(this,r)||this;return n.popUpRef=o.createRef(),n.uuid=s.a.newGuid(),n.options=t.createNPSOptions(),n.valueChangeCallback=function(e){var t=n.props.onValueChange;t&&t(parseInt(e.currentTarget.value,10))},n.inputOnFocusCallback=function(e){n.setState({FocusValue:parseInt(e.currentTarget.value,10)})},n.inputOnBlurCallback=function(){n.setState({FocusValue:void 0})},n.touchStartCallback=function(e){return n.touchStart(e)},n.touchMoveCallback=function(){return n.canceled=!0},n.touchCancelCallback=function(e){n.canceled=!1,n.setState({Touch:-1})},n.touchEndCallback=function(e){return n.touchEnd(e)},n}return d(t,e),t.prototype.render=function(){var e="nps-control clearfix unselectable-text",t="nps-control-table reset";this.props.Disabled||(t=c.a.combineAttributes(t,"enabled"));var r=this.props.HTMLAttributes,n={};return r&&(e=c.a.combineAttributes(e,r.className),i.extend(n,r)),n.className=t,o.createElement("div",{className:e,role:"radiogroup"},this.createPopUp(),o.createElement("table",f({},n),this.createThead(),this.createTbody()),this.props.LeftLabel||this.props.RightLabel?this.createLabels():void 0)},t.prototype.createPopUp=function(){var e=this.state.Touch,t=c.a.combineAttributes(void 0!==e&&-1!==e?"nps-pop-up show":"nps-pop-up",this.props.ClassNameForInnerLabel,e===this.props.Value?"active":"");return o.createElement("div",{className:t,ref:this.popUpRef},o.createElement("span",{className:"nps-pop-up-text"},this.state.Touch))},t.prototype.createLabels=function(){var e=this;return Object(u.c)((function(){return o.createElement("div",{className:"nps-control-label-container clearfix"},o.createElement("div",{className:"left-label"},o.createElement("span",null,e.props.LeftLabel)),o.createElement("div",{className:"right-label"},o.createElement("span",null,e.props.RightLabel)))}),(function(){var t=u.a.sanitizeRichTextHTML(e.props.LeftLabel),r=u.a.sanitizeRichTextHTML(e.props.RightLabel);return o.createElement("div",{className:"nps-control-label-container clearfix"},o.createElement("div",{className:"left-label"},o.createElement(u.a.RichtTextControl,{HTMLContent:t})),o.createElement("div",{className:"right-label"},o.createElement(u.a.RichtTextControl,{HTMLContent:r})))}))},t.createNPSOptions=function(){for(var e=[],t=0;t<11;t++)e.push({DisplayName:m(t),Key:t,Value:t});return e},t.prototype.createThead=function(){return o.createElement("thead",null,o.createElement("tr",{className:"nps-head-row"},this.options.map((function(e){return o.createElement("th",{className:"nps-head-column",key:e.Key},e.Value)}))))},t.prototype.createTbody=function(){var e=this,t=this.options.map((function(t,r){return e.createTd(t,r)}));return o.createElement("tbody",null,o.createElement("tr",null,t))},t.prototype.createTd=function(e,t){var r=this.props.Value,n=this.props.Disabled;i.isString(r)&&(r=parseInt(r,10));var a=r===e.Value,s="nps-"+this.uuid+"-"+e.Value,u={"aria-label":e.Value.toString(),"aria-posinset":t+1,"aria-setsize":this.options.length,checked:a,disabled:this.props.Disabled,id:s,name:"nps-"+this.uuid,type:"radio",value:e.Value},l={htmlFor:s};return n||(i.extend(u,{onBlur:-1===this.state.Touch?void 0:this.inputOnBlurCallback,onChange:this.valueChangeCallback,onFocus:-1===this.state.Touch?void 0:this.inputOnFocusCallback}),i.extend(l,{htmlFor:s,onTouchCancel:this.touchCancelCallback,onTouchEnd:this.touchEndCallback,onTouchMove:this.touchMoveCallback,onTouchStart:this.touchStartCallback})),l.className=c.a.combineAttributes("answer-label",void 0!==this.state.Touch?"touch":"",this.props.ClassNameForInnerLabel,a?"active":"",this.state.FocusValue===e.Value?"focus":""),o.createElement("td",{key:e.Key,className:"radio-button-item"},o.createElement("div",{className:"radio-button"},o.createElement("input",f({},u)),o.createElement("label",f({},l),o.createElement("span",{"data-text":e.Value,className:"radio-button-display"}))))},t.prototype.touchStart=function(e){var t=e.currentTarget,r=this.popUpRef.current,n=r.parentElement.getBoundingClientRect(),o=t.getBoundingClientRect(),i=o.width/2,a=o.height/2;r.style.left=o.left-n.left-i/2+"px",r.style.top=o.top-n.top-a/2+"px",r.style.width=o.width+i+"px",r.style.height=o.height+a+"px";var s=t.firstElementChild;this.setState({Touch:parseInt(s.dataset.text,10)})},t.prototype.touchEnd=function(e){var t=this;if(this.canceled)this.canceled=!1,this.setState({Touch:-1});else{var r=this.state.Touch;this.setState({Touch:-1},(function(){var e=t.props.onValueChange;e&&e(r)}))}e.preventDefault()},t}(l.a);function m(e){return e<7?a.a.LocalizedStrings.NPS_Detractors:e>8?a.a.LocalizedStrings.NPS_Promoters:a.a.LocalizedStrings.NPS_Passives}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return i}));var n=r(35);function o(){var e=n.a.DefaultStorage.getItem("officeforms.userAccountNameKey");return e&&JSON.parse(e)}function i(e){n.a.DefaultStorage.setItem("officeforms.userAccountNameKey",JSON.stringify(e))}},function(e,t,r){"use strict";function n(e){var t=function(e){if(!e)return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);if(!t||t.length<4)return null;return{header:t[1],JWSPayload:t[2],JWSSig:t[3]}}(e);if(!t)return null;try{var r=function(e){return e=e.replace(/-/g,"+").replace(/_/g,"/"),decodeURIComponent(encodeURI(window.atob(e)))}(t.JWSPayload);return r?JSON.parse(r):null}catch(e){}return null}r.d(t,"a",(function(){return n}))},,function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(79),o=function(){function e(e,t,r,n){this.serviceUrl=e+"intelligence/api/",this.ownerServiceUrl=t&&r&&n?""+this.serviceUrl+t+"/"+n+"/"+r+"/":""+this.serviceUrl}return e.prototype.getInsights=function(e,t,r){return Object(n.a)({method:"GET",qosEventName:"Intelligence.GetInsights",requestUri:this.ownerServiceUrl+"forms('"+e+"')/getinsights("+t+","+r+")"})},e.prototype.getDefaultInsights=function(e){return Object(n.a)({method:"GET",qosEventName:"Intelligence.GetDefaultInsights",requestUri:this.ownerServiceUrl+"forms('"+e+"')/defaultinsights"})},e.prototype.getOptionToOptionSuggestion=function(e,t,r){return Object(n.a)({body:JSON.stringify({existingOptions:e,variation:r}),method:"POST",qosEventName:"Ingelligence.GetOptionToOptionSuggestion",qosExtraData:{feature:t,variation:r},requestUri:this.ownerServiceUrl+"getOptionToOptionSuggestion"})},e.prototype.getHistorySuggestion=function(e,t){var r=OfficeFormServerInfo.userInfo,o=r&&r.TenantId,i=r&&r.UserId,a=""+this.serviceUrl+o+"/users/"+i+"/getHistoryFormSuggestion";return Object(n.a)({body:JSON.stringify({Text:e,FormId:t}),method:"POST",qosEventName:"Ingelligence.GetHistorySuggestion",requestUri:a})},e.prototype.predictResponseTime=function(e){var t=this.serviceUrl+"PredictResponseTime";return Object(n.a)({body:JSON.stringify(e),method:"POST",qosEventName:"Intelligence.PredictResponseTime",requestUri:t})},e.prototype.textAnalyze=function(e){return this.textAnalyzeWithFeatures(256,e)},e.prototype.textAnalyzeWithFeatures=function(e,t){if(!t){return $.Deferred().resolve({Features:0,Results:[]}).promise()}return Object(n.a)({body:JSON.stringify({Features:e,Text:t}),method:"POST",qosEventName:"Question.TextAnalysis",qosExtraData:{Features:e},requestUri:this.ownerServiceUrl+"textanalysis3"})},e.prototype.logUserSignal=function(e){return Object(n.a)({body:JSON.stringify(e),method:"POST",qosEventName:"Intelligence.LogUserSignal",requestUri:this.serviceUrl+"LogUserSignal"})},e}()},function(e,t,r){"use strict";var n,o=r(3),i=r(6),a=r(9),s=r(11),c=r(35),u=r(28),l=r(180),d=r(48),f=r(172),p=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),m=function(e){function t(t){var r=e.call(this,t)||this;return r.name=d.a.AuthNoStorageError,r}return p(t,e),t}(f.a),h=r(74);r.d(t,"a",(function(){return v})),r.d(t,"b",(function(){return S}));var g,y,b,v=function(){function e(){}return e.prototype.getFormApiToken=function(){return Object(h.b)(g)},e.prototype.handleAuthForContentPage=function(e){var t=this;return y||(y=S().then((function(r){if(r.HasUserSignedIn)M();else if(e)return t.redirectToLogin()}))),y.promise()},e.prototype.handleAuthForAddinPage=function(){return y||(y=S().then((function(e){if(!e.HasUserSignedIn)return $.Deferred().reject().promise();M()}))),y},e.prototype.hasUserLoggedIn=function(){return!!g.getCachedUser()},e.prototype.isValid=function(){return!Object(i.a)().Flighting.isEnabled("CookieAuth")},e.prototype.redirectToLogin=function(){if(g.login(),b)return b;throw Error("redirectForAuthContextLogin not called.")},e.prototype.refreshToken=function(){},e.prototype.signIn=function(){return this.redirectToLogin()},e.prototype.signOut=function(){return g.config.postLogoutRedirectUri=window.location.href,g.logOut(),$.Deferred().resolve().promise()},e}();function S(){var e=c.a.supportsLocalStorage(),t=c.a.supportsSessionStorage();if(e||Object(a.a)({eventName:"Auth.LocalStorageNotSupported",eventType:"engagement_event",extraData:{supportsSessionStorage:t}}),!e&&!t)return $.Deferred().reject(new m("local storage or session storage can't be used")).promise();var r=Object(l.a)(),n="response_mode=form_post&msafed=0";r&&(n+="&username="+(r=JSON.stringify(r))),Object(i.a)().Flighting.isEnabled("WorkAroundImplicitGrantBreak")&&(n+="&response_type=id_token+token&resource="+s.a.getFormsResourceId());var u=window.location.origin,d={cacheLocation:e?"localStorage":"sessionStorage",clientId:s.a.getAadClientId(),displayCall:I,extraQueryParameter:n,instance:s.a.getAadInstance(),postLogoutRedirectUri:u,redirectUri:u,tenant:""};Object(i.a)().Flighting.isEnabled("WorkAroundImplicitGrantBreak")&&o.extend(d,{loginResource:s.a.getFormsResourceId()});var f=new AuthenticationContext(d),p=f.isCallback(window.location.hash);if(f.handleWindowCallback(),p)return $.Deferred().promise();if(!(g=f).getCachedUser())return $.Deferred().resolve({HasUserSignedIn:!1,UserSignedInBefore:!1}).promise();var h=$.Deferred();return g.acquireToken(s.a.getAadClientId(),(function(e,t){var r=!e&&!!t;r?"live.com"===g.getCachedUser().profile.idp&&(g.clearCache(),r=!1,Object(a.a)({eventName:"UnexpectedLiveId",eventType:"error_event"})):g.clearCache();h.resolve({HasUserSignedIn:r,UserSignedInBefore:!0})})),h.promise()}function I(e){if(b)throw Error("login in progress.");Object(u.f)(e);var t=$.Deferred();b=t.promise();window.setTimeout((function(){return t.reject()}),3e3)}function M(){var e=g.getCachedUser();if(e){var t=e.profile.oid;OfficeFormServerInfo.userInfo={DisplayName:e.profile.name,Email:e.profile.unique_name,GivenName:e.profile.given_name||e.profile.name&&e.profile.name.split(" ")[0],IsMsa:!1,PUID:t.replace(/-/g,"").substring(16),TenantId:e.profile.tid,Upn:e.profile.upn,UserId:t}}}},,function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(79),o=function(){function e(e){this.ownerServiceUrl=e}return Object.defineProperty(e,"OwnerCDBSliceFunctionName",{get:function(){return"CDBOwnerSlice"},enumerable:!0,configurable:!0}),e.prototype.getOwnerCDBSlice=function(){var t={method:"GET",qosEventName:"Push.GetOwnerDBSlice",requestUri:""+this.ownerServiceUrl+e.OwnerCDBSliceFunctionName};return Object(n.a)(t)},e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){function e(){this.buffer=[]}return e.prototype.setFunctionToCall=function(e){var t=this;if(this.functionToCall!==e)if(this.functionToCall=e,e){var r=this.buffer;delete this.buffer,r&&r.length&&r.forEach((function(e){return t.functionToCall.apply(void 0,e)}))}else this.buffer=this.buffer||[]},Object.defineProperty(e.prototype,"queue",{get:function(){return this.functionToCall?this.functionToCall:this.defaultQueue},enumerable:!0,configurable:!0}),e.prototype.defaultQueue=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.buffer.push(e)},e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n,o=r(5),i=r(9),a=r(11),s=function(){function e(e){var t=this;this.frozenValues={},this.tenantValuesReadiness=e.then((function(e){t.tenantValues=m(e)})),"pending"===this.tenantValuesReadiness.state()&&(this.valuesFromServer=m(OfficeFormServerInfo.flights))}return e.prototype.isEnabled=function(e){return this.isEnabledInternal(e)},e.prototype.isEnabledAsync=function(e){var t=this;if(!(e&&e in u))throw Error("Checking uninitialized flight "+e+".");return this.tenantValuesReadiness.then((function(){return t.isEnabledInternal(e)}))},e.prototype.isEnabled_Deprecated=function(e){return this.isEnabledInternal(e)},e.prototype.isEnabledInternal=function(e){var t=l[e];if("tenant"===t){if(!this.tenantValues){if(OfficeFormServerInfo.useDebugVersionScript)throw Error('Checking flight "'+e+'" before ready.');p(e)}t="environment"}switch(t){case"environment":if(e in this.frozenValues)return this.frozenValues[e];break;case"deprecated":this.tenantValues||p(e);break;default:throw Error("Checking uninitialized flight "+e+".")}var r=this.getFlightValue(e);return"environment"===t&&(this.frozenValues[e]=r),r},e.prototype.getFlightValue=function(e){var t=this;if(d[e]&&d[e].some((function(e){return t.isEnabledInternal(e)})))return!1;if(f[e]&&!f[e].every((function(e){return t.isEnabledInternal(e)})))return!1;var r=e.toUpperCase(),n=function(){if(h)return h;var e={};if(!a.a.isProduction()||a.a.isProdAlternative()){var t=o.a.getQueries().fo;Array.isArray(t)&&(t=t[t.length-1]),t&&t.split(";").forEach((function(t){"!"!==t[0]?e[t.toUpperCase()]=!0:(t=t.substr(1).toUpperCase(),e[t]=!1)}))}return h=e,e}();if(r in n)return n[r];var i=this.tenantValues||this.valuesFromServer;return e in i?i[e]:u[e]},e}();!function(e){e[e.AllOff=0]="AllOff",e[e.OnDevBox=1]="OnDevBox",e[e.OnDevBoxAndDaily=2]="OnDevBoxAndDaily",e[e.AllOnNonOSI=3]="AllOnNonOSI",e[e.AllOnButProd=4]="AllOnButProd",e[e.AllOn=5]="AllOn"}(n||(n={}));var c=function(){switch(a.a.getEnvironmentType()){case"DevHost":return n.OnDevBox;case"Daily":case"Drill":case"Pilot":case"Trial":return n.OnDevBoxAndDaily;case"Weekly":case"Hotfix":case"ProDaily":return n.AllOnNonOSI;case"Int":case"MSInt":return n.AllOnButProd;case"WWProd":case"MSProd":case"ProTip":case"USGovProd":case"USDoDProd":case"USGovGccProd":default:return n.AllOn}}(),u={},l={},d={},f={};function p(e){var t=new Error('Checking flight "'+e+'" before ready.');Object(i.a)({eventName:"UnstableFlightChecking",eventType:"error_event",extraData:{flightName:e,flightType:l[e],stack:t.stack}})}function m(e){var t={};return e&&e.split(";").forEach((function(e){"!"!==e[0]?t[e]=!0:(e=e.substr(1),t[e]=!1)})),t}var h=null;function g(e,t){u[e]=t>=c,l[e]="environment"}function y(e,t){u[e]=t>=c,l[e]="tenant"}function b(e,t){u[e]=t>=c,l[e]="deprecated"}var v=function(e,t){d[e]=t},S=function(e,t){f[e]=t};y("TestTenantFlight",n.AllOn),g("TestEnvironmentFlight",n.AllOn),g("TestEnvironmentFlight_Blocker",n.AllOff),b("TestDeprecatedFlight",n.AllOff),g("CookieAuth",n.AllOff),g("UpgradeUxStateModel",n.AllOn),g("SubmitTimeDistributionInsight",n.AllOff),g("EnableNPSKeywordsInsight",n.AllOff),g("EnablePartialOrderInsight",n.AllOff),g("EnableResponseSentimentInsight",n.AllOff),b("EnableMsaContentValidation",n.AllOff),y("ResponseInApp",n.AllOnButProd),y("MathIncorrectAnswerSuggestions",n.OnDevBoxAndDaily),y("MathQuestionGeneration",n.OnDevBoxAndDaily),b("EnableOnlineExcelForMSA",n.AllOff),y("DesignerFileUpload",n.OnDevBoxAndDaily),y("ResponderFileUpload",n.AllOn),b("FormInsight",n.AllOnButProd),b("PartialPut",n.OnDevBox),g("PPTContentAddinSSO",n.AllOnButProd),b("MsaPreviewLabel",n.AllOn),y("PrintForm",n.OnDevBox),y("AssignmentsIFrameLimitParentHeaders",n.AllOnButProd),b("EnableExperimentation",n.AllOnButProd),g("FormInsightFeedbackV2",n.AllOnButProd),b("EmailHrdFallback",n.AllOnButProd),g("WordCloudMultipleRatio",n.AllOnButProd),b("LogDownloadExcelErrorMessage",n.AllOnButProd),b("DisableBrandingForMSA",n.AllOff),y("EnableNonAnonymousForMSA",n.AllOnButProd),b("MSAIntroductionForResponder",n.AllOnButProd),y("QuestionTagForIntelligence",n.AllOff),b("Question200Limit",n.AllOnButProd),g("DataClassification",n.AllOnButProd),b("EnableFormsProRoute",n.AllOnButProd),y("ExcelSurveyIntroductionDialog",n.AllOnButProd),y("TemplateSuggestionModelExp",n.AllOnButProd),y("OptionToOptionSuggestionExp",n.AllOnButProd),y("GetMeetingInfo",n.AllOff),g("DataClassificationRuntime",n.AllOnButProd),g("GetShareInvitationKeyFromQuery",n.AllOnButProd),g("LogShareInvitationKeyFromQuery",n.AllOnButProd),y("EditorOnContextMenuLog",n.AllOnButProd),y("SignalRConnectV2",n.AllOnButProd),y("BranchingExperiment",n.AllOnButProd),y("SuiteHeaderFPS",n.AllOnButProd),y("HistorySuggestion",n.AllOnButProd),y("IntelligenceUseMemoryCache",n.AllOnButProd),y("IntelligenceScenarioProcess",n.AllOnButProd),y("FormCustomizedMessage",n.AllOnButProd),y("TagTemplateSuggestionExp",n.AllOnButProd),y("MSATemplateFPS",n.AllOnButProd),y("MobileEnablePreivew",n.AllOff),g("RemoveRuntimeWarningbarReportAbuse",n.AllOnButProd),g("ShareAssistant",n.AllOff),y("BlockRestrictUser",n.AllOff),y("MobileFPS",n.AllOnButProd),y("ImmersiveReaderInForms",n.AllOnButProd),y("ThemeTeachingCallout",n.AllOnButProd),g("O365ShellSuiteHeader",n.AllOnButProd),g("LeverageServerRingLogic",n.AllOnButProd),y("BaseProSwitcherLink",n.AllOff),y("BaseProFRE",n.AllOff),g("MultiLingualMVP1",n.AllOn),g("FirstTimePhishingDetectionWarning",n.AllOnButProd),y("FormsProAvailableTeachingCallout",n.AllOff),y("MenuItemForAddBranch",n.AllOnButProd),g("TeamsRedirectToExcelPage",n.AllOnButProd),g("DataIdeasUxState",n.AllOnButProd),g("LinkifyEscape",n.AllOnButProd),y("SupportStreamVideo",n.AllOnButProd),y("DisableIntroductionForMobile",n.AllOnButProd),y("XLUnsyncedDialog",n.AllOnButProd),y("MobileAsyncCreateForm",n.AllOnButProd),y("AddUPNToAdminPhishingReviewPage",n.AllOnButProd),y("MobileScriptsPreload",n.AllOnButProd),y("MobilePrefetchResourceStrings",n.AllOnButProd),y("MobileUseIdFromQuery",n.AllOnButProd),y("RemovePreviewLabelForSurvey",n.AllOff),y("PreferUserInfoFromAspx",n.AllOnButProd),y("AddBranchInSection",n.AllOnButProd),g("WorkAroundImplicitGrantBreak",n.AllOff),y("RetryTransientFailure",n.AllOnButProd),g("UserFeatureSettings",n.AllOff),g("EnableUnblockRestrictedUserPage",n.AllOnButProd),y("QuizHistorySuggestion",n.AllOnButProd),y("MobileAddQuestionExperiment",n.AllOnButProd),y("YouTubeAdminControl",n.AllOnButProd),y("PersonalContextSuggestion",n.AllOff),y("FromsSpinnerControl",n.AllOnButProd),g("FormsProEnable",n.AllOff),g("FormsPro",n.AllOn),y("FormsProEmbedCompact",n.AllOnButProd),y("FormsProDelayedProvisioning",n.AllOff),y("FormsProDemoView",n.AllOff),y("FormsProO365SuiteHeader",n.AllOff),y("FormsProAnswerTag",n.OnDevBox),y("FormsProOptout",n.AllOn),y("FormsProQuestionVisibility",n.AllOn),y("FormsProDeferredLoad",n.AllOn),y("FormsProCustomCss",n.AllOff),y("FormsProCustomDomain",n.AllOff),y("FormsProAnswerTag",n.OnDevBox),y("FormsProMultilingualImportExport",n.AllOff),y("FormsProMultilingualImportExportV2",n.AllOff),y("FormsProEmailSlugification",n.AllOff),y("FormsProSubjectSlugification",n.AllOff),y("FormsProFiveByFive",n.AllOff),y("FormsProTrial",n.AllOff),y("FormsProCSAT",n.AllOff),y("FormsProCSATSimulate",n.AllOff),y("FormsProImportCsv",n.AllOff),y("FormsProSampleFormOnClient",n.AllOff),y("FormsProNotifyAdmin",n.AllOff),y("FormsProRedirectLogout",n.AllOnButProd),y("BingImageAdminControl",n.AllOnButProd),y("FormsProSurveyPermissions",n.AllOnButProd),y("FormsProPaidTermOfUsage",n.AllOnButProd),y("FormsProTrialExpiration",n.AllOff),y("FormsProDeferValidationCheck",n.AllOnButProd),y("ProBackfillTeachingBubble",n.AllOff),y("FormsProMSRewardsIntegration",n.AllOnButProd),y("FormsProEmailableEntitySelector",n.AllOff),y("FormsProCascadingBranching",n.AllOff),y("FormsProInvitesFromHive",n.AllOff),y("FormsProDisableAntiFishingNotice",n.AllOff),y("FormsProBranchingImprovement",n.AllOff),y("FormsProInvitesExpiry",n.AllOff),y("FormsProInviteSingleSelection",n.AllOff),y("OwnerInfoOnResponsePage",n.AllOff),y("FormsProEnvStickiness",n.AllOnButProd),y("FormsProEmbedCompactPlus",n.AllOff),y("FormsProCalculateSentiment",n.AllOff),y("FormsProRTFooter",n.AllOff),y("FormsProTextFieldValidation",n.AllOff),y("FormsProRatingSmiley",n.AllOff),y("FormsProCustomFooter",n.AllOff),y("FormsProHidePrivacyLink",n.AllOff),g("PrefetchForm",n.AllOff),g("MobilePrefetchForm",n.AllOff),g("MobilePrefetchCommon",n.AllOff),g("PrefetchUserLicenseInfo",n.AllOff),S("PrefetchForm",["CookieAuth"]),S("MobilePrefetchForm",["CookieAuth"]),S("MobilePrefetchCommon",["CookieAuth"]),S("PrefetchUserLicenseInfo",["CookieAuth"]),v("MobilePrefetchForm",["FormsProEnable"]),v("MobilePrefetchCommon",["FormsProEnable"]),g("CustomizeFabric",n.AllOnNonOSI),g("CustomizeBootstrap",n.AllOnNonOSI),g("ReduceLibJsSize",n.AllOnNonOSI),g("MobilePrefetchOtherJs",n.AllOnNonOSI),g("PrefetchFormAuthFix",n.AllOff),S("PrefetchFormAuthFix",["PrefetchForm"]),g("PrefetchFormInServer",n.AllOnNonOSI),S("PrefetchFormInServer",["PrefetchForm"]),g("FilterHashMapping",n.AllOff),g("FilterServerFlights",n.AllOff),g("ReactUpgrade",n.AllOnNonOSI),y("FormsProBranchingV2",n.AllOnButProd),g("FormsProTIP",n.AllOff),g("FormsProSignupInformationPage",n.AllOff),g("FormsProSignupPassThrough",n.AllOff),g("ProRedirectInWeb",n.AllOff),S("TestTenantFlight",["TestEnvironmentFlight"]),v("TestTenantFlight",["TestEnvironmentFlight_Blocker"]),S("FormsPro",["FormsProEnable"]),S("SuiteHeaderFPS",["O365ShellSuiteHeader"]),S("FormsProO365SuiteHeader",["FormsProEnable","O365ShellSuiteHeader"]),S("BaseProSwitcherLink",["ProRedirectInWeb"]),S("BaseProFRE",["ProRedirectInWeb","BaseProSwitcherLink"]),S("ProBackfillTeachingBubble",["FormsProO365SuiteHeader"]),S("FormsProEnvStickiness",["FormsProEnable","FormsProO365SuiteHeader"]),S("FormsProEmailableEntitySelector",["FormsProEnable"]),S("FormsProAvailableTeachingCallout",["BaseProSwitcherLink"])},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n,o=r(0),i=r(5),a=r(114),s=r(29),c=r(12),u=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),l=function(e){function t(t){var r=e.call(this,t)||this;return r.onClickHref=r.onClickHref.bind(r),r}return u(t,e),t.prototype.render=function(){var e=this.props,t="tipbar-container";switch("Up"===e.TipBarLocation&&(t=i.a.combineAttributes(t,"tipbar-location-up")),"Down"===e.TipBarLocation&&(t=i.a.combineAttributes(t,"tipbar-location-down")),e.TipBarStyle){case"RedBackground":t=i.a.combineAttributes(t,"tipbar-style-red");break;case"YellowBackground":t=i.a.combineAttributes(t,"tipbar-style-yellow");break;default:t=i.a.combineAttributes(t,"tipbar-style-white")}var r=null;if(e.TipBarIconClassName){var n=i.a.combineAttributes("tipbar-info-icon",e.TipBarIconClassName);r=o.createElement("span",{className:n})}var c,u=o.createElement(a.a,{LazyRendering:!0,Role:"Alert"},o.createElement("span",{className:"tipbar-limit-content"},e.Info));e.HrefInfo&&(c=o.createElement("a",{className:"tipbar-limit-content tipbar-limit-href",href:"javascript:void(0)",onClick:this.onClickHref,tabIndex:0},e.HrefInfo));var l=null;return e.ShouldClose&&(l=Object(s.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"tipbar-close",onClick:e.onClose},Icon:"Cancel",IconClassName:"forms-icon-size14x14"})),o.createElement("div",{className:t},l,o.createElement("div",{className:"tipbar-content"},o.createElement("div",{className:"tipbar-txt-content"},r,u,c)))},t.prototype.onClickHref=function(){this.props.onClickHref&&this.props.onClickHref()},t}(c.a)},,function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(18),o=r(23),i=r(8),a=function(){function e(e,t){this.comment=e,this.dataProvider=o.a.getDataProviderByFormMaster(this.comment.Response.Form)}return Object.defineProperty(e.prototype,"FormId",{get:function(){return this.comment.FormId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ResponseId",{get:function(){return this.comment.ResponseId},enumerable:!0,configurable:!0}),e.prototype.add=function(e,t,r){return this.dataProvider.addFormResponseComment(this.FormId,this.ResponseId,t.Snapshot)},e.prototype.delete=function(e){return $.Deferred().promise()},e.prototype.query=function(e){return Object(n.c)("No scenario to call this method currently.")},e.prototype.update=function(e,t){var r=this.comment.Response.Form.SyncContext;return r!==i.e.DesignTimeForm&&r!==i.e.AnalysisTimeForm?$.Deferred().promise():this.add(e,t,!0)},e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){function e(e,t){this.items=[],this.targetApi=e,t=t||{},this.deferredTimeInMs=t.deferredTimeInMs||100,this.maxCount=t.maxCount||10}return e.prototype.insert=function(e){var t=this,r=$.Deferred();return this.items.push({Arguments:e,Deferred:r}),this.items.length>=this.maxCount?this.triggerApi():void 0===this.timerID&&(this.timerID=window.setTimeout((function(){return t.triggerApi()}),this.deferredTimeInMs)),r.promise()},e.prototype.triggerApi=function(){var e=this.items;this.items=[],void 0!==this.timerID&&(window.clearTimeout(this.timerID),this.timerID=void 0),0!==e.length&&this.targetApi(e.map((function(e){return e.Arguments}))).done((function(t){if(e.length!==t.length)throw Error("All the elements needs to be listed in result array.");t.forEach((function(t,r){t.Succeeded?e[r].Deferred.resolve(t.Value):e[r].Deferred.reject(t.Error)}))})).fail((function(t){e.forEach((function(e){e.Deferred.reject(t)}))}))},e}()},function(e,t,r){"use strict";var n=r(4),o=r(1),i=r(107),a=r(23),s=r(8),c=function(){function e(e){this.master=e,this.dataProvider=a.a.getDataProviderByFormMaster(this.master.Form)}return e.prototype.add=function(e){var t=this;if(this.master.Form.SyncContext!==s.e.DesignTimeForm)return $.Deferred().resolve().promise();var r=this.master.QuestionId;if(r){var n=this.master.Form.getQuestionById(r).getChoiceByKey(this.master.Model.key||"");if(n)return n.Synchronizer.existingInDataSource().then((function(){var r=n.Model.Id.toString();t.master.Model.choiceId=r;var o={elementKey:"choiceid_"+r,elementValue:e.description,locale:t.master.LocaleId,questionId:t.master.QuestionId};return Object(i.a)(o,t.master.FormId).then((function(){return{choiceId:r,description:e.description}}))}))}return $.Deferred().reject().promise()},e.prototype.delete=function(e){throw Error("No scenario to call this method currently.")},e.prototype.query=function(e){throw Error("No scenario to call this method currently.")},e.prototype.update=function(e,t){if(!t.ValuesBefore||this.master.Form.SyncContext!==s.e.DesignTimeForm)return $.Deferred().resolve().promise();if(e.choiceId||void 0===e.description)throw Error("No valid payload to update.");var r={elementKey:"choiceid_"+this.master.ChoiceId,elementValue:e.description,locale:this.master.LocaleId,questionId:this.master.QuestionId};return null!==t.ValuesBefore.description?this.dataProvider.updateLocaleItem(this.master.FormId,r):this.dataProvider.createLocaleItem(this.master.FormId,r)},e}();r.d(t,"a",(function(){return f}));var u,l=(u=function(e,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}u(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),d={choiceId:o.a.string({IsKeyField:!0}),description:o.a.string(),key:o.a.string({IsLocalField:!0})},f=function(e){function t(t){var r=e.call(this,t)||this;if(!r.Model.key){if(!r.Model.choiceId)throw Error("Current choice localized master doesn't has key and choiceId.");t.MasterTreeReady&&t.MasterTreeReady.then((function(){return r.Form.fieldsReady([r.Form.Schema.Questions])})).done((function(){var e=r.Form.getQuestionById(r.QuestionId).getChoiceById(Number(r.Model.choiceId));e&&(r.Model.key=e.Model.Key)}))}return r}return l(t,e),Object.defineProperty(t.prototype,"QuestionLocalizedMaster",{get:function(){return this.Parent.Parent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Form",{get:function(){return this.QuestionLocalizedMaster.Form},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"QuestionId",{get:function(){return this.QuestionLocalizedMaster.Model.questionId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"LocaleId",{get:function(){return this.QuestionLocalizedMaster.Model.localeId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ChoiceId",{get:function(){return this.Model.choiceId},enumerable:!0,configurable:!0}),t}(n.a.createObjectMasterClass("ChoiceLocalizedItemMaster",d,(function(e){return new c(e)})))},function(e,t,r){"use strict";var n=r(4),o=r(1),i=r(23),a=r(8),s=function(){function e(e){this.master=e,this.dataProvider=i.a.getDataProviderByFormMaster(this.master.Form)}return e.prototype.add=function(e){if(!e.localeId||!e.localeName||this.master.Form.SyncContext!==a.e.DesignTimeForm)return $.Deferred().resolve().promise();var t={elementKey:"localename",elementValue:e.localeName,locale:e.localeId,questionId:""};return this.dataProvider.createLocaleItem(this.master.FormId,t)},e.prototype.delete=function(e){return e.localeId&&this.master.Form.SyncContext===a.e.DesignTimeForm?this.dataProvider.deleteLocale(this.master.FormId,e.localeId):$.Deferred().resolve().promise()},e.prototype.query=function(e){throw Error("No scenario to call this method currently.")},e.prototype.update=function(e,t){if(!t.ValuesBefore||!e.localeName||this.master.Form.SyncContext!==a.e.DesignTimeForm)return $.Deferred().resolve().promise();var r=null!==t.ValuesBefore.localeName,n={elementKey:"localename",elementValue:e.localeName,locale:this.master.Model.localeId,questionId:null};return r?this.dataProvider.updateLocaleItem(this.master.FormId,n):this.dataProvider.createLocaleItem(this.master.FormId,n)},e}();r.d(t,"a",(function(){return d}));var c,u=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),l={localeId:o.a.string({IsKeyField:!0}),localeName:o.a.string()},d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),Object.defineProperty(t.prototype,"Form",{get:function(){return this.Parent.Parent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!0,configurable:!0}),t}(n.a.createObjectMasterClass("LocaleInfoMaster",l,(function(e){return new s(e)})))},function(e,t,r){"use strict";r.d(t,"a",(function(){return I}));var n,o=r(0),i=r(11),a=r(169),s=r(57),c=r(2),u=r(36),l=r(5),d=r(16),f=r(32),p=r(23),m=r(9),h=r(22),g=r(112),y=r(31),b=r(12),v=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),S=function(){return(S=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},I=function(e){function t(t){var r=e.call(this,t)||this;return r.state={DisableUnblockButton:!1,IsUPNReady:!1,ShowCoauthLoadingBar:!1,ShowUnblockSpinner:!1,UnblockSuccess:!1},r.userPrincipalName="",r.unblockForm=r.unblockForm.bind(r),r.createAdminCoauthLink=r.createAdminCoauthLink.bind(r),r}return v(t,e),t.prototype.componentDidMount=function(){var e=this;if(this.props.FormId&&this.props.ErrorCode===d.b.CDBTableNotFound){var t=i.a.getMSGraphAPIHost(),r=Object(u.a)(this.props.FormId);Object(a.a)((function(e){return Object(f.b)({headers:{Authorization:e,"Content-Type":"application/json"},method:"GET",qosEventName:"AdminPage.GetUserUPN",requestUri:t+"/v1.0/"+r.OrgId+"/users/"+r.OwnerId})})).done((function(t){e.userPrincipalName=t.userPrincipalName,e.setState({IsUPNReady:!0})}))}},t.prototype.render=function(){var e=this.props.FormMaster,t=c.a.LocalizedStrings.AdminPhishingReview_Page_Nav_Bar_Unblock_Process1,r=c.a.LocalizedStrings.AdminPhishingReview_Page_Nav_Bar_Unblock_Process2,n=c.a.LocalizedStrings.AdminPhishingReview_Page_Nav_Bar_Unblock_Process3,i=c.a.LocalizedStrings.AdminPhishingReview_Page_Nav_Bar_Unblock_Process4;if(this.props.FormId&&this.props.ErrorCode===d.b.CDBTableNotFound)return this.state.IsUPNReady?F(c.a.LocalizedStrings.AdminPhishingReview_Page_Nav_Bar_Form_Deleted_Title,{email:M(this.userPrincipalName),unblockProcess3:n,unblockProcess4:i}):F(c.a.LocalizedStrings.AdminPhishingReview_Page_Nav_Bar_Form_Deleted_Title,{unblockProcess3:n});if(this.props.FormId&&this.props.ErrorCode)return null;var a=e.Model.OnlineSafetyLevel,u=o.createElement(g.a,{FormMaster:e,LocalizedStrings:c.a.LocalizedStrings}),l=this.props.FormMaster.Model.CreatedBy;return(a&s.a.TakeDown)===s.a.TakeDown?F(c.a.LocalizedStrings.AdminPhishingReview_Page_Nav_Bar_TakeDown_Title,{email:M(l),generateCoauthLinkButton:this.createGenerateCoauthLinkButton(),termsLink:u,unblockProcess2:r,unblockProcess3:n,unblockProcess4:i}):this.state.UnblockSuccess||0!=(a&s.a.AdminReviewPass)?F(c.a.LocalizedStrings.AdminPhishingReview_Page_Nav_Bar_Unblock_Success,{completedIcon:Object(h.b)({HTMLAttributes:{className:"phishingreview-unblock-complefted-icon forms-icon-size16x16"},IconName:"Completed"})}):0==(a&s.a.PhishingFromContentScan)?F(c.a.LocalizedStrings.AdminPhishingReview_Page_Nav_Bar_Block_Auto_Lifted_Title,{email:M(l),termsLink:u,unblockProcess4:i}):this.state.ShowCoauthLoadingBar?F(c.a.LocalizedStrings.AdminPhishingReview_Page_Nav_Bar_Coauth_Loading_Text,{coauthSpinner:this.createSpinner("phishingreview-form-coauth-spinner")}):F(c.a.LocalizedStrings.AdminPhishingReview_Page_Nav_Bar_Unblock_Title,{email:M(l),generateCoauthLinkButton:this.createGenerateCoauthLinkButton(),termsLink:u,unblockButton:Object(y.b)({ButtonStyle:"LightBackground",HTMLAttributes:{className:"office-form-unblock-form-button",disabled:this.state.ShowUnblockSpinner||this.state.DisableUnblockButton,onClick:this.unblockForm,title:c.a.LocalizedStrings.AdminPhishingReview_Page_Unblock_Button_Text},Text:c.a.LocalizedStrings.AdminPhishingReview_Page_Unblock_Button_Text}),unblockProcess1:t,unblockProcess2:r,unblockProcess3:n,unblockProcess4:i,unblockSpinner:this.createSpinner("phishingreview-form-unblock-spinner")})},t.prototype.createGenerateCoauthLinkButton=function(){var e={className:"office-form-phishingreview-form-link-button-container",onClick:this.createAdminCoauthLink,tabIndex:0,title:c.a.LocalizedStrings.AdminPhishingReview_Page_Nav_Bar_Coauth_Text};return o.createElement("div",S({},e),o.createElement("span",null,c.a.LocalizedStrings.AdminPhishingReview_Page_Nav_Bar_Coauth_Text))},t.prototype.createAdminCoauthLink=function(){var e=this,t=this.props.FormMaster;this.setState({ShowCoauthLoadingBar:!0}),t.ensureFieldsReady([t.Schema.Permissions]).done((function(){t.appendPermission("OrgLink").done((function(t){var r={fragment:"FormId="+e.props.FormMaster.Model.Id+"&Token="+t},n="../Pages/DesignPage.aspx?"+jQuery.param(r);e.setState({ShowCoauthLoadingBar:!1,ShowUnblockSpinner:!1}),window.open(l.a.getAbsoluteUrl(n))})).fail((function(t){e.props.SetErrorStateCallback.bind(e,t)()}))})).fail((function(t){e.props.SetErrorStateCallback.bind(e,t)()}))},t.prototype.createSpinner=function(e){if(this.state.ShowUnblockSpinner||this.state.ShowCoauthLoadingBar)return o.createElement("div",{className:e},o.createElement("div",{className:"spinner-tile-animation"}))},t.prototype.unblockForm=function(){var e=this;Object(m.a)({eventName:"AdminPhishingReview.UnblockButton.Click",eventType:"engagement_event"});var t=this.props.FormMaster;this.setState({ShowUnblockSpinner:!0}),p.a.getDataProviderByFormId(t.Model.Id).unblockPhishingForm(t.Model.Id).done((function(){e.setState({DisableUnblockButton:!0,ShowUnblockSpinner:!1,UnblockSuccess:!0})})).fail((function(t){e.props.SetErrorStateCallback.bind(e,t)()}))},t}(b.a);function M(e){return o.createElement("span",{className:"phishingreview-form-nav-bar-process-email"},e)}function F(e,t){return o.createElement("div",{className:"office-form-phishingreview-form-container"},o.createElement("div",{className:"office-form-phishingreview-form-content"},o.createElement("div",{className:"office-form-phishingreview-form-text"},o.createElement("div",{className:"phishingreview-form-nav-bar-title"},t.coauthSpinner,t.completedIcon,o.createElement("span",null,e),o.createElement("span",{className:"phishingreview-form-nav-bar-terms"},t.termsLink)),o.createElement("div",{className:"phishingreview-form-nav-bar-process"},o.createElement("span",null,t.unblockProcess1),o.createElement("span",{className:"phishingreview-form-nav-bar-process-coauth"},t.unblockProcess2,t.generateCoauthLinkButton),o.createElement("span",null,t.unblockProcess3),o.createElement("span",null,t.unblockProcess4,t.email))),o.createElement("div",{className:"office-form-phishingreview-form-button-container"},t.unblockButton,t.unblockSpinner)))}},,function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n,o=r(0),i=r(5),a=r(7),s=r(101),c=r(108),u=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function l(e){return o.createElement(d,e)}var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.createReactNodes=function(){var e=this,t=this.props,r=t.RadioCheckbox?"radio":"checkbox",n=t.Options,s=n&&n.classNameForInnerDiv,u=i.a.combineAttributes(r,n&&n.classNameForInnerLabel),l=t.Disabled,d=t.HelpText||void 0,f=i.a.mergeReactProps(n&&n.HTMLPropsForInnerElement,{checked:t.Value,disabled:l,type:r,onChange:this.onChange.bind(this),className:this.props.ClassName,ref:this.props.CheckboxRef,autoFocus:t.CheckboxAutoFocus}),p=o.createElement("div",{className:u},o.createElement("label",{disabled:l},o.createElement("input",f),o.createElement("span",{className:this.props.SpanClassName},t.Description),t.ShowRequiredStar?o.createElement(c.a):void 0,Object(a.e)((function(){return t.ShowInfo&&FormsPro.createInfoIconTooltip({id:e.props.Id,tooltip:e.props.ShowInfoTooltip})}))));return[o.createElement("div",{className:s,id:t.Id,disabled:l,title:d},p,t.children)]},t.prototype.onChange=function(e){this.props.onValueChange(e.nativeEvent.target.checked)},t}(s.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n,o=r(0),i=r(106),a=r(8),s=r(61),c=r(7),u=r(170),l=r(226),d=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.subTitleRef=o.createRef(),t}return d(t,e),t.prototype.componentWillMount=function(){var e=this;t.loadCustomCss(this.props.CustomStyle),this.update=function(){return e.forceUpdate()};var r=a.c.Schema;this.props.Form.observe(this.update,[r.Title,r.Description,r.LogoInfo,r.CustomCssFileName]),this.getFormLocalizedItemMaster(this.props)},t.prototype.componentWillReceiveProps=function(e){this.getFormLocalizedItemMaster(e)},t.prototype.componentDidMount=function(){Object(i.a)($(this.subTitleRef.current))},t.prototype.componentWillUnmount=function(){this.props.Form.unobserve(this.update),this.formLocalizedItemMaster&&this.formLocalizedItemMaster.unobserve(this.update)},t.prototype.render=function(){var e,t,r=this.props.Form,n=r.Model,i=n.LogoInfo,s=this.formLocalizedItemMaster,d=s&&s.Model,f=d&&d.title||n.Title,p=d&&d.subtitle||n.Description;if(n.Logo&&n.Logo.ResourceUrl&&i.TargetResourceId){var m=r.getImageMaster(a.c.Schema.Logo),h=r.getImageSettingsMaster(a.c.Schema.LogoInfo),g=h.calcLogoLayout({isMobile:this.props.IsMobile,isSlimSize:this.props.IsSlimTitle,isSmallSize:this.props.IsSmallSize});e=o.createElement("div",{className:"office-form-custom-logo"},o.createElement(u.a,{ImageWidth:g.ActualWidth,ImageHeight:g.ActualHeight,ImageInfoMaster:m,ImageSettingMaster:h,ImageType:"Logo"}))}return p=c.a.sanitizeRichTextHTML(s&&s.Model.formsprortlocalesubtitle||(n.FormsProRTDescription?n.FormsProRTDescription:p)),f=c.a.sanitizeRichTextHTML(s&&s.Model.formsprortlocaletitle||(n.FormsProRTTitle?n.FormsProRTTitle:f)),n.Description&&!this.props.IsSmallSize&&(t=o.createElement("div",{className:"office-form-subtitle heading-1",ref:this.subTitleRef},o.createElement(l.a,{HTMLContent:p}))),o.createElement("div",{className:"customCssContainer"},o.createElement("div",{className:"office-form-custom-image"}),e,o.createElement("div",{className:"office-form-title office-form-custom-title"},o.createElement(l.a,{HTMLContent:f})),o.createElement("div",{className:"office-form-custom-subtitle"},t))},t.loadCustomCss=function(e){var t=document.createElement("style");t.type="text/css",t.innerHTML=e,document.head.appendChild(t)},t.prototype.getFormLocalizedItemMaster=function(e){var t=this.props.Form,r=e.LocaleId;this.formLocalizedItemMaster&&(this.formLocalizedItemMaster.unobserve(this.update),this.formLocalizedItemMaster=void 0),r&&(this.formLocalizedItemMaster=s.a.getFormResourceMaster(r,t),this.formLocalizedItemMaster&&this.formLocalizedItemMaster.observe(this.update,[s.a.Schema.title,s.a.Schema.subtitle]))},t}(o.Component)},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(0),o=r(22);function i(e){var t=e.IsMobile,r=e.VideoUrl,i=t?"mobile-youtube":"pc-youtube";return i=e.InDesignMode?"design-question-title-youtube-placeholder "+i:"office-form-title-youtube-placeholder "+i,n.createElement("div",{className:i},n.createElement("div",{className:"question-title-youtube-title"},n.createElement("a",{className:"question-title-youtube-link",href:r,target:"_blank"},r)),n.createElement("div",{className:"question-title-youtube-tip"},n.createElement("span",{className:"question-title-youtube-tip-text"},e.LocalizedStrings.DesignPage_Youtube_Disabled_Launch_Tip),!t&&n.createElement(o.a,{HTMLAttributes:{className:"forms-icon-size12x12 question-title-youtube-tip-icon"},IconName:"Info"}),n.createElement("span",{className:"question-title-youtube-hover-tip ms-Icon"},e.LocalizedStrings.DesignPage_Youtube_Disabled_Hover_Tip)))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(3),o=r(76),i=r(10),a=function(){function e(){this.runtimeSectionList=[],this.getCachedBranchingResult=this.getCachedBranchingResult.bind(this)}return e.getBranchedSections=function(t,r){for(var a=[],s=[],c=0,u=function(){var u=t[c];if(n.findIndex(a,(function(e){return e.Section===u.Section}))>=0)return"break";for(var l=[],d=void 0,f=u.TopQuestionMasters[0],p=function(){if(n.include(s,f))return"break";s.push(f),l.push(f);var e=r(f,u.TopQuestionMasters),a=e.TargetElement;a instanceof i.d?f=a:(a&&o.a.isSection(a.Model.Type)?d=n.findIndex(t,(function(e){return e.Section===a})):"End"===e.Type&&(d=-1),f=null)};f;){if("break"===p())break}a.push({Section:u.Section,TopQuestionMasters:l}),c=void 0!==d?d:e.getNextSectionFromSection(u,t)};c<=t.length-1&&c>=0;){if("break"===u())break}return a},e.prototype.calculateQuestionRuntimeList=function(t){var r=[],n=this.getShuffledDesignTimeSections(t);this.formRuntimeMaster.IsDisableBranching||(n=e.getBranchedSections(n,this.getCachedBranchingResult));var o=this.runtimeSectionList,i=this.getDefaultRuntimeSections(n,r);if(e.isBranchingResultChanged(o,i)){this.runtimeSectionList=i;var a=this.formRuntimeMaster.Model;this.formRuntimeMaster.bulkEdit((function(){a.QuestionRuntimeMasters=r,a.BranchChangeVersion=(a.BranchChangeVersion||0)+1}))}},e.prototype.hasPrevSection=function(){return this.getCurrentSectionIndex()>0},e.prototype.gotoPrevSection=function(){var e=this.getCurrentSectionIndex();if(e>0){var t=this.runtimeSectionList[e-1];this.formRuntimeMaster.Model.RuntimeSectionId=t.Section&&t.Section.Model.Id}},e.prototype.hasNextSection=function(){return this.getCurrentSectionIndex()<this.runtimeSectionList.length-1},e.prototype.gotoNextSection=function(){var e=this.getNextSectionId();e&&(this.formRuntimeMaster.Model.RuntimeSectionId=e)},e.prototype.getAllSections=function(){return this.runtimeSectionList},e.prototype.getCurrentSection=function(){return this.getSectionNode(this.formRuntimeMaster.Model.RuntimeSectionId)},e.prototype.isFirstPage=function(){var e=this.getCurrentSection();return 0===this.runtimeSectionList.indexOf(e)},e.isBranchingResultChanged=function(e,t){if(e.length!==t.length)return!0;for(var r=0;r<e.length;r++){if(e[r].Section!==t[r].Section||e[r].TopQuestionMasters.length!==t[r].TopQuestionMasters.length)return!0;for(var n=0;n<e[r].TopQuestionMasters.length;n++)if(e[r].TopQuestionMasters[n]!==t[r].TopQuestionMasters[n])return!0}return!1},e.prototype.getCachedBranchingResult=function(e,t){var r=this.formRuntimeMaster.getOrCreateQuestionRuntime(e),n=r.Model.BranchingType,o=r.Model.BranchedElement;return o instanceof i.d&&-1===t.indexOf(o)&&(o=t[t.indexOf(e)+1]),{TargetElement:o,Type:n}},e.prototype.getDefaultRuntimeSections=function(e,t){var r=this;return e.map((function(e){return{Section:e.Section,TopQuestionMasters:e.TopQuestionMasters.map((function(e){var n=r.formRuntimeMaster.getOrCreateQuestionRuntime(e);return t.push(n),e.SubQuestionMasters.forEach((function(e){var n=r.formRuntimeMaster.getOrCreateQuestionRuntime(e);t.push(n)})),n}))}}))},e.getNextSectionFromSection=function(e,t){var r=e.Section,o=r&&r.Model.BranchInfo;if(o){if(o.ToTheEnd)return-1;var i=n.findIndex(t,(function(e){return e.Section&&e.Section.Model.Id===o.TargetQuestionId}));if(i>=0)return i}return n.findIndex(t,e)+1},e.prototype.getSectionNode=function(e){var t=this,r=n.find(this.runtimeSectionList,(function(t,r){return e?t.Section&&e===t.Section.Model.Id:0===r}));return e&&!r&&(r=this.runtimeSectionList[0],setTimeout((function(){t.formRuntimeMaster.Model.RuntimeSectionId=null}))),r},e.prototype.getCurrentSectionIndex=function(){return n.indexOf(this.runtimeSectionList,this.getCurrentSection())},e.prototype.getShuffledDesignTimeSections=function(e){var t=this.formRuntimeMaster.Form;return t.hasSection()?t.FormElementManager.getSectionNodes():[{TopQuestionMasters:e.filter((function(e){return!e.Model.GroupId}))}]},e.prototype.getNextSectionId=function(){var e=this.getCurrentSectionIndex();if(e<this.runtimeSectionList.length-1&&e>=0){var t=this.runtimeSectionList[e+1];return t.Section&&t.Section.Model.Id}},e}()},,,function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n,o,i=r(0),a=r(3),s=r(11),c=r(106),u=r(5),l=r(13),d=r(26),f=r(6),p=r(7),m=r(12),h=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),g=function(){return(g=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};!function(e){e[e.Loading=0]="Loading",e[e.Success=1]="Success",e[e.Error=2]="Error"}(o||(o={}));var y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.subTitleRef=i.createRef(),t.immersiveReaderDebounceTime=400,t.handleLaunchImmersiveReader=function(){var e=[];e.push({content:t.props.Title}),e.push({content:"\n"}),e.push({content:t.props.SubTitle});var r={chunks:e,title:""},n={uiLang:s.a.getExplictLocale()||navigator.language};Object(d.b)().getImmersiveReaderToken().then((function(e){e&&ImmersiveReader&&ImmersiveReader.launchAsync(e,null,r,n)}))},t}return h(t,e),t.prototype.componentDidMount=function(){Object(c.a)($(this.subTitleRef.current))},t.prototype.componentDidUpdate=function(){Object(c.a)($(this.subTitleRef.current))},t.prototype.render=function(){var e=a.extend({},this.props.HTMLAttributes);return e.className=u.a.combineAttributes(e.className,"office-form-title-container"),i.createElement("div",g({},e),this.createTitleContainer(),this.createSubTitle(),"Bottom"===this.props.MediaLayout?this.props.children:void 0)},t.prototype.createTitleContainer=function(e){var t,r="office-form-title-box";return"Bottom"!==this.props.MediaLayout&&(r=r+" "+this.props.MediaLayout.toLowerCase(),t=this.props.children),i.createElement("div",{className:r},t,this.createTitle())},t.prototype.createTitle=function(){var e=this,t=a.extend({},this.props.HTMLPropsForInnerElement);return t.className=u.a.combineAttributes("office-form-title",t.className,"heading-"+(this.props.Heading||1),2===this.props.Heading&&"office-form-theme-secondary-color",!this.props.Title&&"empty-title"),Object(p.c)((function(){return i.createElement("div",g({},t),i.createElement("span",null,e.props.Title),e.createImmersiveReaderButton(),t.children)}),(function(){var r=p.a.sanitizeRichTextHTML(e.props.Title);return i.createElement("div",g({},t),i.createElement(p.a.RichtTextControl,{HTMLContent:r}),t.children)}))},t.prototype.createImmersiveReaderButton=function(){return!l.q()&&Object(f.a)().Flighting.isEnabled("ImmersiveReaderInForms")?i.createElement("button",{className:"immersive-reader-button","data-locale":s.a.getExplictLocale()||navigator.language,onClick:a.debounce(this.handleLaunchImmersiveReader,this.immersiveReaderDebounceTime,!0)}):null},t.prototype.createSubTitle=function(){var e=this;return this.props.SubTitle?Object(p.c)((function(){return i.createElement("div",{className:"office-form-subtitle heading-"+(e.props.Heading||1),ref:e.subTitleRef},i.createElement("span",null,e.props.SubTitle))}),(function(){var t=p.a.sanitizeRichTextHTML(e.props.SubTitle);return i.createElement("div",{className:"office-form-subtitle heading-"+(e.props.Heading||1),ref:e.subTitleRef},i.createElement(p.a.RichtTextControl,{HTMLContent:t}))})):void 0},t}(m.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n,o=r(0),i=r(24),a=r(12),s=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.render=function(){return i.a.ShowImageAltText?o.createElement("div",{className:"image-alternative-text"},this.props.children):null},t}(a.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return g}));var n,o,i=r(0),a=r(20),s=r(25),c=r(2),u=r(47),l=r(5),d=r(111),f=r(7),p=r(101),m=r(29),h=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function g(e){return i.createElement(y,e)}!function(e){e[e.DatePicker=0]="DatePicker",e[e.TimePicker=1]="TimePicker",e[e.DateTimePicker=2]="DateTimePicker"}(o||(o={}));var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),t.prototype.createReactNodes=function(){var e=this.props,t=e.Options,r=t&&t.classNameForInnerDiv,n=t&&t.classNameForInnerLabel,o=e.Disabled;return[e.Label?i.createElement("span",{className:n,disabled:o},e.Label):void 0,i.createElement("div",{className:r,disabled:o},this.hasDatePicker()?this.createDatePicker():void 0,this.hasTimePicker()?this.createTimePicker():void 0,e.children)]},t.prototype.componentWillMount=function(){void 0===t.timeFormat&&this.hasTimePicker()&&(t.timeFormat=OfficeFormServerInfo.cultureInfo.DateTimeFormat.ShortTimePattern,t.timeFormat=t.timeFormat.replace(/mm/g,"i").replace(/tt/g,"A").replace(/s/g,"0"),(t.timeFormat.indexOf("m")>=0||t.timeFormat.indexOf("t")>=0)&&(t.timeFormat=null))},t.prototype.componentDidMount=function(){var e=this,r=c.a.LocalizedStrings;if(this.hasDatePicker()){var n=a.findDOMNode(this.refs.date_picker),o=$(n).pickadate({monthsShort:OfficeFormServerInfo.cultureInfo.DateTimeFormat.AbbreviatedMonthNames,weekdaysShort:OfficeFormServerInfo.cultureInfo.DateTimeFormat.AbbreviatedDayNames,firstDay:OfficeFormServerInfo.cultureInfo.DateTimeFormat.FirstDayOfWeek,today:r.DateTimePicker_Button_Today||void 0,clear:this.props.ShowClearButton?r.DateTimePicker_Button_Clear||void 0:"",close:r.DateTimePicker_Button_Close||void 0,labelMonthNext:r.DateTimePicker_Label_NextMonth||void 0,labelMonthPrev:r.DateTimePicker_Label_PrevMonth||void 0,labelMonthSelect:r.DateTimePicker_Label_SelectMonth||void 0,labelYearSelect:r.DateTimePicker_Label_SelectYear||void 0,closeOnClear:!1,editable:!0,selectYears:200,selectMonths:!1,showMonthsShort:!0,onSet:function(t){var r;void 0===t.clear?null!=t.select&&(r=d.a.isNumber(t.select)?new Date(t.select):t.select.obj,e.setDate(r)):e.setDate(void 0)}});this.datePicker=o.pickadate("picker")}if(this.hasTimePicker()){var i=a.findDOMNode(this.refs.time_picker),s=$(i).pickatime({clear:"",format:t.timeFormat,editable:!0,interval:30,select:this.getTimeNumber(),onSet:function(t){if(null!=t.select){var r;if(e.hasDatePicker()){var n,o,i=new Date(e.props.Value);d.a.isNumber(t.select)?(n=t.select%60,o=(t.select-n)/60):(o=t.select.hour,n=t.select.mins),i.setHours(o,n,0,0),r=i.toJSON()}else r=t.select.toString();e.props.Value!==r&&(e.props.onValueChange(r),e.forceUpdate())}}});this.timePicker=s.pickatime("picker")}this.updateDateTimePickers()},t.prototype.componentDidUpdate=function(){this.updateDateTimePickers()},t.prototype.createDatePicker=function(){var e=this,t=this.props,r=t.Options&&t.Options.HTMLPropsForInnerElement;return i.createElement("div",{className:"office-form-date-time-picker office-form-theme-focus-border"},i.createElement("input",l.a.mergeReactProps(r,{className:"form-control border-no-radius datepicker",disabled:t.Disabled,placeholder:t.Placeholder||OfficeFormServerInfo.cultureInfo.DateTimeFormat.ShortDatePattern,ref:"date_input",onFocus:function(){t.onValueValidation&&t.onValueValidation(!0,!0)},onBlur:function(){var t=a.findDOMNode(e.refs.date_input).value,r=e.props;if(""===t&&null!=r.Value&&r.ShowClearButton)e.datePicker.clear(),e.setDate(void 0);else if(t&&t!==e.getDateString()){var n=Date.parseDate(t,OfficeFormServerInfo.cultureInfo.DateTimeFormat.ShortDatePattern,OfficeFormServerInfo.cultureInfo);null==n?r.onValueValidation&&r.onValueValidation(!1,!0):e.setDate(n)}},onClick:function(r){t.Disabled||(r.stopPropagation(),r.nativeEvent.stopImmediatePropagation(),e.datePicker.open())},onKeyUp:l.a.onKeyboardEvent((function(e){return e.stopPropagation()}),s.a.Esc),onKeyDown:Object(f.e)((function(){return l.a.onKeyboardEvent((function(r){r.stopPropagation(),r.keyCode!=s.a.Enter&&r.which!=s.a.Enter||t.Disabled||e.datePicker.open()}))}))})),Object(m.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",Icon:"Calendar",IconClassName:"dateIcon forms-icon-size20x20",HTMLAttributes:{disabled:t.Disabled,tabIndex:-1,onClick:function(r){t.Disabled||(r.stopPropagation(),r.nativeEvent.stopImmediatePropagation(),e.datePicker.open())},title:t.DateTitle,"aria-label":t.DateTitle}}),i.createElement("input",{ref:"date_picker",style:{display:"none"}}))},t.prototype.createTimePicker=function(){var e=this,t=this.props;return i.createElement("div",{className:"office-form-date-time-picker office-form-theme-focus-border"},i.createElement("input",{className:"form-control border-no-radius datepicker",disabled:t.Disabled,placeholder:OfficeFormServerInfo.cultureInfo.DateTimeFormat.ShortTimePattern,readOnly:!0,tabIndex:-1,ref:"time_picker",onFocus:function(){t.onValueValidation&&t.onValueValidation(!0,!1)},onBlur:function(){var t=a.findDOMNode(e.refs.time_picker).value;if(t&&t!==e.getTimeString()){var r=e.props,n=void 0;n=e.hasDatePicker()?new Date(r.Value):new Date;var o=Date.parseTime(t,OfficeFormServerInfo.cultureInfo.DateTimeFormat.ShortTimePattern,OfficeFormServerInfo.cultureInfo);if(isNaN(o))r.onValueValidation&&r.onValueValidation(!1,!1);else{var i=Math.floor(o/1e3/60/60),s=o/1e3/60%60,c=o/1e3%60;n.setHours(i,s,c),e.setDate(n,!0)}}},onKeyUp:l.a.onKeyboardEvent((function(e){return e.stopPropagation()}),s.a.Esc)}),Object(m.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",Icon:"ChevronDown",IconClassName:"dateCaretDown forms-icon-size16x16",HTMLAttributes:l.a.mergeReactProps(t.Options&&t.Options.HTMLPropsForInnerElement,{disabled:t.Disabled,onClick:function(r){t.Disabled||(r.stopPropagation(),e.timePicker.open())},title:t.TimeTitle,"aria-label":t.TimeTitle})}))},t.prototype.hasDatePicker=function(){return this.props.Type!==o.TimePicker},t.prototype.hasTimePicker=function(){return this.props.Type!==o.DatePicker},t.prototype.isValueInvalid=function(){var e=this.props.Value;return this.hasDatePicker()?isNaN(Date.parse(e)):isNaN(Number(e))},t.prototype.getDateNumber=function(){if(this.hasDatePicker()&&!this.isValueInvalid())return this.props.IsLocaleInvariant?t.parseLocaleInvariantString(this.props.Value).valueOf():Date.parse(this.props.Value)},t.prototype.getDateString=function(){if(this.hasDatePicker())return this.isValueInvalid()?"":(this.props.IsLocaleInvariant?Date.parseDate(this.props.Value,"yyyy-MM-dd",OfficeFormServerInfo.cultureInfo):new Date(this.props.Value)).toDateShortString(OfficeFormServerInfo.cultureInfo)},t.prototype.getTimeNumber=function(){if(this.hasTimePicker()&&!this.isValueInvalid()){if(this.hasDatePicker()){var e=new Date(this.props.Value);return 60*e.getHours()+e.getMinutes()}return parseInt(this.props.Value)}},t.prototype.getTimeString=function(){if(this.hasTimePicker())return this.isValueInvalid()?"":new Date(this.props.Value).toLocaleTimeString(OfficeFormServerInfo.cultureInfo.Name)},t.prototype.setDate=function(e,r){var n=this.props,o=void 0;if(null!=e){var i=new Date(n.Value);i.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),r&&i.setHours(e.getHours(),e.getMinutes(),e.getSeconds()),o=n.IsLocaleInvariant?t.formatLocaleInvariantString(i,!this.hasTimePicker()):i.toJSON()}n.Value!==o&&(n.onValueChange(o),this.forceUpdate())},t.prototype.updateDateTimePickers=function(){var e=this.props,t=new Date(e.Value),r={Start:void 0,End:void 0},n=!1,o=!1;(e.AllowedDateTime&&(e.AllowedDateTime.Start&&(r.Start=new Date(e.AllowedDateTime.Start.toJSON()),r.Start.setMinutes(60,0,0),n=u.a.isLocalDateEqual(r.Start,t),u.a.compareLocalTime(r.Start,t)>0&&r.Start.setDate(r.Start.getDate()+1)),e.AllowedDateTime.End&&(r.End=new Date(e.AllowedDateTime.End.toJSON()),r.End.setMinutes(0,0,0),o=u.a.isLocalDateEqual(r.End,t),u.a.compareLocalTime(r.End,t)<0&&r.End.setDate(r.End.getDate()-1))),this.hasDatePicker())&&(this.datePicker.set({min:void 0!==r.Start&&r.Start,max:void 0!==r.End&&r.End,select:this.getDateNumber()}),a.findDOMNode(this.refs.date_input).value=this.getDateString());this.hasTimePicker()&&this.timePicker.set({min:n&&r.Start,max:o&&r.End,select:this.getTimeNumber()})},t.formatLocaleInvariantString=function(e,t){var r=new Date;r.setUTCFullYear(e.getFullYear(),e.getMonth(),e.getDate()),r.setUTCHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());var n=r.toISOString();return n.slice(0,n.indexOf(t?"T":"Z"))},t.parseLocaleInvariantString=function(e){var t=new Date(e);return t.setFullYear(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()),t.setHours(t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds()),t},t}(p.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(11),o=r(169),i=r(36),a=r(23),s=r(75),c=r(32),u=n.a.isProduction()?"https://graph.microsoft.com/v1.0/":"https://graph.microsoft-ppe.com/v1.0/",l=function(){function e(e){this.formId=e;var t=Object(s.c)(e);t&&(this.dataProvider=a.a.getDataProviderByFormMaster(t))}return e.prototype.createFileUploadSession=function(e,t){return this.dataProvider.createUploadSession(this.formId,e,t).then((function(e){return null==e?$.Deferred().reject(new Error("no data return")).promise():e}))},e.prototype.cancelOrDeleteUploadFile=function(e){return this.dataProvider.cancelOrDeleteUploadFile(e)},e.prototype.uploadBytesToSession=function(e,t,r,n,o,i){return Object(c.b)({body:t,headers:{"Content-Range":"bytes "+n+"-"+o+"/"+i,"Content-Type":"*/*"},method:"PUT",qosEventName:"FileUpload.UploadFile",requestUri:e.uploadUrl})},e.prototype.getFileFolder=function(e){var t=this;return Object(o.a)((function(r){return Object(c.b)({headers:{Authorization:r,"Content-Type":"*/*"},method:"GET",qosEventName:"FileUpload.GetOD4BFolderPath",requestUri:u+(n=t.formId,o=Object(i.a)(n),a=o.OwnerId,s=o.OrgId,l=o.IsGroupOwner?"groups":"users",s+"/"+l+"/"+a)+"/drive/items/"+e}).then((function(e){return e.webUrl}));var n,o,a,s,l}))},e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n,o=r(0),i=r(3),a=r(12),s=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),c=function(){return(c=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function u(e){return o.createElement(l,c({},e))}var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.splitContentIntoLines=function(){var e=this.props.content;return(i.isUndefined(this.props.trim)||this.props.trim)&&(e=e.trim()),e.split("\n")},t.prototype.render=function(){var e=this.splitContentIntoLines();return o.createElement("span",null,e.map((function(t,r){var n=r!==e.length-1?o.createElement("br",null):void 0;return o.createElement("span",null,t,n)})))},t}(a.a)},,,function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n,o=r(0),i=r(106),a=r(22),s=r(114),c=r(12),u=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.messageElementRef=o.createRef(),t}return u(t,e),t.prototype.componentDidMount=function(){Object(i.a)($(this.messageElementRef.current))},t.prototype.render=function(){return o.createElement(s.a,{Role:"Log",LazyRendering:!1},o.createElement("div",{className:"thank-you-page-confirm"},o.createElement(a.a,{HTMLAttributes:{className:"office-form-theme-primary-color thank-you-page-font-icon"},IconName:"Completed"}),o.createElement("span",{className:"thank-you-page-comfirm-text"},this.props.ConfirmText)),o.createElement("div",{className:"thank-you-page-container thank-you-page-message",ref:this.messageElementRef,tabIndex:-1},this.props.Message))},t}(c.a)},function(e,t,r){"use strict";var n,o,i=r(0),a=r(25),s=r(5),c=r(9),u=r(89),l=r(20),d=r(85),f=r(12),p=r(27),m=r(80),h=r(17),g="vk-keys-row-key",y="symbol";!function(e){e[e.KeyEmpty=-1]="KeyEmpty",e[e.KeyZero=0]="KeyZero",e[e.KeyOne=1]="KeyOne",e[e.KeyTwo=2]="KeyTwo",e[e.KeyThree=3]="KeyThree",e[e.KeyFour=4]="KeyFour",e[e.KeyFive=5]="KeyFive",e[e.KeySix=6]="KeySix",e[e.KeySeven=7]="KeySeven",e[e.KeyEight=8]="KeyEight",e[e.KeyNine=9]="KeyNine",e[e.KeyEqual=10]="KeyEqual",e[e.KeyDot=11]="KeyDot",e[e.KeyComma=12]="KeyComma",e[e.KeyBackSpace=13]="KeyBackSpace",e[e.KeyLeftArrow=14]="KeyLeftArrow",e[e.KeyRightArrow=15]="KeyRightArrow",e[e.KeyAdd=16]="KeyAdd",e[e.KeyMinus=17]="KeyMinus",e[e.KeyMultiple=18]="KeyMultiple",e[e.KeyDivision=19]="KeyDivision",e[e.KeyGreaterOrEqual=20]="KeyGreaterOrEqual",e[e.KeyLessOrEqual=21]="KeyLessOrEqual",e[e.KeyParenthesis=22]="KeyParenthesis",e[e.KeyBracket=23]="KeyBracket",e[e.KeyAbs=24]="KeyAbs",e[e.KeyDenominator=25]="KeyDenominator",e[e.KeySquareRoot=26]="KeySquareRoot",e[e.KeyNthRoot=27]="KeyNthRoot",e[e.KeyX=28]="KeyX",e[e.KeyY=29]="KeyY",e[e.KeySquare=30]="KeySquare",e[e.KeyCaret=31]="KeyCaret",e[e.KeySubscript=32]="KeySubscript",e[e.KeyPi=33]="KeyPi",e[e.KeyAlpha=34]="KeyAlpha",e[e.KeyBeta=35]="KeyBeta",e[e.KeyDelta=36]="KeyDelta",e[e.KeyTheta=37]="KeyTheta",e[e.KeyGamma=38]="KeyGamma",e[e.KeySigma=39]="KeySigma",e[e.KeyLambda=40]="KeyLambda",e[e.KeyVarepsilon=41]="KeyVarepsilon",e[e.KeyCapitalSigma=42]="KeyCapitalSigma",e[e.KeyPhi=43]="KeyPhi",e[e.KeyCapitalDelta=44]="KeyCapitalDelta",e[e.KeyLog=45]="KeyLog",e[e.KeyLn=46]="KeyLn",e[e.KeyFactorial=47]="KeyFactorial",e[e.KeyInfinity=48]="KeyInfinity",e[e.KeyGreater=49]="KeyGreater",e[e.KeyLess=50]="KeyLess",e[e.KeyNotEqual=51]="KeyNotEqual",e[e.KeyMod=52]="KeyMod",e[e.KeyFloor=53]="KeyFloor",e[e.KeyCeil=54]="KeyCeil",e[e.KeySum=55]="KeySum",e[e.KeyProd=56]="KeyProd",e[e.KeyEnter=57]="KeyEnter",e[e.KeySin=58]="KeySin",e[e.KeyCos=59]="KeyCos",e[e.KeyTan=60]="KeyTan",e[e.KeyCot=61]="KeyCot",e[e.KeyDegree=62]="KeyDegree"}(n||(n={})),function(e){e[e.AlgebraKeyboard=0]="AlgebraKeyboard",e[e.BasicKeyboard=1]="BasicKeyboard"}(o||(o={}));var b,v=[n.KeyLog,n.KeyFactorial,n.KeyCeil,n.KeyFloor],S=function(){function e(){}return e.getAlgebraLayout=function(){return e.algebraLayoutArray},e.getLayoutRowCount=function(e){return e?0:e.length},e.getLayoutColumnCount=function(e){return e&&e.length>0?e[0].length:0},e.getKeyMap=function(t){var r=[];if(!t)return r;for(var n=t.length,o=e.getLayoutColumnCount(t),i=0,a=0;a<n;a++)for(var s=0;s<o;s++)r[i]=t[a][s],i++;return r},e.algebraLayoutArray=[[n.KeyX,n.KeyY,n.KeySubscript,n.KeyDenominator,n.KeyBracket,n.KeyParenthesis,n.KeySeven,n.KeyEight,n.KeyNine,n.KeyDivision],[n.KeyGreater,n.KeyLess,n.KeyGreaterOrEqual,n.KeyLessOrEqual,n.KeyNotEqual,n.KeyAbs,n.KeyFour,n.KeyFive,n.KeySix,n.KeyMultiple],[n.KeySquareRoot,n.KeyNthRoot,n.KeySquare,n.KeyCaret,n.KeyLog,n.KeyLn,n.KeyOne,n.KeyTwo,n.KeyThree,n.KeyMinus],[n.KeyPi,n.KeyFactorial,n.KeySum,n.KeyProd,n.KeyFloor,n.KeyCeil,n.KeyZero,n.KeyDot,n.KeyEqual,n.KeyAdd],[n.KeyInfinity,n.KeyDegree,n.KeyEmpty,n.KeyBackSpace,n.KeyLeftArrow,n.KeyRightArrow,n.KeyEnter]],e}(),I=r(2),M=function(){function e(){this.keyStorage=[{id:n.KeyEmpty,command:null,type:null,value:null,displayValue:null,category:"empty",title:null},{id:n.KeyZero,command:"write",type:"string",value:"0",displayValue:"0",category:"basic",title:"0"},{id:n.KeyOne,command:"write",type:"string",value:"1",displayValue:"1",category:"basic",title:"1"},{id:n.KeyTwo,command:"write",type:"string",value:"2",displayValue:"2",category:"basic",title:"2"},{id:n.KeyThree,command:"write",type:"string",value:"3",displayValue:"3",category:"basic",title:"3"},{id:n.KeyFour,command:"write",type:"string",value:"4",displayValue:"4",category:"basic",title:"4"},{id:n.KeyFive,command:"write",type:"string",value:"5",displayValue:"5",category:"basic",title:"5"},{id:n.KeySix,command:"write",type:"string",value:"6",displayValue:"6",category:"basic",title:"6"},{id:n.KeySeven,command:"write",type:"string",value:"7",displayValue:"7",category:"basic",title:"7"},{id:n.KeyEight,command:"write",type:"string",value:"8",displayValue:"8",category:"basic",title:"8"},{id:n.KeyNine,command:"write",type:"string",value:"9",displayValue:"9",category:"basic",title:"9"},{id:n.KeyEqual,command:"write",type:"string",value:"=",displayValue:"=",category:"calculating",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Equal},{id:n.KeyDot,command:"write",type:"string",value:".",displayValue:".",category:"basic",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Dot},{id:n.KeyComma,command:"write",type:"string",value:",",displayValue:",",category:"basic",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Comma},{id:n.KeyBackSpace,command:"keystroke",type:"string",value:"Backspace",displayValue:"CE",category:"function",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Backspace},{id:n.KeyLeftArrow,command:"keystroke",type:"string",value:"Left",displayValue:"",category:"function",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Leftarrow},{id:n.KeyRightArrow,command:"keystroke",type:"string",value:"Right",displayValue:"",category:"function",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Rightarrow},{id:n.KeyAdd,command:"write",type:"string",value:"+",displayValue:"+",category:"calculating",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Add},{id:n.KeyMinus,command:"write",type:"string",value:"-",displayValue:"-",category:"calculating",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Minus},{id:n.KeyMultiple,command:"write",type:"string",value:"\\times",displayValue:"",category:"calculating",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Multiply},{id:n.KeyDivision,command:"cmd",type:"string",value:"\\div",displayValue:"",category:"calculating",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Division},{id:n.KeyGreaterOrEqual,command:"cmd",type:"string",value:"\\ge",displayValue:"",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_GreaterOrEqual},{id:n.KeyLessOrEqual,command:"cmd",type:"string",value:"\\le",displayValue:"",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_LessOrEqual},{id:n.KeyParenthesis,command:"cmd",type:"string",value:"(",displayValue:"( )",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Parenthesis},{id:n.KeyBracket,command:"cmd",type:"string",value:"[",displayValue:"[ ]",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Bracket},{id:n.KeyAbs,command:"cmd",type:"string",value:"|",displayValue:"|x|",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Absolute},{id:n.KeyDenominator,command:"cmd",type:y,value:"/",displayValue:"\\frac{x}{}",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Fraction},{id:n.KeySquareRoot,command:"cmd",type:y,value:"\\sqrt",displayValue:"\\sqrt{}",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_SquareRoot},{id:n.KeyNthRoot,command:"cmd",type:y,value:"\\nthroot",displayValue:"\\sqrt[]{}",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_NthRoot},{id:n.KeyX,command:"write",type:"string",value:"x",displayValue:"x",category:"algebra",title:"x"},{id:n.KeyY,command:"write",type:"string",value:"y",displayValue:"y",category:"algebra",title:"y"},{id:n.KeySquare,command:"write",type:y,value:"^2",displayValue:"x^2",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Square},{id:n.KeyCaret,command:"cmd",type:y,value:"^",displayValue:"x^{}",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Exponent},{id:n.KeySubscript,command:"cmd",type:y,value:"_",displayValue:"x_{}",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Subscript},{id:n.KeyPi,command:"write",type:"string",value:"\\pi",displayValue:"",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Pi},{id:n.KeyAlpha,command:"write",type:"string",value:"\\alpha",displayValue:"",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Alpha},{id:n.KeyBeta,command:"write",type:"string",value:"\\beta",displayValue:"",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Beta},{id:n.KeyDelta,command:"write",type:"string",value:"\\delta",displayValue:"",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Delta},{id:n.KeyTheta,command:"write",type:"string",value:"\\theta",displayValue:"",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Theta},{id:n.KeyGamma,command:"write",type:"string",value:"\\gamma",displayValue:"",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Gamma},{id:n.KeySigma,command:"write",type:"string",value:"\\sigma",displayValue:"",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Sigma},{id:n.KeyLambda,command:"write",type:"string",value:"\\lambda",displayValue:"",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Lambda},{id:n.KeyVarepsilon,command:"write",type:"string",value:"\\varepsilon",displayValue:"",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Varepsilon},{id:n.KeyCapitalSigma,command:"write",type:"string",value:"\\Sigma",displayValue:"",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_CapitalSigma},{id:n.KeyPhi,command:"write",type:"string",value:"\\phi",displayValue:"",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Phi},{id:n.KeyCapitalDelta,command:"write",type:"string",value:"\\Delta",displayValue:"",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_CapitalDelta},{id:n.KeyLog,command:"write",type:y,value:"\\log_{}",displayValue:"\\log_{}",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Log},{id:n.KeyLn,command:"cmd",type:"string",value:"\\ln",displayValue:"ln",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Ln},{id:n.KeyFactorial,command:"write",type:"string",value:"!",displayValue:"x!",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Factorial},{id:n.KeyInfinity,command:"cmd",type:"string",value:"\\infty",displayValue:"",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Infinity},{id:n.KeyGreater,command:"write",type:"string",value:">",displayValue:">",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Greater},{id:n.KeyLess,command:"write",type:"string",value:"<",displayValue:"<",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Less},{id:n.KeyNotEqual,command:"cmd",type:"string",value:"\\neq",displayValue:"",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_NotEqual},{id:n.KeyMod,command:"cmd",type:"string",value:"\\mod",displayValue:"mod",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Mod},{id:n.KeyFloor,command:"write",type:"string",value:"\\lfloor{}\\rfloor",displayValue:"x",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Floor},{id:n.KeyCeil,command:"write",type:"string",value:"\\lceil{}\\rceil",displayValue:"x",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Ceil},{id:n.KeySum,command:"cmd",type:"string",value:"\\sum",displayValue:"",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Sum},{id:n.KeyProd,command:"cmd",type:"string",value:"\\prod",displayValue:"",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Prod},{id:n.KeyEnter,command:"submit",type:"string",value:"Enter",displayValue:"OK",category:"function",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Enter},{id:n.KeySin,command:"cmd",type:"string",value:"\\sin",displayValue:"sin",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Sin},{id:n.KeyCos,command:"cmd",type:"string",value:"\\cos",displayValue:"cos",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Cos},{id:n.KeyTan,command:"cmd",type:"string",value:"\\tan",displayValue:"tan",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Tan},{id:n.KeyCot,command:"cmd",type:"string",value:"\\cot",displayValue:"cot",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Cot},{id:n.KeyDegree,command:"write",type:y,value:"^\\circ",displayValue:"^\\circ",category:"algebra",title:I.a.LocalizedStrings.VirtualKeyboard_Button_Degree}]}return e.prototype.getDefinition=function(e){return this.keyStorage.filter((function(t){return t.id===e}))[0]},e}(),F=r(13),O=function(){function e(){this.clickUsage={},this.keydownUsage={},this.keyCategory=[{id:n.KeyDot,category:b.Decimal},{id:n.KeyX,category:b.Variable},{id:n.KeyY,category:b.Variable},{id:n.KeySubscript,category:b.Variable},{id:n.KeyDenominator,category:b.Variable},{id:n.KeyPi,category:b.Constant},{id:n.KeyInfinity,category:b.Constant},{id:n.KeyBracket,category:b.Group},{id:n.KeyParenthesis,category:b.Group},{id:n.KeyGreater,category:b.Comparison},{id:n.KeyGreaterOrEqual,category:b.Comparison},{id:n.KeyLess,category:b.Comparison},{id:n.KeyLessOrEqual,category:b.Comparison},{id:n.KeyNotEqual,category:b.Comparison},{id:n.KeyNthRoot,category:b.Exponent},{id:n.KeySquareRoot,category:b.Exponent},{id:n.KeySquare,category:b.Exponent},{id:n.KeyCaret,category:b.Exponent},{id:n.KeyLog,category:b.Logarithm},{id:n.KeyLn,category:b.Logarithm},{id:n.KeyFactorial,category:b.Sequence},{id:n.KeySum,category:b.Sequence},{id:n.KeyProd,category:b.Sequence},{id:n.KeyCeil,category:b.Approximate},{id:n.KeyFloor,category:b.Approximate},{id:n.KeyAbs,category:b.Absolute},{id:n.KeyDegree,category:b.Degree}];for(var e=F.h(b),t=0;t<e.length;t++)this.clickUsage[e[t]]=0,this.keydownUsage[e[t]]=0}return e.prototype.setClickUsage=function(e){var t=this.getCategoryByKeyId(e);t>=0&&this.clickUsage[b[t]]++},e.prototype.setKeyDownUsage=function(e){var t=this.getCategoryByKeyId(e);t>=0&&this.keydownUsage[b[t]]++},e.prototype.getClickUsage=function(){return this.clickUsage},e.prototype.getKeyDownUsage=function(){return this.keydownUsage},e.prototype.getCategoryByKeyId=function(e){var t=this.keyCategory.filter((function(t){return t.id===e}));return t&&t[0]?t[0].category:-1},e}();!function(e){e[e.Decimal=0]="Decimal",e[e.Variable=1]="Variable",e[e.Constant=2]="Constant",e[e.Group=3]="Group",e[e.Comparison=4]="Comparison",e[e.Exponent=5]="Exponent",e[e.Logarithm=6]="Logarithm",e[e.Sequence=7]="Sequence",e[e.Approximate=8]="Approximate",e[e.Absolute=9]="Absolute",e[e.Degree=10]="Degree"}(b||(b={}));var C,P=function(){function e(e,t){this.controlId=null,this.isTabable=!0,this.isVisible=!1,this.isMouseDown=!1,this.onMathEditorInsertion=new m.a.CallbackManager,this.onInputCompleted=new m.a.CallbackManager,this.onExitEditingMath=new m.a.CallbackManager,this.mathEditor=null,this.editorAndKeysContainer=null,this.editorContainer=null,this.editorInput=null,this.keysContainer=null,this.keyMap=[],this.keyLayoutColumnCount=null,this.keyStrokeManager=new M,this.keyUsageManager=new O,this.outsiderContainerSelector="#body-scrollable-content",this.controlId=t||p.a.newGuid(),this.createLayout(e),this.activateKeyboard()}return e.prototype.show=function(){this.isVisible||(this.editorAndKeysContainer.show(),this.mathEditor.focus(),this.isVisible=!0)},e.prototype.close=function(){var e=this.keyUsageManager.getClickUsage(),t=this.keyUsageManager.getKeyDownUsage();h.a.logData({name:"DesignPage.MathKeyboard.Navigate",extraData:{clickCount:e,keydownCount:t}}),$(this.outsiderContainerSelector).off("click",this.onBodyClick),this.isVisible&&(this.editorAndKeysContainer.hide(),this.isVisible=!1)},e.prototype.attachEvent=function(e,t){if(t)switch(e){case"onMathInsertion":this.onMathEditorInsertion.register(t);break;case"onInputCompleted":this.onInputCompleted.register(t);break;case"onExitEditingMath":this.onExitEditingMath.register(t)}},e.prototype.detachEvent=function(e,t){switch(e){case"onMathInsertion":this.onMathEditorInsertion.unregister(t);break;case"onInputCompleted":this.onInputCompleted.unregister(t);break;case"onExitEditingMath":this.onExitEditingMath.unregister(t)}},e.prototype.setValue=function(e){this.mathEditor.select(),this.mathEditor.write(e),this.mathEditor.focus()},e.prototype.getValue=function(){return this.mathEditor.latex()},e.prototype.reset=function(){this.mathEditor.select(),this.mathEditor.keystroke("Backspace"),this.mathEditor.focus()},e.prototype.getElementId=function(e){return[this.controlId,e].join("_")},e.prototype.parseKeyId=function(e){var t=e.split("_");return t.length>=2?Number(t[1]):null},e.prototype.createLayout=function(e){this.editorAndKeysContainer=$("<div/>",{id:this.getElementId("virtualkeyboard"),dir:"ltr"}).addClass("vk-container").appendTo(e),this.createEditorLayout(),this.createKeysLayout()},e.prototype.activateKeyboard=function(){var e=this;this.onBodyClick=function(t){e.editorAndKeysContainer&&!e.editorAndKeysContainer.is(t.target)&&0===e.editorAndKeysContainer.has(t.target).length&&(e.isMouseDown?(t.preventDefault(),t.stopPropagation(),e.isMouseDown=!1):e.onInputCompleted.trigger(t))},$(this.outsiderContainerSelector).click(this.onBodyClick),this.editorInput.mousedown((function(t){t.preventDefault(),t.stopPropagation(),e.isMouseDown=!0})),this.editorInput.mouseup((function(t){e.isMouseDown=!1})),this.activateEditor(),this.activateKeys()},e.prototype.createEditorLayout=function(){this.editorContainer=$("<div/>").addClass("vk-editor-container").attr({"aria-live":"polite"}).appendTo(this.editorAndKeysContainer),this.editorInput=$("<span/>").addClass("vk-editor-input").appendTo(this.editorContainer)},e.prototype.createKeysLayout=function(){this.keysContainer=$("<div/>").addClass("vk-keys-container").appendTo(this.editorAndKeysContainer);var e=$("<div/>").addClass("vk-keys-algebrakeys").attr({role:"grid"}).appendTo(this.keysContainer);this.createSubKeysLayout(e)},e.prototype.createSubKeysLayout=function(e){var t=this;if("vk-keys-algebrakeys"!==e.attr("class"))throw Error("className is not found.");S.getAlgebraLayout().forEach((function(r){var o=$("<div/>").addClass("vk-keys-row").attr({role:"row"}).appendTo(e);r.forEach((function(e){var r=t.keyStrokeManager.getDefinition(e);if(r){var i={class:s.a.combineAttributes("office-form-theme-interactive-color",g),id:t.getElementId(r.id.toString()),tabindex:-1,title:r.title,role:"gridcell","aria-label":r.title};i["mq-command"]=r.command,i["mq-value"]=r.value,i["mq-category"]=r.category;var a=r.id===n.KeyEmpty?$("<div/>"):$("<button/>");a.attr(i).appendTo(o),$("<span/>").addClass([g,r.type].join("-")).text(r.displayValue).attr({"aria-hidden":!0}).appendTo(a),t.isTabable&&(a.removeAttr("tabindex"),t.isTabable=!1),"submit"===r.command&&(a.removeClass("office-form-theme-interactive-color"),a.addClass("office-form-theme-button"),a.removeAttr("mq-category"))}}))}))},e.prototype.activateEditor=function(){var e=this;if(!(this.editorInput&&this.editorInput.length>0))throw Error("Can not render mathField, editorInput is undefined.");var t=MathQuill.getInterface(2).MathField(this.editorInput[0]);this.mathEditor=t,this.editorInput.on("mousedown",".mq-text-mode",(function(e){e.preventDefault(),e.stopPropagation()})),this.editorInput.on("keypress",(function(t){var r=t.charCode||t.which,o=String.fromCharCode(r);o&&o.match(/^[(0-9.=+*\-)]$/)&&("*"===o&&(t.preventDefault(),t.stopPropagation(),o=e.keyStrokeManager.getDefinition(n.KeyMultiple).value,e.mathEditor.write(o),o="\\"+o),e.keyAnimation(o))})),this.editorInput.on("keydown",(function(t){var r=t.keyCode||t.which,n=null;switch(r){case a.a.ArrowLeft:n="Left";break;case a.a.ArrowRight:n="Right";break;case a.a.BackSpace:n="Backspace"}e.keyAnimation(n),r===a.a.Enter?(t.preventDefault(),t.stopPropagation(),e.onInputCompleted.trigger(t)):r===a.a.PlaceHolder?t.key&&t.key.match(/^[a-zA-Z]$|^Unidentified$/)&&(t.preventDefault(),t.stopPropagation()):t.shiftKey&&r===a.a.Tab?e.onInputCompleted.trigger(t):r===a.a.Esc&&e.onExitEditingMath.trigger(t)}))},e.prototype.activateKeys=function(){var e=this,t=this.keysContainer.find("."+[g,y].join("-")),r=S.getAlgebraLayout();this.keyMap=S.getKeyMap(r),this.keyLayoutColumnCount=S.getLayoutColumnCount(r);for(var n=0;n<t.length;n++)MathQuill.getInterface(2).StaticMath(t[n]);this.keysContainer.on("mousedown",(function(t){t.preventDefault(),t.stopPropagation(),e.mathEditor.focus()})),this.keysContainer.find("."+g).on("mousedown",(function(t){if(!e.mathEditor)throw Error("mathEditor undefined.");t.preventDefault(),t.stopPropagation();var r=$(t.currentTarget);e.keyUsageManager.setClickUsage(e.getKeyId(r)),e.sendMathCommand(r),e.mathEditor.focus()})),this.keysContainer.find(".mq-root-block").on("mousedown",(function(t){t.preventDefault(),t.stopPropagation();var r=$(t.currentTarget).closest("."+g);e.sendMathCommand(r)})),this.keysContainer.find("."+g).on("keydown",(function(t){var r=t.which||t.keyCode;if(!t.shiftKey){var n=$(t.currentTarget);switch(r){case a.a.ArrowDown:case a.a.ArrowUp:case a.a.ArrowLeft:case a.a.ArrowRight:t.preventDefault(),t.stopPropagation();var o=e.getNextKeyId(n,r);if(o>=0){var i=e.getElementId(o.toString());$("#"+i).focus()}break;case a.a.Enter:case a.a.Space:t.preventDefault(),t.stopPropagation(),e.keyUsageManager.setKeyDownUsage(e.getKeyId(n)),e.sendMathCommand(n),n.focus();break;case a.a.BackSpace:t.preventDefault(),t.stopPropagation(),e.mathEditor.keystroke("Backspace");break;case a.a.Esc:e.onExitEditingMath.trigger(t)}}})),this.keysContainer.find("."+g).on("keypress",(function(t){t.charCode>0&&e.mathEditor.typedText(String.fromCharCode(t.charCode))}))},e.prototype.sendMathCommand=function(e){var t=e.attr("mq-command"),r=e.attr("mq-value");switch(t){case"cmd":this.mathEditor.cmd(r);break;case"write":this.mathEditor.write(r);break;case"keystroke":this.mathEditor.keystroke(r);break;case"submit":this.onInputCompleted.trigger()}var n=this.parseKeyId(e.attr("id"));this.adjustCursor(n)},e.prototype.getNextKeyId=function(e,t){var r=this.parseKeyId(e.attr("id")),o=this.keyMap.indexOf(r);if(o>=0){var i=o+[-1,-1*this.keyLayoutColumnCount,1,this.keyLayoutColumnCount][t-a.a.ArrowLeft];if(i>=this.keyMap.length||i<=-1)return r;for(;this.keyMap[i]===n.KeyEmpty;)i+=t===a.a.ArrowRight?1:-1;return this.keyMap[i]}},e.prototype.keyAnimation=function(e){if(e){var t=this.keysContainer.find("[mq-value='"+e+"']");t&&(t.css("background-color","#D2D2D2"),setTimeout((function(){t.css("background-color","")}),200))}},e.prototype.getKeyId=function(e){var t=e.attr("id");if(t)return this.parseKeyId(t)},e.prototype.adjustCursor=function(e){-1!==v.indexOf(e)&&this.mathEditor.keystroke("Left")},e}(),T=(C=function(e,t){return(C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}C(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={MathQuillLoaded:!1},t.onBlur=function(e){var r=s.a.getTargetElementOfFocusEvent(e);l.findDOMNode(t).contains(r)||(t.props.onExit&&t.props.onExit(),t.props.onBoxBlur&&t.props.onBoxBlur(e))},t}return T(t,e),t.prototype.render=function(){return i.createElement("div",{onBlur:this.onBlur,ref:"VirtualKeyboard"})},t.prototype.componentWillMount=function(){var e=this;Object(d.a)("MathQuill").done((function(){e.setState({MathQuillLoaded:!0})}))},t.prototype.componentDidMount=function(){this.renderVirtualKeyboard()},t.prototype.componentDidUpdate=function(){this.renderVirtualKeyboard()},t.prototype.componentWillUnmount=function(){this.keyborad&&(this.props.onValueChange(this.keyborad.getValue()),this.keyborad.close(),this.keyborad.detachEvent("onInputCompleted",this.onValueChange),this.keyborad.detachEvent("onExitEditingMath",this.onExitEdit))},t.prototype.renderVirtualKeyboard=function(){var e=this;if(this.state.MathQuillLoaded&&!this.keyborad){var t=$(l.findDOMNode(this.refs.VirtualKeyboard));this.keyborad=new P(t,this.props.QuestionId),this.keyborad.show(),this.keyborad.setValue(this.props.Value),this.onExitEdit=function(t){e.props.onExit&&e.props.onExit(!0),e.props.onBoxBlur&&e.props.onBoxBlur()},this.onValueChange=function(t,r){e.props.onValueChange(e.keyborad.getValue()),e.onExitEdit(t)},this.keyborad.attachEvent("onInputCompleted",this.onValueChange),this.keyborad.attachEvent("onExitEditingMath",this.onExitEdit)}},t}(f.a);r.d(t,"a",(function(){return R}));var _=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),E=function(){return(E=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},R=function(e){function t(t){var r=e.call(this,t)||this;return r.formulaRef=i.createRef(),r.onKeyDown=r.onKeyDown.bind(r),r.onMouseDown=r.onMouseDown.bind(r),r.onExit=r.onExit.bind(r),r.onValueChange=r.onValueChange.bind(r),r.props.ForceDesignMode&&(r.state.InDesignMode=r.props.ForceDesignMode),r}return _(t,e),t.prototype.render=function(){var e;return e=this.state.InDesignMode?this.createDesignerComponent():this.createRendererComponent(),i.createElement("div",{className:"formula-designer-container",ref:this.props.containerRef},e,this.props.children)},t.prototype.componentDidMount=function(){!this.state.InDesignMode&&this.props.HasFocus&&this.setFocusOnFormulaMixer()},t.prototype.componentDidUpdate=function(){this.state.InDesignMode&&this.props.onRenderComplete&&this.props.onRenderComplete(null,null)},t.prototype.shouldComponentUpdate=function(e,t){return this.props.Value!==e.Value||this.state.InDesignMode!==t.InDesignMode},t.prototype.createRendererComponent=function(){var e=this,t=s.a.mergeReactProps(this.props.HTMLAttributes,{"aria-label":this.props.Value,className:this.props.Value?"design-formula-mixer":"design-formula-mixer placeholder",disabled:this.props.Disabled,key:"r",onKeyDown:this.onKeyDown,onMouseDown:this.onMouseDown,ref:this.formulaRef,role:"button",tabIndex:0}),r={DisableLinebreaks:!0,Formula:this.props.Value,onRenderComplete:function(t,r){e.props.onRenderComplete&&e.props.onRenderComplete(t,r)}};return this.props.Value?i.createElement("div",E({},t),Object(u.a)(r)):i.createElement("div",E({},t),this.props.Placeholder)},t.prototype.onKeyDown=function(e){var t=this;if(!this.props.Disabled)switch(e.keyCode){case a.a.Enter:case a.a.Space:this.setState({InDesignMode:!0},(function(){t.props.blockEndDesignMode&&t.props.blockEndDesignMode(!0)}))}},t.prototype.onMouseDown=function(e){var t=this;this.props.Disabled||setTimeout((function(){return t.setState({InDesignMode:!0},(function(){t.props.blockEndDesignMode&&t.props.blockEndDesignMode(!0)}))}),0)},t.prototype.createDesignerComponent=function(){var e={onBoxBlur:this.props.onBoxBlur,onExit:this.onExit,onValueChange:this.onValueChange,QuestionId:this.props.QuestionId,Value:this.props.Value};return i.createElement("div",{className:"design-keyboard-container",key:"d"},i.createElement(w,E({},e)))},t.prototype.onExit=function(e){var t=this;this.setState({InDesignMode:!1},(function(){t.props.blockEndDesignMode&&t.props.blockEndDesignMode(!1),e&&t.setFocusOnFormulaMixer()}))},t.prototype.onValueChange=function(e){this.props.Value!==e&&Object(c.a)({eventName:"DesignPage.Quiz.EditMathFormula",eventType:"engagement_event",extraData:{formulaLength:e?e.length:0,Location:this.props.Location,questionId:this.props.QuestionId}}),this.props.onValueChange(e)},t.prototype.setFocusOnFormulaMixer=function(){var e=this.formulaRef.current;e&&e.focus()},t}(f.a)},,function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n,o=r(3),i=r(214),a=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.calculateQuestionRuntimeList=function(e){var t,r=this,n=[];o.forEach(e,(function(e){t=r.formRuntimeMaster.getOrCreateQuestionRuntime(e),n.push(t),e.SubQuestionMasters.forEach((function(e){var t=r.formRuntimeMaster.getOrCreateQuestionRuntime(e);n.push(t)}))})),this.formRuntimeMaster.Model.QuestionRuntimeMasters=n,this.formRuntimeMaster.ensureProRuleManager()},t.prototype.getPreviousSection=function(){var e,t=this.formRuntimeMaster,r=t.Model.RuntimeSectionId,n=t.Form.FormElementManager,i=n.getDescriptiveElementMasterById(r),a=n.SectionMasters,s=o.findLastIndex(a,(function(e){return e.Model.Order<i.Model.Order}));if(null==r||s<0)return null;for(;s>=0;){e=a[s];var c=this.getRuntimeQuestionsWithSectionId(e.Model.Id);if(!(c.length>0))break;if((c=c.filter((function(e){return t.formsProQuestionVisiblityCheck(e)}))).length>0)break;s--}return s<0?null:e},t.prototype.getNextSection=function(){for(var e,t=this.formRuntimeMaster,r=t.Model.RuntimeSectionId,n=t.Form,i=function(){if(null==r)e=n.hasSection()?o.min(n.FormElementManager.SectionMasters,(function(e){return e.Model.Order})):null;else{var i=n.FormElementManager.getDescriptiveElementMasterById(r);e=o.find(n.FormElementManager.SectionMasters,(function(e){return e.Model.Order>i.Model.Order}))}if(null==e)return"break";var s=a.getRuntimeQuestionsWithSectionId(e.Model.Id);return s.length>0?(s=s.filter((function(e){return t.formsProQuestionVisiblityCheck(e)}))).length>0?"break":void(r=e.Model.Id):"break"},a=this;;){if("break"===i())break}return e},t}(i.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(3),o=r(4),i=function(){function e(){}return e.prototype.hasPrevSection=function(){return!!this.formRuntimeMaster.Model.RuntimeSectionId},e.prototype.gotoPrevSection=function(){var e=this.getPreviousSection();this.formRuntimeMaster.Model.RuntimeSectionId=null==e?null:e.Model.Id},e.prototype.hasNextSection=function(){return!!this.getNextSection()},e.prototype.gotoNextSection=function(){var e=this.getNextSection();e&&(this.formRuntimeMaster.Model.RuntimeSectionId=e.Model.Id)},e.prototype.getAllSections=function(){var e=this,t=[];t.push({TopQuestionMasters:this.getRuntimeQuestionsWithSectionId()});var r=this.formRuntimeMaster.Form.FormElementManager.SectionMasters.map((function(t){return{Section:t,TopQuestionMasters:e.getRuntimeQuestionsWithSectionId(t.Model.Id)}}));return t=t.concat(r)},e.prototype.getCurrentSection=function(){var e=this.formRuntimeMaster,t=e.Model.RuntimeSectionId;return{Section:t?e.Form.FormElementManager.getDescriptiveElementMasterById(t):void 0,TopQuestionMasters:this.getRuntimeQuestionsWithSectionId(t)}},e.prototype.isFirstPage=function(){return!this.getCurrentSection().Section},e.prototype.getRuntimeQuestionsWithSectionId=function(e){var t,r=o.a.convertToArray(this.formRuntimeMaster.Model.QuestionRuntimeMasters).filter((function(e){return!e.Question.Model.GroupId})),i=this.formRuntimeMaster.Form;if(e){var a=i.FormElementManager.getDescriptiveElementMasterById(e);t=r.filter((function(e){return e.Question.Model.Order>a.Model.Order}));var s=n.find(i.FormElementManager.SectionMasters,(function(e){return e.Model.Order>a.Model.Order}));s&&(t=n.filter(t,(function(e){return s.Model.Order>e.Question.Model.Order})))}else{var c=i.FormElementManager.SectionMasters,u=c.length&&c[0].Model.Order;t=r,u>0&&(t=n.filter(t,(function(e){return e.Question.Model.Order<u})))}return t},e}()},function(e,t,r){"use strict";var n,o=r(0),i=r(21),a=r(5),s=r(8),c=r(30),u=r(42),l=r(61),d=r(6),f=r(7),p=r(12),m=r(203),h=r(170),g=r(106),y=r(123),b=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.subTitleRef=o.createRef(),t}return b(t,e),t.prototype.componentWillMount=function(){var e=this;this.update=function(){return e.forceUpdate()};var t=s.c.Schema;this.props.Form.observe(this.update,[t.Title,t.Description,t.LogoInfo])},t.prototype.componentDidMount=function(){Object(g.a)($(this.subTitleRef.current))},t.prototype.componentWillUnmount=function(){this.props.Form.unobserve(this.update)},t.prototype.render=function(){var e,t,r=this.props.Form,n=r.Model,i=n.LogoInfo;if(n.Logo&&n.Logo.ResourceUrl&&i.TargetResourceId){var c=r.getImageMaster(s.c.Schema.Logo),u=r.getImageSettingsMaster(s.c.Schema.LogoInfo);e=o.createElement("div",{className:"logo-image-container old"},o.createElement(y.a,{Image:c,ImageSettings:u,ImageType:"Logo"}),Object(y.c)(c.Model))}n.Description&&!this.props.IsSmallSize&&(t=o.createElement("div",{className:"office-form-subtitle heading-1",ref:this.subTitleRef},n.Description));var l=a.a.combineAttributes("__title__ office-form-title-container office-form-form-title",!this.props.IsReadOnlyOnMobile&&"office-form-theme-primary-background",this.props.IsSmallSize&&"small-size");return o.createElement("div",{className:l},o.createElement("div",{className:"office-form-logo-title"},e,o.createElement("div",{className:"office-form-title heading-1"},o.createElement("span",{role:"heading","aria-level":1},n.Title))),t)},t}(p.a);r.d(t,"a",(function(){return F}));var S=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),I=function(){return(I=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return S(t,e),t.prototype.componentWillMount=function(){var e=this;this.update=function(){return e.forceUpdate()};var t=s.c.Schema;this.props.Form.observe(this.update,[t.Title,t.Description]);var r=this.props.Form.getImageSettingsMaster(s.c.Schema.LogoInfo),n=u.b.Schema;r.observe(this.update,[n.NaturalWidth,n.NaturalHeight]);var o=this.props.Form.getImageMaster(s.c.Schema.Logo),i=c.b.Schema;o.observe(this.update,[i.ImageProcessingStatus,i.UploadParameters])},t.prototype.componentWillUnmount=function(){this.props.Form.unobserve(this.update),this.props.Form.getImageSettingsMaster(s.c.Schema.LogoInfo).unobserve(this.update),this.props.Form.getImageMaster(s.c.Schema.Logo).unobserve(this.update)},t.prototype.render=function(){var e,t,r,n,i=this.props.Form,u=i.Model,d={className:a.a.combineAttributes("__title__ office-form-form-title",!this.props.IsReadOnlyOnMobile&&"office-form-theme-primary-background",this.props.IsSmallSize&&"small-size",this.props.IsSlimTitle&&"slim-size")},p="Left",g=i.getImageMaster(s.c.Schema.Logo),y=i.getImageSettingsMaster(s.c.Schema.LogoInfo),b=g.Model;if(!b.ErrorType&&(b.ImageProcessingStatus!==c.c.Idle||Object(c.e)(b))){var v=this.calcImageLayout(y);p=v.ImageLayout,e=o.createElement(h.a,{ImageWidth:v.Width,ImageHeight:v.Height,ImageInfoMaster:g,ImageSettingMaster:y,ImageType:"Logo"})}var S=this.props.LocaleId;return S&&(n=l.a.getFormResourceMaster(S,this.props.Form),t=n.Model.title||"",r=n.Model.subtitle||""),t=t||u.Title,r=this.props.IsSlimTitle||this.props.IsSmallSize?"":r||u.Description,Object(f.e)((function(){r=n&&n.Model.formsprortlocalesubtitle||(u.FormsProRTDescription?u.FormsProRTDescription:r),t=n&&n.Model.formsprortlocaletitle||(u.FormsProRTTitle?u.FormsProRTTitle:t),r=f.a.sanitizeRichTextHTML(r),t=f.a.sanitizeRichTextHTML(t)})),o.createElement(m.a,{HTMLAttributes:d,HTMLPropsForInnerElement:{"aria-level":1,role:"heading"},MediaLayout:p,SubTitle:r,Title:t},e)},t.prototype.calcImageLayout=function(e){if(e.Model.NaturalWidth){var t=e.calcLogoLayout({isMobile:this.props.IsMobile,isSlimSize:this.props.IsSlimTitle,isSmallSize:this.props.IsSmallSize});return{Height:t.ActualHeight,ImageLayout:t.Layout===u.a.Vertical?"Top":"Left",Width:t.ActualWidth}}return{Height:i.a.ImagePlaceHolderWidth,ImageLayout:"Left",Width:i.a.ImagePlaceHolderHeight}},t}(p.a);function F(e){return Object(d.a)().Flighting.isEnabled_Deprecated("DisableBrandingForMSA")&&OfficeFormServerInfo.userInfo.IsMsa?o.createElement(v,I({},e)):o.createElement(M,I({},e))}},,function(e,t,r){"use strict";r.d(t,"a",(function(){return ge})),r.d(t,"b",(function(){return ye}));var n,o,i=r(0),a=r(20),s=r(270),c=r(3),u=r(198),l=r(263),d=r(4),f=r(119),p=r(151),m=r(152),h=r(11),g=r(24),y=r(45),b=r(85),v=r(106),S=r(2),I=r(44),M=r(49),F=r(27),O=r(5),C=r(28),P=r(78),T=r(13),w=r(16),_=r(67),E=r(46),R=r(23),D=r(8),A=r(61),L=r(132),N=r(91),k=r(6),x=r(7),j=r(17),U=r(34),z=r(9),B=r(197),Q=r(22),q=r(207),V=r(105),H=r(114),W=r(31),G=r(150),K=r(219),J=r(77),Y=r(87),X=r(12),Z=r(109),ee=r(90),te=r(267),re=r(159),ne=r(262),oe=r(228),ie=r(229),ae=r(268),se=r(128),ce=r(215),ue=r(189),le=r(70),de=r(53),fe=r(92),pe=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),me=function(){return(me=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},he=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n};function ge(e){var t=me(me({},e),{ViewMode:fe.a.Mobile});return i.createElement(be,t)}function ye(e){return i.createElement(be,e)}!function(e){e[e.NotAvailable=1]="NotAvailable",e[e.NotAvailableDueToSettingChange=2]="NotAvailableDueToSettingChange",e[e.NotAvailableDueToCountryAvailablity=3]="NotAvailableDueToCountryAvailablity",e[e.ExhaustedPromocodes=4]="ExhaustedPromocodes",e[e.Available=5]="Available",e[e.Success=6]="Success",e[e.Failed=7]="Failed",e[e.SuccessWithNoData=8]="SuccessWithNoData"}(o||(o={}));var be=function(e){function t(t){var r=e.call(this,t)||this;r.defaultLanguageId=r.props.Master.Model.DefaultLanguage,r.compact=!1,r.compactPlus=!1,r.formRendererRef=i.createRef();var n=Object(G.c)();return r.defaultLanguageName=n[r.defaultLanguageId],r.state={IsSmallScreen:$(window).width()<768,SubmitState:de.a.NotSubmitted,ShowDuplicateSpinner:!1,ShowErrorPage:!1,ShowPhishingWarningBar:!0,IsStudentViewMode:null!=r.props.Response,IsReportingView:!1,HideQuestions:!1,EmailReceiptConsent:!1,LocalizedResource:r.props.Master.Model.LocaleList.length&&{localeId:r.defaultLanguageId,localeName:r.defaultLanguageName},ShowSpinnerWhenChangeLanguage:!1,ShowSpinnerForFirstTimeLoadMultilingual:!1,LocalizedStrings:S.a.LocalizedStrings,ShowLongOperationMessage:!1},r.updateScreenSizeClass=r.updateScreenSizeClass.bind(r),r.update=r.update.bind(r),r.onAnswersChanged=r.onAnswersChanged.bind(r),r.onSectionIdChanged=r.onSectionIdChanged.bind(r),r.increaseUploadingFileCount=r.increaseUploadingFileCount.bind(r),r.decreaseUploadingFileCount=r.decreaseUploadingFileCount.bind(r),r.showAbuseReport=r.showAbuseReport.bind(r),r.onThankYouViewResult=r.onThankYouViewResult.bind(r),r.onBackButtonClick=r.onBackButtonClick.bind(r),r.onPreviousButton=r.onPreviousButton.bind(r),r.onNextButton=r.onNextButton.bind(r),r.onLanguageChange=r.onLanguageChange.bind(r),r.onClickHrefOnPhishingTipBar=r.onClickHrefOnPhishingTipBar.bind(r),r.onClickPhishingCloseButton=r.onClickPhishingCloseButton.bind(r),r.getFooterText=r.getFooterText.bind(r),r.scrollAndFocusForSection=r.scrollAndFocusForSection.bind(r),Object(x.e)((function(){Object(k.a)().Flighting.isEnabled("FormsProEmbedCompact")&&(r.compact=T.n(),r.compactPlus=Object(k.a)().Flighting.isEnabled("FormsProEmbedCompactPlus"))})),r.phishingReviewUXFactory=t.PhishingReviewUXFactory,r}return pe(t,e),t.prototype.componentWillMount=function(){var e=this;this.formRuntimeMaster=new L.a(this.props.Master,{disableBranching:this.disableBranching()}),this.state.IsStudentViewMode?(this.resetAnswers(this.props.Response.Answers),this.formRuntimeMaster.updateWithResponse(this.props.Response),this.setServerQuizResult(this.props.Response.QuizResult),this.setState({ShowQuizResult:!0})):this.resetAnswers(this.props.PersistedAnswers),this.resetSectionId(this.props.PersistedSectionId),this.formRuntimeMaster.observeAnswerChange(this.onAnswersChanged),this.formRuntimeMaster.observe(this.onSectionIdChanged,[L.a.Schema.RuntimeSectionId]),this.formRuntimeMaster.observe(this.update,[L.a.Schema.BranchChangeVersion,L.a.Schema.QuestionRuntimeMasters,L.a.Schema.UploadingFileCount]),Object(x.e)((function(){e.formRuntimeMaster.TopQuestionRuntimeMasters().forEach((function(t){t.observe(e.update,[N.a.Schema.Visible])})),e.setState({MSRewardsState:Object(l.a)()})})),Object(x.e)((function(){e.formRuntimeMaster.resetQuestions()})),Object(x.e)((function(){var t=e.formRuntimeMaster.getQuestionResponseFromQueryString();e.formRuntimeMaster.Answers=e.props.PersistedAnswers||t})),window.addEventListener("resize",this.updateScreenSizeClass)},t.prototype.componentDidMount=function(){var e=this;if(P.a.notifyResponsePageHeightToParentWindow(),this.props.ForcedLocaleId){var t=this.props.Master.Model.LocalizedResources;t&&t[0]&&t[0].localeId==this.props.ForcedLocaleId&&this.setState({LocalizedResource:t[0],ShowSpinnerForFirstTimeLoadMultilingual:!1})}else if(this.state.IsStudentViewMode){var r=this.props.Response.SubmitLanguage;if(r){var n=JSON.parse(r).localeId;this.showBestMatchLanguage(n),this.ensureLayout(n)}}else{var o=this.props.Master.Model.LocaleList;if(o.length>0){var i=this.props.Master.SyncContext===D.e.ResponseTimeForm,a=OfficeFormServerInfo.cultureInfo.Name.toLowerCase();Object(x.e)((function(){a=h.a.getExplictLocale()||a}));var s=d.a.Collection.getItemWithKeyFields(this.props.Master.Model.LocaleList,{localeId:a});if(s)this.showBestMatchLanguage(a),this.ensureLayout(a);else if(this.ensureLayout(this.defaultLanguageId),a!==this.defaultLanguageId){var c=Object(G.b)(this.defaultLanguageId);S.a.loadLanguageStrings(c).done((function(t){e.setState({LocalizedStrings:t})}))}i&&Object(z.a)({eventName:"ResponsePage.MultiLingual.OpenForm",eventType:"engagement_event",extraData:{browserLocaleId:a,defaultLocaleId:this.defaultLanguageId,firstRenderMatched:!!s,localeCount:o.length}})}}Object(x.e)((function(){e.formRuntimeMaster.resetQuestions()})),this.renderImmersiveReaderButtons()},t.prototype.componentDidUpdate=function(){P.a.notifyResponsePageHeightToParentWindow(),Object(v.a)($(".office-form-answerhint"));var e=a.findDOMNode(this.refs["office-form-quiz-result-container"]);e&&e.focus();var t=a.findDOMNode(this.refs["auto-release-grade-quiz-result-container"]);t&&t.focus(),this.renderImmersiveReaderButtons()},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.updateScreenSizeClass),this.formRuntimeMaster.observe(this.onSectionIdChanged),this.formRuntimeMaster.unobserveAnswerChange(this.onAnswersChanged),this.formRuntimeMaster.unobserve(this.update),this.formRuntimeMaster.release()},t.prototype.render=function(){var e=this;if(this.state.ShowSpinnerForFirstTimeLoadMultilingual)return this.createMultiLingualSpinnerForEmailReceipt();var t,r=this.props.Master.SyncContext===D.e.SharedTimeForm;if(this.state.ShowErrorPage)return i.createElement(Z.a,{Error:this.error,FormId:this.props.Master.Model.Id,ShowCreateFormLink:!1});var n={className:Object(x.c)((function(){return"office-form-content office-form-page-padding"}),(function(){return e.state.IsReportingView?"office-form-content office-form-page-padding":"office-form-content office-form-page-padding-preview"}))};if(!this.state.IsReportingView&&this.state.ShowPhishingWarningBar&&Object(Y.c)(this.props.Master.Model.OnlineSafetyLevel)&&(n.className=O.a.combineAttributes(n.className,"height-with-tip-bar")),r&&(n.className=O.a.combineAttributes(n.className,"share-page")),(this.props.ViewMode===fe.a.Mobile||this.state.IsSmallScreen)&&(n.className=O.a.combineAttributes(n.className,"small-screen")),Object(x.e)((function(){if(e.compact){var t=e.compactPlus?"forms-pro-compact-plus":"";e.state.IsSmallScreen?n.className=O.a.combineAttributes(n.className,"forms-pro-compact",t):n.className=O.a.combineAttributes(n.className,"small-screen","forms-pro-compact",t)}})),this.isMobile()&&(n.className=O.a.combineAttributes(n.className,"mobile-view")),Object(x.e)((function(){e.props.CustomStyle&&(n.className=O.a.combineAttributes(n.className,"custom-style-content"))})),this.state.SubmitState===de.a.Succeed||this.state.SubmitState===de.a.SucceedWithQuizResult&&!this.state.ShowQuizResult){var o,a;this.props.Master.Model.Settings.RequiresUniqueResponse||(o=function(){return e.submitAnotherResponse()}),this.state.SubmitState===de.a.SucceedWithQuizResult&&(a=this.onThankYouViewResult);var s=this.state.LocalizedResource.localeId;t=i.createElement(J.a.Consumer,{children:function(t){return i.createElement(ae.a,{FormMaster:e.props.Master,LocaleId:s!==e.defaultLanguageId&&s,LocalizedStrings:t.LocalizedStrings,ShowPromotionMessage:!M.a.isPPTIntegration(),submitAnother:o,viewResultsHandler:a,CustomStyle:Object(x.e)((function(){return e.props.CustomStyle})),msRewardsThankYouProps:Object(x.e)((function(){return e.state.MSRewardsState}))})}}),Object(k.a)().Flighting.isEnabled_Deprecated("MSAIntroductionForResponder")&&Object(y.c)()&&!this.isMobile()&&(t=i.createElement("div",null,t,i.createElement(te.a)))}else t=this.state.IsReportingView?i.createElement(J.a.Consumer,{children:function(t){return i.createElement(ne.a,{LocalizedStrings:t.LocalizedStrings,FormMaster:e.props.Master})}}):i.createElement("div",null,i.createElement("div",{"aria-label":this.props.Master.Model.Title,className:"office-form office-form-theme-shadow",role:"form"},this.createDataClassificationLabel(),!this.isMobile()&&this.createMultiLingualSelect(),Object(x.c)((function(){return e.createTitleContainer()}),(function(){return e.createProTitleContainer()})),this.createResultContainer(),i.createElement("div",{className:"office-form-body"},this.createNoticeContainer(),this.createRuntimeFormContent(),this.createEmailReceiptCheckbox(),i.createElement("div",{className:"office-form-button-container"},this.createPreviousSection(),this.createSubmitButton(),this.createNextSection()),this.showDuplicateMessage(),i.createElement("div",{className:this.compact?"office-form-error-message-container compact-view":"office-form-error-message-container"},this.createValidationErrorLabel(),this.createErrorMessage()),this.createPhishingNotice(),this.createBackToThankYouLink())),this.createFooter());var c="form-content-container";return this.props.ViewMode===fe.a.Mobile?c="form-content-container mobile-view":this.state.IsSmallScreen&&(c="form-content-container small-screen"),Object(x.e)((function(){e.compact&&(c=e.state.IsSmallScreen?O.a.combineAttributes(c,"forms-pro-compact"):O.a.combineAttributes(c,"small-screen","forms-pro-compact"))})),i.createElement(J.a.Provider,{value:this.state,children:i.createElement("div",{className:c,ref:this.formRendererRef},this.createDuplicateNavBar(),this.createAdminPhishingReviewNavBar(),this.createPhishingWarningPage(),this.createPhishingFormTipBar(),i.createElement("div",n,this.props.HeaderMessage&&this.createHeader(),i.createElement(se.a,{ThemeMaster:this.props.Master.ThemeMaster}),this.isMobile()&&this.createMultiLingualSelect(),t),this.createMultiLingualSpinner(),this.submitSuccessHintForNarrator())})},t.prototype.createFooter=function(){var e=this;if(!this.props.MobileReadOnly){var t="ShowStatementWithNotice";return this.props.Master.SyncContext===D.e.ResponseTimeForm&&this.props.Master.Model.Settings.IsAnonymous&&(t="ShowStatement"),i.createElement(ee.a,{FormMaster:this.props.Master,FooterType:t,FooterText:Object(x.e)((function(){return e.getFooterText()}))})}},t.prototype.createPhishingWarningPage=function(){if(this.phishingReviewUXFactory)return this.phishingReviewUXFactory.createPhishingWarningPage(this.props.Master,this.state.IsReportingView)},t.prototype.createPhishingFormTipBar=function(){var e=this,t=this.props.Master.Model.OnlineSafetyLevel,r=this.isSharedFormPage()?"ShareForm":"Response";if(Object(Y.c)(t)&&!this.state.IsReportingView&&this.state.ShowPhishingWarningBar&&!this.isAdminPhishingReviewPage())return i.createElement(J.a.Consumer,{children:function(n){return i.createElement(ue.a,{Info:Object(Y.e)(t,r),TipBarLocation:"Up",TipBarStyle:Object(Y.b)(t)?"RedBackground":"YellowBackground",ShouldClose:!Object(Y.b)(t),HrefInfo:!Object(k.a)().Flighting.isEnabled("RemoveRuntimeWarningbarReportAbuse")&&n.LocalizedStrings.Response_Page_Footer_Report,onClickHref:!Object(k.a)().Flighting.isEnabled("RemoveRuntimeWarningbarReportAbuse")&&e.onClickHrefOnPhishingTipBar,onClose:e.onClickPhishingCloseButton})}})},t.prototype.onClickHrefOnPhishingTipBar=function(){this.setState({IsReportingView:!0})},t.prototype.onClickPhishingCloseButton=function(){this.setState({ShowPhishingWarningBar:!1})},t.prototype.createMultiLingualSpinner=function(){if(this.state.ShowSpinnerWhenChangeLanguage)return i.createElement("div",{className:"multi-lingual-spinner-container"},i.createElement("div",{className:"multi-lingual-blank-page"}),i.createElement("div",{className:"multi-lingual-spinner"},i.createElement("div",{className:"spinner-tile-animation"})))},t.prototype.createMultiLingualSpinnerForEmailReceipt=function(){return i.createElement("div",{className:"multi-lingual-page-loading-background"},i.createElement("div",{className:"page-loading-messagebox",tabIndex:0,"aria-label":S.a.LocalizedStrings.Page_LoadingMessage,"aria-live":"polite"},i.createElement("div",{className:"page-loading-animation"},i.createElement("div",{className:"spinner-tile-animation"})),i.createElement("div",{className:"page-loading-message"},S.a.LocalizedStrings.Page_LoadingMessage)))},t.prototype.showBestMatchLanguage=function(e){var t=this;if(e!==this.defaultLanguageId&&this.props.Master.isFieldReady(D.c.Schema.LocalizedResources))if(this.setState({ShowSpinnerForFirstTimeLoadMultilingual:!0}),this.state.IsStudentViewMode){var r=Object(G.b)(e);S.a.loadLanguageStrings(r).done((function(r){t.setState({LocalizedStrings:r}),t.getBestMatchLocaleResources(e)}))}else this.getBestMatchLocaleResources(e)},t.prototype.getBestMatchLocaleResources=function(e){var t=this;this.props.Master.getLocaleResouceById(e).done((function(e){var r=t.props.Master.Model.LocalizedResources,n=e.localizedResources;d.a.Collection.getItemWithKeyFields(r,{localeId:n[0].localeId})||d.a.Collection.itemsAddedInSource(r,n),t.setState({LocalizedResource:e&&n[0],ShowSpinnerForFirstTimeLoadMultilingual:!1})}))},t.prototype.createRuntimeFormContent=function(){return this.state.HideQuestions?null:this.props.Master.hasSection()?this.createSectionRenderers():i.createElement("div",null,this.createElementRenderers(this.formRuntimeMaster.TopQuestionRuntimeMasters()))},t.prototype.onThankYouViewResult=function(){this.setState({ShowQuizResult:!0})},t.prototype.createBackToThankYouLink=function(){if(this.state.ShowQuizResult&&this.state.SubmitState===de.a.SucceedWithQuizResult)return i.createElement("div",{className:"office-form-quiz-back-to-result-link"},i.createElement("a",{href:"javascript:void(0)",onClick:this.onBackButtonClick},S.a.LocalizedStrings.Response_Page_Quiz_Result_Back_To_Thank_You_Message))},t.prototype.onBackButtonClick=function(){this.setState({ShowQuizResult:!1})},t.prototype.createHeader=function(){return i.createElement("div",{className:"form-header-text-message"},this.props.HeaderMessage)},t.prototype.createDuplicateSpinner=function(){if(this.state.ShowDuplicateSpinner)return i.createElement("div",{className:"duplicate-form-spinner"},i.createElement("div",{className:"spinner-tile-animation"}))},t.prototype.createDuplicateNavBar=function(){var e=this;if(this.props.Master.SyncContext===D.e.SharedTimeForm&&!this.state.IsReportingView){var t=i.createElement("img",{className:"duplicate-form-nav-bar-icon",src:Object(I.a)("/Images/SaveAsForms_30x30x32.png"),alt:S.a.LocalizedStrings.HeaderBar_AppTitle}),r=i.createElement("span",{className:"duplicate-form-nav-bar-title"},S.a.LocalizedStrings.DuplicateForm_Page_Nav_Bar_Title),n=Object(W.b)({HTMLAttributes:{className:"office-form-copy-form-button",titel:S.a.LocalizedStrings.DuplicateForm_Page_Duplicate_Button_Text,onClick:function(){return e.duplicateForm()},disabled:this.state.ShowDuplicateSpinner},ButtonStyle:"LightBackground",Text:S.a.LocalizedStrings.DuplicateForm_Page_Duplicate_Button_Text});return i.createElement("div",{className:"office-form-duplicate-form-container"},i.createElement("div",{className:"office-form-duplicate-form-content"},t,r,i.createElement("div",{className:"office-form-duplicate-form-button-container"},n,this.createDuplicateSpinner())))}},t.prototype.createAdminPhishingReviewNavBar=function(){var e=this;if(this.phishingReviewUXFactory)return this.phishingReviewUXFactory.createAdminPhishingReviewNavBar(this.props.Master,(function(t){e.error=t,e.setState({ShowErrorPage:!0})}))},t.prototype.showDuplicateMessage=function(){var e=this;if(this.props.Master.SyncContext===D.e.SharedTimeForm)return i.createElement("div",{className:"office-form-duplicate-message-container"},i.createElement("span",null,S.a.LocalizedStrings.DuplicateForm_Page_Nav_Bar_Title),i.createElement("div",{className:"office-form-duplicate-form-duplicate-link office-form-theme-primary-foreground",onClick:function(){return e.duplicateForm()},disabled:this.state.ShowDuplicateSpinner,tabIndex:0},S.a.LocalizedStrings.DuplicateForm_Page_Duplicate_Button_Text))},t.prototype.ensureLocalizedResourceReadyToDuplicate=function(){var e=this.props.Master,t=e.Model.LocaleList;if(t.length>0){var r=e.Model.LocalizedResources;if(void 0===r||t.length>r.length){for(var n=[],o=0;o<t.length;o++){var i=t[o].localeId;if(this.props.Master.isFieldReady(D.c.Schema.LocalizedResources))d.a.Collection.getItemWithKeyFields(e.Model.LocalizedResources,{localeId:i})||n.push(this.props.Master.getLocaleResouceById(i))}return $.when.apply($,n).then((function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return t.forEach((function(t){d.a.Collection.itemsAddedInSource(e.Model.LocalizedResources,t.localizedResources)})),$.Deferred().resolve().promise()}))}}return $.Deferred().resolve().promise()},t.prototype.duplicateForm=function(){var e=this,t=F.a.newGuid();window.sessionStorage.setItem("FormCopy.GUID",t),j.a.logData({name:"ShareFormPage.Copy.DuplicateButton",extraData:{CopyCorelationID:t,Time:(new Date).toUTCString()}});var r=this.props.Master;this.setState({ShowDuplicateSpinner:!0}),R.a.getDataProviderByFormId(r.Model.Id).getSharedForm(r.Model.Id).done((function(){e.ensureLocalizedResourceReadyToDuplicate().done((function(){var e=r.getSnapshotToCopy();window.sessionStorage.setItem("FormCopy.FormModelToJSON",JSON.stringify(e));var t=window.location.origin+"/Pages/DesignPage.aspx",n=Object(k.a)();if(!n.AuthContext.hasUserLoggedIn()&&n.Flighting.isEnabled("CookieAuth")){var o=window.sessionStorage.getItem("FormCopy.GUID");j.a.logData({name:"ShareFormPage.Copy.LoginToAutoCopy",extraData:{CopyCorelationID:o,Time:(new Date).toUTCString()}}),window.sessionStorage.setItem("FormCopy.LoginToAutoCopy",JSON.stringify("LoginToAutoCopy")),Object(f.b)(t)}else Object(C.c)(t)}))})).fail((function(t){e.error=t,e.setState({ShowErrorPage:!0,ShowDuplicateSpinner:!1})}))},t.prototype.createNoticeContainer=function(){if(this.state.SubmitState!==de.a.SucceedWithQuizResult&&!this.state.IsStudentViewMode&&!this.props.MobileReadOnly){var e=[this.createRecordIdentityNotice(),this.createRequiredNotice()];return e.some((function(e){return!!e}))?i.createElement.apply(i,he(["div",{className:"office-form-notice-container"}],e)):void 0}},t.prototype.createRecordIdentityNotice=function(){var e=this,t=this.props.Master.Model.Settings,r=this.props.Master.SyncContext===D.e.SharedTimeForm,n=!this.formRuntimeMaster.ElementManager().isFirstPage();return r||n?void 0:i.createElement(J.a.Consumer,{children:function(r){var n;if(t.IsAnonymous||t.NotRecordIdentity)n="";else{var o=OfficeFormServerInfo.userInfo.GivenName||OfficeFormServerInfo.userInfo.DisplayName;o?n=r.LocalizedStrings.Response_NonAnonymous_Notice.format(o):(U.a.logData({errorName:"MissingUserName",errorInfo:{givenName:!!OfficeFormServerInfo.userInfo.GivenName,displayName:!!OfficeFormServerInfo.userInfo.DisplayName,userId:!!OfficeFormServerInfo.userInfo.UserId}}),n=r.LocalizedStrings.Response_NonName_Notice)}if(e.state.SubmitState!==de.a.SucceedWithQuizResult)return i.createElement("div",{},i.createElement("span",{className:"office-form-notice-long-text"},n))}})},t.prototype.createRequiredNotice=function(){if(!this.props.MobileReadOnly){var e=this.props.Master,t=[];return t=e.hasSection()&&!this.showAllSectionsAtOnce()?this.formRuntimeMaster.ElementManager().getCurrentSection().TopQuestionMasters.map((function(e){return e.Question.Model})):d.a.convertToArray(e.Model.Questions),c.some(t,(function(e){return e.Required}))?i.createElement(J.a.Consumer,{children:function(e){return i.createElement("div",null,i.createElement("span",{className:"office-form-required-notice-star"}),i.createElement("span",null,e.LocalizedStrings.Answer_Required_Notice))}}):void 0}},t.prototype.createResultContainer=function(){if(this.state.IsStudentViewMode||this.state.SubmitState===de.a.SucceedWithQuizResult){var e=this.createFormCommentContainer(),t=this.createTotalScoreBar();if(e||t)return i.createElement("div",{className:"office-form-result-container"},e,t)}},t.prototype.createFormCommentContainer=function(){if(this.state.IsStudentViewMode){var e=this.props.Response.Feedback;if(e){var t=S.a.LocalizedStrings.RuntimeView_FormComment.format(e),r=Object(q.a)({content:t});return i.createElement("div",{className:"office-form-formcomment-container"},i.createElement("div",{className:"office-form-formcomment office-form-theme-primary-foreground"},r))}}else;},t.prototype.createTotalScoreBar=function(){var e=this,t=0,r=0,n=0,o=0,a=!1;if((this.state.SubmitState===de.a.SucceedWithQuizResult||this.state.IsStudentViewMode)&&this.formRuntimeMaster.TopQuestionRuntimeMasters().forEach((function(i){var s=i.Question.Model,c=i.Question;if(s.IsQuiz)if(c.hasCorrectAnswers(i.Model.QuizResult)&&++n,r+=s.Point||0,o+=i.Model.QuizResult&&i.Model.QuizResult.IsAnswerCorrect?1:0,e.state.SubmitState===de.a.SucceedWithQuizResult)t+=i.Model.QuizResult&&i.Model.QuizResult.IsAnswerCorrect&&s.Point||0,a=!0;else{var u=i.SubQuestionRuntimeMasters,l=(i=u[u.length-1]||i).getScore();null!=l&&(t+=l,a=!0)}})),n||r){var s={className:"office-form-totalscore-bar",tabIndex:-1,ref:"auto-release-grade-quiz-result-container"};if(0===r&&0===t){var c=Math.round(100*o/n)+"%";return s["aria-label"]=S.a.LocalizedStrings.Response_Preview_SubmitNotificationUnderAutoReleaseGrade.format(S.a.LocalizedStrings.Response_QuizResult_Title,c),i.createElement("div",s,i.createElement("div",{className:"office-form-point-label"},S.a.LocalizedStrings.Quiz_Points_Text+":"),i.createElement("div",{className:"office-form-score-label office-form-theme-primary-foreground"},c))}var u=a?t:"-",l=r||"-";return s["aria-label"]=S.a.LocalizedStrings.Response_Preview_SubmitNotificationUnderAutoReleaseGrade.format(S.a.LocalizedStrings.Response_QuizResult_Title,S.a.LocalizedStrings.Response_ScoreResult_Transcript.format(u,r)),i.createElement("div",s,i.createElement("div",{className:"office-form-point-label"},S.a.LocalizedStrings.Quiz_Points_Text+":"),i.createElement("div",{className:"office-form-score-label office-form-theme-primary-foreground"},S.a.LocalizedStrings.RuntimeView_TotalPoints_Content.format(u,l)))}return null},t.prototype.createValidationErrorLabel=function(){var e=this;return i.createElement(J.a.Consumer,{children:function(t){var r,n,o=(r=e.formRuntimeMaster.Form.hasSection()?e.formRuntimeMaster.getQuestionsWithWrongAnswer(e.formRuntimeMaster.ElementManager().getCurrentSection().TopQuestionMasters):e.formRuntimeMaster.getQuestionsWithWrongAnswer(e.formRuntimeMaster.TopQuestionRuntimeMasters())).map((function(e){return t.LocalizedStrings.Form_QuestionWithOrdinal.format(e)})).join(t.LocalizedStrings.Common_ItemSeperator);n=e.formRuntimeMaster.ElementManager().hasNextSection()?t.LocalizedStrings.Section_Question_Error_Message.format(r.length,o):t.LocalizedStrings.Form_Question_Error_Message.format(r.length,o);var a=Object(Q.b)({HTMLAttributes:{className:"office-form-alert-icon forms-icon-size16x16"},IconName:"Warning"}),s=!!e.state.ShowValidationStyle&&!!r.length;return i.createElement("div",{className:O.a.combineAttributes("office-form-submit-error",s?"":"NotVisible"),role:"alert"},a,i.createElement("span",{className:"error-message"},s?n:""))}})},t.prototype.showMultiLingualSelect=function(){if(Object(x.e)((function(){return!0}))){var e=h.a.getMultilingualDisplayParam();if(e)return"true"===e}return!(!this.props.Master.Model.LocaleList.length||this.state.IsStudentViewMode||!this.showAllSectionsAtOnce()&&!this.formRuntimeMaster.ElementManager().isFirstPage())},t.prototype.createMultiLingualSelect=function(){if(this.showMultiLingualSelect()){var e=this.props.Master.Model.LocaleList,t=[];t.push({DisplayName:this.defaultLanguageName,Key:"default-language",Value:this.defaultLanguageId}),c.forEach(e,(function(e){t.push({DisplayName:e.localeName||"",Key:e.localeId,Value:e.localeId||""})}));var r="multi-lingual-select-control office-form-theme-secondary-background";return this.isMobile()&&(r=O.a.combineAttributes(r,"isMobile")),Object(V.b)({HTMLAttributes:{className:r,disabled:this.props.MobileReadOnly},onValueChange:this.onLanguageChange,Placeholder:t[0]&&t[0].DisplayName,PlaceholderIcon:"World",SelectOptions:t,Value:this.state.LocalizedResource.localeId})}},t.prototype.createDataClassificationLabel=function(){var e=this.props.Master,t=e.SyncContext===D.e.SharedTimeForm;if(!this.isMobile()&&(this.showAllSectionsAtOnce()||this.formRuntimeMaster.ElementManager().isFirstPage())&&(this.props.PrintView||Object(k.a)().Flighting.isEnabled("DataClassificationRuntime")&&!OfficeFormServerInfo.userInfo.IsMsa&&t&&e.isFieldReady(D.c.Schema.DataClassificationLabel)&&e.Model.DataClassificationLabel)){var r=O.a.combineAttributes(this.showMultiLingualSelect()?"office-form-duplicate-classification-label-with-multilingual":"office-form-duplicate-classification-label-without-multilingual","office-form-duplicate-classification-label","office-form-theme-secondary-background");return i.createElement(K.a,{FormMaster:this.props.Master,HTMLAttributes:{className:r},DesignTimeView:!1})}},t.prototype.isAdminPhishingReviewPage=function(){return this.props.Master.SyncContext===D.e.AdminPhishingReviewForm},t.prototype.isSharedFormPage=function(){return this.props.Master.SyncContext===D.e.SharedTimeForm},t.prototype.ensureLayout=function(e){Object(G.e)(e)?this.switchToRtlFormContentLayout():this.switchToLtrFormContentLayout()},t.prototype.switchToLtrFormContentLayout=function(){var e=this,t=this.props.Master.SyncContext===D.e.ResponseTimeForm,r=this.props.Master.SyncContext===D.e.DesignTimeForm&&!h.a.isMobile(),n=this.props.Master.SyncContext===D.e.DesignTimeForm&&h.a.isMobile();t?($(".form-content").attr("dir","ltr"),Object(m.a)(p.a.ResponsePage).done((function(){return e.forceUpdate()}))):r?($(".form-content").attr("dir","ltr"),Object(m.a)(p.a.DesignPage).done((function(){return e.forceUpdate()}))):n&&($(".form-content").attr("dir","ltr"),Object(m.a)(p.a.MobileDesignPage).done((function(){return e.forceUpdate()})))},t.prototype.switchToRtlFormContentLayout=function(){var e=this,t=this.props.Master.SyncContext===D.e.ResponseTimeForm,r=this.props.Master.SyncContext===D.e.DesignTimeForm&&!h.a.isMobile(),n=this.props.Master.SyncContext===D.e.DesignTimeForm&&h.a.isMobile();t?($(".form-content").attr("dir","rtl"),Object(m.a)(p.a.ResponsePageRtl).done((function(){return e.forceUpdate()}))):r?($(".form-content").attr("dir","rtl"),Object(m.a)(p.a.DesignPageRtl).done((function(){return e.forceUpdate()}))):n&&($(".form-content").attr("dir","rtl"),Object(m.a)(p.a.MobileDesignPageRtl).done((function(){return e.forceUpdate()})))},t.prototype.onLanguageChange=function(e){var t=this;Object(z.a)({eventName:"ResponsePage.MultiLingual.ChangeLanguage",eventType:"engagement_event",extraData:{LocaleId:e}});var r=Object(G.b)(e);S.a.loadLanguageStrings(r).done((function(n){t.ensureLayout(r),t.setState({LocalizedStrings:n}),t.setLocalizedResources(e)})),Object(x.e)((function(){t.formRuntimeMaster.resetQuestions()}))},t.prototype.setLocalizedResources=function(e){if(e!==this.defaultLanguageId){if(this.props.Master.isFieldReady(D.c.Schema.LocalizedResources)){var t=d.a.Collection.getItemWithKeyFields(this.props.Master.Model.LocalizedResources,{localeId:e});t?this.setState({LocalizedResource:t}):this.getLocaleResourceByLocaleId(e)}}else this.setState({LocalizedResource:{localeId:this.defaultLanguageId,localeName:this.defaultLanguageName}})},t.prototype.getLocaleResourceByLocaleId=function(e){var t=this;this.setState({ShowSpinnerWhenChangeLanguage:!0}),this.props.Master.getLocaleResouceById(e).done((function(e){d.a.Collection.itemsAddedInSource(t.props.Master.Model.LocalizedResources,e.localizedResources),t.setState({LocalizedResource:e&&e.localizedResources[0],ShowSpinnerWhenChangeLanguage:!1})}))},t.prototype.createTitleContainer=function(){var e=this.state.LocalizedResource.localeId;return Object(ce.a)({Form:this.props.Master,LocaleId:e!==this.defaultLanguageId&&e,IsMobile:this.props.ViewMode===fe.a.Mobile||T.t(),IsReadOnlyOnMobile:this.props.MobileReadOnly,IsSlimTitle:!this.showAllSectionsAtOnce()&&!this.formRuntimeMaster.ElementManager().isFirstPage()})},t.prototype.createProTitleContainer=function(){var e;if(this.props.Master.isFieldReady(D.c.Schema.CustomCssFileName)){var t=this.state.LocalizedResource.localeId;this.props.Master.Model.CustomCssFileName&&""!==this.props.Master.Model.CustomCssFileName?h.a.getCustomCssOriginalHeaderParam()?(u.a.loadCustomCss(this.props.CustomStyle),e=this.createTitleContainer()):e=i.createElement(u.a,{Form:this.props.Master,LocaleId:t!==this.defaultLanguageId&&t,IsMobile:this.props.ViewMode===fe.a.Mobile||T.t(),IsSlimTitle:!1,CustomStyle:this.props.CustomStyle}):e=this.createTitleContainer()}return e},t.prototype.createSectionRenderer=function(e,t){var r=e.Section,n=e.TopQuestionMasters;if(!r)return this.createElementRenderers(n);var o=r.Model.Id,a=this.state.LocalizedResource.localeId,s=[];t||s.push(i.createElement(oe.a,{HasTheme:!this.isMobile(),key:"form-section-breaker-"+o}));var c=this.createElementRenderers(n);return s.push(i.createElement(ie.a,{children:c,Disabled:!0,DisableShuffle:!0,Expaned:!0,IsMobile:this.props.ViewMode===fe.a.Mobile||T.t(),LocaleId:a!==this.defaultLanguageId&&a,key:"form-section-container-"+o,SectionMaster:r})),s},t.prototype.createSectionRenderers=function(){var e=this;return this.showAllSectionsAtOnce()?[this.formRuntimeMaster.ElementManager().getAllSections().map((function(t,r){return e.createSectionRenderer(t,0===r)}))]:this.createSectionRenderer(this.formRuntimeMaster.ElementManager().getCurrentSection(),!0)},t.prototype.createElementRenderers=function(e){var t=this;if(e.length<=0)return null;var r,n=this.state.ShowValidationStyle,o=this.state.ShowQuizResult,a=0;Object(x.c)((function(){r=c.indexOf(t.formRuntimeMaster.TopQuestionRuntimeMasters(),e[0])+1}),(function(){var n=t.formRuntimeMaster.TopQuestionRuntimeMasters().filter((function(e){return t.formRuntimeMaster.formsProQuestionVisiblityCheck(e)})),o=e.filter((function(e){return t.formRuntimeMaster.formsProQuestionVisiblityCheck(e)}));r=c.indexOf(n,o[0])+1}));var s=this.state.LocalizedResource.localeId;return i.createElement(J.a.Consumer,{children:function(i){return e.map((function(e,c){var u=e.Question.Model.Id;Object(x.e)((function(){t.formRuntimeMaster.formsProQuestionVisiblityCheck(e)&&(e.Model.FormsProOrdinal=r+a,a++)}));var l={Master:e,LocaleId:s!==t.defaultLanguageId&&s,LocalizedStrings:i.LocalizedStrings,Ordinal:r+c,Disabled:t.state.SubmitState===de.a.SucceedWithQuizResult||t.state.IsStudentViewMode,key:u,IsMobile:t.isMobile(),ShowValidationStyle:n,ShowQuizResult:o,ShowPhishingWarning:t.showPhishingInfo(),ShowFileInfo:!!t.props.HeaderMessage,HideMedia:!1,IsStudentViewMode:t.state.IsStudentViewMode,HideDeleteButton:t.state.SubmitState===de.a.Submitting||t.state.SubmitState===de.a.SucceedWithQuizResult||t.state.IsStudentViewMode,increaseUploadingFileCountCallBack:t.increaseUploadingFileCount,decreaseUploadingFileCountCallBack:t.decreaseUploadingFileCount,setAbuseReportStateCallBack:t.showAbuseReport,EnableShowHideQuestion:Object(x.c)((function(){return!1}),(function(){return!0}))};return Object(re.a)(l)}))},key:"elementRenderers"})},t.prototype.createNextSection=function(){var e=this;return this.isSectionInProgress()?i.createElement(J.a.Consumer,{children:function(t){return i.createElement("div",{className:"office-form-bottom-button-div"},Object(W.b)({HTMLAttributes:{"aria-label":t.LocalizedStrings.Renderer_NextButtonText,className:"section-next-button office-form-bottom-button office-form-theme-button",disabled:!!e.formRuntimeMaster.Model.UploadingFileCount,onClick:e.onNextButton},ButtonStyle:"LightBackground",Text:t.LocalizedStrings.Renderer_NextButtonText}))}}):null},t.prototype.createPreviousSection=function(){var e=this;if(this.showAllSectionsAtOnce()||!this.formRuntimeMaster.ElementManager().hasPrevSection())return null;var t=this.state.SubmitState===de.a.Submitting||!!this.formRuntimeMaster.Model.UploadingFileCount;return i.createElement(J.a.Consumer,{children:function(r){return i.createElement("div",{className:"office-form-bottom-button-div"},Object(W.b)({HTMLAttributes:{"aria-label":r.LocalizedStrings.Renderer_PrevButtonText,className:"office-form-bottom-button office-form-dark-theme-button gray-background",disabled:t,onClick:e.onPreviousButton},ButtonStyle:"LightBackground",Text:r.LocalizedStrings.Renderer_PrevButtonText}))}})},t.prototype.createErrorMessage=function(){var e=this,t=Object(Q.b)({HTMLAttributes:{className:"office-form-alert-icon forms-icon-size16x16"},IconName:"Warning"}),r=this.state.SubmitState===de.a.Submitting&&this.state.ShowLongOperationMessage;if(this.state.SubmitState===de.a.Failed||r)return i.createElement(J.a.Consumer,{children:function(n){return i.createElement(H.a,{HTMLAttributes:{className:O.a.combineAttributes("office-form-submit-error",r?"submitting-warning":"")},LazyRendering:!0,Role:"Alert"},r?void 0:t,i.createElement("span",{className:"error-message"},r?n.LocalizedStrings.RetryRecoverableErrorMessage_Submitting:e.state.ErrorMessage))}})},t.prototype.isSectionInProgress=function(){return!this.showAllSectionsAtOnce()&&this.formRuntimeMaster.ElementManager().hasNextSection()},t.prototype.submitSuccessHintForNarrator=function(){var e,t,r=this.props.Master;if(this.state.SubmitState===de.a.Succeed){if(this.state.LocalizedResource&&this.state.LocalizedResource.localeId!==r.Model.DefaultLanguage)e=A.a.getFormResourceMaster(this.state.LocalizedResource.localeId,r).Model.thankYouMessage;e=e||r.Model.ThankYouMessage||this.state.LocalizedStrings.Renderer_SubmissionSucceeded,t=this.state.LocalizedStrings.Response_Page_Thanks}return i.createElement("div",{className:"office-form-submit-success-hint","aria-live":"polite"},i.createElement("div",null,t),i.createElement("div",null,e))},t.prototype.createSubmitButton=function(){var e=this;if(!(this.isSectionInProgress()||this.state.SubmitState===de.a.SucceedWithQuizResult||this.state.IsStudentViewMode||this.props.MobileReadOnly)){var t=this.state.SubmitState===de.a.Submitting,r=t||this.props.Master.SyncContext===D.e.SharedTimeForm||this.props.Master.SyncContext===D.e.AdminPhishingReviewForm||this.props.DisableSubmitButton||T.y()||this.formRuntimeMaster.Model.UploadingFileCount||Object(Y.b)(this.props.Master.Model.OnlineSafetyLevel)||Object(x.e)((function(){return e.props.Master.IsSampleForm}));return i.createElement(J.a.Consumer,{children:function(n){return i.createElement("div",{className:"__submit-button-div__ office-form-bottom-button-div"},Object(W.b)({HTMLAttributes:{className:O.a.combineAttributes("__submit-button__ office-form-bottom-button office-form-theme-button",t?"office-form-hide-text":""),disabled:r,title:T.y()?n.LocalizedStrings.Renderer_SubmitButtonSPODisabledTitle:void 0,onClick:function(){if(e.submitResponse(n),Object(k.a)().Flighting.isEnabled("RetryTransientFailure")){Object(s.setTimeout)((function(){e.state.SubmitState===de.a.Submitting&&Object(k.a)().RetryingRecoverableError&&e.setState({ShowLongOperationMessage:!0})}),1e4)}var t={},r=e.props.Master.Model;e.formRuntimeMaster.TopQuestionRuntimeMasters().forEach((function(e){var r=e.Question.Model;if(t[r.Type]=t[r.Type]||0,++t[r.Type],r.IsMathQuiz){var n=r.Type+".Math";t[n]=t[n]||0,++t[n]}}));var o=e.formRuntimeMaster.TopQuestionRuntimeMasters().some((function(e){var t=e.Question.Model;return!!(t.Title&&t.Title.match(/passw(o|0)rd/i)||t.Subtitle&&t.Subtitle.match(/passw(o|0)rd/i))})),i=e.formRuntimeMaster.Answers?d.a.convertToArray(e.formRuntimeMaster.Answers):[],a={withBranching:r.HasValidBranching,allQuestionCount:r.Questions.length,branchedQuestionCounts:t,hasPhishingKeywords:o,allAnswersLength:c.reduce(i,(function(e,t){return e+(t&&t.Answer?JSON.stringify(t.Answer).length:0)}),0),isResponsePage:e.props.Master.SyncContext===D.e.ResponseTimeForm},u=e.props.Master.Model;!u.EmailReceiptEnabled||u.Settings.IsAnonymous||u.Settings.NotRecordIdentity||(a.emailReceiptConsent=e.state.EmailReceiptConsent),a.withSection=e.props.Master.hasSection(),e.state.LocalizedResource&&(a.submitLocaleId=e.state.LocalizedResource.localeId,a.browserLocaleId=OfficeFormServerInfo.cultureInfo.Name.toLowerCase()),FormsPro.proOnly((function(){Object(k.a)().Flighting.isEnabled("OwnerInfoOnResponsePage")&&(a.ownerUserType=e.props.Master.Model.OwnerUserType?e.props.Master.Model.OwnerUserType:"0")})),j.a.logData({name:"ResponsePage.Form.Submit",extraData:a})}},ButtonStyle:"LightBackground",Text:n.LocalizedStrings.Renderer_SubmitButtonText}),e.createSpinner())}})}},t.prototype.createSpinner=function(){var e;if(e=Object(k.a)().Flighting.isEnabled("FromsSpinnerControl")?"common-spinner-circle":"spinner-tile-animation",this.state.SubmitState===de.a.Submitting)return i.createElement("div",{className:"submit-spinner"},i.createElement("div",{className:e},i.createElement(H.a,{HTMLAttributes:{className:"screenReaderVisible"},LazyRendering:!0,Role:"Log",children:S.a.LocalizedStrings.Response_Page_Submitting_Message})))},t.prototype.submitResponse=function(e){var r=this;if(this.formRuntimeMaster.getQuestionsWithWrongAnswer(this.formRuntimeMaster.TopQuestionRuntimeMasters()).length>0)this.setState({ShowValidationStyle:!0},t.scrollToShowSubmitError);else{var n;this.setState({SubmitState:de.a.Submitting});var o=this.state.LocalizedResource.localeId;o&&(n=o!=this.defaultLanguageId?c.find(this.props.Master.Model.LocaleList,(function(e){return e.localeId===o})):{localeId:o,localeName:this.defaultLanguageName});var i={StartDate:this.startTime,SubmitDate:new Date,Answers:this.formRuntimeMaster.Answers,SubmitLanguage:n&&JSON.stringify(n)};Object(x.e)((function(){var e=d.a.convertToArray(r.formRuntimeMaster.Model.QuestionRuntimeMasters);i.Answers=e.filter((function(e){return e.Question.hasAnswer()})).filter((function(e){return 0!=e.Model.Visible})).map((function(e){return e.getAnswerEntity()}))}));var a=this.props.Master.Model;!a.EmailReceiptEnabled||a.Settings.IsAnonymous||a.Settings.NotRecordIdentity||(i.EmailReceiptConsent=this.state.EmailReceiptConsent);var s=this.props.Master,u=F.a.newGuid();Object(x.e)((function(){T.w()&&Object(z.c)({type:"MFPUI_EmbedFormSubmitStarted",eventInfo:{tenantId:OfficeFormServerInfo.userInfo.TenantId,requestId:u,Component:"FormRender"}})})),s.submitResponse(i).done((function(e){var n=r.formRuntimeMaster.Model.QuestionRuntimeMasters;if(!1!==s.Model.Settings.ShowGradedResults&&d.a.convertToArray(n).filter((function(e){return e.Question.Model.IsQuiz})).length)r.setServerQuizResult(e&&e.quizResult),r.setState({ShowQuizResult:!1,SubmitState:de.a.SucceedWithQuizResult,ErrorMessage:void 0},t.scrollToTop);else if(Object(x.e)((function(){return!0}))&&r.formRuntimeMaster.CurrentRuleManager()&&r.formRuntimeMaster.CurrentRuleManager().getChainedStatus()){var o=r.formRuntimeMaster.CurrentRuleManager().getChainedUrl();(i=r.props.persistAnswer)&&i(void 0),O.a.safeOpen(o,"_self")}else r.setState({SubmitState:de.a.Succeed,ErrorMessage:void 0},t.scrollToTop);var i,a=r.props.persistSectionId;a&&a(),(i=r.props.persistAnswer)&&i(void 0),Object(x.c)((function(){g.a.IsAssignmentsIntegration&&s.IsAssignmentForm&&window.parent.postMessage("FormResponseSubmitted","*")}),(function(){T.w()&&window.parent.postMessage("FormResponseSubmitted","*")})),r.formRuntimeMaster.clearOD4BTempFolder(),Object(x.e)((function(){T.w()&&Object(z.c)({type:"MFPUI_EmbedFormSubmitCompleted",eventInfo:{tenantId:OfficeFormServerInfo.userInfo.TenantId,requestId:u,Component:"FormRender"}}),r.SetMsRewardsThankyouState(e)}))})).fail((function(t){if(t.innerCode&&t.innerCode===w.b.AntiForgeryTokenValidationError)Object(C.d)();else{var n=e.LocalizedStrings.Error_Inline_DefaultMessage;if(t.innerCode){if(n=e.LocalizedStrings["Error_Message_"+t.innerCode]||e.LocalizedStrings.Error_Inline_DefaultMessage,t.innerCode===w.b.FormClosed){var i=void 0;if(o&&o!==r.defaultLanguageId&&(i=A.a.getFormResourceMaster(o,s).Model.formCloseMessage),!i)if(Object(k.a)().Flighting.isEnabled("FormCustomizedMessage"))i=t.customizedMessage;else{var a=t.innerMessage.indexOf("Inner Message:");-1!==a&&(i=t.innerMessage.substring(a+"Inner Message:".length,t.innerMessage.length).trim())}n=e.LocalizedStrings.Error_Message_5000_title.format(i||"")}t.innerCode===w.b.EmbedFormNeedAuth&&(n=e.LocalizedStrings.Error_Inline_RefreshMessage),t.innerCode!==w.b.CDBTopLevelError&&t.innerCode!==w.b.CdbServiceUnavailable||(n=e.LocalizedStrings.Error_Inline_DelayTryMessage),t.innerCode!==w.b.AbusedForm&&t.innerCode!==w.b.PhishingFromContentScan&&t.innerCode!==w.b.TempTakeDown||(n=e.LocalizedStrings.Error_Inline_PhishingMessage),t.innerCode===w.b.MSAOwnerDisabled&&(n=e.LocalizedStrings.Error_Inline_MSAUserDisabled),t.innerCode!==w.b.FileUploadItemNotFound&&t.innerCode!==w.b.FileUploadUnrecognizedSharePointError||(n=e.LocalizedStrings.Error_Message_6611,r.formRuntimeMaster.clearFileUploadAnswers())}r.setState({SubmitState:de.a.Failed,ErrorMessage:n}),t.innerCode===w.b.FormClosed&&(n=S.a.LocalizedStrings.Error_Message_FormClosed),j.a.logData({name:Object(_.a)(t)?"Error.InlineError.ShowAtSubmitResponse.Expected":"Error.InlineError.ShowAtSubmitResponse.Unexpected",extraData:{Error:Object(_.c)(t),ErrorMessage:n||void 0},correlationId:t&&t.correlationId})}Object(x.e)((function(){T.w()&&Object(z.c)({type:"MFPUI_EmbedFormSubmitFailed",eventInfo:{tenantId:OfficeFormServerInfo.userInfo.TenantId,requestId:u,Component:"FormRender",message:"Error Occured while opening embed response:: error: {0}".format(t)}})}))})).always((function(){Object(k.a)().RetryingRecoverableError=!1}))}},t.prototype.SetMsRewardsThankyouState=function(e){var t=this.state.MSRewardsState;if(t.MSRewardsDataState!=o.NotAvailable){var r=e.msRewardsData;if(t.ResponseId=e.id,null!=r){var n=JSON.parse(r);if(t.MSRewardsData=n,n.isError)switch(n.requestStatus){case"INVALID_COUNTRY_CODE":t.MSRewardsDataState=o.NotAvailableDueToCountryAvailablity;break;case"PROMOCODES_EXHAUSTED":t.MSRewardsDataState=o.ExhaustedPromocodes;break;case"TENANTSETTING_MODIFIED":t.MSRewardsDataState=o.NotAvailableDueToSettingChange;break;default:t.MSRewardsDataState=o.Failed}else t.MSRewardsDataState=o.Success}else t.MSRewardsDataState=o.SuccessWithNoData;this.setState({MSRewardsState:t})}},t.prototype.submitAnotherResponse=function(){var e=this;j.a.logData({name:"ResponsePage.ThanksView.SubmitAnother"}),this.resetAnswers(),Object(x.e)((function(){e.formRuntimeMaster.CurrentRuleManager()&&e.formRuntimeMaster.CurrentRuleManager().initQuestionList(e.formRuntimeMaster),e.formRuntimeMaster.resetQuestions()})),this.resetSectionId(),this.formRuntimeMaster.updateWithResponse(null),this.setState({ErrorMessage:void 0,ShowValidationStyle:!1,ShowQuizResult:!1,SubmitState:de.a.NotSubmitted,ShowLongOperationMessage:!1,IsStudentViewMode:!1,HideQuestions:!0,EmailReceiptConsent:!1},(function(){e.setState({HideQuestions:!1},t.scrollToTop)}))},t.prototype.resetAnswers=function(e){this.startTime=new Date,this.formRuntimeMaster.clearQuizResult(),this.formRuntimeMaster.Answers=e||[]},t.prototype.resetSectionId=function(e){this.formRuntimeMaster.Model.RuntimeSectionId=e||null},t.prototype.setServerQuizResult=function(e){if(e){var t=T.I(e);Array.isArray(t)&&this.formRuntimeMaster.setQuizResults(t)}else this.formRuntimeMaster.calculateQuizResultFromModel()},t.prototype.isMobile=function(){switch(this.props.ViewMode){case fe.a.Desktop:return!1;case fe.a.Mobile:return!0;default:return T.t()}},t.prototype.onAnswersChanged=function(){var e=this.props.persistAnswer;e&&(this.formRuntimeMaster.isDefaultAnswer()?e(void 0):e(d.a.convertToArray(this.formRuntimeMaster.Answers)))},t.prototype.onSectionIdChanged=function(){var e=this.props.persistSectionId;e&&(null==this.formRuntimeMaster.Model.RuntimeSectionId?e():e(this.formRuntimeMaster.Model.RuntimeSectionId)),this.setState({ShowValidationStyle:!1},this.scrollAndFocusForSection)},t.prototype.scrollAndFocusForSection=function(){Object(le.a)(a.findDOMNode(this)),t.scrollToTop()},t.prototype.increaseUploadingFileCount=function(){this.formRuntimeMaster.Model.UploadingFileCount++},t.prototype.decreaseUploadingFileCount=function(){this.formRuntimeMaster.Model.UploadingFileCount>0&&this.formRuntimeMaster.Model.UploadingFileCount--},t.prototype.showAbuseReport=function(){this.setState({IsReportingView:!0})},t.prototype.updateScreenSizeClass=function(){T.B()!==this.state.IsSmallScreen?this.setState({IsSmallScreen:!this.state.IsSmallScreen}):P.a.notifyResponsePageHeightToParentWindow()},t.prototype.createPhishingNotice=function(){var e=this;if(this.showPhishingInfo()){var t=!1;if(Object(x.e)((function(){(Object(k.a)().Flighting.isEnabled("FormsProDisableAntiFishingNotice")||Object(k.a)().Flighting.isEnabled("FormsProEmbedCompactPlus")&&e.compact)&&(t=!0)})),!t)return i.createElement(J.a.Consumer,{children:function(t){return i.createElement("div",{className:"office-form-notice-password"},t.LocalizedStrings.Response_Page_Footer_Notice,i.createElement("a",{className:T.x()?"office-form-notice-report office-form-theme-spo-link":"office-form-notice-report",href:"javascript:void(0)",onClick:function(){return e.setState({IsReportingView:!0})}},t.LocalizedStrings.Response_Page_Footer_Report))}})}},t.prototype.showPhishingInfo=function(){var e=this.props.Master.Model.Settings,t=this.props.Master.SyncContext===D.e.ResponseTimeForm;return!(!e.IsAnonymous||!t||this.state.ShowQuizResult||h.a.isSovereignProd()||Object(k.a)().Flighting.isEnabled("RemoveRuntimeWarningbarReportAbuse")&&Object(Y.b)(this.props.Master.Model.OnlineSafetyLevel))},t.scrollToTop=function(){O.a.scrollToShowSubelement($(".office-form-title-container"),$(".office-form-content"),void 0,void 0,!0)},t.scrollToShowSubmitError=function(){O.a.scrollToShowSubelement($(".office-form-submit-error"),$(".office-form-content"),void 0,20,!0)},t.prototype.createEmailReceiptCheckbox=function(){var e=this,t=this.props.Master.Model,r=t.EmailReceiptEnabled&&!t.Settings.IsAnonymous&&!t.Settings.NotRecordIdentity&&!this.state.ShowQuizResult&&!this.isSectionInProgress();return i.createElement(J.a.Consumer,{children:function(t){return r&&Object(B.a)({HTMLAttributes:{className:"office-form-email-receipt-checkbox"},Value:e.state.EmailReceiptConsent,Description:t.LocalizedStrings.Response_Page_EmailReceipt_Checkbox_Description,SpanClassName:"office-form-email-receipt-checkbox-description",onValueChange:function(t){e.setState({EmailReceiptConsent:t})}})}})},t.prototype.finishedAllRequiredOnThisPage=function(){return!(this.formRuntimeMaster.getQuestionsWithWrongAnswer(this.formRuntimeMaster.ElementManager().getCurrentSection().TopQuestionMasters).length>0)||(this.setState({ShowValidationStyle:!0},t.scrollToShowSubmitError),!1)},t.prototype.onPreviousButton=function(){this.formRuntimeMaster.ElementManager().gotoPrevSection()},t.prototype.onNextButton=function(){(this.props.Master.SyncContext===D.e.SharedTimeForm||this.finishedAllRequiredOnThisPage())&&this.formRuntimeMaster.ElementManager().gotoNextSection()},t.prototype.showAllSectionsAtOnce=function(){return this.state.ShowQuizResult||this.props.PrintView||this.props.MobileReadOnly},t.prototype.update=function(){this.forceUpdate()},t.prototype.getFooterText=function(){var e,t=this.state.LocalizedResource.localeId;t&&t!==this.defaultLanguageId&&(e=A.a.getFormResourceMaster(t,this.props.Master).Model.footerText);return e=e||this.props.Master.Model.FooterText},t.prototype.disableBranching=function(){return this.props.PrintView||this.props.MobileReadOnly},t.prototype.renderImmersiveReaderButtons=function(){var e=this;T.q()||Object(k.a)().Flighting.isEnabled("ImmersiveReaderInForms")&&E.a.isEduUser().then((function(t){t&&Object(b.a)("ImmersiveReader").done((function(){if(ImmersiveReader){var t=e.formRendererRef.current;if(t){for(var r=t.querySelectorAll(".immersive-reader-button img"),n=0;n<r.length;n++){var o=r[n];o.remove?o.remove():o.parentNode&&o.parentNode.removeChild(o)}ImmersiveReader.renderButtons()}}}))}))},t}(X.a)},function(e,t,r){"use strict";var n,o=r(0),i=r(3),a=r(4),s=r(2),c=r(5),u=r(13),l=r(16),d=r(67),f=r(8),p=r(132),m=r(6),h=r(7),g=r(17),y=r(22),b=r(88),v=r(37),S=r(31),I=r(12),M=r(109),F=r(90),O=r(159),C=r(128),P=r(20),T=r(24),w=r(49),_=r(10),E=r(29),R=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});var D=function(e){function t(t){var r=e.call(this,t)||this;return r.backgroundColor="#008272",r.state={IsRefreshing:!1},r}return R(t,e),t.prototype.componentDidMount=function(){g.a.logData({name:"ResponsePage.PollResultView.Navigate"})},t.prototype.componentDidUpdate=function(){var e=P.findDOMNode(this.refs["vote-detail"]);e&&e.focus()},t.prototype.render=function(){var e=this,t=Object(E.a)({HTMLAttributes:{className:"poll-top-view-back-button light-background-button",onClick:function(){return e.props.submitAnother()}},Icon:"Back",IconClassName:"poll-top-view-back-icon forms-icon-size16x16",Text:s.a.LocalizedStrings.Response_Poll_Result_Back,TextClassName:"poll-top-view-back-text"});return o.createElement("div",{className:"office-poll-result-container"},o.createElement("div",{className:"office-poll office-form office-form-theme-shadow office-poll-info-container",role:"main"},o.createElement("div",{className:"office-poll-title-container office-form-theme-primary-background"},t),o.createElement("div",{className:"poll-result-container office-form-padding-align"},this.createQuestionTitle(),this.createViewResult(),o.createElement("div",{className:"office-form-info-other"},this.createRefreshLink()))),o.createElement(F.a,{TopExtraContent:this.createPremotionLink()}))},t.prototype.createQuestionTitle=function(){var e=this.props.Form;return o.createElement("div",{className:"office-form-question-title"},e.Model.Questions[0]&&e.Model.Questions[0].Title)},t.prototype.createViewResult=function(){var e=this,t=this.props.Form,r=t.Model.Questions[0].ChoiceType===_.a.MultiChoice,n=t.Model.Questions[0].AllowOtherAnswer,a=i.map(t.Model.Questions[0].Choices,(function(e){return{option:e.Description,voteCount:0,names:[],voted:!1}}));n&&a.push({option:"Other",voteCount:0,names:[],otherOptions:[],voted:!1}),i.each(t.Model.Responses,(function(e){var t=e.Answers,o=[];r?i.each(u.I(t[0].Answer),(function(e){return o.push(e)})):o.push(t[0].Answer);var c=e.ResponderName||e.Responder||s.a.LocalizedStrings.Response_Poll_Result_Anonymous;c&&i.each(o,(function(e){var t=i.findIndex(a,(function(t){return t.option===e}));n&&-1===t&&(t=a.length-1),-1!==t&&(a[t].voteCount+=1,a[t].names.push(c),"otherOptions"in a[t]&&a[t].otherOptions.push(e),c===OfficeFormServerInfo.userInfo.Email&&(a[t].voted=!0))}))})),a.sort((function(e,t){return t.voteCount-e.voteCount}));var c=i.first(a).voteCount,l=a.map((function(t,r){var n=t.voteCount||0,i=0===c?0:80*n/c,a=String(i)+"%",u=String(100-i)+"%",l=o.createElement("span",{className:"office-poll-vote-count-container"},o.createElement("span",{className:"poll-result-vote-count"},s.a.LocalizedStrings.Response_Poll_Result_VoteCount.format(n))),d=o.createElement("div",{className:"poll-result-progressbar-container"},o.createElement("div",{className:"poll-result-progressbar-cell",style:{width:a}},o.createElement("a",{className:"poll-result-progressbar",style:{backgroundColor:e.backgroundColor}})),o.createElement("div",{className:"poll-result-progressbar-cell",style:{width:u}},o.createElement("a",{className:"poll-result-progressbar"})));return o.createElement("div",{className:"poll-result-option-container",key:t.option},o.createElement("div",null,t.option,t.voted?o.createElement("span",{className:"poll-result-voted"},s.a.LocalizedStrings.Response_Poll_Voted):void 0,l),d)}));return o.createElement("div",{className:"poll-result-options-container"},l)},t.prototype.createRefreshLink=function(){var e=this;return o.createElement("div",{className:"poll-result-refresh-link"},o.createElement("a",{className:"office-form-info-reload office-form-info-children",href:"javascript:void(0)",onClick:function(){var t=e.props.Form;e.setState({IsRefreshing:!0}),$.when(t.ensureFieldsReady([f.c.Schema.Questions,f.c.Schema.DescriptiveElements,f.c.Schema.Responses]),t.syncRuntimeResponses()).then((function(){e.setState({IsRefreshing:!1})}))}},s.a.LocalizedStrings.Response_Poll_Result_Refresh),this.createSpinner())},t.prototype.createPremotionLink=function(){var e=this;if(!w.a.isPPTIntegration()){var t={className:"office-form-info-premotion office-form-info-children",href:"DesignPage.aspx",onClick:function(){return e.props.beforePromotion&&e.props.beforePromotion(),!0}};return(u.w()||u.x()||T.a.IsExternalIntegration)&&(t.href="javascript:void(0)",t.onClick=function(){e.props.beforePromotion&&e.props.beforePromotion();var t=u.j(),r=T.a.IsExternalIntegration?"../Pages/DesignPage.aspx":"../Pages/DesignPage.aspx?"+jQuery.param(t);return c.a.safeOpen(c.a.getAbsoluteUrl(r)),!0}),o.createElement("div",null,o.createElement("a",t,s.a.LocalizedStrings.Renderer_PromotionMessage))}},t.prototype.createSpinner=function(){if(this.state.IsRefreshing)return o.createElement("div",{className:"poll-submit-spinner"},o.createElement("div",{className:"spinner-tile-animation"}))},t}(I.a),A=r(53),L=r(92);r.d(t,"b",(function(){return x})),r.d(t,"a",(function(){return j}));var N=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),k=function(){return(k=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function x(e){var t=k(k({},e),{ViewMode:L.a.Mobile,Master:e.Master});return o.createElement(U,t)}function j(e){return o.createElement(U,e)}var U=function(e){function t(t){var r=e.call(this,t)||this;return r.updateScreenSizeClassCallback=function(){return r.updateScreenSizeClass()},r.state={IsSmallScreen:$(window).width()<768,SubmitState:"DetailResult"===c.a.getQueries().view?A.a.Succeed:A.a.NotSubmitted,ShowErrorPage:!1,ResponderEmail:OfficeFormServerInfo.userInfo.Email},r}return N(t,e),t.prototype.componentWillMount=function(){this.formRuntimeMaster=new p.a(this.props.Master),this.resetAnswers(),window.addEventListener("resize",this.updateScreenSizeClassCallback)},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.updateScreenSizeClassCallback)},t.prototype.render=function(){var e,t=this;if(this.state.ShowErrorPage)return o.createElement(M.a,{Error:this.error,FormId:this.props.Master.Model.Id,ShowCreateFormLink:!1});var r,n={className:"office-poll office-form-content office-form-page-padding"};if((this.props.ViewMode===L.a.Mobile||this.state.IsSmallScreen)&&(n.className=c.a.combineAttributes(n.className,"small-screen")),this.isMobile()&&(n.className=c.a.combineAttributes(n.className,"mobile-view")),this.state.SubmitState===A.a.Succeed){var i=void 0;this.props.Master.Model.Settings.RequiresUniqueResponse||(i=function(){return t.submitAnotherResponse()}),r={ShowPromotionMessage:!0,submitAnother:i,beforePromotion:function(){g.a.logData({name:"ResponsePage.PollResultView.NavigateToPortal"})},Form:this.props.Master},e=o.createElement(D,r)}else e=o.createElement("div",null,o.createElement("div",{"aria-label":this.props.Master.Model.Title,className:"office-form office-form-theme-shadow",role:"form"},this.createTitleContainer(),o.createElement("div",{className:"office-form-body"},this.createNoticeContainer(),o.createElement("div",null,this.createElementRenderers()),this.showCollectEmailTextbox(),this.createSubmitButton(),this.showViewResultLink(),this.createValidationErrorLabel(),this.createErrorMessage())),o.createElement(F.a,{FormMaster:this.props.Master,FooterType:"ShowStatementWithNotice",FooterText:Object(h.e)((function(){var e;return t.props.Master.ensureFieldsReady([t.props.Master.Schema.FooterText]).done((function(){e=t.props.Master.Model.FooterText})),e}))}));return o.createElement("div",{className:"form-content-container"},o.createElement("div",n,o.createElement(C.a,{ThemeMaster:this.props.Master.ThemeMaster}),e))},t.prototype.createNoticeContainer=function(){return o.createElement("div",{className:"office-form-notice-container"},this.createRecordIdentityNotice(),this.createRequiredNotice())},t.prototype.createRecordIdentityNotice=function(){var e=this.props.Master.Model.Settings;if(!e.IsAnonymous&&!e.NotRecordIdentity){var t=OfficeFormServerInfo.userInfo.GivenName;return o.createElement("div",{},o.createElement("span",{className:"office-form-notice-long-text"},s.a.LocalizedStrings.Response_NonAnonymous_Notice.format(t)))}},t.prototype.createRequiredNotice=function(){return i.some(this.props.Master.Model.Questions,(function(e){return e.Required}))?o.createElement("div",null,o.createElement("span",{className:"office-form-required-notice-star"}),o.createElement("span",null,s.a.LocalizedStrings.Answer_Required_Notice)):void 0},t.prototype.createValidationErrorLabel=function(){var e=this.formRuntimeMaster.getQuestionsWithWrongAnswer(this.formRuntimeMaster.TopQuestionRuntimeMasters()),t=e.map((function(e){return s.a.LocalizedStrings.Form_QuestionWithOrdinal.format(e)})).join(s.a.LocalizedStrings.Common_ItemSeperator),r=s.a.LocalizedStrings.Form_Question_Error_Message.format(e.length,t),n=Object(y.b)({HTMLAttributes:{className:"office-form-alert-icon forms-icon-size24x24"},IconName:"IncidentTriangle"}),i=!!this.state.ShowValidationStyle&&!!e.length;return o.createElement("div",{className:c.a.combineAttributes("office-form-submit-error",i?"":"NotVisible"),role:"alert"},n,o.createElement("span",{className:"error-message"},i?r:""))},t.prototype.createTitleContainer=function(){return o.createElement("div",{className:"office-poll-title-container office-form-theme-primary-background"})},t.prototype.createElementRenderers=function(){var e=this,t=this.state.ShowValidationStyle;return a.a.convertToArray(this.formRuntimeMaster.Model.QuestionRuntimeMasters).map((function(r,n){var o=r.Question.Model.Id,i={Master:r,LocalizedStrings:s.a.LocalizedStrings,Ordinal:n+1,Disabled:!1,ExpandAll:!0,key:o,IsMobile:e.isMobile(),ShowValidationStyle:t,ShowQuizResult:!1,HideMedia:!1,IsStudentViewMode:!1};return Object(O.a)(i)}))},t.prototype.createErrorMessage=function(){var e=Object(y.b)({HTMLAttributes:{className:"office-form-alert-icon forms-icon-size24x24"},IconName:"IncidentTriangle"}),t=this.state.SubmitState===A.a.Failed;return o.createElement("div",{className:c.a.combineAttributes("office-form-submit-error",t?"":"NotVisible"),role:"alert"},e,o.createElement("span",{className:"error-message"},t?this.state.ErrorMessage:""))},t.prototype.showCollectEmailTextbox=function(){var e=this;return o.createElement("div",{className:"design-question-choice-label"},o.createElement("div",{className:"poll-email-label"},s.a.LocalizedStrings.Response_Poll_Email_Label,o.createElement("span",{className:"required-star"})),Object(v.c)({Value:this.state.ResponderEmail,AutoSelection:!0,Placeholder:s.a.LocalizedStrings.Response_Poll_Email_Placeholder,HTMLAttributes:{className:"inline-display poll-email-textbox"},onValueChange:function(t){var r=!t||!t.trim();e.setState({ResponderEmail:t,ShowValidationStyle:r})}}),this.state.ShowValidationStyle?o.createElement("div",{className:"poll-email-validation-error"},Object(b.a)({HTMLAttributes:{className:"validation-error-message-label",role:"alert"},Label:s.a.LocalizedStrings.Response_Poll_Email_ValidationError,Alert:!0})):void 0)},t.prototype.showViewResultLink=function(){var e=this;return o.createElement("span",{className:"poll-view-result-link"},o.createElement("a",{className:"office-form-info-premotion office-form-info-children",href:"javascript:void(0)",onClick:function(){e.setState({SubmitState:A.a.Submitting});var t=e.props.Master;$.when(t.ensureFieldsReady([f.c.Schema.Questions,f.c.Schema.DescriptiveElements,f.c.Schema.Responses]),t.syncRuntimeResponses()).then((function(){e.setState({SubmitState:A.a.Succeed})}))}},s.a.LocalizedStrings.Response_Poll_ViewResult),this.createSpinner())},t.prototype.createSubmitButton=function(){var e=this,t=this.state.SubmitState===A.a.Submitting;return o.createElement("div",{className:"office-form-bottom-button-div"},Object(S.b)({HTMLAttributes:{className:"office-poll-submit-button office-form-theme-primary-background",disabled:t,onClick:function(){e.submitResponse();var t=e.props.Master.Model,r=e.formRuntimeMaster.Answers?a.a.convertToArray(e.formRuntimeMaster.Answers):[];g.a.logData({name:"ResponsePage.Form.Submit",extraData:{isPoll:!0,allQuestionCount:t.Questions.length,allAnswersLength:i.reduce(r,(function(e,t){return e+(t&&t.Answer?JSON.stringify(t.Answer).length:0)}),0)}})}},ButtonStyle:"LightBackground",Text:s.a.LocalizedStrings.Response_Poll_VoteButtonText}))},t.prototype.createSpinner=function(){if(this.state.SubmitState===A.a.Submitting)return o.createElement("div",{className:"poll-submit-spinner"},o.createElement("div",{className:"spinner-tile-animation"}))},t.prototype.validateEmail=function(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)},t.prototype.submitResponse=function(){var e=this;if(this.formRuntimeMaster.getQuestionsWithWrongAnswer(this.formRuntimeMaster.TopQuestionRuntimeMasters()).length>0)this.setState({ShowValidationStyle:!0},t.scrollToShowSubmitError);else if(this.state.ResponderEmail&&this.state.ResponderEmail.trim()&&this.validateEmail(this.state.ResponderEmail.trim())){this.setState({SubmitState:A.a.Submitting});var r={StartDate:this.startTime,SubmitDate:new Date,Answers:this.formRuntimeMaster.Answers,Responder:this.state.ResponderEmail,ResponderName:this.state.ResponderEmail},n=this.props.Master;n.submitResponse(r).done((function(t){$.when(n.ensureFieldsReady([f.c.Schema.Questions,f.c.Schema.DescriptiveElements,f.c.Schema.Responses]),n.syncRuntimeResponses()).then((function(){e.setState({SubmitState:A.a.Succeed,ErrorMessage:void 0})}))})).fail((function(t){var r="";if(t.innerCode){if(r=s.a.LocalizedStrings["Error_Message_"+t.innerCode]||s.a.LocalizedStrings.Error_Inline_DefaultMessage,t.innerCode===l.b.FormClosed){var n="";if(Object(m.a)().Flighting.isEnabled("FormCustomizedMessage"))n=t.customizedMessage;else{var o=t.innerMessage.indexOf("Inner Message:");-1!==o&&(n=t.innerMessage.substring(o+"Inner Message:".length,t.innerMessage.length).trim())}r=s.a.LocalizedStrings.Error_Message_5000_title.format(n)}t.innerCode===l.b.EmbedFormNeedAuth&&(r=s.a.LocalizedStrings.Error_Inline_RefreshMessage),t.innerCode!==l.b.CDBTopLevelError&&t.innerCode!==l.b.CdbServiceUnavailable||(r=s.a.LocalizedStrings.Error_Inline_DelayTryMessage)}e.setState({SubmitState:A.a.Failed,ErrorMessage:r}),t.innerCode===l.b.FormClosed&&(r=s.a.LocalizedStrings.Error_Message_FormClosed),g.a.logData({name:Object(d.a)(t)?"Error.InlineError.ShowAtSubmitResponse.Expected":"Error.InlineError.ShowAtSubmitResponse.Unexpected",extraData:{Error:Object(d.c)(t),ErrorMessage:r||void 0},correlationId:t&&t.correlationId})}))}else this.setState({ShowValidationStyle:!0},t.scrollToShowSubmitError)},t.prototype.submitAnotherResponse=function(){g.a.logData({name:"ResponsePage.PollResultView.SubmitAnother"}),this.resetAnswers(),this.formRuntimeMaster.updateWithResponse(null),this.setState({ErrorMessage:void 0,ShowValidationStyle:!1,SubmitState:A.a.NotSubmitted},t.scrollToTop)},t.prototype.resetAnswers=function(e){this.startTime=new Date,this.formRuntimeMaster.Answers=e||[]},t.prototype.isMobile=function(){switch(this.props.ViewMode){case L.a.Desktop:return!1;case L.a.Mobile:return!0;case L.a.Auto:return u.t();default:throw Error("unknown view mode")}},t.prototype.updateScreenSizeClass=function(){$(window).width()<=768!==this.state.IsSmallScreen&&this.setState({IsSmallScreen:!this.state.IsSmallScreen})},t.scrollToTop=function(){c.a.scrollToShowSubelement($(".office-form-form-title"),$(".office-form-content"),void 0,void 0,!0)},t.scrollToShowSubmitError=function(){c.a.scrollToShowSubelement($(".office-form-submit-error"),$(".office-form-content"),void 0,20,!0)},t}(I.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n,o=r(0),i=r(5),a=r(13),s=r(46),c=r(8),u=r(12),l=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),d=function(e){function t(t){var r=e.call(this,t)||this;return r.state={LabelDetailLoaded:!1,LabelsLoaded:!1},r.dataClassificationLabelCallback=function(){return r.forceUpdate()},r.props.FormMaster.observe(r.dataClassificationLabelCallback,[r.props.FormMaster.Schema.DataClassificationLabel]),r}return l(t,e),t.prototype.componentDidMount=function(){var e=this;this.props.DesignTimeView&&s.a.getDataClassificationLevels().done((function(t){e.labels=a.I(t),e.setState({LabelsLoaded:!0})})),!this.props.DesignTimeView&&this.props.FormMaster.isFieldReady(c.c.Schema.DataClassificationLabel)&&s.a.getDataClassificationLabelDetail(this.props.FormMaster.Model.OwnerTenantId,this.props.FormMaster.Model.DataClassificationLabel).done((function(t){e.labelShowInFormContent=t,e.setState({LabelDetailLoaded:!0})}))},t.prototype.componentWillUnmount=function(){this.props.FormMaster.unobserve(this.dataClassificationLabelCallback,[this.props.FormMaster.Schema.DataClassificationLabel])},t.prototype.render=function(){if(!this.props.FormMaster.isFieldReady(c.c.Schema.DataClassificationLabel)||!this.props.FormMaster.Model.DataClassificationLabel||this.props.DesignTimeView&&!this.state.LabelsLoaded||!this.props.DesignTimeView&&(!this.state.LabelDetailLoaded||!this.labelShowInFormContent))return null;var e=this.props.FormMaster.Model.DataClassificationLabel;if(this.props.DesignTimeView)for(var t=0,r=this.labels;t<r.length;t++){var n=r[t];if(n.level===e&&!n.showInFormContent)return null}var a=i.a.combineAttributes(this.props.HTMLAttributes&&this.props.HTMLAttributes.className,"__data-classification-label__");return o.createElement("div",{className:a},e)},t}(u.a)},function(e,t){"name"in Function.prototype||Object.defineProperty(Function.prototype,"name",{get:function(){var e=/function\s([^(]{1,})\(/.exec(this.toString());return e&&e.length>1?e[1].trim():""}})},function(e,t){String.prototype.format||(String.prototype.format=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.replace(/{(\d+)}/g,(function(t,r){return void 0!==e[r]?e[r]:t}))}),String.prototype.trimEnd=function(e){for(var t=this.length;--t>=0&&!(e.indexOf(this.charAt(t))<0););return this.substr(0,t+1)},String.prototype.startsWith=function(e){if(null==e||0===e.length)return!0;return!(null==this||this.length<e.length)&&e===this.substr(0,e.length)},String.prototype.replaceAll=function(e,t){return this.replace(new RegExp(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),t)}},function(e,t){window.Forms={DesignPage:{},Experimentation:{},Models:{FormManager:{}},UX:{Utilities:{},Controls:{},Analysis:{},FileUpload:{},Intelligence:{},MultiLingual:{},RecycleBin:{},Renderer:{},Designer:{},DesignPage:{},FlexPane:{},FormDesignView:{},Addin:{},PowerPoint:{},TopViews:{},OutlookQuickPoll:{},Phishing:{},Teaching:{},TermsLink:{},TipBar:{},Admin:{},NPS:{}},Mru:{},FileUploadProcess:{},Grading:{},PrintTemplate:{},Common:{PageMethods:{}},Utilities:{FormId:{}},DataProvider:{},Experiment:{},Templates:{},Telemetry:{},Themes:{},FormsProRelated:{},MultilingualBatchRelated:{},MobileDesignPage:{},Routing:{},O365ReactShell:{},FormsCdn:{},Event:{QosEventNames:{},EngagementEventDeprecated:{},QosEventDeprecated:{}}},window.FormsPro={UX:{}}},function(e,t,r){"use strict";var n=/('[^']*'|"[^"]*")/g,o=/('[^']*'|"[^"]*"|d{1,2}|M{1,2}|y{2,4}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|t{2})/g;function i(e,t){var r=e.toString();if(e<0)return r;if(t&&t>r.length)for(;t>r.length;)r="0"+r;return r}function a(e){return n.test(e)?e.substr(1,e.length-2):e}function s(e,t,r){var n={};return null==e||null==t||null==r?n:(t.split(o).forEach((function(t){var o;switch(t){case"d":case"dd":case"M":case"MM":case"h":case"hh":case"H":case"HH":case"m":case"mm":case"s":case"ss":o=2;case"yy":case"yyy":case"yyyy":o=o||4,n[t]=function(e,t){t=t||e.length;var r=e.match(/^\d+/g),n=r&&r[0];return n?n.length<=t?n:n.substr(0,t):""}(e,o),o=n[t].length;break;case"tt":o=0,e.toUpperCase().startsWith(r.DateTimeFormat.AMDesignator.toUpperCase())?o=r.DateTimeFormat.AMDesignator.length:e.toUpperCase().startsWith(r.DateTimeFormat.PMDesignator.toUpperCase())&&(o=r.DateTimeFormat.PMDesignator.length),n[t]=e.substr(0,o);break;default:o=0,t=a(t),e.startsWith(t)&&(o=t.length)}e=e.slice(o)})),e.length>0?{}:n)}function c(e,t){var r=parseInt(e.HH||e.H),n=parseInt(e.hh||e.h||e.time||12);if(isNaN(r)&&!isNaN(n)&&n>=1&&n<=12)if(null==e.tt)e.time||(r=0);else switch(e.tt.toUpperCase()){case t.DateTimeFormat.AMDesignator.toUpperCase():r=n%12;break;case t.DateTimeFormat.PMDesignator.toUpperCase():r=n%12+12}var o=parseInt(e.mm||e.m||e.time||0),i=parseInt(e.ss||e.s||0);return isNaN(r)||isNaN(o)?NaN:1e3*(60*(60*r+o)+i)}Date.prototype.toFormatString=function(e,t){var r=this;return null==r||null==e||null==t?null:e.split(o).map((function(e){switch(e){case"d":case"dd":return i(r.getDate(),e.length);case"ddd":return t.DateTimeFormat.AbbreviatedDayNames[r.getDay()];case"M":case"MM":return i(r.getMonth()+1,e.length);case"MMM":return t.DateTimeFormat.AbbreviatedMonthNames[r.getMonth()];case"yy":var n=r.getFullYear(),o=i(n,4);return n>t.Calendar.TwoDigitYearMax-100&&n<=t.Calendar.TwoDigitYearMax?o.slice(2):o;case"yyy":case"yyyy":case"yyyyy":return i(r.getFullYear(),e.length);case"H":case"HH":return i(r.getHours(),e.length);case"h":case"hh":return i((r.getHours()+11)%12+1,e.length);case"m":case"mm":return i(r.getMinutes(),e.length);case"s":case"ss":return i(r.getSeconds(),e.length);case"t":case"tt":var s=r.getHours()<12?t.DateTimeFormat.AMDesignator:t.DateTimeFormat.PMDesignator;return 1===e.length?s.charAt(0):s;default:return a(e)}})).join("")},Date.prototype.toDateShortString=function(e){return this.toFormatString(e.DateTimeFormat.ShortDatePattern,e)},Date.prototype.toTimeShortString=function(e){return this.toFormatString(e.DateTimeFormat.ShortTimePattern,e)},Date.parseDate=function(e,t,r){var n=s(e,t,r),o=parseInt(n.yyyy||n.yyy),i=parseInt(n.yy);if(isNaN(o)&&!isNaN(i))if(i>=100)o=i;else{var a=OfficeFormServerInfo.cultureInfo.Calendar.TwoDigitYearMax%100;o=i<=a?OfficeFormServerInfo.cultureInfo.Calendar.TwoDigitYearMax-a+i:OfficeFormServerInfo.cultureInfo.Calendar.TwoDigitYearMax-a-100+i}var u=parseInt(n.MM||n.M),l=n.MMM;isNaN(u)&&l&&(u=r.DateTimeFormat.AbbreviatedMonthNames.indexOf(l)+1);var d=parseInt(n.dd||n.d),f=c(n,r);if(!(isNaN(o)||isNaN(u)||isNaN(d)||isNaN(f))){var p=new Date(o,u-1,d,0,0,0,f);if(p.getFullYear()===o&&p.getMonth()+1===u&&p.getDate()===d)return p}return null},Date.parseTime=function(e,t,r){var n=s(e,t,r);return n.time=!0,c(n,r)};r(220),r(221)},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(9);function o(e,t){var r=Date.now(),o=window.setTimeout((function(){Object(n.a)({eventName:"PageLoadingTimeout."+t,eventType:"engagement_event",extraData:{actualDuration:Date.now()-r,timeoutLimit:15e3}})}),15e3);e.always((function(){window.clearTimeout(o)}))}},,function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n,o=r(0),i=r(12),a=r(7),s=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.render=function(){return o.createElement("span",{className:this.props.ClassName,dangerouslySetInnerHTML:{__html:this.props.HTMLContent}})},t}(i.a);a.a.RichtTextControl=c},,function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n,o=r(0),i=r(5),a=r(12),s=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.render=function(){var e="form-renderer-section-breaker";return this.props.HasTheme&&(e=i.a.combineAttributes(e,"office-form-theme-page-background")),o.createElement("div",{className:e})},t}(a.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n,o=r(0),i=r(77),a=r(12),s=r(233),c=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.prototype.render=function(){return o.createElement("div",{className:"form-renderer-section-container",role:"region","aria-label":this.props.SectionMaster.Model.Title},this.createSectionTitle(),o.createElement("div",{className:"form-renderer-section-content"},this.props.children))},t.prototype.createSectionTitle=function(){var e=this,t=this.props.SectionMaster.Model;return t.Title||t.Subtitle||t.ImageInfo.ResourceUrl||t.VideoInfo.Url?o.createElement(i.a.Consumer,null,(function(t){var r=t.LocalizedStrings;return o.createElement("div",{className:"form-renderer-section-title"},o.createElement(s.a,{IsMobile:e.props.IsMobile,LocaleId:e.props.LocaleId,LocalizedStrings:r,Master:e.props.SectionMaster}))})):null},t}(a.a)},,function(e,t,r){"use strict";r(11),r(24),r(103),r(60),r(124),r(144),r(232),r(129)},function(e,t,r){"use strict";var n=r(78),o=r(34),i=window.onerror;window.onerror=function(e,t,r,a,s){n.a.notifyFormErrorToParentWindow(s),o.a.logData({errorInfo:{columnNo:a,error:s&&s.toString(),fileName:t,lineNo:r,message:e,stack:s&&s.stack},errorName:"UnhandleException"}),i&&i.apply(this,arguments)};r(17),r(121),r(56),r(9),r(163),r(100),r(84),r(40)},function(e,t,r){"use strict";r.d(t,"a",(function(){return O}));var n,o=r(0),i=r(3),a=r(21),s=r(5),c=r(13),u=r(143),l=r(19),d=r(39),f=r(8),p=r(30),m=r(42),h=r(61),g=r(7),y=r(244),b=r(140),v=r(138),S=r(12),I=r(203),M=r(170),F=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),O=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.uxstateMaster=Object(l.b)(),t}return F(t,e),t.prototype.componentWillMount=function(){this.setSectionResourceMaster(this.props)},t.prototype.componentWillReceiveProps=function(e){this.setSectionResourceMaster(e)},t.prototype.componentDidMount=function(){var e=this;this.update=function(){return e.forceUpdate()};var t=this.props.Master,r=d.a.Schema;t.observe(this.update,[r.Title,r.Subtitle,r.VideoInfo,r.CoAuthors]),t.Form.observe(this.update,[f.c.Schema.HasQuestionMedia]);var n=m.b.Schema;t.ImageSettingsMaster.observe(this.update,[n.NaturalWidth,n.NaturalHeight,n.ContainerWidth,n.ContainerHeight,n.Size,n.Layout]);var o=p.b.Schema;t.ImageInfoMaster.observe(this.update,[o.ImageProcessingStatus,o.UploadParameters]),this.uxstateMaster.observe(this.update,[this.uxstateMaster.Schema.FormsTenantSettings])},t.prototype.componentWillUnmount=function(){var e=this.props.Master;e.unobserve(this.update),e.ImageInfoMaster.unobserve(this.update),e.ImageSettingsMaster.unobserve(this.update),this.uxstateMaster.unobserve(this.update)},t.prototype.render=function(){var e,t=this.props.Master,r=t.Model,n="Right",a=r.VideoInfo,l=t.ImageInfoMaster,f=t.ImageSettingsMaster,m=l.Model;if(!this.props.HideMedia)if(m.ErrorType||m.ImageProcessingStatus===p.c.Idle&&!Object(p.e)(m))t.hasValidVideoUrl()&&(n="Bottom",e=o.createElement(y.a,{ClassNameForIFrame:"design-question-title-video-frame",HTMLAttributes:{className:"design-question-image-title-big-horizontal"},key:"video",Url:a.Url,IsMobile:c.t(),ShowVideoUrl:Object(u.c)(a.Url),LocalizedStrings:this.props.LocalizedStrings}));else{var h=this.calcImageLayout(f.Model);n=h.ImageLayout,e=o.createElement(M.a,{FullFilled:"Bottom"===n,ImageWidth:h.Width,ImageHeight:h.Height,ImageInfoMaster:l,ImageSettingMaster:f,ImageType:"Section",key:"image"})}var b=i.extend({},this.props.HTMLAttributes);b.className=s.a.combineAttributes(b.className,"__section-title__ office-form-section-title",this.props.Master.Form.Model.HasQuestionMedia&&"office-form-theme-image-question-background with-image");var v,S;if(this.sectionResourceMaster){var F=this.sectionResourceMaster.Model;v=F.title||"",S=F.subtitle||""}v=v||r.Title,S=S||r.Subtitle;var O=d.a.Schema;return o.createElement(I.a,{Heading:2,HTMLAttributes:b,HTMLPropsForInnerElement:{className:"office-form-theme-primary-color"},MediaLayout:n,SubTitle:Object(g.c)((function(){return S}),(function(){return t.isFieldReady(O.FormsProRTSubtitle)&&r.FormsProRTSubtitle?r.FormsProRTSubtitle:S})),Title:Object(g.c)((function(){return v}),(function(){return t.isFieldReady(O.FormsProRTQuestionTitle)&&r.FormsProRTQuestionTitle?r.FormsProRTQuestionTitle:v}))},e,this.createCoAuthorContainer())},t.prototype.setSectionResourceMaster=function(e){var t=e.Master,r=t.Form,n=e.LocaleId;this.sectionResourceMaster=n?h.a.getQuestionResourceMaster(n,t.Model.Id,r):void 0},t.prototype.createCoAuthorContainer=function(){var e=this,t=this.props.Master.Model.CoAuthors;if(t&&t.length>0&&t[t.length-1].userId!==OfficeFormServerInfo.userInfo.UserId)return o.createElement("div",{className:"question-coAuthor-notification-container-design-mode",key:"coAuthor"},i.map(t,(function(t){return e.createAuthorFacePile(t)})))},t.prototype.createAuthorFacePile=function(e){if(e.userId!==OfficeFormServerInfo.userInfo.UserId){var t=this.props.LocalizedStrings.DesignPage_NavBar_CoAuthor_Section_Screen_Reader.format(e.displayName||e.userId,this.props.Ordinal);return o.createElement(b.a,{ariaLabel:t,displayText:Object(v.a)(e.displayName,e.firstName,e.lastName),email:e.email,key:e.userId,name:e.displayName,tooltip:e.displayName||e.userId})}},t.prototype.calcImageLayout=function(e){return this.props.IsMobile||c.B()||e.Layout===m.a.Horizontal&&e.Size===m.c.Large?{ImageLayout:"Bottom"}:{Height:e.ContainerHeight||a.a.ImagePlaceHolderHeight,ImageLayout:"Right",Width:e.ContainerWidth||a.a.ImagePlaceHolderWidth}},t}(S.a)},,function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n,o=r(0),i=r(3),a=r(2),s=r(5),c=r(7),u=r(101),l=r(164),d=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function f(e){return o.createElement(p,e)}var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ariaLabelId=i.uniqueId("ratingAccessibilityLabel."),t}return d(t,e),t.prototype.createReactNodes=function(){var e,t=this.props;if(!(null!=t.Value&&""!==t.Value)&&t.ToRenderIfNoRatingAlreadyGiven)return[t.ToRenderIfNoRatingAlreadyGiven];var r=t.MinRating;return null==r&&(r=1),e=t.ShowRatingLabel?Object(l.b)(l.a.Number,null,t.LeftDescription,t.RightDescription,r.toString(),t.Length.toString(),this.createRatingTable(),t.Length,10,null,Object(c.e)((function(){return t.FormsProRTLeftDescription})),Object(c.e)((function(){return t.FormsProRTRightDescription}))):[o.createElement("div",{className:"office-form-question-rating-container"},this.createRatingTable())],t.ShouldAccessibleTextReadSelectedValue?[o.createElement("div",{"aria-labelledby":this.ariaLabelId},o.createElement("div",{id:this.ariaLabelId,className:"screenReaderVisible"},a.a.LocalizedStrings.GradingView_RatingAnswer_LabelFormat.format(this.getSelectedValue(),t.Length)),o.createElement("div",{"aria-hidden":"true",role:"presentation"},e))]:e},t.prototype.createRatingTable=function(){var e=this,t=this.props.MinRating;null==t&&(t=1);var r=i.range(t,this.props.Length+1),n=this.getSelectedValue(),a=s.a.combineAttributes("office-form-question-rating-body","Center"===this.props.Layout?"justifyContentSpaceBetween":"");return o.createElement("div",{className:a},r.map((function(t){var i=n===t;return o.createElement("div",{className:"office-form-question-rating-item",key:t},o.createElement("label",{htmlFor:e.getRatingInputId(t)},t),o.createElement("input",{id:e.getRatingInputId(t),"aria-checked":i,"aria-label":""+t,"aria-posinset":t,"aria-setsize":r.length,type:"radio",disabled:e.props.Disabled,checked:i,onClick:function(){return e.props.onValueChange(t)}}))})))},t.prototype.getRatingInputId=function(e){return this.ariaLabelId+"-number-rating-"+e},t.prototype.getSelectedValue=function(){return parseInt(this.props.Value)},t}(u.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(213),o=r(200);function i(e){var t=FormsPro.proOnly((function(){return!0}))?new n.a:new o.a;return t.formRuntimeMaster=e,t}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(2),o=function(){function e(){}return e.getBracketPointText=function(e){var t=n.a.LocalizedStrings.Quiz_Points_BracketsText_Singular,r=n.a.LocalizedStrings.Quiz_Points_BracketsText_Plural;return(1===e?t:r).format(e)},e}()},,function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n,o=r(0),i=r(2),a=r(147),s=r(12),c=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.prototype.render=function(){var e={ButtonsProps:[{ClassName:"upload-question-cancel-continue-button",ConveyDescription:!0,GlyphButtonStyle:"Horizontal",Key:"deleteItem",onClick:this.props.clickContinueButton,Text:i.a.LocalizedStrings.UploadFile_Dialog_Continue_Button,Title:i.a.LocalizedStrings.UploadFile_Dialog_Continue_Text}],ClassName:"upload-question-button-container",Description:this.props.description,IconClassName:"forms-icon-size36x36 upload-question-icon-class",IconName:"FabricFolder",ShowDialog:!0};return o.createElement("div",{className:"upload-question-confirm-dialog"},Object(a.b)(e))},t}(s.a)},,,,function(e,t,r){"use strict";r.d(t,"b",(function(){return d})),r.d(t,"a",(function(){return f}));var n=r(6),o=r(84),i=r(11),a=r(35),s=r(27),c=r(5),u=r(28),l=r(65);function d(){return-1!==window.location.hash.indexOf("state="+p)&&(window.parent&&window.parent.formDetectUserLoggedInAADCallback&&window.parent.formDetectUserLoggedInAADCallback(function(e){var t=!1,r=c.a.getQueries(e.substring(1).trim());r.state&&a.a.DefaultStorage.getItem(m)===r.state&&(t=!0);return!t||-1!==e.indexOf("error_description=")}(window.location.hash)),!0)}function f(){if(!l.a.isSupported())return $.Deferred().reject();var e=$.Deferred(),t=!l.a.DetectAADInProgress;t&&function(){l.a.DetectAADInProgress=!0,l.a.DetectAADResult=!1;var e=function(){var e=p;Object(n.a)().Flighting.isEnabled("CookieAuth")&&(e+="cookieAuth.");return e+s.a.newGuid()}(),t={client_id:i.a.getAadClientId(),msafed:0,prompt:"none",redirect_uri:window.location.origin,resource:i.a.getFormsResourceId(),response_mode:"form_post",response_type:"token",state:e};a.a.DefaultStorage.setItem(m,e);var r=new o.a("Auth.DetectUserLoggedInAAD");r.start(),window.formDetectUserLoggedInAADCallback=function(e){r.end({resultType:e?"ExpectedFailure":"Success"}),l.a.DetectAADInProgress=!1,l.a.DetectAADResult=!e};var c=i.a.getAadInstance()+"common/oauth2/authorize?"+jQuery.param(t);$("body").append('<iframe id="detectAADAuthFrame" style="display:none;" src='+c+"><iframe>")}();var r=window.setInterval((function(){if(!l.a.DetectAADInProgress)if(window.clearInterval(r),l.a.DetectAADResult)if(t)e.resolve();else{setTimeout(u.d,2e3)}else e.reject()}),100);return e.promise()}var p="form.detectUserLoggedInAAD.",m="officeforms.auth.state"},function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n,o=r(0),i=r(21),a=r(13),s=r(12),c=r(199),u=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),l=function(){return(l=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.render=function(){var e;return e=this.props.ShowVideoUrl?o.createElement(c.a,{InDesignMode:this.props.InDesignMode,IsMobile:this.props.IsMobile,LocalizedStrings:this.props.LocalizedStrings,VideoUrl:this.props.Url}):o.createElement("iframe",{allowFullScreen:!0,className:this.props.ClassNameForIFrame,frameBorder:"0",height:t.calcVideoDisplayHeight(),sandbox:"allow-scripts allow-same-origin allow-popups allow-forms",src:this.props.Url,width:"100%"}),o.createElement("div",l({},this.props.HTMLAttributes),e,this.props.children)},t.calcVideoDisplayHeight=function(){if(a.t()){var e=$(window).width();return 0===e&&(e=document.body.scrollWidth),9*e/16}return i.a.DefaultVideoHeight},t}(s.a)},,,function(e,t){var r,n,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(e){r=i}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var c,u=[],l=!1,d=-1;function f(){l&&c&&(l=!1,c.length?u=c.concat(u):d=-1,u.length&&p())}function p(){if(!l){var e=s(f);l=!0;for(var t=u.length;t;){for(c=u,u=[];++d<t;)c&&c[d].run();d=-1,t=u.length}c=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function h(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new m(e,t)),1!==u.length||l||s(p)},m.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=h,o.addListener=h,o.once=h,o.off=h,o.removeListener=h,o.removeAllListeners=h,o.emit=h,o.prependListener=h,o.prependOnceListener=h,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n,o=r(205),i=r(88),a=r(94),s=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.createReactNodes=function(){var e,t=this,r=this.props.Master.Model;return this.isValueInvalid&&(e=Object(i.a)({Alert:!0,HTMLAttributes:{className:"validation-error-message-label",role:"alert"},key:"error",Label:this.props.LocalizedStrings.DateValidation_ErrorMessage.format(OfficeFormServerInfo.cultureInfo.DateTimeFormat.ShortDatePattern)})),[Object(o.b)({DateTitle:this.props.LocalizedStrings.QuestionType_DatePicker_DateTitle,Disabled:this.props.Disabled,IsLocaleInvariant:!0,key:"dateTime",onValueChange:function(e){r.Answer=e},onValueValidation:function(e){t.isValueInvalid=!e,t.forceUpdate()},Options:{classNameForInnerDiv:"office-form-textfield",HTMLPropsForInnerElement:this.getElementProps({className:"office-form-question-textbox"})},Placeholder:this.props.LocalizedStrings.QuestionType_DateTime_PlaceHolder.format(OfficeFormServerInfo.cultureInfo.DateTimeFormat.ShortDatePattern),ShowClearButton:!0,Theme:this.props.Theme,Type:o.a.DatePicker,ValidationStyle:this.getValidationStyle(),Value:r.Answer}),e]},t}(a.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n,o=r(4),i=r(1),a=r(21),s=r(206),c=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),u={hasFile:i.a.boolean(),uploadSessions:i.a.collectionOf({bytesToSend:i.a.number(),fileName:i.a.string(),fileSize:i.a.number(),key:i.a.string(),uploadState:i.a.reference(),uploadUrl:i.a.string()},{IsLocalField:!0})},l=function(e){function t(t){var r=e.call(this)||this;return r.fileUploadProcessProvider=new s.a(t),r}return c(t,e),t.prototype.uploadFile=function(e,t,r,n,o){var i=this;return this.fileUploadProcessProvider.createFileUploadSession(n,t).then((function(t){return i.uploadFileInternal(e,o,t)}))},t.prototype.cancelOrDeleteUploadFile=function(e){return this.fileUploadProcessProvider.cancelOrDeleteUploadFile(e)},t.prototype.uploadBytesToSession=function(e,t,r,n){var o=this;void 0===n&&(n=0);if(t&&"rejected"!==t.uploadState)if(n>=2)this.fileUploadProcessProvider.cancelOrDeleteUploadFile(t.uploadUrl);else{var i=function(e,t){var r=t.bytesToSend?t.bytesToSend:0,n=a.a.FileUploadMaxChunkBytes,o=e.size-t.bytesToSend;o>n&&(o=n);return{chunkSize:o,finalByteIndex:r+o-1,initialByteIndex:r}}(e,t),s=new FileReader;s.onerror=function(){o.fileUploadProcessProvider.cancelOrDeleteUploadFile(t.uploadUrl)},s.onload=function(){o.uploadReadBytesToSession(s.result,e,t,n,i,r)};var c=e.slice(i.initialByteIndex,i.finalByteIndex+1);s.readAsArrayBuffer(c)}},t.prototype.uploadReadBytesToSession=function(e,t,r,n,o,i){var a=this;return this.fileUploadProcessProvider.uploadBytesToSession(r,e,o.chunkSize,o.initialByteIndex,o.finalByteIndex,t.size).done((function(){o.finalByteIndex<t.size-1?(r.bytesToSend=o.finalByteIndex+1,a.uploadBytesToSession(t,r,i)):("rejected"!==r.uploadState&&(r.uploadState="success"),i.resolve(r.uploadUrl))})).fail((function(e){a.uploadBytesToSession(t,r,i,n+1)}))},t.prototype.uploadFileInternal=function(e,t,r){var n=$.Deferred();if(t.uploadUrl=r,"rejected"!==t.uploadState)return this.uploadBytesToSession(e,t,n),n.promise();n.resolve(r)},t}(o.a.createObjectMasterClass("UploadFileProcessMaster",u))},function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n,o=r(0),i=r(3),a=r(4),s=r(13),c=r(58),u=r(251),l=r(94),d=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),f=function(){return(f=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},p=function(e){function t(t){var r=e.call(this,t)||this;return r.state={IsSubQuestionsExpanded:[!t.Disabled]},r}return d(t,e),t.prototype.componentWillMount=function(){var t=this;e.prototype.componentWillMount.call(this);var r=this.props.Master;this.onSubQuestionListChangeCallback=function(e){return t.onSubQuestionListChange(e)},a.a.getCollectionMasterFromModel(r.Question.Form.Model.Questions).observe(this.onSubQuestionListChangeCallback),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.update,[c.a.Schema.choices])},t.prototype.componentWillUnmount=function(){a.a.getCollectionMasterFromModel(this.props.Master.Question.Form.Model.Questions).unobserve(this.onSubQuestionListChangeCallback),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.update),e.prototype.componentWillUnmount.call(this)},t.prototype.createReactNodes=function(){var e,t=this.createSubQuestionsLayout();if(this.showPadView()){var r=this.getElementProps({className:"office-form-mobile-matrix-container",key:"Likert",role:"list"});e=o.createElement("div",f({},r),t)}else{var n=this.createHeaderLine();e=o.createElement("div",{className:"office-form-matrix-table",key:"Likert"},o.createElement("table",f({},this.getElementProps(),{role:"group"}),n,o.createElement("tbody",{className:"office-form-matrix-stbody"},t)))}return[e]},t.prototype.onSubQuestionListChange=function(e){var t=this.props.Master;e.AddedModels.concat(a.a.convertToArray(e.RemovedModels)).map(a.a.getObjectMasterFromModel).some((function(e){return e.Model.GroupId===t.Question.Model.Id}))&&this.forceUpdate()},t.prototype.createHeaderLine=function(){var e,t=this,r=this.props.Master.Question.Model,n=this.questionLocalizedItemMaster,a=o.createElement("td",{className:"office-form-matrix-ptd",key:"emptyTd"}),s={className:"office-form-matrix-ptd",width:"width:calc((100% - 180px)/"+r.ChoiceGroup.length+")"},c=r.ChoiceGroup;return e=i.map(c,(function(e,r){var a;n&&n.Model.choices.length&&(a=i.find(n.Model.choices,(function(t){return t.choiceId===e.Id.toString()})));var c=a&&a.description||e.Description;return o.createElement("td",f({},s,{key:r,id:t.getLabelId(r)}),o.createElement("span",null,c))})),o.createElement("thead",{className:"office-form-matrix-pthead"},o.createElement("tr",{className:"office-form-matrix-ptr"},a,e))},t.prototype.createSubQuestionsLayout=function(){var e,t,r=this,n=this.props.Master,a=n.Question.Model.ChoiceGroup,s=n.SubQuestions,c=this.showPadView(),l=this.questionLocalizedItemMaster;if(l){var d=l.Model;e=d.localeId,t=d.choices}return i.map(s,(function(i,s){var l={Choices:a,Disabled:r.props.Disabled,IsExpanded:r.state.IsSubQuestionsExpanded[s],LocaleId:e||"",LocalizedChoices:t,onChange:function(e,t){return r.questionExpandedChange(e,t)},PadView:!!c,QuestionIndex:s,QuestionMasterClass:i,QuestionOrdinal:r.getQuestionId(),QuestionRuntimeMasterClass:n.getSubQuestionRuntimeById(i.Model.Id),ShowDesignInfo:!!r.props.ShowDesignInfo};return o.createElement(u.a,f({},l,{key:i.getInstanceId()}))}))},t.prototype.showPadView=function(){return this.props.IsMobile||!this.props.ShowDesignInfo&&s.B()},t.prototype.questionExpandedChange=function(e,t){var r=[];e<this.props.Master.SubQuestions.length&&(r[e]=t),this.setState({IsSubQuestionsExpanded:r})},t.prototype.getLabelId=function(e){return this.getQuestionId()+"-col-"+(e+1)},t}(l.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var n,o=r(0),i=r(3),a=r(5),s=r(10),c=r(61),u=r(58),l=r(91),d=r(7),f=r(22),p=r(12),m=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),h=function(){return(h=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},g=function(e){function t(t){var r=e.call(this,t)||this;return r.rootRef=o.createRef(),r.onQuestionChangeCallback=function(){return r.forceUpdate()},r.state={FocusedIndex:-1},r.expandWhenFocus=r.expandWhenFocus.bind(r),r.onValueChange=r.onValueChange.bind(r),r.lostFocus=r.lostFocus.bind(r),r.isHidden=!1,r}return m(t,e),t.prototype.componentWillMount=function(){var e=this;this.props.Disabled||Object(d.c)((function(){e.props.QuestionRuntimeMasterClass.observe(e.onQuestionChangeCallback,[l.a.Schema.Answer])}),(function(){e.props.QuestionRuntimeMasterClass&&e.props.QuestionRuntimeMasterClass.observe(e.onQuestionChangeCallback,[l.a.Schema.Answer,l.a.Schema.Visible])})),this.props.QuestionMasterClass.observe(this.onQuestionChangeCallback,[s.d.Schema.Title]),this.props.LocaleId&&this.updateQuestionLocalizedItemMaster(this.props.LocaleId,this.props.QuestionMasterClass.Model.Id,this.props.QuestionMasterClass.Form),Object(d.e)((function(){null!=e.props.QuestionRuntimeMasterClass&&e.props.QuestionRuntimeMasterClass.observe(e.onQuestionChangeCallback,[l.a.Schema.Visible])}))},t.prototype.componentWillReceiveProps=function(e){this.updateQuestionLocalizedItemMaster(e.LocaleId,e.QuestionMasterClass.Model.Id,e.QuestionMasterClass.Form)},t.prototype.componentWillUnmount=function(){this.props.QuestionRuntimeMasterClass&&this.props.QuestionRuntimeMasterClass.unobserve(this.onQuestionChangeCallback),this.props.QuestionMasterClass.unobserve(this.onQuestionChangeCallback),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.onQuestionChangeCallback)},t.prototype.render=function(){var e=this;Object(d.e)((function(){null==e.props.QuestionRuntimeMasterClass||null==e.props.QuestionRuntimeMasterClass.Model.Visible?e.isHidden=!1:e.isHidden=!e.props.QuestionRuntimeMasterClass.Model.Visible}));var t=this.props.QuestionMasterClass,r=this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.Model.title||t.Model.Title;return this.props.PadView?o.createElement("div",{className:"office-form-mobile-matrix-points",onBlur:this.lostFocus,onFocus:this.expandWhenFocus,ref:this.rootRef},this.createMobileQuestionRow(r)):o.createElement("tr",{className:"office-form-matrix-str",role:"radiogroup",hidden:this.isHidden},this.createQuestionRow(r))},t.prototype.updateQuestionLocalizedItemMaster=function(e,t,r){this.questionLocalizedItemMaster&&(this.props.QuestionMasterClass.unobserve(this.onQuestionChangeCallback),this.questionLocalizedItemMaster=void 0),e&&(this.questionLocalizedItemMaster=c.a.getQuestionResourceMaster(e,t,r),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.onQuestionChangeCallback,[u.a.Schema.title]))},t.prototype.expandWhenFocus=function(e){this.props.IsExpanded||this.props.onChange(this.props.QuestionIndex,!0);var t=e.target;this.setState({FocusedIndex:parseInt(t.value,10)})},t.prototype.lostFocus=function(e){var t=e.relatedTarget,r=this.rootRef.current;r&&!r.contains(t)&&this.setState({FocusedIndex:-1})},t.prototype.createQuestionRow=function(e){var t=this,r=[];Object(d.e)((function(){var r=t.props.QuestionMasterClass;e=t.questionLocalizedItemMaster&&t.questionLocalizedItemMaster.Model.formsprortlocaletitle||(r.Model.FormsProRTQuestionTitle?r.Model.FormsProRTQuestionTitle:e),e=d.a.sanitizeRichTextHTML(e)}));var n=o.createElement("span",{className:"office-form-matrix-subquestion",id:this.getSubLabelId(this.props.QuestionIndex)},Object(d.c)((function(){return e}),(function(){return o.createElement(d.a.RichtTextControl,{HTMLContent:e})}))),a=o.createElement("td",{className:"office-form-matrix-std",key:"subQuestionTitle"},n);r.push(a);var s=i.map(this.props.Choices,(function(e,r){var n=!1;if(!t.props.ShowDesignInfo){var o=t.props.QuestionRuntimeMasterClass&&t.props.QuestionRuntimeMasterClass.Model.Answer;n=o&&i.isEqual(o.id,e.Id)}return t.createMatrixRadio(t.props.QuestionMasterClass.Model.Id,r,!!n)}));return r=r.concat(s)},t.prototype.createMatrixRadio=function(e,r,n){var s=this.props,c=s.Disabled,u=s.Choices,l=s.PadView,d="subquestion-radio-"+e,f=this.getLabelId(r),p=o.createElement("input",{"aria-checked":n,"aria-labelledby":f+" "+this.getSubLabelId(this.props.QuestionIndex),"aria-posinset":r+1,"aria-setsize":u.length,checked:n,disabled:c,name:d,onChange:c?void 0:this.onValueChange,type:"radio",value:r,role:"button"});if(l){var m=this.props.LocalizedChoices,h=u[r],g=void 0;m&&m.length&&(g=i.find(m,(function(e){return e.choiceId===h.Id.toString()})));var y=g&&g.description||h.Description,b=a.a.combineAttributes("office-form-question-matrix-choice","office-form-theme-page-background-active",n?"active":""),v=a.a.combineAttributes("radio-icon "+(this.state.FocusedIndex===r?"focused":""),"ms-Icon ms-Icon--"+(n?"RadioBtnOn":"RadioBtnOff"),c?"disabled":"");return o.createElement("li",{key:r,className:b,role:"listitem"},o.createElement("label",{className:"office-form-question-matrix-choice-row"},p,o.createElement("i",{className:v,"aria-hidden":"true"}),o.createElement("span",{className:"office-form-question-matrix-choice-text",id:f},y)))}return o.createElement("td",{className:"office-form-matrix-radio",key:r,onClick:t.enlargeClickArea},o.createElement("label",{className:"office-form-matrix-label"},p))},t.enlargeClickArea=function(e){var t=e.target;t===e.currentTarget&&t.firstChild.click()},t.prototype.getLabelId=function(e){return this.props.QuestionOrdinal+"-col-"+(e+1)},t.prototype.createMobileQuestionRow=function(e){var t=this,r=this.props,n=r.QuestionMasterClass,a=r.Choices,s=r.QuestionRuntimeMasterClass,c=r.QuestionIndex,u=-1,l=i.map(a,(function(e,r){var o=!1;if(!t.props.ShowDesignInfo){var a=s&&s.Model.Answer;o=a&&i.isEqual(a.id,e.Id)}return o&&(u=r),t.createMatrixRadio(n.Model.Id,r,o)})),d=o.createElement("ul",{className:"office-form-mobile-matrix-choices",key:"choicelist",role:"radiogroup"},l),f=-1!==u?a[u].Description:"";return[this.createQuestionTitle(e,f,c),d]},t.prototype.getSubLabelId=function(e){return this.props.QuestionOrdinal+"-row-"+(e+1)},t.prototype.createQuestionTitle=function(e,t,r){var n=this,i={className:"office-form-mobile-matrix-title",id:this.getSubLabelId(r),key:"subquestion-title",onClick:this.props.PadView?function(){return n.props.onChange(r,!n.props.IsExpanded)}:void 0,ref:function(e){if(e){var t=e.parentElement,r=e.offsetHeight;n.props.IsExpanded&&(r+=e.nextElementSibling.offsetHeight),t&&(t.style.height=r+"px")}}};return o.createElement("div",h({},i),o.createElement("div",{className:"office-form-mobile-matrix-title-header"},o.createElement("span",null,e),o.createElement(f.a,{HTMLAttributes:{className:"select-dropdown-arrow forms-icon-size20x20"},IconName:this.props.IsExpanded?"ChevronUp":"ChevronDown"})),o.createElement("div",{className:"office-form-mobile-matrix-answered-indicator"},o.createElement("span",null,t)))},t.prototype.onValueChange=function(e){var t=this.props.QuestionRuntimeMasterClass,r=e.currentTarget,n=r.checked?{id:this.props.Choices[parseInt(r.value,10)].Id}:void 0;t&&(this.props.PadView&&this.props.onChange(this.props.QuestionIndex+1,!0),t.Model.Answer=n)},t}(p.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n,o=r(0),i=r(58),a=r(7),s=r(179),c=r(94),u=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),l=function(e){function t(t){var r=e.call(this,t)||this;return r.onValueChangeCallback=function(e){return r.props.Master.Model.Answer=e},r}return u(t,e),t.prototype.componentWillMount=function(){var t=this;e.prototype.componentWillMount.call(this),this.questionLocalizedItemMaster&&(this.questionLocalizedItemMaster.observe(this.update,[i.a.Schema.leftDescription,i.a.Schema.rightDescription]),Object(a.e)((function(){t.questionLocalizedItemMaster.observe(t.update,[i.a.Schema.formsprortlocaleldescription,i.a.Schema.formsprortlocalerdescription])})))},t.prototype.componentWillUnmount=function(){this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.update),e.prototype.componentWillUnmount.call(this)},t.prototype.createReactNodes=function(){var e=this.props.Master.Question.Model,t=this.props.Master.Model,r=this.questionLocalizedItemMaster,n=r&&r.Model,i=n&&n.leftDescription||e.LeftDescription,c=n&&n.rightDescription||e.RightDescription;return Object(a.e)((function(){i=n&&n.formsprortlocaleldescription||(e.FormsProRTLeftDescription?e.FormsProRTLeftDescription:i),c=n&&n.formsprortlocalerdescription||(e.FormsProRTRightDescription?e.FormsProRTRightDescription:c)})),[o.createElement("div",{key:"nps",className:"office-form-question-nps-container"},o.createElement(s.a,{ClassNameForInnerLabel:"office-form-theme-button-foreground",Disabled:this.props.Disabled,HTMLAttributes:this.getElementProps(),LeftLabel:i,RightLabel:c,onValueChange:this.onValueChangeCallback,Value:t.Answer}))]},t}(c.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n,o,i=r(0),a=r(3),s=r(4),c=r(85),u=r(25),l=r(5),d=r(10),f=r(58),p=r(9),m=r(62),h=r(22),g=r(94),y=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),b=function(){return(b=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};!function(e){e[e.Up=0]="Up",e[e.Down=1]="Down"}(o||(o={}));var v=function(e){function t(t){var r=e.call(this,t)||this;return r.selectedClass="office-form-theme-sort-item office-form-selected-item",r.focusStatus=-1,r.selectedIndex=-1,r.rankingRef=i.createRef(),r.isDragging=!1,r.sortableInitialized=!1,r.mounted=!1,r.updateChoicesInternally(),r.rankUp=r.rankUp.bind(r),r.rankDown=r.rankDown.bind(r),r.focusOnSortItem=r.focusOnSortItem.bind(r),r.blurOnSortItem=r.blurOnSortItem.bind(r),r.onKeyDown=r.onKeyDown.bind(r),r.decorateSortableGroup=r.decorateSortableGroup.bind(r),r.onDragStart=r.onDragStart.bind(r),r.onDragEnd=r.onDragEnd.bind(r),r}return y(t,e),t.prototype.componentWillMount=function(){var t=this;e.prototype.componentWillMount.call(this),this.mounted=!0,Object(c.a)("Sortable").done((function(){t.mounted&&t.setState({SortableLoaded:!0})})),this.choicesUpdate=function(){t.updateChoicesInternally(),t.forceUpdate()},this.props.Master.Question.observe(this.choicesUpdate,[d.d.Schema.ChoiceGroup]),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.choicesUpdate,[f.a.Schema.choices])},t.prototype.componentWillUnmount=function(){this.mounted=!1,this.sortable&&(this.sortable.destroy(),this.sortable=void 0),e.prototype.componentWillUnmount.call(this),this.props.Master.Question.unobserve(this.choicesUpdate),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.choicesUpdate)},t.prototype.componentWillReceiveProps=function(t){e.prototype.componentWillReceiveProps.call(this,t),t.ShowQuizResult&&this.updateChoicesInternally(),(t.ShowDesignInfo||t.Disabled)&&this.sortable&&(this.sortable.destroy(),this.sortable=void 0)},t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this);var t=this.rankingRef.current;!this.props.ShowDesignInfo&&!this.props.Disabled&&this.state.SortableLoaded&&t&&this.decorateSortableGroup(t)},t.prototype.componentDidUpdate=function(e,t){if(this.choices&&this.choices.length>0&&-1!==this.focusStatus&&this.updateFocusStatus(),!this.props.ShowDesignInfo&&!this.props.Disabled&&this.state.SortableLoaded&&!this.sortable){var r=this.rankingRef.current;r&&this.decorateSortableGroup(r)}},t.prototype.createReactNodes=function(){var e=this.createSortableList(),t=this.createCorrectAnswerList(),r=this.props.IsMobile?"office-form-mobile-sort-list":"office-form-sort-list",n=this.getElementProps({className:r,onKeyDown:this.onKeyDown,ref:this.rankingRef,role:"listbox"});return[i.createElement("div",b({},n,{key:"Ranking"}),e),t]},t.prototype.getFormattedDataForImmersiveReader=function(){var t=e.prototype.getFormattedDataForImmersiveReader.call(this),r=null,n=document.createElement("ul");return a.forEach(this.choices,(function(e){var t=document.createElement("li"),o=null;if(e.IsMathOption&&"undefined"!=typeof MathJax){r=r||MathJax.Hub.getAllJax(null);var i=a.find(r,(function(t){return t.originalText===e.Description}));if(i){var s=i.root&&i.root.toMathML&&i.root.toMathML();s&&(s=s.replace(/\n\s*/g,""),o="\x3c!--[if mathML]&#62;"+l.a.encodeHTML(s,!0)+"&#60;![endif]--\x3e")}}t.innerHTML=o||l.a.encodeHTML(e.Description,!0),n.appendChild(t)})),n.appendChild(document.createElement("br")),t.splice(t.length-1,0,{content:n.outerHTML,mimeType:"text/html"}),t},t.prototype.decorateSortableGroup=function(e){var t={animation:150,chosenClass:"office-form-sortable-chosen",delay:this.props.IsMobile?150:0,fallbackClass:"office-form-sortable-fallback",filter:".office-form-ranking-arrow",forceFallback:!0,ghostClass:"office-form-sortable-ghost",handle:".office-form-sort-item",onEnd:this.onDragEnd,onStart:this.onDragStart,preventOnFilter:!1};try{this.sortable=Sortable.create(e,t),this.sortableInitialized||Object(p.a)({eventName:"DesignPage.Questions.SortableInitialization",eventType:"engagement_event",extraData:{Successful:!0}}),this.sortableInitialized=!0}catch(e){Object(p.a)({eventName:"DesignPage.Questions.SortableInitialization",eventType:"engagement_event",extraData:{Successful:!1}}),this.sortableInitialized=!1}},t.prototype.onDragStart=function(e){if(this.isDragging=!0,-1!==this.selectedIndex&&this.selectedIndex!==e.oldIndex){var t=this.rankingRef.current;if(t){var r=t.children[this.selectedIndex];r&&$(r.firstElementChild).removeClass(this.selectedClass)}}},t.prototype.onDragEnd=function(e){var t=e.oldIndex,r=e.newIndex,n=this.props.Master.Model.Answer;if(this.isDragging=!1,n&&t===r)e.item.firstChild.focus();else{var o=this.rankingRef.current;t<r?$(o).find(".office-form-sort-item-container:eq("+t+")").before($(e.item)):t>r&&$(o).find(".office-form-sort-item-container:eq("+t+")").after($(e.item)),this.focusStatus=0,this.moveElement(t,r)}},t.prototype.createSortableList=function(){var e=this,t=this.props.Master.Model.Answer,r=this.shouldShowJudgeIcon(),n=t&&t.length>0;return a.map(this.choices,(function(t,o){return e.createRankItem(t,o,r,n)}))},t.prototype.createRankItem=function(e,r,n,o){var s,c,u=this.questionLocalizedItemMaster;if(u){var d=a.find(u.Model.choices,(function(t){return t.choiceId===e.Id+""}));s=d&&d.description||""}if(s=s||e.Description,o&&n){var f=this.props.Master.Model.QuizResult,p=JSON.parse(f.GradingBasis),g=e.Key===p[r];c=i.createElement("span",{className:"office-form-sort-item-icon"},t.getAnswerKeyMark(g))}!this.props.Disabled&&this.props.IsMobile&&(c=t.createDragHandleIcon());var y,v=i.createElement("div",{className:"office-form-sort-item-indicator"},c,i.createElement("span",{className:"office-form-sort-item-ordinal office-form-theme-secondary-color"},o?r+1:void 0)),S=this.getQuestionId()+"-"+r,I={"aria-posinset":r+1,"aria-setsize":this.choices.length,className:"office-form-sort-item",disabled:this.props.Disabled,id:S,role:"option",tabIndex:this.props.Disabled?void 0:0};if(!this.props.Disabled){var M={disabled:!0,tabIndex:-1},F=0===r,O={"aria-describedby":S,"aria-label":this.props.LocalizedStrings.QuestionType_Ranking_ArrowUp_Narrator,className:l.a.combineAttributes("office-form-ranking-arrow",F?"office-sort-disabled-arrow":"office-form-active-arrow"),onClick:F?void 0:this.rankUp,title:this.props.LocalizedStrings.QuestionType_Ranking_ArrowUp_Narrator};O=F?l.a.mergeReactProps(O,M):O;var C={ButtonStyle:"LightBackground",children:Object(h.b)({HTMLAttributes:{className:"forms-icon-size18x18"},IconName:"Up"}),HTMLAttributes:O,key:"form-up-arrow"+r},P=i.createElement(m.a,b({},C)),T=r===this.choices.length-1,w={"aria-describedby":S,"aria-label":this.props.LocalizedStrings.QuestionType_Ranking_ArrowDown_Narrator,className:l.a.combineAttributes("office-form-ranking-arrow",T?"office-sort-disabled-arrow":"office-form-active-arrow"),onClick:T?void 0:this.rankDown,title:this.props.LocalizedStrings.QuestionType_Ranking_ArrowDown_Narrator};w=T?l.a.mergeReactProps(w,M):w;var _={ButtonStyle:"LightBackground",children:Object(h.b)({HTMLAttributes:{className:"forms-icon-size18x18"},IconName:"Down"}),HTMLAttributes:w,key:"form-down-arrow"+r},E=i.createElement(m.a,b({},_));I=l.a.mergeReactProps(I,{onBlur:this.blurOnSortItem,onFocus:this.focusOnSortItem}),y=i.createElement("div",{className:"office-form-sort-list-arrows"},P,E)}var R=i.createElement("div",b({},I),v,i.createElement("p",{className:"office-form-sort-item-content"},s),y);return i.createElement("div",{className:"office-form-sort-item-container office-form-unselectable",key:e.Key},R)},t.prototype.focusOnSortItem=function(e){if(!this.isDragging){var t=e.currentTarget;$(t).addClass(this.selectedClass);var r=this.rankingRef.current;if(r){var n=r.children,o=t.parentElement;this.selectedIndex=a.findIndex(n,(function(e){return o===e}))}}},t.prototype.blurOnSortItem=function(e){var t=e.currentTarget,r=l.a.getTargetElementOfFocusEvent(e);this.isDragging||t&&r&&t.contains(r)||($(t).removeClass(this.selectedClass),this.selectedIndex=-1)},t.prototype.rankUp=function(){this.resortItems(o.Up)},t.prototype.rankDown=function(){this.resortItems(o.Down)},t.prototype.resortItems=function(e){var t,r=this.selectedIndex;e===o.Up?(this.focusStatus=1,t=r-1):(this.focusStatus=2,t=r+1),this.moveElement(r,t)},t.getAnswerKeyMark=function(e){return Object(h.b)({HTMLAttributes:{className:l.a.combineAttributes("office-form-judge-icon forms-icon-size16x16",e?"office-form-right-answerkey":"office-form-wrong-answerkey")},IconName:e?"CheckMark":"Cancel"})},t.stringifyAnswer=function(e){return a.map(e,(function(e,t){return{answerOrder:t,id:e.Id}}))},t.createDragHandleIcon=function(){return i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},i.createElement("circle",{cx:"9.5",cy:"6.5",r:"1.5",fill:"currentColor"}),i.createElement("circle",{cx:"14.5",cy:"6.5",r:"1.5",fill:"currentColor"}),i.createElement("circle",{cx:"9.5",cy:"12.5",r:"1.5",fill:"currentColor"}),i.createElement("circle",{cx:"14.5",cy:"12.5",r:"1.5",fill:"currentColor"}),i.createElement("circle",{cx:"9.5",cy:"18.5",r:"1.5",fill:"currentColor"}),i.createElement("circle",{cx:"14.5",cy:"18.5",r:"1.5",fill:"currentColor"}))},t.prototype.shouldShowJudgeIcon=function(){var e=this.props.Master.Question.Model,t=this.props.Master.Model.QuizResult;return!(!this.props.ShowQuizResult||!e.IsQuiz)&&!!t},t.prototype.createCorrectAnswerList=function(){var e=this.props.Master.Model.QuizResult;if(!this.shouldHideCorrectAnswerList()){var t=this.props.Master.Question.Model.ChoiceGroup,r=JSON.parse(e.GradingBasis).map((function(e){return a.findWhere(t,{Key:e})})).filter((function(e){return!!e})).map((function(e){return e&&e.Description})).join(this.props.LocalizedStrings.VariousLocations_ItemList_Separator),n=l.a.combineAttributes("office-form-right-answerkey","various-short-text-correct-answer-list-correctness-icon","forms-icon-size14x14"),o=Object(h.b)({HTMLAttributes:{"aria-hidden":!0,className:n,role:"presentation"},IconName:"CheckMark"});return i.createElement("div",{className:"various-short-text-correct-answer-list",key:"correctAnswerList"},o,i.createElement("b",null,this.props.LocalizedStrings.VariousLocations_CorrectAnswerList_Label," "),r)}},t.prototype.shouldHideCorrectAnswerList=function(){var e=this.props.Master.Question.Model,t=this.props.Master.Model.QuizResult;return!(!this.props.ShowDesignInfo&&e.IsQuiz)||!(t&&!t.IsAnswerCorrect)},t.prototype.onKeyDown=function(e){var t=this.rankingRef.current;if(-1!==this.selectedIndex&&t){var r=t.children,n=r.length,o=this.selectedIndex+n,i=void 0;switch(e.keyCode){case u.a.ArrowUp:this.focusStatus=-1,(i=r[--o%n])&&i.firstElementChild.focus();break;case u.a.ArrowDown:this.focusStatus=-1,(i=r[++o%n])&&i.firstElementChild.focus()}}},t.prototype.updateFocusStatus=function(){var e=this.selectedIndex,t=this.rankingRef.current;if(t){var r=t.children[e];if(r)if(0===this.focusStatus)r.firstElementChild.focus();else{var n=".office-form-sort-list-arrows > button:nth-child("+((1===this.focusStatus?0===e?1:0:r===t.lastElementChild?0:1)+1)+")";r.querySelector(n).focus()}}this.focusStatus=-1},t.prototype.updateChoicesInternally=function(){var e=this.props.Master,t=e.Question.Model,r=e.Model.Answer;r&&r.length>0?this.choices=a.clone(r).sort((function(e,t){return e.answerOrder-t.answerOrder})).map((function(e){return a.find(t.ChoiceGroup,(function(t){return t.Id===e.id}))||{Description:e.displayText,Id:e.id,Key:e.key,Order:e.order}})):this.props.ShowDesignInfo||!t.IsQuiz||this.props.ShowQuizResult?this.choices=s.a.convertToArray(t.ChoiceGroup).sort((function(e,t){return e.Order-t.Order})):this.choices=a.shuffle(t.ChoiceGroup)},t.prototype.moveElement=function(e,r){var n=this.choices.splice(e,1)[0];this.choices.splice(r,0,n),this.selectedIndex=r,this.props.Master.Model.Answer=t.stringifyAnswer(this.choices),this.forceUpdate()},t}(g.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n,o=r(13),i=r(10),a=r(58),s=r(6),c=r(7),u=r(235),l=r(175),d=r(94),f=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return f(t,e),t.prototype.componentWillMount=function(){e.prototype.componentWillMount.call(this),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.update,[a.a.Schema.leftDescription,a.a.Schema.rightDescription])},t.prototype.componentWillUnmount=function(){this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.update),e.prototype.componentWillUnmount.call(this)},t.prototype.createReactNodes=function(){var e,t,r=this.props.Master,n=r.Question.Model,a=n.Length>3&&(this.props.IsMobile||o.t()),d=this.questionLocalizedItemMaster,f=d&&d.Model,p=f&&f.leftDescription||n.LeftDescription,m=f&&f.rightDescription||n.RightDescription;if(Object(c.e)((function(){e=n.FormsProRTLeftDescription,t=n.FormsProRTRightDescription,p=f&&f.formsprortlocaleldescription||(n.FormsProRTLeftDescription?n.FormsProRTLeftDescription:p),m=f&&f.formsprortlocalerdescription||(n.FormsProRTRightDescription?n.FormsProRTRightDescription:m)})),n.RatingShape===i.f.Number)return[Object(u.a)({Disabled:this.props.Disabled,FormsProRTLeftDescription:e,FormsProRTRightDescription:t,HTMLAttributes:this.getElementProps(),key:"numberRating",Layout:a?"Center":"Left",LeftDescription:p,Length:n.Length,MinRating:n.MinRating,onValueChange:function(e){return r.Model.Answer=e},RightDescription:m,ShowRatingLabel:n.ShowRatingLabel,Value:r.Model.Answer})];$.rateit.aria.ratingLabel=this.props.LocalizedStrings.RateItControl_AriaLabel,o.r()&&($.rateit.aria.ratingDescription=this.props.LocalizedStrings.RateItControl_AriaDescription);var h=!1;return FormsPro.proOnly((function(){Object(s.a)().Flighting.isEnabled("FormsProEmbedCompact")&&(h=o.n())})),[Object(l.a)({Compact:h,Disabled:this.props.Disabled,FormsProRTLeftDescription:e,FormsProRTRightDescription:t,IsMobile:!!this.props.IsMobile,key:"rating",Label:"",LeftDescription:p,LeftDescriptionTitle:this.props.LocalizedStrings.RatingDescriptionTitle.format(1),Length:n.Length,NoTabFocus:this.props.Disabled,onValueChange:function(e){return r.Model.Answer=e},Options:{HTMLPropsForInnerElement:this.getElementProps()},RightDescription:m,RightDescriptionTitle:this.props.LocalizedStrings.RatingDescriptionTitlePlural.format(n.Length),ShowRatingLabel:n.ShowRatingLabel,Theme:this.props.Theme,ValidationStyle:this.getValidationStyle(),Value:r.Model.Answer})]},t}(d.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return P}));var n,o=r(0),i=r(3),a=r(21),s=r(27),c=r(5),u=r(86),l=r(13),d=r(10),f=r(73),p=r(6),m=r(9),h=r(22),g=r(29),y=r(88),b=r(37),v=r(89),S=r(211),I=r(94),M=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),F=function(){return(F=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},O=d.e,C=!1,P=function(e){function t(t){var r=e.call(this,t)||this;return r.domRole="presentation",r.onMathValueChange=r.onMathValueChange.bind(r),r.toggleMathResponse=r.toggleMathResponse.bind(r),r.validateOnBlur=r.validateOnBlur.bind(r),r.showPhishingFormWarning=r.showPhishingFormWarning.bind(r),r.setInputFieldDefault(),r}return M(t,e),t.prototype.createReactNodes=function(){var e,t,r=this,n=this.props.Master.Model,i=this.props.Master.Question,s=i.Model,c=this.getErrorMessageLabel();if(this.props.PrintView)e=o.createElement("div",{className:"textbox-printview",key:"printView"},n.Answer);else{var u=void 0,d=void 0;if(s.IsMathQuiz&&!s.Multiline){var f=this.getCorrectnessIcon(!0),m=s.InputSwitcherDisabled||!s.IsMathInputDefault,h=this.props.Disabled||m?void 0:this.createMathTextSwitcher(),g=void 0,y=void 0;if(n.AnswerEntity)g=n.AnswerEntity.IsMathAnswer,y=n.AnswerEntity.Answer;else g=!s.IsAnswerPlainText,y=l.I(n.Answer||"{}").Answer||"";if(g){var v=s.InputSwitcherDisabled?this.props.LocalizedStrings.TextField_EnterMathAnswer:this.props.LocalizedStrings.TextField_DefaultPlaceholder,I={onBlur:this.validateOnBlur},M=o.createElement(S.a,{Disabled:this.props.Disabled,HTMLAttributes:I,key:"textmathquestion-mathfield",Location:"TextField.Response",onValueChange:this.onMathValueChange,Placeholder:v,QuestionId:s.Id,Value:y},h);d=o.createElement("div",{className:"office-form-response-question-math-container"},M,f)}else{var F=Object(b.c)({AutoSelection:!0,Disabled:this.props.Disabled,HTMLAttributes:{className:"design-question-math-plaintext-text",onBlur:this.validateOnBlur},key:"textmathquestion-textfield",Label:void 0,MaxLength:a.a.AnswerTextfieldLength,MinimalHeight:40,onValueChange:this.onMathValueChange,Options:{HTMLPropsForInnerElement:this.getElementProps({className:"design-question-math-plaintext-text"})},Placeholder:this.props.LocalizedStrings.TextField_DefaultPlaceholder||"",Theme:this.props.Theme,ValidationStyle:this.getValidationStyle(),Value:y});d=o.createElement("div",{className:"office-form-response-question-math-textfield"},F,h,f)}t=o.createElement("div",{className:"student-feedback-view-short-text-field-with-correctness",key:"normalView"},d)}else{v=FormsPro.baseProAdapter((function(){return s.IsNumber?i.getNumberValidationErrorMessage(r.props.LocalizedStrings):s.Placeholder||r.props.LocalizedStrings.TextField_DefaultPlaceholder}),(function(){return s.IsNumber||s.HasTFRestrictionForPro?Object(p.a)().Flighting.isEnabled("FormsProTextFieldValidation")?i.getValidationErrorMessage():i.getNumberValidationErrorMessage(r.props.LocalizedStrings):s.Placeholder||r.props.LocalizedStrings.TextField_DefaultPlaceholder}));u=Object(b.c)({Disabled:this.props.Disabled,HTMLAttributes:{onBlur:this.validateOnBlur,onFocus:this.showPhishingFormWarning},key:"textquestion-textfield",Label:void 0,MaxLength:a.a.AnswerTextfieldLength,onValueChange:function(e){return n.Answer=e},Options:{HTMLPropsForInnerElement:this.getElementProps({className:"office-form-question-textbox"})},Placeholder:v,TextFieldType:s.Multiline?b.a.AutoHeightMultiline:b.a.SingleLine,Theme:this.props.Theme,ValidationStyle:this.getValidationStyle(),Value:n.Answer});f=this.getCorrectnessIcon();t=o.createElement("div",{className:"student-feedback-view-short-text-field-with-correctness",key:"normalView"},u,f)}}return[e,t,this.createCorrectAnswerList(),c]},t.prototype.createMathTextSwitcher=function(){var e,t,r=this.props.Master.Question.Model,n="design-question-choice-to-math-button";return this.props.IsMobile&&(n=c.a.combineAttributes(n,"isMobile")),r.IsAnswerPlainText?(e={"aria-label":this.props.LocalizedStrings.Designer_Question_Equation_Button,className:n,onClick:this.toggleMathResponse(),title:this.props.LocalizedStrings.Designer_Question_Equation_Button_Tooltip},t="NumberField"):(e={"aria-label":this.props.LocalizedStrings.Designer_Question_EquationToText_Button,className:n,onClick:this.toggleMathResponse(),title:this.props.LocalizedStrings.Designer_Question_EquationToText_Button_Tooltip},t="TextField"),Object(g.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:e,Icon:t,IconClassName:"design-question-choice-to-math-button-icon"})},t.prototype.toggleMathResponse=function(){var e=this;return function(t){var r=e.props.Master.Question.Model,n=e.props.Master.Model,o=l.I(n.Answer||"{}");r.IsAnswerPlainText=!r.IsAnswerPlainText;var i={Answer:o.Answer,IsMath:!r.IsAnswerPlainText};n.Answer=JSON.stringify(i),Object(m.a)({eventName:r.IsAnswerPlainText?"DesignPage.Quiz.SwitchMathToTextInput":"DesignPage.Quiz.SwitchTextToMathInput",eventType:"engagement_event",extraData:{location:"TextField.Response",questionId:r.Id}}),e.forceUpdate()}},t.prototype.setInputFieldDefault=function(){var e=this.props.Master.Question.Model,t=this.props.Master;if(e.IsMathQuiz){if(t.Model.Answer){var r=l.I(t.Model.Answer||"{}");if(void 0!==r.IsMath)return void(e.IsAnswerPlainText=!r.IsMath)}e.IsAnswerPlainText=!e.IsMathInputDefault}else e.IsAnswerPlainText=!0},t.prototype.onMathValueChange=function(e){var t=this.props.Master.Model,r={Answer:e,IsMath:!this.props.Master.Question.Model.IsAnswerPlainText};t.Answer=JSON.stringify(r)},t.prototype.validateOnBlur=function(){var e=this.props.Master.Model,t=this.props.Master.Question;if(t.Model.IsNumber){var r=e.Answer;t.verify(r)!==O.Success||t.Model.IsMathQuiz||FormsPro.baseProAdapter((function(){return e.Answer=u.a.formatAsFloat(r)}),(function(){return e.Answer=!Object(p.a)().Flighting.isEnabled("FormsProTextFieldValidation")||t.Model.FormsProValidationType!==d.g.Email&&t.Model.FormsProValidationType!==d.g.Custom?u.a.formatAsFloat(r):r}))}},t.prototype.showPhishingFormWarning=function(){this.props.Master.Model.ShowPhishingFormWarning=!0,C||(C=!0,Object(m.a)({eventName:"ResponsePage.Phshing.Warning",eventType:"engagement_event"}))},t.prototype.getErrorMessageLabel=function(){var e=this.props.Master.Model,t=this.props.Master.Question,r=t.verify(e.Answer);if(e.Answer&&r!==O.Success){var n;switch(r){case O.NumberValidationError:case O.RegExValidationError:n=t.getNumberValidationErrorMessage(),FormsPro.proOnly((function(){Object(p.a)().Flighting.isEnabled("FormsProTextFieldValidation")&&(n=t.getValidationErrorMessage())}));break;case O.MathLengthError:n=this.props.LocalizedStrings.Math_Answer_LengthLimit_Message;break;default:return}return Object(y.a)({Alert:!0,HTMLAttributes:{className:"validation-error-message-label",role:"alert"},key:"textquestion-errorlabel",Label:n})}},t.prototype.getCorrectnessIcon=function(e){var r=this.props.Master,n=this.props.Master.Question,i=n.Model;if(this.props.ShowQuizResult&&!i.Multiline&&i.IsQuiz){var a=t.isAnswerCorrect(r);if(null!==a&&(a||this.props.IsMobile)){var u=e?"student-feedback-view-short-text-math-correctness-icon-container":"student-feedback-view-short-text-correctness-icon-container";this.props.IsMobile&&(u=c.a.combineAttributes(u,"isMobile"));var d,f=a?this.props.LocalizedStrings.Quiz_CorrectAnswer:this.props.LocalizedStrings.Quiz_WrongAnswer,p={HTMLAttributes:{className:c.a.combineAttributes("student-feedback-view-short-text-correctness-icon forms-icon-size14x14",a?"image-button-answerkey":"image-button-checked-wrong-answer"),title:f},IconName:a?"CheckMark":"Cancel"},m=r.Model.Answer;if(d=m,!m||s.a.isNullOrEmpty(m))d=i.Placeholder||this.props.LocalizedStrings.TextField_DefaultPlaceholder;else if(n.Model.IsMathQuiz){var g=l.I(m||"{}");d=g.IsMath?Object(v.a)({Formula:null==g.Answer?m:g.Answer}):null==g.Answer?m:g.Answer}var y={"aria-hidden":!0,className:"student-feedback-view-short-text-hidden-text-to-position-correctness-icon",role:this.domRole};return o.createElement("div",{className:u},o.createElement("span",F({},y),d),Object(h.b)(p))}}},t.isAnswerCorrect=function(e){var t=e.Model;return null!=t.QuizResult?t.QuizResult.IsAnswerCorrect:new f.a(e.Question.Model).areAnyAnswersDefined()?e.Question.isCorrectAnswer(t.Answer):null},t.prototype.createCorrectAnswerList=function(){var e=this.props.Master.Question.Model,t=this.props.Master.Model.QuizResult;if(this.shouldShowCorrectAnswerList()){var r=null!=t?t:e,n=new f.a(r);if(n.areAnyAnswersDefined()){var a,s=n.getAnswers();if(s.some((function(e){return e.isMath}))){for(var c=[],u=0,l=s;u<l.length;u++){var d=l[u];if(d.isMath){var p=Object(v.a)({Formula:d.answer});c.push(o.createElement("div",{className:"correct-answer-list-formula-element"},p))}else c.push(d.answer);c.push(this.props.LocalizedStrings.VariousLocations_ItemList_Separator)}c.pop(),a=o.createElement("div",{className:"correct-answer-list-formula-container"},c)}else a=i.map(s,(function(e){return e.answer})).join(this.props.LocalizedStrings.VariousLocations_ItemList_Separator);var m={HTMLAttributes:{"aria-hidden":!0,className:"office-form-right-answerkey various-short-text-correct-answer-list-correctness-icon",role:this.domRole},IconName:""};return o.createElement("div",{className:"various-short-text-correct-answer-list",key:"answerList"},Object(h.b)(m),o.createElement("b",null,this.props.LocalizedStrings.VariousLocations_CorrectAnswerList_Label," "),a)}}},t.prototype.shouldShowCorrectAnswerList=function(){var e=this.props.Master.Model,t=this.props.Master.Question.Model,r=this.props.Master.Model.QuizResult;return!(t.Multiline||!t.IsQuiz)&&(!(!this.props.ShowDesignInfo&&null==r)&&((null==r||!r.IsAnswerCorrect)&&!(null==r&&this.props.Master.Question.isCorrectAnswer(e.Answer))))},t}(I.a)},function(e,t,r){"use strict";var n,o=r(0),i=r(3),a=r(102),s=r(4),c=r(83),u=r(21),l=r(27),d=r(5),f=r(96),p=r(10),m=r(58),h=r(91),g=r(6),y=r(7),b=r(88),v=r(105),S=r(37),I=r(71),M=r(89),F=r(22),O=r(12),C=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),P=function(){return(P=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},T=function(e){function t(t){var r=e.call(this,t)||this;return r.handleValueChange=r.handleValueChange.bind(r),r}return C(t,e),t.prototype.render=function(){var e=this,t=this.props.Choice,r=this.props.ContainerClassName;this.props.IsChecked&&this.props.IsMobile&&(r=d.a.combineAttributes(r,"active"));var n=d.a.combineAttributes("office-form-question-choice-row",this.props.ClassNameForLabel),i=Object(y.c)((function(){return t.Description}),(function(){return t.Description||e.props.LocalizedStrings.Quiz_Empty_Option_Label}));return o.createElement("div",{className:r},o.createElement("div",{className:this.props.IsSingleChoice?"radio":"checkbox"},o.createElement("label",{className:n},o.createElement("input",P({"aria-checked":this.props.IsChecked,"aria-label":i,checked:this.props.IsChecked,disabled:this.props.Disabled,onChange:this.handleValueChange,type:this.props.IsSingleChoice?"radio":"checkbox",value:t.Description},this.props.HTMLPropsForInput)),this.props.children,this.getAnswerKeyMark())),this.getAnswerHintLabel())},t.prototype.getAnswerKeyMark=function(){var e,t;switch(this.props.AnswerType){case"Correct":t="CheckMark",e=this.props.IsMobile&&this.props.IsChecked?"image-button-checked-answerkey-mobile office-form-answerkey":"image-button-answerkey office-form-answerkey";break;case"Wrong":e=this.props.IsMobile?"image-button-checked-wrong-answer-mobile office-form-answerkey":"",t=this.props.IsMobile?"Cancel":""}if(t)return Object(F.b)({HTMLAttributes:{className:d.a.combineAttributes(e,"forms-icon-size20x20"),role:"tooltip",title:this.props.ToolTipForAnswer},IconName:t})},t.prototype.getAnswerHintLabel=function(){if(this.props.AnswerHint){var e=void 0;return e="Correct"===this.props.AnswerType?this.props.IsMobile?"validation-success-mobile":"validation-success":this.props.IsMobile?"validation-error-mobile":"validation-error",e=d.a.combineAttributes("office-form-answerhint",e),o.createElement("div",{className:e},this.props.AnswerHint)}},t.prototype.handleValueChange=function(){this.props.onChange(this.props.Choice.Description)},t}(O.a),w=r(94);r.d(t,"a",(function(){return D}));var _=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),E=function(){return(E=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},R="6c660282-db72-436c-87bb-8272cba504d3",D=function(e){function t(t){var r=e.call(this,t)||this;r.otherAnswerTextRef=o.createRef(),r.radioGroupName=l.a.newGuid();var n=r.parseAnswer(),a=r.getOptions(),s=r.generateOptionsOrder();return r.state={ChoiceOptions:a,IsOtherOptionSelected:!!n.OtherAnswer,LocalizedOptions:r.questionLocalizedItemMaster&&r.questionLocalizedItemMaster.Model.option,OptionsOrder:s,OrderedChoices:i.map(s,(function(e){return a[e]})),OtherOptionText:n.OtherAnswer,ReachMaxLengthLimit:!1,SelectedOptions:n.SelectedOptions},r.onChange=r.onChange.bind(r),r.handleOtherInputChange=r.handleOtherInputChange.bind(r),r.resetState=r.resetState.bind(r),r.resetLocaleResourceState=r.resetLocaleResourceState.bind(r),r.onAnswerChange=r.onAnswerChange.bind(r),r.handleOtherValueChange=r.handleOtherValueChange.bind(r),r}return _(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this.props.Master.Question.observe(this.resetState),this.props.ShowQuizResult&&this.props.Master.observe(this.onAnswerChange,[h.a.Schema.Answer]),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.resetLocaleResourceState,[m.a.Schema.choicesV1])},t.prototype.componentWillUnmount=function(){this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.resetLocaleResourceState),this.props.Master.Question.unobserve(this.resetState),this.props.ShowQuizResult&&this.props.Master.unobserve(this.onAnswerChange,[h.a.Schema.Answer]),e.prototype.componentWillUnmount.call(this)},t.prototype.componentWillReceiveProps=function(t){var r=this;this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.resetLocaleResourceState),e.prototype.componentWillReceiveProps.call(this,t),this.questionLocalizedItemMaster&&(this.questionLocalizedItemMaster.observe(this.resetLocaleResourceState,[m.a.Schema.choicesV1]),FormsPro.proOnly((function(){r.setLocalizedChoice(r.props.Master.Model.Answer)})))},t.prototype.shouldComponentUpdate=function(e,t){var r=!i.isEqual(e,this.props),n=!i.isEqual(t,this.state);return r||n},t.prototype.createReactNodes=function(){var e=this.props.Master.Question,t=e.Model,r=t.ChoiceType===p.a.SingleChoice;return this.props.ExpandAll||!e.showAsDropdown()||this.props.IsMobile||t.IsQuiz&&this.props.ShowQuizResult?[this.createChoices(r),this.getErrorMessageLabel()]:[this.createDropDown()]},t.prototype.getFormattedDataForImmersiveReader=function(){var t=e.prototype.getFormattedDataForImmersiveReader.call(this),r=null,n=document.createElement("ul");return i.forEach(this.state.OrderedChoices,(function(e){var t=document.createElement("li"),o=null;if(e.IsMathOption&&"undefined"!=typeof MathJax){r=r||MathJax.Hub.getAllJax(null);var a=i.find(r,(function(t){return t.originalText===e.Description}));if(a){var s=a.root&&a.root.toMathML&&a.root.toMathML();s&&(s=s.replace(/\n\s*/g,""),o="\x3c!--[if mathML]&#62;"+d.a.encodeHTML(s,!0)+"&#60;![endif]--\x3e")}}t.innerHTML=o||d.a.encodeHTML(e.Description,!0),n.appendChild(t)})),n.appendChild(document.createElement("br")),t.splice(t.length-1,0,{content:n.outerHTML,mimeType:"text/html"}),t},t.prototype.onAnswerChange=function(){var e=this.parseAnswer();this.setState({IsOtherOptionSelected:!!e.OtherAnswer,OtherOptionText:e.OtherAnswer,SelectedOptions:e.SelectedOptions})},t.prototype.setLocalizedChoice=function(e){if(Object(g.a)().Flighting.isEnabled("FormsProAnswerTag")){var t=i.findIndex(this.props.Master.Question.Model.Choices,(function(t){return t.Description===e}));if(t>-1){var r=this.questionLocalizedItemMaster,n=void 0;if(r){var o=r.getChoiceV1LocalizedMaster(t);n=o&&o.Model.description,n=o.Model.formsProDisplayRTText||n,this.props.Master.Model.SelectedChoice=n}else this.props.Master.Model.SelectedChoice=e}}},t.prototype.updateAnswer=function(){var e,t=this,r=[],n=this.props.Master.Question.Model.ChoiceType===p.a.SingleChoice,o=this.state.SelectedOptions;o&&o.forEach((function(e){return r.push(e)}));var i=this.state.OtherOptionText;if(FormsPro.baseProAdapter((function(){t.state.IsOtherOptionSelected&&i&&-1===r.indexOf(i)&&r.push(i)}),(function(){t.state.IsOtherOptionSelected&&!Object(a.isNullOrUndefined)(i)&&-1===r.indexOf(i)&&r.push(i)})),n)e=r[0];else if(r.length){var s=this.sortAnswers(r);e=JSON.stringify(s)}FormsPro.proOnly((function(){t.setLocalizedChoice(e)})),this.props.Master.Model.Answer=e},t.prototype.createChoices=function(e){var r=this,n=this.props.Master.Question.Model,a=this.state.OrderedChoices.length+(n.AllowOtherAnswer?1:0),s=this.props.Master.Question.Form;FormsPro.proOnly((function(){return Object(g.a)().Flighting.isEnabled("FormsProCascadingBranching")&&r.resetChoice()}));var u=c.a.supportsExtensionPoint(s,c.b.ResponsePagePollView),l=d.a.combineAttributes(this.props.IsMobile&&!u?"office-form-question-choice-mobile office-form-theme-page-background-active":"office-form-question-choice"),f=this.state.OrderedChoices.map((function(n,s){var c,u=-1!==r.state.SelectedOptions.indexOf(n.Description),f=r.props.Master.Question.Model.IsQuiz?"office-form-question-choice-quiz-row":"";if(r.props.Master.Question.Model.IsMathQuiz&&n.IsMathOption){var p=Object(M.a)({DisableLinebreaks:r.props.DisableFormulaLinebreak,Formula:n.Description,onRenderComplete:r.props.onHeightChange});c=o.createElement("div",{className:"office-form-question-choice-formula"},p)}else{f=d.a.combineAttributes(f,"office-form-question-choice-text-row");var m,h=r.questionLocalizedItemMaster;if(h){var g=h.getChoiceV1LocalizedMaster(r.state.OptionsOrder[s]);m=g&&g.Model.description,Object(y.e)((function(){m=g&&null!=g.Model.formsProDisplayRTText?g.Model.formsProDisplayRTText:null==m?n.FormsProDisplayRTText?n.FormsProDisplayRTText:n.Description:m}))}else Object(y.e)((function(){m=n.FormsProDisplayRTText?n.FormsProDisplayRTText:m,r.props.Master.Model.SelectedChoice=r.props.Master.Model.Answer}));var b={RenderMode:"RichText",Text:m||n.Description};Object(y.e)((function(){b.ContainsHtml=!0})),c=o.createElement("span",{className:"office-form-question-choice-text-span"},Object(I.b)(b))}var v,S=t.getAnswerKeyMark(r.props,n,u);switch(S){case"Correct":v=r.props.LocalizedStrings.Quiz_CorrectAnswer;break;case"Wrong":v=r.props.LocalizedStrings.Quiz_WrongAnswer}var F={name:r.radioGroupName};return e&&i.extend(F,{"aria-posinset":s+1,"aria-setsize":a}),o.createElement(T,{AnswerHint:t.getAnswerHintLabel(r.props,n,u),AnswerType:S,ToolTipForAnswer:v,Choice:n,ClassNameForLabel:f,ContainerClassName:l,Disabled:r.props.Disabled,HTMLPropsForInput:F,IsChecked:u,IsMobile:r.props.IsMobile,IsSingleChoice:e,key:s,LocalizedStrings:r.props.LocalizedStrings,onChange:r.onChange},c)})),p=this.getElementProps({key:"choicequestion-choices",role:e?"radiogroup":"group"});return o.createElement("div",E({},p),f,this.createOtherAnswer(e))},t.prototype.resetChoice=function(){this.props.Master.Model.Answer||this.props.Master.Model.Visible||this.resetState()},t.prototype.createOtherAnswer=function(e){var t=this.props.Master.Question.Form,r=c.a.supportsExtensionPoint(t,c.b.ResponsePagePollView);if(this.props.Master.Question.Model.AllowOtherAnswer){var n={className:this.props.IsMobile&&!r?"office-form-other-answer-mobile":"office-form-other-answer",key:"other-answer"};return o.createElement("div",E({},n),this.createOtherAnswerInput(e),this.createOtherAnswerTextbox())}},t.prototype.createOtherAnswerInput=function(e){var t=this.state.ChoiceOptions,r={"aria-label":this.props.LocalizedStrings.Response_Page_OtherAnswerTitle,checked:this.state.IsOtherOptionSelected,disabled:this.props.Disabled,name:e?this.radioGroupName:void 0,onChange:this.handleOtherInputChange,ref:"otherAnswerInput",role:"checkbox",type:"checkbox",value:this.state.OtherOptionText||""};return e&&(r.role="radio",r.type="radio",r["aria-posinset"]=t.length+1,r["aria-setsize"]=t.length+1,Object(y.e)((function(){r["aria-checked"]=r.checked}))),o.createElement("input",E({},r))},t.prototype.handleOtherInputChange=function(){var e=this,t=this.state.IsOtherOptionSelected,r=i.clone(this.state.SelectedOptions);if(!t){this.props.Master.Question.Model.ChoiceType===p.a.SingleChoice&&(r=[]);var n=this.otherAnswerTextRef.current;n&&n.focus()}this.setState({IsOtherOptionSelected:!t&&!!this.state.OtherOptionText,SelectedOptions:r},(function(){return e.updateAnswer()}))},t.prototype.createOtherAnswerTextbox=function(){var e={"aria-label":this.props.LocalizedStrings.Designer_OtherAnswer,className:"office-form-other-answer-textbox"},t={AutoSelection:!0,Disabled:this.props.Disabled,HTMLAttributes:{className:"inline-display office-form-other-answer-margin-left-mobile"},MaxLength:u.a.OtherOptionLength,onValueChange:this.handleOtherValueChange,Options:{HTMLPropsForInnerElement:e},Placeholder:this.props.LocalizedStrings.Designer_OtherAnswer,ref:this.otherAnswerTextRef,Value:this.state.OtherOptionText||""};return Object(S.c)(t)},t.prototype.handleOtherValueChange=function(e){var t=this,r=this.state.SelectedOptions;this.props.Master.Question.Model.ChoiceType===p.a.SingleChoice&&(r=[]),this.setState({IsOtherOptionSelected:!!e,OtherOptionText:e,SelectedOptions:r},(function(){return t.updateAnswer()}))},t.prototype.resetState=function(){var e=this.parseAnswer();this.setState({ChoiceOptions:this.getOptions(),OptionsOrder:this.generateOptionsOrder(),OrderedChoices:this.getOrderedChoices(),OtherOptionText:e.OtherAnswer,SelectedOptions:e.SelectedOptions})},t.prototype.resetLocaleResourceState=function(){this.setState({LocalizedOptions:this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.Model.option})},t.prototype.onChange=function(e){var t=this,r=i.clone(this.state.SelectedOptions),n=this.props.Master.Question.Model.ChoiceType===p.a.SingleChoice,o=this.state.IsOtherOptionSelected,a=!1;if(n){if(e===r[0])return;o=!1,r=[e]}else{var s=r.indexOf(e);-1===s?r.push(e):r.splice(s,1),a=JSON.stringify(r).length>f.a.MaxAnswerLength}this.setState({IsOtherOptionSelected:o,ReachMaxLengthLimit:a,SelectedOptions:r},(function(){return t.updateAnswer()}))},t.prototype.getErrorMessageLabel=function(){if(this.state.ReachMaxLengthLimit)return Object(b.a)({Alert:!0,HTMLAttributes:{className:"validation-error-message-label",role:"alert"},key:"textquestion-errorlabel",Label:this.props.LocalizedStrings.Error_Message_Question_Reach_Limit})},t.prototype.createDropDown=function(){var e,t,r=this,n=this.props.Master,i=n.Question.Model,a=this.state.OrderedChoices.map((function(e,t){var n,o=r.questionLocalizedItemMaster;if(o){var i=o.getChoiceV1LocalizedMaster(r.state.OptionsOrder[t]);n=i&&i.Model.description,Object(y.e)((function(){n=i&&null!=i.Model.formsProDisplayRTText?i.Model.formsProDisplayRTText:null==n?e.FormsProDisplayRTText?e.FormsProDisplayRTText:e.Description:n}))}return{DisplayName:n||e.Description,Key:s.a.getObjectMasterFromModel(e).getInstanceId(),Value:e.Description}})),c=n.Model.Answer;i.AllowOtherAnswer&&a.push(this.createDropDownOtherOption()),this.state.IsOtherOptionSelected&&(c=R),!this.props.ShowDesignInfo&&this.state.IsOtherOptionSelected&&(e=this.createDropDownOtherAnswer()),t=function(e){return r.onDropDownValueChange(e)};var u=Object(v.b)({AllowWrap:!0,HTMLAttributes:this.getElementProps({className:"office-form-question-dropdown",disabled:this.props.Disabled,title:i.Hint||this.props.LocalizedStrings.Dropdown_DefaultHint}),key:"choicequestion-dropdown",onValueChange:t,Placeholder:i.Hint||this.props.LocalizedStrings.Dropdown_DefaultHint,SelectOptions:a,Value:c});return o.createElement("div",{className:this.getValidationStyle()},u,e)},t.prototype.onDropDownValueChange=function(e){var t=this,r=e===R,n=r?[]:[e];FormsPro.baseProAdapter((function(){t.setState({IsOtherOptionSelected:r,SelectedOptions:n},(function(){return t.updateAnswer()}))}),(function(){t.setState({IsOtherOptionSelected:r,OtherOptionText:t.state.OtherOptionText||(r?"":void 0),SelectedOptions:n},(function(){return t.updateAnswer()}))}))},t.prototype.createDropDownOtherOption=function(){return{DisplayName:this.props.LocalizedStrings.Designer_OtherAnswer,Key:R,Value:R}},t.prototype.createDropDownOtherAnswer=function(){var e=this,t={"aria-label":this.props.LocalizedStrings.TextField_DefaultPlaceholder,className:"office-form-other-answer-textbox"},r={AutoFocus:!0,Disabled:this.props.Disabled,HTMLAttributes:{className:"office-form-other-answer office-form-dropdown-other-answer"},onValueChange:function(t){e.setState({OtherOptionText:t,SelectedOptions:[]},(function(){return e.updateAnswer()}))},Options:{HTMLPropsForInnerElement:t},Placeholder:this.props.LocalizedStrings.TextField_DefaultPlaceholder,ref:this.otherAnswerTextRef,Value:this.state.OtherOptionText};return Object(S.c)(r)},t.prototype.sortAnswers=function(e){var t=this.props.Master.Question.Model.Choices,r=i.map(t,(function(e){return e.Description}));return e.sort((function(e,t){return r.indexOf(e)-r.indexOf(t)}))},t.isQuizResultAnswerKey=function(e,t){if(!e||!e.IsAnswerKeys)return!1;var r=e.Choices;return!!r&&e.IsAnswerKeys[r.indexOf(t.Description)]},t.getAnswerKeyMark=function(e,r,n){var o=e.Master,i=o.Model.QuizResult,a=o.Question,s=t.isQuizResultAnswerKey(i,r);return r.IsAnswerKey&&e.ShowDesignInfo&&a.Model.IsQuiz||s?"Correct":n&&i&&i.IsAnswerKeys&&i.IsAnswerKeys.some((function(e){return e}))&&!s?"Wrong":"Normal"},t.getAnswerHintLabel=function(e,t,r){var n=e.Master.Model.QuizResult;if(!e.ShowDesignInfo&&r&&n){var o=n.Choices,i=o?o.indexOf(t.Description):-1;return n.AnswerHints&&n.AnswerHints[i]}},t.prototype.getOptions=function(){var e=this.props.Master.Question.Model;return this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.getChoiceV1LocalizedMaster(e.Choices.length-1),s.a.convertToArray(e.Choices)},t.prototype.getOrderedChoices=function(){var e=this;return i.map(this.state.OptionsOrder,(function(t){return e.state.ChoiceOptions[t]}))},t.prototype.generateOptionsOrder=function(){for(var e=this.props.Master.Question.Model,t=[],r=0;r<e.Choices.length;r++)t[r]=r;return this.props.ShowQuizResult||!e.ShuffleOptions||this.props.DisableShuffle?t:i.shuffle(t)},t.prototype.parseAnswer=function(){var e,t=this.props.Master,r=t.Model,n=t.Question.Model,o=n.ChoiceType===p.a.SingleChoice,a=[],s=Object(f.b)(r.Answer,n).SelectedOptions;s.length>0&&(o?[r.Answer]:s).forEach((function(t){-1!==i.findIndex(n.Choices,(function(e){return e.Description===t}))?a.push(t):n.AllowOtherAnswer&&(e=t)}));return{OtherAnswer:e,SelectedOptions:a}},t}(w.a)},function(e,t,r){"use strict";var n,o=r(0),i=r(3),a=r(4),s=r(5),c=r(16),u=r(249),l=r(8),d=r(6),f=r(9),p=r(68),m=r(29),h=r(239),g=r(22),y=r(70),b=r(31),v=r(12),S=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),I=function(e){function t(t){var r=e.call(this,t)||this;return r.cancelFileUpload=r.cancelFileUpload.bind(r),r.deleteFile=r.deleteFile.bind(r),r.onFocus=r.onFocus.bind(r),r.onBlur=r.onBlur.bind(r),r}return S(t,e),t.prototype.render=function(){var e=this.props;if("pending"===e.UploadState){var t=o.createElement(b.a,{ButtonStyle:"LightBackground",HTMLAttributes:{"aria-label":e.LocalizedStrings.UploadFile_Cancel_Upload_Label&&e.LocalizedStrings.UploadFile_Cancel_Upload_Label.format(e.FileName),className:"office-form-cancel-fileUpload office-form-theme-primary-foreground office-form-theme-button-color",onClick:this.cancelFileUpload},Text:e.LocalizedStrings.UploadFile_Cancel_Button});return this.props.IsMobile,o.createElement("div",{className:"office-form-uploadFile"},o.createElement(g.a,{HTMLAttributes:{className:"uploading office-form-theme-primary-color forms-icon-size14x14"},IconName:"Sync"}),Object(p.d)(e.FileName),o.createElement("span",{className:"office-form-uploadFile-text"},e.FileName),t)}var r=Object(m.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{"aria-label":e.LocalizedStrings.UploadFile_Delete_Uploaded_File_Label&&e.LocalizedStrings.UploadFile_Delete_Uploaded_File_Label.format(e.FileName),className:(this.props.AutoFocus?"inline-display":"dn")+" office-form-delete-button",onClick:this.deleteFile,title:this.props.LocalizedStrings.Delete_Button_Narrator},Icon:"Delete",IconClassName:"delete-file-button forms-icon-size16x16"}),n="office-form-upload-done-item";return e.Disabled||(n=s.a.combineAttributes(n,"office-form-upload-done-item-background")),o.createElement("div",{className:n,onBlur:this.onBlur},o.createElement("div",{className:"office-form-upload-file-info",onFocus:this.onFocus,tabIndex:0},Object(p.d)(e.FileName),e.showFileInfo?o.createElement("a",{className:"office-form-uploadFile-text office-form-uploadFile-name",href:e.FilePath,target:"_blank"},e.FileName):o.createElement("span",{className:"office-form-uploadFile-text office-form-uploadFile-name"},e.FileName)),!this.props.Disabled&&r)},t.prototype.onFocus=function(){this.props.setFocusOnCurrentItem(this.props.FileName)},t.prototype.onBlur=function(e){var t=e.currentTarget.parentElement,r=s.a.getTargetElementOfFocusEvent(e);t&&r&&t.contains(r)||this.props.setFocusOnCurrentItem()},t.prototype.deleteFile=function(e){var t=this.props;t.deleteFile(t.FilePath,t.FileName,t.UploadState,t.FileKey),this.props.setFocusOnCurrentItem(),Object(y.c)(e.currentTarget)},t.prototype.cancelFileUpload=function(e){var t=this.props;t.deleteFile(t.FilePath,t.FileName,t.UploadState,t.FileKey),this.props.setFocusOnCurrentItem(),Object(y.c)(e.currentTarget)},t}(v.a),M=r(94);r.d(t,"a",(function(){return C}));var F=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),O=function(){return(O=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},C=function(e){function t(t){var r=e.call(this,t)||this;r.waitingToShowErrorAlert=1e3,r.fileInputRef=o.createRef(),r.updateUX=function(){return r.forceUpdate()},r.uploadFileInPut=r.uploadFileInPut.bind(r),r.deleteFile=r.deleteFile.bind(r),r.onChange=r.onChange.bind(r),r.onClickContinueButton=r.onClickContinueButton.bind(r),r.setFocusOnCurrentItem=r.setFocusOnCurrentItem.bind(r);var n=t.Master;return n&&(r.clearExpiredFiles(),n.observe(r.updateUX,[n.Schema.Answer])),r}return F(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),0===this.allowedFileTypesCount&&Object(p.g)(this.props.Master.Question)},t.prototype.syncAnswerAndSession=function(){var e=this.props.Master;if(!this.fileUploadProcessMaster){var t=e.Question.Form;if(!t.isFieldReady(t.Schema.Id))return!1;this.fileUploadProcessMaster=new u.a(t.Model.Id)}var r=this.fileUploadProcessMaster,n=this.answersToSessions(),o=r.Model.uploadSessions,a=i.filter(o,(function(e){return"pending"===e.uploadState||!!i.find(n,(function(t){return t.uploadUrl===e.uploadUrl}))}));return i.forEach(n,(function(e){i.find(a,(function(t){return t.uploadUrl===e.uploadUrl}))||a.push(e)})),r.Model.uploadSessions=a,!0},t.prototype.createReactNodes=function(){if(!this.syncAnswerAndSession())return null;var e=this.props.Master;return[o.createElement("div",{key:e.Question.Model.Id,className:"office-form-uploadFile-container"},this.createUploadInfo(),this.createFileUploadDefaultButton(),this.fileInputContainer(),this.createHintTip(),this.createErrorMessage(),this.createRestrictions())]},t.prototype.createQuestionContent=function(){var t,r=this.props.Master.Question.Form;r.isFieldReady(l.c.Schema.Id)&&(t=Object(p.f)(r.Model.Id));var n=r.IsGroupForm?this.props.LocalizedStrings.UploadFile_GroupForm_Warning_Text:this.props.LocalizedStrings.UploadFile_Warning_Text;return t&&this.props.designElement?[o.createElement(h.a,{clickNoButton:function(){},clickContinueButton:this.onClickContinueButton,description:n,key:"dialog"})]:e.prototype.createQuestionContent.call(this)},t.prototype.answersToSessions=function(){return this.getParsedAnswers().map((function(e){return{fileName:e.name,key:e.link,uploadState:"success",uploadUrl:e.link}}))},t.prototype.createFileUploadDefaultButton=function(){var e=this.props,t=this.fileUploadProcessMaster.Model.uploadSessions.length,r=this.props.LocalizedStrings;if(!e.IsStudentViewMode&&t<e.Master.Question.Model.MaxFileCount&&!e.ShowQuizResult){var n="office-form-upload-container office-form-theme-primary-foreground";this.props.IsMobile&&(n=s.a.combineAttributes(n,"office-form-upload-container-width"));var o={className:n,disabled:e.Disabled,onClick:this.uploadFileInPut};Object(d.a)().Flighting.isEnabled("ResponderFileUpload")||(o.disabled=!0,o.title=e.LocalizedStrings.UploadFile_Service_Unavailable_Warning);var i=this.props.LocalizedStrings.UploadFile_Button+"\n            "+r.UploadFile_Max_File_Number.format(e.Master.Question.Model.MaxFileCount)+"\n            "+r.UploadFile_Single_File_Size.format(this.getFileSizeLimit())+"\n            "+r.UploadFile_Allowed_File_Type.format(this.getAllowedFileTypes());return o["aria-label"]=i,Object(m.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"Horizontal",HTMLAttributes:o,Icon:"Upload",IconClassName:"forms-icon-size18x18",Text:this.props.LocalizedStrings.UploadFile_Button,TextClassName:"office-form-upload-text"})}},t.prototype.uploadFileInPut=function(e){$(this.fileInputRef.current).val("").click()},t.prototype.fileInputContainer=function(){var e=Object(p.c)(this.props.Master.Question.Model.FileTypes),t="";e.forEach((function(e){t+="."+e+","}));var r={accept:t,className:"file-upload-question-file-reader",multiple:!0,onChange:this.onChange,ref:this.fileInputRef,type:"file"};return o.createElement("input",O({},r))},t.prototype.onChange=function(e){var t=this,r=e&&e.target,n=r&&r.files;if(this.fileUploadProcessMaster.Model.uploadSessions.length+n.length<=this.props.Master.Question.Model.MaxFileCount){if(this.validationFilesSize(n)&&this.validationFilesType(n)&&this.validateFileNames(n)){this.setState({ErrorMessage:""});var o=[];i.forEach(n,(function(e){var r=e.name.replace(/^.*[\\\/]/,"");r=r.replace(/[%#]/g,"-"),t.uploadFile(e,r),o.push(r)}));var a=o.join(" ");this.setState({ToolTip:this.props.LocalizedStrings.UploadFile_Uploading_Text.format(a)})}}else this.setErrorMessageWithTimeOut(this.props.LocalizedStrings.UploadFile_ExceedFileNumber_ErrorMessage)},t.prototype.validateFileNames=function(e){var t=this.fileUploadProcessMaster.Model.uploadSessions;return void 0===i.find(e,(function(r){return void 0!==i.find(e,(function(e){return e!==r&&e.name===r.name}))||void 0!==i.find(t,(function(e){return e.fileName===r.name}))}))||(this.setErrorMessageWithTimeOut(this.props.LocalizedStrings.UploadFile_FileNameExisted_ErrorMessage),!1)},t.prototype.validationFilesSize=function(e){var t=this,r=i.find(e,(function(e){return 0===e.size}));return r?(this.setErrorMessageWithTimeOut(this.props.LocalizedStrings.UploadFile_Error_Empty_File),!1):!(r=i.find(e,(function(e){return e.size>1024*t.props.Master.Question.Model.MaxFileSize*1024})))||(this.setErrorMessageWithTimeOut(this.props.LocalizedStrings.UploadFile_ExceedMaxsize_ErrorMessage),!1)},t.prototype.validationFilesType=function(e){var t=Object(p.c)(this.props.Master.Question.Model.FileTypes);return!i.find(e,(function(e){var r=e.name.split("."),n=r[r.length-1].toLowerCase();return-1===t.indexOf(n)}))||(this.setErrorMessageWithTimeOut(this.props.LocalizedStrings.UploadFile_WrongFileType_ErrorMessage),!1)},t.prototype.createUploadInfo=function(){var e,t=this,r=this.props,n=[];return(null===(e=this.fileUploadProcessMaster)||void 0===e?void 0:e.Model)&&(n=a.a.convertToArray(this.fileUploadProcessMaster.Model.uploadSessions)),i.map(n,(function(e){return o.createElement(I,{AutoFocus:e.fileName===t.state.SelectedFileName,Disabled:r.Disabled,FileKey:e.key,FileName:e.fileName,FilePath:e.uploadUrl,FileUploadProcessMaster:t.fileUploadProcessMaster,key:e.key,LocalizedStrings:r.LocalizedStrings,increaseUploadingFileCountCallBack:r.increaseUploadingFileCountCallBack,decreaseUploadingFileCountCallBack:r.decreaseUploadingFileCountCallBack,deleteFile:t.deleteFile,UploadState:e.uploadState,setFocusOnCurrentItem:t.setFocusOnCurrentItem,showFileInfo:r.ShowFileInfo,IsMobile:r.IsMobile})}))},t.prototype.createRestrictions=function(){var e=this.props,t=e.Master.Question.Model,r=this.getParsedAnswers().length+this.fileUploadProcessMaster.Model.uploadSessions.length,n=this.props.LocalizedStrings;if(!e.Disabled&&r<e.Master.Question.Model.MaxFileCount||e.ShowDesignInfo)return o.createElement("div",{className:"office-form-upload-restriction"},o.createElement("span",{className:"office-form-upload-restriction-text"},n.UploadFile_Max_File_Number.format(t.MaxFileCount)),o.createElement("span",{className:"office-form-upload-restriction-text"},n.UploadFile_Single_File_Size.format(this.getFileSizeLimit())),o.createElement("span",{className:"office-form-upload-restriction-text"},n.UploadFile_Allowed_File_Type.format(this.getAllowedFileTypes())))},t.prototype.createErrorMessage=function(){var e=this.state.ErrorMessage;if(e)return o.createElement("div",{className:"office-form-upload-file-error-message-container"},e)},t.prototype.createHintTip=function(){return o.createElement("div",{"aria-live":"assertive",className:"office-form-uploading-tip"},o.createElement("span",null,this.state.ToolTip))},t.prototype.getAllowedFileTypes=function(){var e=this;this.allowedFileTypesCount=0;var t=[],r=[],n=this.props.Master.Question.Model.FileTypes,o=this.props.LocalizedStrings;return Object.keys(n).forEach((function(i){var a=Object(p.a)(o,i);r.push(a),n[i]&&(e.allowedFileTypesCount++,t.push(a))})),0===this.allowedFileTypesCount?r.join(o.UploadFile_Comma):t.join(o.UploadFile_Comma)},t.prototype.uploadFile=function(e,t){var r=this;OfficeFormServerInfo.userInfo.UserId||Object(d.a)().AuthContext.redirectToLogin(),this.props.increaseUploadingFileCountCallBack&&this.props.increaseUploadingFileCountCallBack();var n=this.fileUploadProcessMaster,o=this.props.Master.Question,s={bytesToSend:0,fileName:t,fileSize:e.size,key:Date.now().toString(),uploadState:"pending"},c=n.Model.uploadSessions,u=a.a.Collection.addItems(c,[s])[0];this.setState({ErrorMessage:""}),n.uploadFile(e,t,o.Form.Model.Id,o.Model.Id,u).done((function(e){"success"===u.uploadState&&(r.setFileUploadAnswer(e,t),r.props.decreaseUploadingFileCountCallBack())})).fail((function(e){Object(f.a)({eventName:"DesignPage.Questions.FileUpload.UploadFailure",eventType:"engagement_event",extraData:{error:e}}),n.bulkEdit((function(t){r.uploadFileErrorHandling(e),c=i.reject(c,(function(e){return e.key===s.key})),t.uploadSessions=c}))}))},t.prototype.deleteFile=function(e,t,r,n){var o="";o="pending"===r?this.props.LocalizedStrings.UploadFile_Cancel_Upload_Label.format(t):this.props.LocalizedStrings.UploadFile_Delete_Uploaded_File_Label.format(t),this.setState({ToolTip:o}),this.props.decreaseUploadingFileCountCallBack();var s=this.fileUploadProcessMaster.Model.uploadSessions,c=i.find(s,(function(e){return e.key===n}));"rejected"!==c.uploadState&&(c.uploadState="rejected",e&&this.fileUploadProcessMaster.cancelOrDeleteUploadFile(e)),a.a.Collection.deleteItems(s,[c]);var u=this.getParsedAnswers(),l=i.findIndex(u,(function(t){return t.link===e}));-1!==l&&(u.splice(l,1),this.setAnswer(u))},t.prototype.setErrorMessageWithTimeOut=function(e){var t=this;setTimeout((function(){t.setState({ErrorMessage:e}),t.setState({ToolTip:e})}),this.waitingToShowErrorAlert)},t.prototype.uploadFileErrorHandling=function(e){if(e){var t=e.innerCode===c.b.CDBFormSchemaMismatch?this.props.LocalizedStrings.Error_Message_620:this.props.LocalizedStrings.UploadFile_Default_ErrorMessage;this.setErrorMessageWithTimeOut(t),this.props.decreaseUploadingFileCountCallBack&&this.props.decreaseUploadingFileCountCallBack()}},t.prototype.clearExpiredFiles=function(){var e=this.getParsedAnswers(),t=e.filter((function(e){return!e.time||Date.now()-e.time<864e5}));e.length!==t.length&&this.setAnswer(t)},t.prototype.setFileUploadAnswer=function(e,t){var r=this.getParsedAnswers(),n={link:e,name:t,uploadSessionUrl:e,time:Date.now()};r.push(n);var o=this.fileUploadProcessMaster.Model.uploadSessions;r.sort((function(e,t){return i.findIndex(o,(function(t){return t.uploadUrl===e.link}))-i.findIndex(o,(function(e){return e.uploadUrl===t.link}))})),this.setAnswer(r)},t.prototype.setAnswer=function(e){0===e.length?this.props.Master.Model.Answer=void 0:this.props.Master.Model.Answer=JSON.stringify(e)},t.prototype.getParsedAnswers=function(){var e=this.props.Master.Model.Answer,t=[];return e&&(t=JSON.parse(e)),t},t.prototype.onClickContinueButton=function(){var e=this.props.Master.Question;Object(p.h)(e.Form,!1),this.props.designElement(e)},t.prototype.getFileSizeLimit=function(){var e=this.props.Master.Question.Model.MaxFileSize,t=p.b,r="";return Object.keys(p.b).forEach((function(n){e===t[n]&&(r=n)})),r},t.prototype.setFocusOnCurrentItem=function(e){this.setState({SelectedFileName:e})},t}(M.a)},,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return I}));var n,o,i,a=r(0),s=r(24),c=r(45),u=r(5),l=r(13),d=r(26),f=r(9),p=r(210),m=r(37),h=r(114),g=r(31),y=r(12),b=r(90),v=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),S=function(){return(S=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};!function(e){e[e.Phishing=1]="Phishing",e[e.ThreatsCyberbullyingHarassment=2]="ThreatsCyberbullyingHarassment",e[e.ChildEndangermentExploitation=3]="ChildEndangermentExploitation",e[e.OffensiveContent=4]="OffensiveContent",e[e.VirusSpywareMalware=5]="VirusSpywareMalware",e[e.ContentInfringement=6]="ContentInfringement",e[e.Other=7]="Other"}(o||(o={})),function(e){e[e.NotReported=0]="NotReported",e[e.Reportting=1]="Reportting",e[e.Failed=2]="Failed",e[e.Succeed=3]="Succeed"}(i||(i={}));var I=function(e){function t(t){var r=e.call(this,t)||this;return r.state={Notes:"",ReportState:i.NotReported},r.clickSubmitButton=r.clickSubmitButton.bind(r),Object(f.a)({eventName:"ReportPage.Navigate",eventType:"engagement_event"}),r}return v(t,e),t.prototype.render=function(){var e,t=Object(c.c)();return e=this.state.ReportState===i.Succeed?a.createElement("div",{className:"office-form thank-you-page-content"},a.createElement(p.a,{ConfirmText:this.props.LocalizedStrings.Report_Page_Thanks,Message:this.props.LocalizedStrings.Report_Page_Submit_Succeed_Message})):a.createElement("div",{className:"office-form-body"},a.createElement("div",{className:"office-form-report-title-div"},a.createElement("span",{className:"office-form-report-title"},this.props.LocalizedStrings.Report_Page_Question)),a.createElement("div",{className:"office-form-report-choice-div"},this.createOptions(t)),a.createElement("div",null,this.createComments(),this.createSubmitButton())),a.createElement("div",null,this.createTitle(),a.createElement("div",null,e),a.createElement(b.a,{FormMaster:this.props.FormMaster}))},t.prototype.createTitle=function(){return a.createElement("div",{className:"office-form-title-container office-form-abuse-title office-form-theme-primary-background"},a.createElement("div",{className:"office-form-title small-size"},a.createElement("span",{role:"heading","aria-level":1},this.props.LocalizedStrings.Report_Page_Title)))},t.prototype.createOptions=function(e){var t=this,r=[],n=function(n){if(o[n]){var s=parseInt(n,10);if(!e&&s>o.Phishing&&s<o.ContentInfringement)return"continue";if(!isNaN(s)){var c=o[n],u={"aria-checked":i.state.Category===s,"aria-posinset":s+1,checked:i.state.Category===s,name:c,onChange:function(){return t.setState({Category:s})},role:"radio",type:"radio"},l=i.props.LocalizedStrings,d="Report_Page_Choice_"+c;r.push(a.createElement("div",{className:"radio office-form-question-choice office-form-question-choice-margin",key:s},a.createElement("label",{className:"office-form-question-choice-row office-form-question-choice-text-row"},a.createElement("input",S({},u)),a.createElement("span",{className:"office-form-question-choice-text-span office-form-report-text"},l[d]))))}}},i=this;for(var s in o)n(s);return r},t.prototype.createComments=function(){var e=this;if(this.state.Category===o.ContentInfringement){var r=t.addInlineLink(this.props.LocalizedStrings.Report_Page_Notice_content,"https://www.microsoft.com/info/cpyrtInfrg.aspx");return a.createElement("div",{className:"office-form-notice-contaienr"},a.createElement("div",null,a.createElement("span",{className:"office-form-report-text",dangerouslySetInnerHTML:{__html:r}})))}var n=Object(m.c)({MaxLength:500,MinimalHeight:100,onValueChange:function(t){return e.setState({Notes:t})},Options:{HTMLPropsForInnerElement:{"aria-label":this.props.LocalizedStrings.Report_Page_PlacheHolder}},Placeholder:this.props.LocalizedStrings.Report_Page_PlacheHolder,TextFieldType:m.a.AutoHeightMultiline,Value:this.state.Notes});return a.createElement("div",{className:"office-form-comments-container"},a.createElement("div",{className:"office-form-comments-title"},this.props.LocalizedStrings.Report_Page_Comments),a.createElement("div",{className:"office-form-comments-textfield"},n))},t.prototype.createSubmitButton=function(){var e=this.state.Category===o.ContentInfringement,t=this.state.ReportState===i.Reportting;if(!e){var r=e?this.props.LocalizedStrings.Report_Page_OkayButton:this.props.LocalizedStrings.Report_Page_SubmitButton,n={ButtonStyle:"LightBackground",HTMLAttributes:{className:u.a.combineAttributes("__submit-button__ office-form-bottom-button office-form-theme-button",t?"office-form-hide-text":""),disabled:t,onClick:this.clickSubmitButton},Text:t?this.props.LocalizedStrings.Report_Page_Submitting_Message:r},s=a.createElement(g.a,S({},n));return a.createElement("div",{className:"office-form-bottom-button-div"},s,this.createSpinner())}},t.prototype.submitReportLog=function(){Object(f.a)({eventName:"ReportPage.Submit",eventType:"engagement_event",extraData:{category:this.state.Category&&o[this.state.Category],formId:Object(c.a)()}})},t.prototype.submitReport=function(){var e=this;this.setState({ReportState:i.Reportting}),Object(d.b)().reportAbuse({Category:this.state.Category&&o[this.state.Category],Notes:this.state.Notes,Url:window.location.href}).done((function(){e.setState({ReportState:i.Succeed})})).fail((function(t){e.setState({ReportState:i.Failed})}))},t.addInlineLink=function(e,t){return l.x()||s.a.IsExternalIntegration?e.replace("<a>",'<a href="'+t+"\" target='_blank'>"):e.replace("<a>",'<a href="'+t+'" >')},t.prototype.clickSubmitButton=function(){this.submitReportLog(),this.state.Category!==o.ContentInfringement&&this.submitReport()},t.prototype.createSpinner=function(){if(this.state.ReportState===i.Reportting){return a.createElement("div",{className:"submit-spinner"},a.createElement("div",{className:"spinner-tile-animation"},a.createElement(h.a,{HTMLAttributes:{className:"screenReaderVisible"},LazyRendering:!0,Role:"Log"},this.props.LocalizedStrings.Response_Page_Submitting_Message)))}return null},t}(y.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n,o,i=r(0),a=r(2),s=r(5),c=r(9),u=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function l(){var e={MSRewardsDataState:o.NotAvailable};return null!=s.a.getQueries().vt&&FormsPro.isMSRewardsFeatureEnabledToC2User()&&(e.MSRewardsDataState=o.Available),e}!function(e){e[e.NotAvailable=1]="NotAvailable",e[e.NotAvailableDueToSettingChange=2]="NotAvailableDueToSettingChange",e[e.NotAvailableDueToCountryAvailablity=3]="NotAvailableDueToCountryAvailablity",e[e.ExhaustedPromocodes=4]="ExhaustedPromocodes",e[e.Available=5]="Available",e[e.Success=6]="Success",e[e.Failed=7]="Failed",e[e.SuccessWithNoData=8]="SuccessWithNoData"}(o||(o={}));var d=function(e){function t(t){return e.call(this,t)||this}return u(t,e),t.prototype.render=function(){var e=this,t=this.props.MSRewardsDataState;if(!FormsPro.isMSRewardsFeatureEnabled()||void 0===t)return null;var r="office-form-theme-footer thank-you-page-promotion office-form-padding-align msRewardsNotification";switch(t){case o.NotAvailable:case o.Available:return null;case o.NotAvailableDueToSettingChange:return i.createElement("div",{className:r+" msRewards_Text"},a.a.LocalizedStrings.RESPONSEPAGE_MICROSOFTREWARDS_NOTAVAILABLE);case o.ExhaustedPromocodes:case o.Failed:return i.createElement("div",{className:r+" msRewards_Text"},a.a.LocalizedStrings.RESPONSEPAGE_MSREWARDS_ERROR);case o.NotAvailableDueToCountryAvailablity:case o.SuccessWithNoData:return null;case o.Success:var n=this.props.MSRewardsData,s=a.a.LocalizedStrings.RESPONSEPAGE_MICROSOFTREWARDS_AVAILABLE;s=s.format(n.promoCode,n.sweepStake,n.promoCodeValidatiy,"https://go.microsoft.com/fwlink/p/?linkid=2101223");var u="https://account.microsoft.com/rewards/redeem/redeemcode?code={0}&ref=formspro&programname=formspro".format(n.promoCode);return i.createElement("div",{className:r},i.createElement("div",{className:"msRewards_Text",dangerouslySetInnerHTML:{__html:s}}),i.createElement("button",{className:"flex-pane-button msRewardsNotification_button",onClick:function(){Object(c.c)({type:"MFPUI_MSRewardsRedeemPromoCode",eventInfo:{tenantId:e.props.Form.Model.OwnerTenantId,formId:e.props.Form.Model.Id,responseId:e.props.ResponseId,Component:"Response Page"}}),window.open(u)},tabIndex:0,title:a.a.LocalizedStrings.Redeem_Reward},a.a.LocalizedStrings.Redeem_Reward));default:return null}},t}(i.Component);FormsPro.createMSRewardsThanksStatus=function(e){return i.createElement(d,e)},FormsPro.getMSRewardsDisclaimer=function(e){if(e.MSRewardsDataState===o.Success){var t=a.a.LocalizedStrings.RESPONSEPAGE_MSREWARDS_DISCLAIMER.format(e.MSRewardsData.promoCodeValidatiy);return i.createElement("div",{className:"office-form-theme-footer thank-you-page-promotion office-form-padding-align msRewardsNotification"},i.createElement("div",{className:"msRewards_Text",dangerouslySetInnerHTML:{__html:t}}))}return null},FormsPro.getInitilalResponseIncentiveState=l},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},,,function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n,o=r(0),i=r(2),a=r(28),s=r(9),c=r(31),u=r(12),l=r(120),d=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),f=function(){return(f=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buttonRef=o.createRef(),t}return d(t,e),t.prototype.render=function(){var e=o.createElement("div",{className:"introduction-title-container"},o.createElement("div",{className:"introduction-title"},i.a.LocalizedStrings.Form_Introduction_Title_MSA),o.createElement("a",{className:"office-form-try-link",href:"javascript:void(0)",onClick:m},i.a.LocalizedStrings.Form_Introduction_TryText_MSA)),t={ButtonStyle:"LightBackground",HTMLAttributes:{"aria-label":i.a.LocalizedStrings.Form_Introduction_CreateButtonText_MSA,className:"introduction-create-form",onClick:h,title:i.a.LocalizedStrings.Form_Introduction_CreateButtonText_MSA},ref:this.buttonRef,Text:i.a.LocalizedStrings.Form_Introduction_CreateButtonText_MSA},r=o.createElement(c.a,f({},t));return o.createElement("div",{className:"office-form introduction-for-responser-container"},e,o.createElement("div",{className:"introduction-container"},o.createElement("div",{className:"introduction"},o.createElement(l.a,{alt:i.a.LocalizedStrings.Form_Introduction_MSA_1,className:"introduction-image",key:"introductionImage1",src:"/Images/MSAIntroduction1.png"}),o.createElement("div",{className:"introduction-text"},i.a.LocalizedStrings.Form_Introduction_MSA_1)),o.createElement("div",{className:"introduction"},o.createElement(l.a,{alt:i.a.LocalizedStrings.Form_Introduction_MSA_2,className:"introduction-image",key:"introductionImage2",src:"/Images/MSAIntroduction2.png"}),o.createElement("div",{className:"introduction-text"},i.a.LocalizedStrings.Form_Introduction_MSA_2)),o.createElement("div",{className:"introduction"},o.createElement(l.a,{alt:i.a.LocalizedStrings.Form_Introduction_MSA_3,className:"introduction-image",key:"introductionImage3",src:"/Images/MSAIntroduction3.png"}),o.createElement("div",{className:"introduction-text"},i.a.LocalizedStrings.Form_Introduction_MSA_3))),o.createElement("div",{className:"introduction-button"},r))},t}(u.a);function m(){return Object(s.a)({eventName:"ResponsePage.IntroductionForResponser.TryForms",eventType:"engagement_event"}),Object(a.c)("/Pages/DesignPage.aspx"),!0}function h(){return Object(s.a)({eventName:"ResponsePage.IntroductionForResponser.Create",eventType:"engagement_event"}),Object(a.c)("/Pages/DesignPage.aspx"),!0}},function(e,t,r){"use strict";r.d(t,"a",(function(){return F}));var n,o=r(0),i=r(198),a=r(24),s=r(5),c=r(28),u=r(78),l=r(13),d=r(61),f=r(6),p=r(7),m=r(9),h=r(210),g=r(71),y=r(31),b=r(12),v=r(90),S=r(215),I=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),M=function(){return(M=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},F=function(e){function t(t){var r=e.call(this,t)||this;return r.contentRef=o.createRef(),r.titleRef=o.createRef(),r.notifyHeightToParentWindow=r.notifyHeightToParentWindow.bind(r),r}return I(t,e),t.prototype.componentDidMount=function(){Object(m.a)({eventName:"ResponsePage.ThanksView.Navigate",eventType:"engagement_event"}),l.x()&&(this.notifyHeightToParentWindow(),window.addEventListener("resize",this.notifyHeightToParentWindow))},t.prototype.componentWillUnmount=function(){l.x()&&window.removeEventListener("resize",this.notifyHeightToParentWindow)},t.prototype.render=function(){var e=this,t="office-form thank-you-page-content";this.props.viewResultsHandler&&(t=s.a.combineAttributes(t,"quiz")),this.props.submitAnother||(t=s.a.combineAttributes(t,"one-response"));var r,n=this.props.LocaleId,a=!l.x()&&Object(p.c)((function(){return o.createElement("div",{className:"thank-you-page-footer-container"},e.createPromotionLink(),o.createElement(v.a,{FormMaster:e.props.FormMaster}))}),(function(){var t;if(n){var r=d.a.getFormResourceMaster(n,e.props.FormMaster);t=r.Model.footerText}return e.props.FormMaster.ensureFieldsReady([e.props.FormMaster.Schema.FooterText]).done((function(){t=t||e.props.FormMaster.Model.FooterText})),e.props.msRewardsThankYouProps.Form=e.props.FormMaster,o.createElement("div",{className:"thank-you-page-footer-container"},FormsPro.createMSRewardsThanksStatus(e.props.msRewardsThankYouProps),o.createElement(v.a,{FooterText:t}),FormsPro.getMSRewardsDisclaimer(e.props.msRewardsThankYouProps))}));if(n){var c=d.a.getFormResourceMaster(n,this.props.FormMaster);r=c.Model.thankYouMessage}r=r||this.props.FormMaster.Model.ThankYouMessage||this.props.LocalizedStrings.Renderer_SubmissionSucceeded,Object(p.e)((function(){Object(f.a)().Flighting.isEnabled("FormsProRTFooter")&&(r=Object(g.b)({ContainsHtml:!0,RenderMode:"RichText",Text:r}))}));var u=Object(S.a)({Form:this.props.FormMaster,IsSmallSize:!0,LocaleId:n,ref:this.titleRef});Object(p.e)((function(){e.props.FormMaster.Model.CustomCssFileName&&""!==e.props.FormMaster.Model.CustomCssFileName&&(u=o.createElement(i.a,{CustomStyle:e.props.CustomStyle,Form:e.props.FormMaster,IsSlimTitle:!1,LocaleId:n})),Object(f.a)().Flighting.isEnabled("FormsProEmbedCompactPlus")&&Object(f.a)().Flighting.isEnabled("FormsProEmbedCompact")&&l.n()&&(u=null)}));var m=o.createElement(h.a,{ConfirmText:this.props.LocalizedStrings.Response_Page_Thanks,Message:r});return o.createElement("div",{className:"thank-you-page-root-container"},u,o.createElement("div",{ref:this.contentRef,className:t},m,o.createElement("div",{className:"thank-you-page-other"},this.createQuizButton(),this.createReloadLink())),a)},t.prototype.notifyHeightToParentWindow=function(){if(this.contentRef.current&&this.titleRef.current){var e=$(this.contentRef.current).height()+$(this.titleRef.current).height()+200,t=$(".form-content").height();e>t&&(e=t),u.a.notifyResponsePageFixedHeightToParentWindow(e)}},t.prototype.createQuizButton=function(){var e={ButtonStyle:"LightBackground",HTMLAttributes:{className:"office-form-view-result-button office-form-theme-button",onClick:this.props.viewResultsHandler},Text:this.props.LocalizedStrings.Response_Thank_You_Page_Button_Quiz_ViewResults};return this.props.viewResultsHandler&&o.createElement(y.a,M({},e))},t.prototype.createReloadLink=function(){var e=this,t="office-form-info-children",r="thank-you-page-reload-link";return this.props.viewResultsHandler&&(r=s.a.combineAttributes(r,"quiz")),l.x()&&(t=s.a.combineAttributes(t,"office-form-theme-spo-link")),FormsPro.baseOnly((function(){if(e.props.submitAnother)return o.createElement("div",{className:r},o.createElement("a",{className:t,href:"javascript:void(0)",onClick:e.props.submitAnother},e.props.LocalizedStrings.Response_Submit_Again_Link))}))},t.prototype.createPromotionLink=function(){if(this.props.ShowPromotionMessage&&!a.a.IsAssignmentsIntegration){var e={className:"office-form-info-children",href:"javascript:void(0)",onClick:P};(l.w()||a.a.IsExternalIntegration)&&(e.onClick=O);return o.createElement("div",{className:"office-form-theme-footer thank-you-page-promotion office-form-padding-align"},o.createElement("a",M({},e),this.props.LocalizedStrings.Renderer_PromotionMessage))}},t}(b.a);function O(){C();var e="/Pages/DesignPage.aspx";return a.a.IsExternalIntegration||(e+="?"+jQuery.param(l.j())),a.a.IsTeamsIntegration||l.w()?s.a.safeOpen(s.a.getAbsoluteUrl(e)):Object(c.c)(e),!0}function C(){return Object(m.a)({eventName:"ResponsePage.ThanksView.NavigateToPortal",eventType:"engagement_event"}),!0}function P(){return C(),Object(c.c)("/Pages/DesignPage.aspx"),!0}},,function(e,t,r){(function(e){var n=void 0!==e&&e||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;function i(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new i(o.call(setTimeout,n,arguments),clearTimeout)},t.setInterval=function(){return new i(o.call(setInterval,n,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(n,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},r(299),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,r(264))},,,,,,,,,,,,function(e,t,r){"use strict";r.d(t,"b",(function(){return Q})),r.d(t,"c",(function(){return q})),r.d(t,"a",(function(){return V}));var n=r(0),o=r(20),i=r(243),a=r(83),s=r(11),c=r(24),u=r(45),l=r(85),d=r(115),f=r(2),p=r(35),m=r(47),h=r(49),g=r(60),y=r(27),b=r(5),v=r(28),S=r(78),I=r(13),M=r(16),F=r(46),O=r(32),C=r(8),P=r(7),T=r(217),w=r(218),_=r(92),E=r(17),R=r(121),D=r(160),A=r(9),L=r(100),N=r(224),k=r(22),x=r(118),j=r(109),U=r(128),z=r(6),B=function(){function e(e,t){void 0===t&&(t=!0),this.storage=t?p.a.LocalStorage:p.a.SessionStorage,this.formId=e}return e.prototype.getAnswerMapId=function(){return e.KeyPrefix_AnswerMap+this.formId+"."+OfficeFormServerInfo.userInfo.UserId},Object.defineProperty(e.prototype,"Answers",{get:function(){var e=this.storage.getItem(this.getAnswerMapId());if(e){var t=JSON.parse(e);return Array.isArray(t)?t:void(this.Answers=void 0)}},set:function(e){e?this.storage.setItem(this.getAnswerMapId(),JSON.stringify(e)):this.storage.removeItem(this.getAnswerMapId())},enumerable:!0,configurable:!0}),e.prototype.getActiveSectionKey=function(){return e.KeyPrefix_ActiveSection+this.formId+"."+OfficeFormServerInfo.userInfo.UserId},Object.defineProperty(e.prototype,"SectionId",{get:function(){var e=this.getActiveSectionKey();return this.storage.getItem(e)||null},set:function(e){var t=this.getActiveSectionKey();e?this.storage.setItem(t,e):this.storage.removeItem(t)},enumerable:!0,configurable:!0}),e.KeyPrefix_AnswerMap="officeforms.answermap.",e.KeyPrefix_ActiveSection="officeforms.activesection",e}();function Q(e,t,r,n,o,i){var a=e.Model.Id;Object(u.g)((function(){return a})),Object(u.f)((function(){return e}));var s=y.a.newGuid();Object(P.e)((function(){I.w()&&Object(A.c)({type:"MFPUI_EmbedFormRenderStarted",eventInfo:{tenantId:OfficeFormServerInfo.userInfo.TenantId,requestId:s,Component:"RuntimeFormPage"}})}));var p,M,F,O=Object(d.b)("loadForm",t()),w=o;if(w||(w=Object(d.b)("responseStrings",f.a.loadLocalizedStrings())),r?(p=OfficeFormServerInfo.useDebugVersionScript?["BootStrap","JQuery_RateIt","Linkify","Linkify_JQuery","JQuery_Picker","JQuery_Picker_Date"]:["combined-response"],M=Object(d.b)("scripts",Object(l.b)(p))):M=$.Deferred().resolve().promise(),w.fail((function(e){S.a.notifyFormErrorToParentWindow({message:"LoadLocalizedStrings failure, error: "+(e&&e.message)})})).done((function(){return L.a.setExtraData("resourceStringLoaded",m.a.getTimeStamp())})),M.fail((function(e){S.a.notifyFormErrorToParentWindow({message:"LoadDependencies failure, error: "+(e&&e.message)})})).done((function(){return L.a.setExtraData("otherJsLoaded",m.a.getTimeStamp())})),Object(z.a)().Flighting.isEnabled("RetryTransientFailure")){F=window.setTimeout((function(){Object(z.a)().RetryingRecoverableError&&$(".page-loading-messagebox").append("<div>"+f.a.LocalizedStrings.RetryRecoverableErrorMessage_OpeningForm+"</div>")}),1e4)}O.fail(J).fail((function(){Object(P.e)((function(){I.w()&&Object(A.c)({type:"MFPUI_EmbedFormRenderFailed",eventInfo:{tenantId:OfficeFormServerInfo.userInfo.TenantId,requestId:s,Component:"RuntimeFormPage"}})}))})).done((function(){return L.a.setExtraData("formApiFinished",m.a.getTimeStamp())})).then((function(){return Object(g.d)("survey"===e.Model.Type)})).then((function(){return function(e){S.a.notifyFormInfoToParentWindow(e);var t=e.SyncContext===C.e.SharedTimeForm;if(function(e){if(!Object(z.a)().Flighting.isEnabled("ResponseInApp")||!e.Model.Settings.RespondInAppOnly)return!1;var t=!1;if(void 0===window.browser){if(I.D()){b.a.safeOpen("ms-edu-secureassessment:".concat(window.location.href).concat("!enforceLockdown"),"_self","directories=no,titlebar=no,toolbar=no,location=no,status=no,menubar=no,scrollbars=no,resizable=no"),V(!1,Error(f.a.LocalizedStrings.TakeATest_Win10),"Information")}else V(!1,Error(f.a.LocalizedStrings.TakeATest_NotWin10),"Information");t=!0}else E.a.logData({name:"ResponsePage.Form.OpenInTakeATest"});return t}(e))return $.Deferred().reject();var r=Object(P.e)((function(){return Object(z.a)().Flighting.isEnabled("FormsProEmbedCompact")&&Object(z.a)().Flighting.isEnabled("FormsProEmbedCompactPlus")&&I.n()})),n=h.a.isPPTIntegration()||c.a.IsAssignmentsIntegration||I.x();if(window.parent!==window&&!n&&!r&&(window.innerWidth<320||window.innerHeight<320||I.l()))return E.a.logData({name:"ResponsePage.EmbedView.BlockEmbed",extraData:{iFrameWidth:window.innerWidth,iFrameHeight:window.innerHeight,isAndroid:I.l()}}),H(),$.Deferred().reject();document.title=Object(P.c)((function(){return e.Model.Title}),(function(){return Object(x.d)(e.Model.Title?e.Model.Title.replace(/<[^>]*>/g,""):e.Model.Title)})),t?E.a.logData({name:"ShareFormPage.Copy.Navigate"}):E.a.logData({name:"ResponsePage.Form.Navigate"})}(e)})).then((function(){return!i&&function(e){var t=$.Deferred();e.SettingMaster.Model.IsAnonymous||OfficeFormServerInfo.userInfo.UserId?t.resolve():(E.a.logData({name:"Auth.NoUserInfoForNonanonymousForm"}),Object(v.d)());return t.promise()}(e)})).then((function(){return function(e){var t=b.a.getQueries().rid;return null!=t?e.getRuntimeResponse(t).then((function(e){return[e]})):e.Model.Settings.IsQuizMode&&e.SyncContext===C.e.ResponseTimeForm?Object(d.b)("releasedResponses",e.getReleasedResponsesByResponder(OfficeFormServerInfo.userInfo.Email)).done((function(){return L.a.setExtraData("responseApiFinished",m.a.getTimeStamp())})):$.Deferred().resolve().promise()}(e).fail(J)})).done((function(t){$.when(w,M).done((function(){Object(d.a)(),Object(D.d)(e),e.Model.LocaleList.length&&e.Synchronizer.setFieldsQueryJob([C.c.Schema.LocalizedResources],$.Deferred().resolve({localizedResources:[]}).promise()),t&&t.length?function(e,t,r){null!=b.a.getQueries().rid?E.a.logData({name:"ResponsePage.ViewResultView.Navigate"}):E.a.logData({name:"ResponsePage.StudentView.Navigate"});var n=e[e.length-1],o={Master:t,ViewMode:_.a.Auto,Response:n,PhishingReviewUXFactory:r};K(Object(T.b)(o))}(t,e,n):W(e,n),h.a.isRuntimePageAutoRefreshEnabled()&&function e(t){t.Synchronizer.query(C.c.FieldsToResponse).done((function(){setTimeout((function(){return e(t)}),1e4)})).fail((function(){setTimeout((function(){return e(t)}),1e4)}))}(e),Object(A.b)(),Object(P.e)((function(){I.w()&&Object(A.c)({type:"MFPUI_EmbedFormRenderCompleted",eventInfo:{tenantId:OfficeFormServerInfo.userInfo.TenantId,requestId:s,Component:"RuntimeFormPage"}})}))}))})),$.when(M,w,O).always((function(){Object(z.a)().Flighting.isEnabled("RetryTransientFailure")&&(window.clearTimeout(F),Object(z.a)().RetryingRecoverableError=!1)})),Object(N.a)($.when(M,w,O),"ResponsePage_Load")}function q(e,t){var r,n=Object(d.b)("responseStrings",f.a.loadLocalizedStrings());r=OfficeFormServerInfo.useDebugVersionScript?["BootStrap","JQuery_RateIt","Linkify","Linkify_JQuery","JQuery_Picker","JQuery_Picker_Date"]:["combined-response"];var o=Object(d.b)("scripts",Object(l.b)(r));if(n.fail((function(e){S.a.notifyFormErrorToParentWindow({message:"LoadLocalizedStrings failure, error: "+(e&&e.message)})})),o.fail((function(e){S.a.notifyFormErrorToParentWindow({message:"LoadDependencies failure, error: "+(e&&e.message)})})),Object(z.a)().Flighting.isEnabled("DataClassification")&&e.isFieldReady(e.Schema.DataClassificationLabel)){var i=F.a.getDataClassificationLabelDetail(e.Model.OwnerTenantId,e.Model.DataClassificationLabel);$.when(n,o,i).done((function(){Object(d.a)(),W(e,null,!0,t)}))}else $.when(n,o).done((function(){Object(d.a)(),W(e,null,!0,t)}))}function V(e,t,r){void 0===e&&(e=!0),f.a.loadLocalizedStrings().done((function(){var i=n.createElement(j.a,{Error:t,ErrorType:r,FormId:b.a.getQueries().id,IsResponsePage:!0,ShowCreateFormLink:e});Object(P.d)(),I.x()&&e?o.render(n.createElement("div",{className:"embed-view-spo"},n.createElement(U.a),i),document.getElementById("content-root")):o.render(i,document.getElementById("content-root")),Object(A.b)(t)}))}function H(){f.a.loadLocalizedStrings().done((function(){E.a.logData({name:"ResponsePage.EmbedView.Navigate"});var e=I.x()?"embed-view office-form-theme-primary-background":"embed-view",t=n.createElement("div",{className:e},n.createElement("div",{className:"embed-view-container"},Object(k.b)({HTMLAttributes:{className:"embed-view-icon"},IconName:"OfficeFormsLogo"}),n.createElement("span",{className:"embed-view-content"},f.a.LocalizedStrings.Page_Title),n.createElement("a",{className:"embed-view-content",onClick:function(){E.a.logData({name:"ResponsePage.EmbedView.OpenInBrowser"});var e=I.j(),t=window.location.pathname+"?";t+=jQuery.param(e),b.a.safeOpen(b.a.getAbsoluteUrl(t),"_blank","toolbar=yes, menubar=yes")}},f.a.LocalizedStrings.EmbedPage_Link)));I.x()&&(t=n.createElement("div",{className:"embed-view-spo"},n.createElement(U.a),t)),Object(P.d)(),o.render(t,document.getElementById("content-root"))}))}function W(e,t,r,n){var o=!e.Model.Settings.IsAnonymous,i=new B(e.Model.Id,o),s={PersistedAnswers:i.Answers,PrintView:r,PersistedSectionId:i.SectionId,Master:e,DisableSubmitButton:!1,ViewMode:_.a.Auto,persistAnswer:function(t){Object(P.c)((function(){i.Answers=t}),(function(){I.w()||(i.Answers=t)})),e.SyncContext===C.e.ResponseTimeForm&&(window.onbeforeunload=t?function(){return""}:null)},persistSectionId:function(e){Object(P.c)((function(){i.SectionId=e}),(function(){I.w()||(i.SectionId=e)}))},ForcedLocaleId:n,PhishingReviewUXFactory:t};a.a.supportsExtensionPoint(e.Model.Category,a.b.ResponsePagePollView)?"DetailResult"===b.a.getQueries().view?$.when(e.ensureFieldsReady([C.c.Schema.Questions,C.c.Schema.DescriptiveElements,C.c.Schema.Responses]),e.syncRuntimeResponses()).then((function(){Object(P.c)((function(){return K(Object(w.a)(s))}),(function(){return G(e,s,!0)}))}),J):Object(P.c)((function(){return K(Object(w.a)(s))}),(function(){return G(e,s,!0)})):Object(P.c)((function(){return K(Object(T.b)(s))}),(function(){return G(e,s,!1)}))}function G(e,t,r){e.ensureFieldsReady([C.c.Schema.CustomCssFileName,C.c.Schema.FooterText]).then((function(){e.Model.CustomCssFileName&&""!==e.Model.CustomCssFileName?function(e){var t=s.a.getFormsProApiFacadeHost();if(t)return Object(A.c)({type:"MFPUI_LoadCustomStylesStarted",eventInfo:{tenantId:OfficeFormServerInfo.userInfo.TenantId,formId:e,Component:"RuntimeFormPage"}}),Object(O.b)({requestUri:t+"api/downloadcustomcss",method:"post",body:JSON.stringify({FormId:e}),headers:[]}).then((function(t){return Object(A.c)({type:"MFPUI_LoadCustomStylesCompleted",eventInfo:{tenantId:OfficeFormServerInfo.userInfo.TenantId,formId:e,Component:"RuntimeFormPage"}}),t})).fail((function(t){Object(A.c)({type:"MFPUI_LoadCustomStylesFailed",eventInfo:{tenantId:OfficeFormServerInfo.userInfo.TenantId,formId:e,Component:"RuntimeFormPage",message:t}})}))}(e.Model.Id).then((function(e){e?(t.CustomStyle=e,K(r?Object(w.a)(t):Object(T.b)(t))):J("")})).fail((function(e){J(e)})):K(r?Object(w.a)(t):Object(T.b)(t))}),J)}function K(e){var t;if(t=I.x()?"office-form-theme-page-background office-form-spo-embed":"office-form-theme-page-background",Object(P.d)(),D.c.mark(D.a.FP_RenderResponseFormStart),o.render(n.createElement("div",{id:"form-container",className:t},n.createElement("div",{className:"form-content"},e)),document.getElementById("content-root")),D.c.measure(D.b.FP_RenderResponseForm,D.a.FP_RenderResponseFormStart),window.performance){var r=L.a.getExtraDataToLog();r.measures=D.c.getMeasures(),R.a.logData({name:"Endpoint.ResponsePage",extraData:r})}Object(P.e)((function(){I.w()&&parent.postMessage("ResponsePageLoaded","*")}))}function J(e){if(e)switch(S.a.notifyFormErrorToParentWindow(e),e.innerCode){case M.b.CDBTableMoved:var t=b.a.updateUrlParam(window.location.href,"id",e.innerMessage);t!==window.location.href&&Object(v.c)(t);break;case M.b.FormClosed:V(!0,e);break;case M.b.EmbedFormNeedAuth:E.a.logData({name:"ResponsePage.EmbedView.NeedAuth"}),Object(i.a)().done((function(){setTimeout((function(){Object(z.a)().AuthContext.signIn().then(v.b)}))})).fail(H);break;case M.b.NetworkIssue:V(!1,e);break;default:V(!0,e)}else V(!0,null,"Error")}},,function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},function(e,t){function r(e){return $.expr.filters.visible(e)&&!$(e).parents().addBack().filter((function(){return"hidden"===$.css(this,"visibility")})).length}$.extend($.expr[":"],{focusable:function(e){
/*!
 * jQuery UI Core @VERSION
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */
return function(e,t){var n,o,i,a=e.nodeName.toLowerCase();return"area"===a?(o=(n=e.parentNode).name,!(!e.href||!o||"map"!==n.nodeName.toLowerCase())&&(!!(i=$("img[usemap=#"+o+"]")[0])&&r(i))):(/input|select|textarea|button|object/.test(a)?!e.disabled:"a"===a&&e.href||t)&&r(e)}(e,!isNaN($.attr(e,"tabindex")))}})},,,,,,,,,,,,,function(e,t,r){(function(e,t){!function(e,r){"use strict";if(!e.setImmediate){var n,o,i,a,s,c=1,u={},l=!1,d=e.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(e);f=f&&f.setTimeout?f:e,"[object process]"==={}.toString.call(e.process)?n=function(e){t.nextTick((function(){m(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?e.MessageChannel?((i=new MessageChannel).port1.onmessage=function(e){m(e.data)},n=function(e){i.port2.postMessage(e)}):d&&"onreadystatechange"in d.createElement("script")?(o=d.documentElement,n=function(e){var t=d.createElement("script");t.onreadystatechange=function(){m(e),t.onreadystatechange=null,o.removeChild(t),t=null},o.appendChild(t)}):n=function(e){setTimeout(m,0,e)}:(a="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(a)&&m(+t.data.slice(a.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),n=function(t){e.postMessage(a+t,"*")}),f.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),r=0;r<t.length;r++)t[r]=arguments[r+1];var o={callback:e,args:t};return u[c]=o,n(c),c++},f.clearImmediate=p}function p(e){delete u[e]}function m(e){if(l)setTimeout(m,0,e);else{var t=u[e];if(t){l=!0;try{!function(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(void 0,r)}}(t)}finally{p(e),l=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,r(264),r(247))},,,,,,,,,,,,,,,,,function(e,t,r){"use strict";var n,o=r(0),i=r(45),a=r(57),s=r(8),c=r(2),u=r(9),l=r(31),d=r(22),f=r(12),p=r(90),m=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),h=function(){return(h=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},g=function(e){function t(t){var r=e.call(this,t)||this;return r.hideWarningPage=r.hideWarningPage.bind(r),r.state={display:!0},r}return m(t,e),t.prototype.render=function(){if(!this.state.display)return null;Object(u.a)({eventName:"ResponsePage.PhishingWarningPage.Navigate",eventType:"engagement_event"});var e=Object(d.b)({HTMLAttributes:{className:"forms-icon-size80x80 phishing-warning-page-reporthacked-icon"},IconName:"ReportHacked",key:"reportHackedIcon"}),t={ButtonStyle:"LightBackground",HTMLAttributes:{className:"phishing-warning-page-button office-form-theme-button",onClick:y},key:"closePageButton",ref:"closePageButton",Text:c.a.LocalizedStrings.Phishing_Warning_Page_ClosePage_Button},r={ButtonStyle:"LightBackground",HTMLAttributes:{className:"phishing-warning-page-continue-button light-background-button",onClick:this.hideWarningPage},key:"continueButton",ref:"continueButton",Text:c.a.LocalizedStrings.Phishing_Warning_Page_Continue_Button};return o.createElement("div",{className:"phishing-warning-page"},o.createElement("div",{className:"phishing-warning-page-container"},o.createElement("div",null,e),o.createElement("div",{className:"phishing-warning-page-title"},c.a.LocalizedStrings.Phishing_Warning_Page_Title),o.createElement("div",{className:"phishing-warning-page-subtitle"},c.a.LocalizedStrings.Phishing_Warning_Page_Subtitle),o.createElement("div",{className:"phishing-warning-page-close-button-container"},o.createElement(l.a,h({},t))),o.createElement("div",{className:"phishing-warning-page-continue-button-container"},o.createElement(l.a,h({},r)))),o.createElement(p.a,null))},t.prototype.hideWarningPage=function(){Object(u.a)({eventName:"ResponsePage.PhishingWarningPage.Continue",eventType:"engagement_event"}),this.setState({display:!1})},t}(f.a);function y(){Object(u.a)({eventName:"ResponsePage.PhishingWarningPage.ClosePage",eventType:"engagement_event"}),window.open("about:blank","_self").close()}var b=r(195);function v(e){return e.SyncContext===s.e.AdminPhishingReviewForm}r.d(t,"a",(function(){return S}));var S=function(){function e(){}return e.prototype.createAdminPhishingReviewNavBar=function(e,t){return v(e)?o.createElement(b.a,{FormMaster:e,SetErrorStateCallback:t}):null},e.prototype.createPhishingWarningPage=function(e,t){return Object(i.c)()&&!t&&!v(e)&&e.SyncContext===s.e.ResponseTimeForm&&(e.Model.OnlineSafetyLevel===a.a.PhishingFromCustomerReport||e.Model.OnlineSafetyLevel===a.a.Suspicious||e.Model.OnlineSafetyLevel===(a.a.Suspicious|a.a.PhishingFromCustomerReport))?o.createElement(g,null):null},e}()},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n,o=r(160),i=r(2),a=r(158),s=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),c=function(e){function t(){var t=e.call(this,window.FormPrefetchCache.stringCache)||this;return t.init(),t}return s(t,e),t.prototype.onPrefetchSucceed=function(){try{o.c.mark(o.a.FP_ParseResourceStringStart),i.a.LocalizedStrings=JSON.parse(this.cache.data).d,o.c.measure(o.b.FP_ParseResourceString,o.a.FP_ParseResourceStringStart),this.prefetchDeferred.resolve(i.a.LocalizedStrings)}catch(e){this.fallBackToNormalBoot()}},t.prototype.onPrefetchFaied=function(){this.fallBackToNormalBoot()},t.prototype.fallBackToNormalBoot=function(){var e=this;i.a.loadLocalizedStrings().done((function(){return e.prefetchDeferred.resolve()})).fail((function(t){return e.prefetchDeferred.reject(t)}))},t}(a.a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var n,o=r(16),i=r(67),a=r(32),s=r(6),c=r(160),u=r(9),l=r(74),d=r(54),f=r(5),p=r(28),m=r(158),h=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),g=function(e){function t(t,r){var n=e.call(this,window.FormPrefetchCache.formCache)||this;return n.formMaster=t,n.eventName=r,n.init(),n}return h(t,e),t.prototype.onPrefetchSucceed=function(){var e=this;this.removeCallbacks(),setTimeout((function(){c.c.mark(c.a.FP_ParseFormResponseStart),e.updateFormModel(),c.c.measure(c.b.FP_ParseFormResponse,c.a.FP_ParseFormResponseStart),e.prefetchDeferred.resolve()}),0),this.logQosEventForPrefetchRequest(!0,null)},t.prototype.updateFormModel=function(){var e=this.cache.data;this.formMaster.Synchronizer.onSourceDataReceived("object"==typeof e?e:JSON.parse(e))},t.prototype.onPrefetchFaied=function(){var e=this;this.removeCallbacks();var t=this.cache.error;if(this.logQosEventForPrefetchRequest(!1,t),t&&t.response&&t.response.statusCode===o.a.Unauthorized)if(Object(l.c)(t))Object(l.d)().done((function(){Object(d.i)((function(){return e.fallBackToNormalBoot()}),p.d)}));else{var r=a.a.convertToResponseError(t);if(!a.a.tryHandleRequireLogin(r)){switch(r.innerCode){case o.b.EmbedFormNeedAuth:Object(s.a)().Flighting.isEnabled("PrefetchFormAuthFix")?this.fallBackToNormalBoot():this.prefetchDeferred.reject(r);break;case o.b.LoginNotSupportInCurrentBrowser:return void this.prefetchDeferred.reject(r)}this.fallBackToNormalBoot()}}else this.fallBackToNormalBoot()},t.prototype.fallBackToNormalBoot=function(){var e=this;this.formMaster.ensureReadyToResponse().done((function(){return e.prefetchDeferred.resolve()})).fail((function(t){return e.prefetchDeferred.reject(t)}))},t.prototype.logQosEventForPrefetchRequest=function(e,t){var r,n=t&&Object(a.c)(OfficeFormServerInfo.prefetchFormUrl,t);r=e?"Success":Object(i.b)(n)?"ExpectedFailure":"Failure";var o=Object(s.a)().Flighting.isEnabled("PrefetchFormAuthFix"),c="";!e&&o&&(c=f.a.getQueries());var l={correlationId:this.cache.logData.correlationId,duration:this.cache.logData.duration,eventName:this.eventName+"."+r,eventType:"qos_event",extraData:{flightQueries:c,prefetch:!0,prefetchAuthFix:o}};n&&(l.extraData.ServiceError=n),Object(u.a)(l)},t.prototype.removeCallbacks=function(){this.cache.errorCallback&&(this.cache.errorCallback=null),this.cache.successCallback&&(this.cache.successCallback=null)},t}(m.a)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";r(231);var n,o=r(115),i=r(481),a=r(480),s=r(47),c=r(5),u=r(13),l=r(8),d=r(160),f=r(9),p=r(100),m=r(224),h=r(40),g=r(316),y=r(6),b=r(282);function v(){return Object(y.a)().Flighting.isEnabled("PrefetchForm")&&(!u.w()||Object(y.a)().Flighting.isEnabled("PrefetchFormAuthFix"))}Object(y.b)(),Object(y.a)().setFlightsBasingOnAuth_Deprecated(OfficeFormServerInfo.flights),Object(h.f)(),(n=Object(o.b)("pre-auth",Object(y.a)().AuthContext.handleAuthForContentPage(!1))).done((function(){p.a.setExtraData("authEnd",s.a.getTimeStamp()),Object(f.a)({eventName:"session_start",eventType:"session_start"}),d.c.mark(d.a.FP_CreateFormMasterStart);var e=Object(l.k)(c.a.getQueries().id);if(d.c.measure(d.b.FP_CreateFormMaster,d.a.FP_CreateFormMasterStart),Object(b.b)(e,(function(){return function(e){return v()?new i.a(e,"ResponseForm.Get").getPromise():e.ensureReadyToResponse()}(e)}),!Object(y.a)().Flighting.isEnabled("ReduceLibJsSize"),new g.a,function(){if(v())return(new a.a).getPromise()}()),c.a.getQueries().qrcode&&Object(f.a)({eventName:"ResponsePage.Form.QRCode",eventType:"engagement_event"}),c.a.getQueries().nocdn&&Object(f.a)({eventName:"ResponsePage.CdnFallback",eventType:"error_event"}),u.w()){var t=c.a.getQueries().platform,r=c.a.getQueries().host,n=void 0;(t||r)&&(n={host:r,platform:t}),Object(f.a)({eventName:"ResponsePage.EmbedView.IsEmbeddedSession",eventType:"engagement_event",extraData:n})}})).fail((function(e){Object(b.a)(!1,e)})),Object(m.a)(n,"ResponsePage_HandleAuth")},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";r.r(t);r(223),r(222),r(971)}]);